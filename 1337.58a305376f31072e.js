"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[1337],{91337:(de,W,f)=>{f.r(W),f.d(W,{BulkEditFilter:()=>V,BulkEditReplace:()=>re,BulkEditViewModel:()=>oe});var w=f(10467),p=f(86739),e=f(8787),P=f(95707),R=f(32647),H=f(36466),v=f(24028),x=f(31820),Y=f(23823),B=f(49710),M=f(18569),L=f(92701),O=f(38859),U=f(71336),G=f(35725),X=f(83240),j=f(89417),I=f(54438),Z=f(60177),_=f(8495),Q=f(73955);function z(E,a){if(1&E&&(I.j41(0,"div",3),I.EFF(1,"\n            "),I.eu8(2,10),I.EFF(3,"\n        "),I.k0s()),2&E){const t=I.XpG();I.R7$(2),I.Y8G("obj",t.obj.AppRejDate)("group",t.form)}}function $(E,a){if(1&E){const t=I.RV6();I.j41(0,"button",6),I.bIt("click",function(){I.eBV(t);const l=I.XpG();return I.Njj(l.obj.onClickIkon("Suspend"))}),I.EFF(1),I.nI1(2,"translate"),I.k0s()}2&E&&(I.R7$(),I.JRh(I.bMT(2,1,"Suspend")))}let q=(()=>{class E{constructor(){}ngOnInit(){this.form=new j.gE({})}static#e=this.\u0275fac=function(r){return new(r||E)};static#t=this.\u0275cmp=I.VBU({type:E,selectors:[["app-bulk-edit-approve-component"]],inputs:{obj:"obj"},decls:35,vars:12,consts:[[1,"master-screen",2,"padding-bottom","4px","min-width","400px"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group row form-row col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"fa-light","fa-rectangle-xmark"],["FieldDirective","",3,"obj","group"]],template:function(r,l){1&r&&(I.j41(0,"div",0),I.EFF(1,"\n    "),I.j41(2,"div",1),I.EFF(3,"\n        "),I.DNE(4,z,4,2,"div",2),I.EFF(5,"\n        "),I.j41(6,"div",3),I.EFF(7,"\n            "),I.eu8(8,4),I.EFF(9,"\n        "),I.k0s(),I.EFF(10,"\n        \n    "),I.k0s(),I.EFF(11,"\n    "),I.j41(12,"div",5),I.EFF(13,"\n      "),I.j41(14,"div"),I.EFF(15,"\n        "),I.j41(16,"button",6),I.bIt("click",function(){return l.obj.onClickIkon("Approve")}),I.EFF(17),I.nI1(18,"translate"),I.k0s(),I.EFF(19,"\n        "),I.j41(20,"button",7),I.bIt("click",function(){return l.obj.onClickIkon("Reject")}),I.EFF(21),I.nI1(22,"translate"),I.k0s(),I.EFF(23,"\n        "),I.DNE(24,$,3,3,"button",8),I.EFF(25,"\n        "),I.EFF(26,"\n        "),I.j41(27,"button",7),I.bIt("click",function(){return l.obj.Cancelclick()}),I.nrm(28,"i",9),I.EFF(29),I.nI1(30,"translate"),I.k0s(),I.EFF(31,"\n      "),I.k0s(),I.EFF(32,"\n      \n  "),I.k0s(),I.EFF(33,"\n"),I.k0s(),I.EFF(34,"\n")),2&r&&(I.R7$(4),I.Y8G("ngIf",l.obj.AppRejDate.Visible),I.R7$(4),I.Y8G("obj",l.obj.Remarks),I.R7$(9),I.JRh(I.bMT(18,6,"btnApprove")),I.R7$(4),I.JRh(I.bMT(22,8,"btnReject")),I.R7$(3),I.Y8G("ngIf",l.obj.SuspendVisiblity),I.R7$(5),I.JRh(I.bMT(30,10,"Cancel")))},dependencies:[Z.bT,_._,Q.D9],encapsulation:2})}return E})();var ee=f(70824),F=f(9524),te=f(97965),ie=f(38410),se=f(27392),K=f(43756),ne=f(73988),le=f(98669),k=f(95543),ae=f(78906);class oe extends Y.g{get AppDisplayMessage(){return this._AppDisplayMessage}set AppDisplayMessage(a){a!=this._AppDisplayMessage&&(this._AppDisplayMessage=a,this.AppMessageVisibility=!e.J0.IsEmpty(this._AppDisplayMessage))}constructor(a,t=null){super(),this.ButtonApprove=new H.v,this.AppMessageVisibility=!1,this.HeaderAppearance=new O.bA,this.TextDataAppearance=new O.bA,this.NumberDataAppearance=new O.bA,this.SavePDF=new k.u("LW Document",10,"Group1"),this.SaveXLS=new k.u("LW Document",10,"Group1"),this.SaveXLSX=new k.u("LW Document",10,"Group1"),this._AppDisplayMessage="",this.VoucherData=new Array,this.TrasUserVisibility=!1,this.TranserUserVisiblity=!1,this.strOldUserID="",this.Remarks=new x.Dw(0),this.AppRejDate=new v.Lc(0),this.SuspendVisiblity=!1,this.CostCenterName="",this.ReplaceVisibility=!1,this.DeleteVisibility=!1,this.ShowRightPanel=!0,this.SaveButtonVisible=!1,this.ExportButtonVisible=!1,this.IsBarcode=!1,this.HideTitle=!1,this.Replace=null,this.IsLWApproval=!1,this.ID=0,this.intLinkDimCC=0,this.CostCenterID=0,this.MainTableName="",this.dvFields=null,this.dvFieldsNew=null,this.IsDetailVoucher=!1,this.IsSelectOnRowLeave=!0,this.IsApproval=!1,this.IsProductExists=!1,this.HideFilterDialog=!1,this.HideProductImage=!1,this.ShowFilter=!1,this.UpdateOnApproval=!1,this.RemarksApprove=!1,this.RemarksReject=!1,this.RemarksSuspend=!1,this.SelectedFields=[],this.DateColIDs=new Array,this.EditColumns=new Array,this.EditColumnsDr=[],this.Entities=new P.bT,this.strWhereforAuctionHistory="",this.ProductImageVisibility=!1,this.ApproveVisibility=!1,this.PhotoTextVisibility=!1,this.ProductID=0,this.ProductPhoto="",this.ImportIsCode=!1,this.ImportVisiblity=!1,this.ExportVisibility=!1,this.ReportID=0,this.DB=null,this.IsDocument=!1,this.PrimaryKey="",this.PrimaryColumns="",this.ReportObj=null,this.Report=[],this.AddressFields=new Array,this.docAllowCols=["billno","billdate","linenarration","commonnarration","chequenumber","chequematuritydate"],this.ReportFilterVisible=!1,this.oDocPayroll=null,this.vnofield="",this.dimfield="",this.cprimary=null,this.strVoucherNo="VoucherNo",this.dicBarLayouts=new P.bT,this.ClassName="BulkEditViewModel",this.FromDate=new v.Lc,this.FromDate.Label=p.d.GetResource("Calender_FromDate"),this.ToDate=new v.Lc,this.ToDate.Label=p.d.GetResource("Calender_ToDate"),this.FromDate.CustomFormat=p.d.SessionManager.Preferences["Date Format"],this.ToDate.CustomFormat=p.d.SessionManager.Preferences["Date Format"],this.FromDate.Date=e.J0.ParseDate(p.d.SessionManager.AccountingDate),this.ToDate.Date=new Date,this.DateRanges=X.w.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.AppRejDate.CustomFormat=p.d.SessionManager.Preferences["Date Format"],this.AppRejDate.Date=new Date,this.SavePDF.Label="PDF",this.SaveXLS.Label="Spreadsheet (xlsx)",this.SaveXLSX.Label="Spreadsheet (Open xlsx)",this.ID=a,this.DB=t,this.TargetUserID=new le.y$(0),this.TargetUserID.CCID=7,this.TargetUserID.TypeID=4,this.InitGrids(),this.EditGrid.SelectAll.Visible=!0,this.Margin="2",null!=t&&(this.HideFilterDialog=!0,this.ShowRightPanel=!1,this.HideTitle=!0,this.EditGrid.SearchCols.Width="140",this.EditGrid.SearchOptions.Width="100",this.EditGrid.SearchText.Width="130",this.Margin="2"),this.HideFilterDialog&&(this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,(null!=this.ReportObj&&this.ReportObj.IsDefaultSortColumnExists||p.d.SessionManager.IsWebApplication)&&(this.bgWorker_DoWork(null,null),this.bgWorker_RunWorkerCompleted(null,null)))}bgWorker_DoWork(a,t){null!=this.ReportObj?null!=this.ReportObj.oReportDialog?this.ReportObj.oReportDialog.OnOkClick("OK"):this.ReportObj.Filter.OnButtonClick("OK"):this.RefreshData()}bgWorker_RunWorkerCompleted(a,t){this.DisplayName=this.Title,null==this.DB&&this.HideFilterDialog&&null!=this.EditGrid.Table&&0==this.EditGrid.Table.length&&(this.DisplayMessage="No Data Available.")}AddAddressColumns(a,t){let r,l=["ContactPerson","Address1","Address2","Address3","City","State","Zip","Country","Phone1","Phone2","Fax","Email1","Email2","URL","AddressName"],D="Account",s=a.filter(m=>m.CostCenterID==t);s.length>0&&(D=s[0].CostCenterName.toString());for(let m=0;m<l.length;m++)r={},r.SysTableName="COM_Address",r.UserColumnName=r.SysColumnName=l[m],r.ColumnCostCenterID=r.CostCenterID=t,r.CostCenterName=D,r.CostCenterColID=4e5+m+200*t,r.IsForeignKey=!1,r.IsColumnUserDefined=!1,a.push(r)}AddPmsUserColumns(a,t){let r,D="User",s=a.filter(m=>m.CostCenterID==t);s.length>0&&(D=s[0].CostCenterName.toString()),r={},r.SysTableName="ADM_Users",r.UserColumnName="Transer User",r.SysColumnName="ccAlpha13",r.CostCenterID=t,r.CostCenterName=D,r.CostCenterColID=15408700,r.IsForeignKey=!1,r.IsColumnUserDefined=!1,r.UserColumnType="LISTBOX",r.ColumnDataType="LISTBOX",r.ParentCostCenterID=7,r.ColumnCostCenterID=7,r.ColumnCCListViewTypeID=4,a.push(r)}InitGrids(){this.SaveButtonVisible=!0,this.ExportButtonVisible=p.d.SessionManager.IsActionAssigned(49,"Bulk Export Data");let a=p.d.common.BulkEditDetals(6,this.ID,0);null!=a&&a.Tables.length>3&&a.Tables[3].length>0&&!e.J0.IsEmpty(a.Tables[3][0].PrefValue.toString())&&(this.intLinkDimCC=e.J0.IntTryParse(e.J0.String(a.Tables[3][0].PrefValue))),this.CostCenterID=parseInt(a.Tables[0][0].CostCenterID),this.DisplayName=e.J0.String(a.Tables[0][0].Name),this.Title=this.DisplayName,this.MainTableName=e.J0.String(a.Tables[1][0].TableName),this.CostCenterName=e.J0.String(a.Tables[1][0].Name);let t=p.d.common.BulkEditDetals(2,0,this.CostCenterID);2==this.CostCenterID&&this.AddAddressColumns(t.Tables[0],this.CostCenterID),this.intLinkDimCC==this.CostCenterID&&this.AddPmsUserColumns(t.Tables[0],this.intLinkDimCC);let r=new e.VB,l=new e.VB;r.LoadXml(e.J0.String(a.Tables[0][0].Options)),this.IsSelectOnRowLeave=null!=r.SelectSingleNode("XML/SelectOnRowLeave"),this.IsDetailVoucher=null!=r.SelectSingleNode("XML/DetailsVoucher"),this.HideFilterDialog=null!=r.SelectSingleNode("XML/HideFilterDialog"),this.HideProductImage=null!=r.SelectSingleNode("XML/HideProductImage"),this.IsApproval=null!=r.SelectSingleNode("XML/ApproveDocuments"),this.ShowFilter=null!=r.SelectSingleNode("XML/ShowFilter"),this.IsApproval&&(this.RemarksApprove=null!=r.SelectSingleNode("XML/RemarksApprove"),this.RemarksReject=null!=r.SelectSingleNode("XML/RemarksReject"),this.RemarksSuspend=null!=r.SelectSingleNode("XML/RemarksSuspend"),this.UpdateOnApproval=null!=r.SelectSingleNode("XML/UpdateOnApproval"),this.ExportButtonVisible=!1),this.IsBarcode=null!=r.SelectSingleNode("XML/BarcodePrint"),this.IsBarcode&&(this.SaveButtonVisible=!1,this.IsDetailVoucher=!0,this.ExportButtonVisible=!1),3==this.CostCenterID&&!this.HideProductImage&&(this.ProductImageVisibility=!0),this.CostCenterID>4e4&&this.CostCenterID<5e4?(this.IsDocument=!0,this.IsLWApproval=!!(this.IsDetailVoucher&&a.Tables[2].length>0&&1==parseInt(a.Tables[2][0].IsLineWise)),this.AppRejDate.Visible=t.Tables[3].filter(C=>"AppDate"==C.PrefName&&"True"==C.PrefValue).length>0):this.AppRejDate.Visible=!1;let s,D=t.Tables[0];this.dvFields=D,this.dvFieldsNew=D,null!=r.SelectSingleNode("XML/Report")?(this.ReportID=parseInt(r.SelectSingleNode("XML/Report").innerHTML),this.InitReport()):this.ReportID=0,(this.IsDocument||2==this.CostCenterID||3==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID||this.CostCenterID>5e4)&&this.IsApproval&&p.d.SessionManager.IsActionAssigned(49,"Document Bulk Approval")?(this.ButtonApprove.Visible=!0,this.SaveButtonVisible=!1,this.IsDocument&&this.IsLWApproval&&(this.SuspendVisiblity=p.d.SessionManager.IsActionAssigned(this.CostCenterID,"Suspend"))):this.ButtonApprove.Visible=!1,(2==this.CostCenterID||3==this.CostCenterID||this.CostCenterID>5e4)&&(this.DeleteVisibility=p.d.SessionManager.IsActionAssigned(49,"Bulk Delete"),this.DeleteVisibility&&(this.DeleteVisibility=p.d.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"))),this.EditGrid=new B.vv,this.EditGrid.Width="",this.EditGrid.Height=void 0,this.EditGrid.CanUserDeleteRows=!1,this.EditGrid.Columns=[],this.EditGrid.SearchVisible=!0,this.EditGrid.SearchColStartIndex=1,this.EditGrid.CanUserSortColumns=!0,this.EditGrid.Visible=!1,this.EditGrid.CellEditEnding.Subscribe(this,"EditGridOnCellEditEnding"),this.EditGrid.OnPreviewKeyDown.Subscribe(this,"OnKeyDown"),this.Report.length>0&&this.EditGrid.Clear(),s=new M.O7,s.Header="Select",s.DisplayMember="Select",s.DataType="CheckBox",s.Width=50,s.IsFrozen=!p.d.IsNativeMobile,s.DisableTab=!0,this.EditGrid.Columns.push(s);let m=0;r.LoadXml(e.J0.String(a.Tables[0][0].FieldsXML));let h=new Array;if(this.IsDocument){let C=new U.PE,i=[];t.Tables[1].forEach(n=>{i.Clear(),C.ParseFormula(e.J0.String(n.Formula),i);let d=null;for(let u=i.length-1;u>=0;u--)d=i[u],d.getTokenClass()==U.C3.OPERAND&&d.getTokenType()==U.Wz.REFERENCE&&!h.Contains(d.tokenValue.toString())&&h.push(d.tokenValue.toString())})}if(this.intLinkDimCC==this.CostCenterID){l.LoadXml(e.J0.String(a.Tables[0][0].FilterXML));for(let C=0;C<l.DocumentElement.children.length;C++){const i=l.DocumentElement.children[C];!e.J0.IsEmpty(i.attributes.Field.value)&&"15408700"==i.attributes.Field.value&&(e.J0.IsEmpty(i.attributes.Value_Key.value)||(this.strOldUserID=i.attributes.Value_Key.value,this.TrasUserVisibility=!0))}}for(let C=0;C<r.DocumentElement.children.length;C++){const i=r.DocumentElement.children[C];if(this.dvFields=e.J0.IsEmpty(i.attributes.ID.value)?[]:this.dvFieldsNew.filter(n=>n.CostCenterColID==i.attributes.ID.value),0!=this.dvFields.length){if(this.SelectedFields.push(this.dvFields[0]),m=parseInt(this.dvFields[0].CostCenterColID),s=new M.O7,s.DisplayMember="C"+(this.SelectedFields.length-1),s.SectionName=s.DisplayMember,s.Header=e.J0.String(this.dvFields[0].UserColumnName),s.Width=parseInt(i.attributes.Width.value),s.ReadOnly="YES"!=i.attributes.Edit.value,!e.J0.IsEmpty(i.attributes.ShowCode)&&"YES"==i.attributes.ShowCode.value&&(this.dvFields[0].ShowCode="YES"),this.ButtonApprove.Visible&&(s.ReadOnly=!0),s.ID=e.J0.String(this.dvFields[0].SysColumnName),this.IsDocument&&this.IsApproval&&this.UpdateOnApproval&&(s.ID.toLowerCase().startsWith("dcalpha")||s.ID.toLowerCase().startsWith("dcccnid"))&&"YES"==i.attributes.Edit.value&&(s.ReadOnly=!1),"COM_ADDRESS"==e.J0.String(this.dvFields[0].SysTableName).toUpperCase()&&this.AddressFields.push(s.SectionName),s.CrRefID=m,null!=this.ReportObj&&(s.OPParams=i.attributes.RPTID.value),!s.ReadOnly&&!this.IsBarcode)if(this.IsDocument)if(s.ID.startsWith("dcAlpha")||s.ID.toLowerCase().startsWith("dcccnid")||this.docAllowCols.Contains(s.ID.toLowerCase())){(0!=t.Tables[1].filter(u=>u.CostCenterColID==m.toString()).length||h.Contains(s.Header))&&(alert(s.Header+" Used in formula hence its not editable"),s.ReadOnly=!0);let d=t.Tables[0].filter(u=>u.CostCenterColID==m.toString());0!=d.Length&&("dcCCNID2"==s.ID&&p.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"TRUE"==p.d.SessionManager.Preferences.EnableLocationWise.toUpperCase()?(alert(s.Header+" Used in Location wise"),s.ReadOnly=!0):"dcCCNID1"==s.ID&&p.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"TRUE"==p.d.SessionManager.Preferences.EnableDivisionWise.toUpperCase()?(alert(s.Header+" Used in Dimension wise"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences["Maintain Dimensionwise stock"].toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise stock"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Batches")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences["Maintain Dimensionwise Batches"].toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Batches"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise AverageRate")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences["Maintain Dimensionwise AverageRate"].toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise AverageRate"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Bills")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences["Maintain Dimensionwise Bills"].toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Bills"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences.DimensionwiseBins.toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Bins"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("DimensionwiseAssets")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences.DimensionwiseAssets.toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Assets"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("DimWiseCreditDebit")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences.DimWiseCreditDebit.toString()==d[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Credit Debit"),s.ReadOnly=!0):p.d.SessionManager.Preferences.ContainsKey("DimensionwiseCurrency")&&!e.J0.IsEmpty(d[0].ColumnCostCenterID)&&parseInt(d[0].ColumnCostCenterID)>5e4&&p.d.SessionManager.Preferences.DimensionwiseCurrency.toString()==d[0].ColumnCostCenterID.toString()&&(alert(s.Header+" Used in Dimension wise Currency"),s.ReadOnly=!0))}else s.ReadOnly=!0;else if(2==this.CostCenterID&&s.ID.startsWith("AccountCode")){let n=t.Tables[2].filter(d=>0==d.IsGroupCode&&0==d.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==e.J0.String(n[0].IsEnable).toLowerCase()}else if(3==this.CostCenterID&&s.ID.startsWith("ProductCode")){let n=t.Tables[2].filter(d=>0==d.IsGroupCode&&0==d.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==e.J0.String(n[0].IsEnable).toLowerCase()}else if(16==this.CostCenterID&&s.ID.startsWith("BatchCode")){let n=t.Tables[3].filter(d=>"BatchCodeAutoGen"==d.Name);(n.length>0&&"true"==e.J0.String(n[0].Value).toLowerCase()||t.Tables[2].length>0&&!e.J0.IsEmpty(t.Tables[2][0].IsParentCodeInherited)&&(0,R.yG0)(t.Tables[2][0].IsParentCodeInherited))&&(s.ReadOnly=!0)}else if(93==this.CostCenterID&&s.ID.startsWith("Code")){let n=t.Tables[2].filter(d=>0==d.IsGroupCode&&0==d.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==n[0].IsEnable.toString().toLowerCase()}else if(this.CostCenterID>=50001&&s.ID.startsWith("Code")){let n=t.Tables[2].filter(d=>0==d.IsGroupCode&&0==d.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==e.J0.String(n[0].IsEnable).toLowerCase()}if(this.SelectedFields.length<3&&(s.IsFrozen=!p.d.IsNativeMobile),s.IsColumnUserDefined=!!(0,R.yG0)(this.dvFields[0].IsColumnUserDefined),s.DataType=e.J0.String(this.dvFields[0].UserColumnType).toUpperCase(),241==m)s.ValueMember="AccountTypeID",s.DisplayMember="AccountType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=t.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(264==m)s.ValueMember="ProductTypeID",s.DisplayMember="ProductType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=t.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(252==m)s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=V.GetBillWiseTable(),s.DataType="ComboBox";else if("StatusID"==s.ID||93==this.CostCenterID&&"Status"==s.ID)s.ValueMember="ID",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=this.IsDocument?t.Tables[2]:t.Tables[1],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if("Attachments"==s.ID)s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onAttachClick");else if(95!=this.CostCenterID&&103!=this.CostCenterID&&104!=this.CostCenterID&&129!=this.CostCenterID||"SNO"!=s.ID){if(s.ReadOnly||!e.J0.IsEmpty(this.dvFields[0].IsForeignKey)&&(0,R.yG0)(this.dvFields[0].IsForeignKey)&&parseInt(this.dvFields[0].ColumnCostCenterID)>0&&(s.DataType="LISTBOX",s.CostCenterID=parseInt(this.dvFields[0].ColumnCostCenterID),3==s.CostCenterID&&!this.HideProductImage&&(this.IsProductExists=!0,this.ProductImageVisibility=!0),s.TypeID=parseInt(this.dvFields[0].ColumnCCListViewTypeID)),"DATE"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if(s.IsColumnUserDefined)if("DATE"==s.DataType||"DATETIME"==s.DataType)s.DataType=s.DataType,this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("TIME"==s.DataType)s.DataType="TIME",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("NUMERIC"==s.DataType)s.DataType="FLOAT";else if("SELECTIONBOX"==s.DataType||"editablecombobox"==s.DataType)s.DataType="SELECTIONBOX",s.CostCenterID=this.CostCenterID;else if("COMBOBOX"==s.DataType){let n=[],d={};this.dvFields[0].UserProbableValues.toString().split(";").forEach(u=>{d={},d.Value=u,d.Name=u,n.push(d)}),s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=n,s.DataType="ComboBox"}else if("LISTBOX"==s.DataType)s.DataType="LISTBOX",p.d.SessionManager.IsWebApplication&&(s.ValueMember="C"+(this.SelectedFields.length-1)+"_Key"),s.CostCenterID=parseInt(e.J0.String(this.dvFields[0].ColumnCostCenterID)),s.TypeID=parseInt(e.J0.String(this.dvFields[0].ColumnCCListViewTypeID));else if("LOOKUP"==s.DataType){s.ValueBinding=s.ID,s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let n=p.d.common.GetDataSet("DOC019",parseInt(this.dvFields[0].ColumnCCListViewTypeID).toString());if(null!=n){let d=[];for(let u=0;u<n.length;u++)d.push(L._p.ComboBoxItems_2(n[u].Name.toString(),n[u].NodeID.toString()));s.ComboData=d}}}else s.DataType="LINK",s.Click.Subscribe(this,"onDimClick");if("FLOAT"==e.J0.String(this.dvFields[0].ColumnDataType)){s.DataType="FLOAT";let n=e.J0.String(this.dvFields[0].Decimal);s.ID.toLowerCase().Contains("dcnum")?!e.J0.IsEmpty(n)&&parseFloat(n)>=0?s.DecimalPoints=n:p.d.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=p.d.SessionManager.Preferences.DecimalsinExtraFields&&(s.DecimalPoints=p.d.SessionManager.Preferences.DecimalsinExtraFields):"Quantity"==s.ID?""!=n&&parseFloat(n)>=0?s.DecimalPoints=n:p.d.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=p.d.SessionManager.Preferences.DecimalsinQty&&(s.DecimalPoints=p.d.SessionManager.Preferences.DecimalsinQty):"Gross"==s.ID||"Rate"==s.ID?""!=n&&parseFloat(n)>=0?s.DecimalPoints=n:p.d.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=p.d.SessionManager.Preferences.DecimalsinRate&&(s.DecimalPoints=p.d.SessionManager.Preferences.DecimalsinRate):"Amount"==s.ID||"DebitAmount"==s.ID||"CreditAmount"==s.ID?""!=n&&parseFloat(n)>=0?s.DecimalPoints=n:p.d.SessionManager.Preferences.ContainsKey("DecimalsinAmount")&&""!=p.d.SessionManager.Preferences.DecimalsinAmount&&(s.DecimalPoints=p.d.SessionManager.Preferences.DecimalsinAmount):""!=n&&parseFloat(n)>=0&&(s.DecimalPoints=n)}else"COMBOTEXT"==e.J0.String(this.dvFields[0].ColumnDataType)&&(s.DataType="LINK",s.Click.Subscribe(this,"onDocClick"),this.vnofield=s.DisplayMember);95!=this.CostCenterID&&103!=this.CostCenterID&&104!=this.CostCenterID&&129!=this.CostCenterID||s.ReadOnly||s.ID.toLowerCase().Contains("alpha")||s.ID.toLowerCase().Contains("ccnid")||(s.ReadOnly=!0),s.ReadOnly?s.DisableTab=!0:(this.EditColumns.push(s),this.EditColumnsDr.push(this.dvFields[0].Row),s.DisableTab=!1),this.EditGrid.Columns.push(s),null!=this.ReportObj&&("LISTBOX"==s.DataType||"DATE"==s.DataType?(this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):this.EditGrid.TableColumns.push("FLOAT"==s.DataType?s.DisplayMember:"ComboBox"==s.DataType?s.ValueBinding:s.DisplayMember))}else if(null!=this.ReportObj){var o=this.ReportObj.ReportColumns.find(n=>n.ID==i.attributes.RPTID.value);if(null==o||null==o)continue;s=new M.O7,s.DisplayMember="RC"+this.EditGrid.TableColumns.length,s.OPParams=i.attributes.RPTID.value,s.SectionName=s.DisplayMember,s.Header=o.HeaderText,s.Width=parseInt(i.attributes.Width.value),s.ReadOnly=!0,s.DataType=o.DataAppearance.ColumnType,this.EditGrid.Columns.push(s),"DATE"==s.DataType||"DATETIME"==s.DataType?(s.DataType=s.DataType,this.DateColIDs.push(s.SectionName),this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):"FLOAT"==s.DataType?(s.DecimalPoints=o.DataFormat.DecimalsPoints.ToString(),this.EditGrid.TableColumns.push(s.DisplayMember),o.LinkType==F.T6.Dimension&&(s.DataType="LINK",s.Click.Subscribe(this,"onDimClick"),this.dimfield=s.DisplayMember+"_ID",this.EditGrid.TableColumns.push(s.DisplayMember+"_ID"))):(this.EditGrid.TableColumns.push(s.DisplayMember),(o.LinkType==F.T6.Attachment||o.LinkType==F.T6.Dimension||"11414"==o.FieldName&&o.LinkType==F.T6.Document)&&(s.DataType="LINK",o.LinkType==F.T6.Attachment?(s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onAttachClick")):o.LinkType==F.T6.Dimension?(s.Click.Subscribe(this,"onDimClick"),this.dimfield=s.DisplayMember+"_ID"):o.LinkType==F.T6.Document&&(s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onDocClick")),this.EditGrid.TableColumns.push(s.DisplayMember+"_ID")))}}s=new M.O7,s.Header="Message",s.DisplayMember="Message",s.Width=250,s.ReadOnly=!0,s.DisableTab=!0,this.EditGrid.Columns.push(s),this.EditGrid.AddSearchCols(),this.Filter=new V(t,this),this.StaticFilter=new V(t,this),this.ShowFilter?this.Filter.LoadXML(e.J0.String(a.Tables[0][0].FilterXML)):this.StaticFilter.LoadXML(e.J0.String(a.Tables[0][0].FilterXML)),this.IsDocument?(this.FromDate.Visible=!0,this.ToDate.Visible=!0):(this.FromDate.Visible=!1,this.ToDate.Visible=!1)}GetColumn(a,t,r,l,D){let s=new O.yL;"Millions"==p.d.SessionManager.Preferences.Commas?s.Commas=1:"Lakhs"==p.d.SessionManager.Preferences.Commas&&(s.Commas=2),s.DateType=p.d.SessionManager.Preferences["Date Format"];let m=new F.D_;return m.gridLines=3,m.ID=a,m.FieldName=a,m.HeaderText=p.d.GetResource(t),m.HeaderAppearance=l,m.DataAppearance=l,m.HeaderHeight=22,m.width=D,m.DataFormat=s,m.ColumnType=r,m}SetCellValue(a,t,r,l,D){G.ReportViewModel.SetCellValue(a,t,r,-1,l,D)}EditGridOnCellEditEnding(a){0!=a.cell&&this.IsSelectOnRowLeave&&(a.item.Select=!0)}onDocClick(a){var t=this;return(0,w.A)(function*(){if(null!=t.EditGrid.SelectedItem&&t.EditGrid.TableColumns.Contains(t.vnofield)){let r,l;if(l=e.J0.String(a?.command).Contains("-")?p.d.report.GetDocumentDetailsByVoucherNo(e.J0.String(a.command.trimLeft())):p.d.report.GetDocumentDetailsByVoucherNo(t.EditGrid.SelectedItem[t.vnofield].toString()),r=e.J0.Int(l.obj),r>0){let D;if(D=l.Tables[0].length>0?l.Tables[0][0]:l.Tables[1][0],40054==parseInt(D.CostCenterID)){const{MonthlyPayrollComponent:s}=yield Promise.resolve().then(f.bind(f,50334)),{MonthlyPayrollViewModel:m}=yield Promise.resolve().then(f.bind(f,75782));t.oDocPayroll=new m(D.DocumentName.toString(),"",D.VoucherNo.toString()),p.d.page.addNewTab({title:D.DocumentName.toString(),component:s,params:{obj:t.oDocPayroll}})}else if(40095==parseInt(D.CostCenterID)){const{FinalSettlementComponent:s}=yield Promise.resolve().then(f.bind(f,54004)),{FinalSettlementViewModel:m}=yield Promise.resolve().then(f.bind(f,70234));t.oDocPayroll=new m(D.DocumentName.toString(),D.DocNumber.toString(),D.DocPrefix.toString()),t.oDocPayroll.FinalSettlementViewModel_1().then(h=>{1==t.oDocPayroll.DialogResult&&(t.oDocPayroll.DisplayName=D.DocumentName.toString(),p.d.page.addNewTab({title:D.DocumentName.toString(),component:s,params:{obj:t.oDocPayroll}}))})}else{const{AddEditDocumentComponent:s}=yield Promise.resolve().then(f.bind(f,33012)),{AddEditDocumentViewModel:m}=yield Promise.resolve().then(f.bind(f,26983));let h=new m(parseInt(D.CostCenterID),D.DocumentName.toString(),!0);h.ScreenObject.DocPrefix.ComboBox.SelectedValue=D.DocPrefix.toString(),h.ScreenObject.DocPrefix.TextBox.Text=D.DocNumber.toString(),h.OnDocPrefixChanged("lostFocus"),h.ScreenObject.FillDocumentPrefix(!0),p.d.page.addNewTab({component:s,params:{obj:h}})}}}})()}onDimClick(a){if(e.J0.IsEmpty(this.dimfield)&&(this.dimfield=this.PrimaryKey),null!=this.EditGrid.SelectedItem&&this.EditGrid.TableColumns.Contains(this.dimfield)){this.EditGrid.TableColumns.Contains(a)&&(a=this.EditGrid.SelectedItem[a].toString());let t=new ne.DocumentViewerViewModel;t.DocumentViewerViewModel_ByVoucherNo_3(a,parseInt(e.J0.IsEmpty(this.EditGrid.SelectedItem[this.dimfield])?"0":this.EditGrid.SelectedItem[this.dimfield]),this.CostCenterID),t.IsDocumentFound?p.d.page.addNewTab({component:K.DocumentViewerComponent,params:{obj:t}}):(t.DocumentViewerViewModel_ByVoucherNo_3(a,0,this.CostCenterID),t.IsDocumentFound&&p.d.page.addNewTab({component:K.DocumentViewerComponent,params:{obj:t}}))}}onAttachClick(a){return(0,w.A)(function*(){if(null!=(a=a.command)){let t=e.J0.GetPath(a);p.d.IsMobile&&p.d.IsNativeMobile?yield se.P.open({url:t,isPDF:!1,isExport:!1}):window.open(t)}})()}InitReport(){let a=new G.ReportViewModel;a.ReportViewModel_1(this.ReportID,null!=this.DB,!0),this.ReportObj=a,this.ReportObj.ScreenName="BULK",this.ReportObj.BulkEdit=this,this.Report.push(this.ReportObj),this.ReportFilterVisible=!this.HideFilterDialog}OnButtonClick(a){if(this.DisplayMessage="","Save"==a){if(null==this.EditGrid.Table)return;let t=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==t.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4?this.SaveDocument(t):this.SaveDimension(t),this.DisplayMessage=95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID?"Saved successfully":"Posting Completed"}else if("Delete"==a){if(!this.DeleteVisibility)return;let t=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==t.length)return void(this.DisplayMessage="No Rows Selected");if(!confirm("Do you want to delete selected rows?"))return;this.CostCenterID>4e4&&this.CostCenterID<5e4||this.DeleteDimension(t)}else if("ShowAssigningUser"==a){if(this.strOldUserID.length<=0)return void(this.DisplayMessage="Please select user from filter before transfer");this.TranserUserVisiblity=!0,p.d.page.ShowDialog(this,ie.s,{ShowCenter:!1,HideClose:!0,NoWidth:!0,Title:"Transer User"})}else if("HideAssignUserPanel"==a)this.TranserUserVisiblity=!1,p.d.page.HideDialog(this.PopUpGUID);else if("TransferUser"==a){if(this.intLinkDimCC>0){if(null==this.EditGrid.Table)return;let t=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==t.length)return void(this.DisplayMessage="No Rows Selected");if(this.strOldUserID.length<=0)return void(this.DisplayMessage="Please select the before transfer");if(0==this.TargetUserID.SelectedValue)return void(this.DisplayMessage="Please select the user before transfer");if(e.J0.IntTryParse(this.strOldUserID.toString())==this.TargetUserID.SelectedValue)return void(this.DisplayMessage="Both Users are same");this.TransferUsers(t)}}else if("BACK"==a)this.EditGrid.Visible=!0;else if("OK"==a)this.EditGrid.Visible=!0,this.Filter.FilterGrid.commitEdit(),this.RefreshData();else if("Filter"==a)this.EditGrid.Visible=!1,this.Report.length>0&&(this.Report[0].ShowFilter=!0,this.ReportFilterVisible=!0);else if("Refresh"==a)this.Report.length>0?this.Report[0].Refresh():this.RefreshData();else if("Import"==a){let t=[];this.DtImport=[];let r=new M.O7;r.DisplayMember="FieldName",r.Header=p.d.GetResource("Import_FieldName"),r.DataType="TextBlock",r.Width=100,r.ReadOnly=!0,t.push(r),this.DtImport.Columns.push("FieldName"),r=new M.O7,r.DisplayMember="Name",r.ValueMember="Value",r.ValueBinding="FeatureFieldName",r.Header=p.d.GetResource("Import_FeatureFieldName"),r.DataType="ComboBox",r.Width=120;let l=new Array;l.push(L._p.ComboBoxItems_2("","")),this.EditGrid.Columns.forEach(D=>{null!=D.ID&&"DocDate"!=D.ID&&l.push(L._p.ComboBoxItems_2(D.Header,D.ID))}),r.ComboData=l,t.push(r),this.DtImport.Columns.push("FeatureFieldName"),this.IsImport=!0,this.ImportCols=t,this.ImportVisiblity=!0,this.ProductImageVisibility=!1,this.ExportVisibility=!1}else if("openfile"!=a)if("ImportOK"==a)null!=this.ExcelTable&&this.ExcelTable.length>0&&this.importWorker_DoWork(null,null);else if("ImportCancel"==a)this.ImportVisiblity=!1,3==this.CostCenterID&&!this.HideProductImage&&(this.ProductImageVisibility=!0);else if("PopUp"==a);else if("Approve"==a)this.ShowRightPanel=!0,this.ProductImageVisibility=!1,this.ReplaceVisibility=!1,this.ApproveVisibility=!0,this.AppDisplayMessage="",this.AppMessageVisibility=!1,this.Remarks.Text="",this.ExportVisibility=!1,p.d.page.ShowDialog(this,q,{ShowCenter:!0,HideClose:!0,NoWidth:!0,Title:p.d.GetResource("ApproveReject")});else if("CancelAction"==a)this.ApproveVisibility=!1,p.d.page.HideDialog(this.PopUpGUID),null!=this.DB&&(this.ShowRightPanel=!1);else if("Barcode"==a){if(null==this.EditGrid.Table)return;let t=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==t.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4&&this.BarcodeDocument(t)}else if("Export"==a)this.ExportVisibility=!0,this.ImportVisiblity=!1,this.ProductImageVisibility=!1,this.TranserUserVisiblity=!1;else if("CancelExport"==a)this.ExportVisibility=!1;else if("ExportData"==a){let r,t=new G.ReportViewModel;this.VoucherColumns=new Array,this.HeaderAppearance.Alignment="Left",this.HeaderAppearance.FontSize=12,this.HeaderAppearance.IsBold=!0,this.HeaderAppearance.BackColor="White",this.HeaderAppearance.ForeColor="Black",this.TextDataAppearance.Alignment="Left",this.TextDataAppearance.FontSize=12,this.TextDataAppearance.BackColor="White",this.TextDataAppearance.ForeColor="Black",this.NumberDataAppearance.Alignment="Right",this.NumberDataAppearance.FontSize=12,this.NumberDataAppearance.BackColor="White",this.NumberDataAppearance.ForeColor="Black";for(let h=0;h<this.EditGrid.Columns.length;h++)e.J0.IsEmpty(this.EditGrid.Columns[h].ID)||(r=this.GetColumn(this.EditGrid.Columns[h].DisplayMember,this.EditGrid.Columns[h].Header,this.EditGrid.Columns[h].DataType,this.TextDataAppearance,100),r.HeaderText=this.EditGrid.Columns[h].Header,null!=this.EditGrid.Columns[h].DataType&&"float"==this.EditGrid.Columns[h].DataType.toLowerCase()&&(r.DataFormat.DecimalsPoints=e.J0.Double(this.EditGrid.Columns[h].DecimalPoints)),this.VoucherColumns.push(r));this.VoucherData.Clear(),this.EditGrid.Table.forEach(h=>{this.oRow=new O.Ji(this.VoucherColumns.length,22),this.oRow.Height=22;for(let o=0;o<this.VoucherColumns.length;o++){let C=this.VoucherColumns[o];e.J0.IsEmpty(h[C.ID])||G.ReportViewModel.SetCellValue(h[C.ID],C.DataFormat,C.ColumnType,-1,this.oRow.Cells[o],C.ID)}this.VoucherData.push(this.oRow)}),t.ReportColumns=this.VoucherColumns,t.Data=this.VoucherData,t.ScreenName=this.Title+"~BulkEdit",t.SaveXLS=this.SaveXLS,t.SavePDF=this.SavePDF,t.SaveXLSX=this.SaveXLSX;let l=[],D={},m="<RptBody><LevelTree>None</LevelTree><LevelNo>10</LevelNo><_ColumnHeaderFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_ColumnHeaderFontStream><_GroupFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_GroupFontStream><_SubTotalFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_SubTotalFontStream><_GrandTotalFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_GrandTotalFontStream><BodyHeaderHeight>50</BodyHeaderHeight><ShowHeaderBackColors>true</ShowHeaderBackColors><ShowBodyHorizontalLines>true</ShowBodyHorizontalLines><ShowBodyVerticalLines>true</ShowBodyVerticalLines><ShowBodyBorders>false</ShowBodyBorders><ShowBodyBackColors>true</ShowBodyBackColors><CenterOnPage>false</CenterOnPage><VerticalAlignment>Center</VerticalAlignment><BodyPosition>Fixed</BodyPosition><BodyBottom>Fixed</BodyBottom><BodyHeight>800</BodyHeight><LeftMargin>15</LeftMargin><PageWidth>829</PageWidth><IsLandscape>false</IsLandscape><IgnoreBody>false</IgnoreBody><ReportHeaderHeight>101</ReportHeaderHeight><PageHeaderHeight>5</PageHeaderHeight><PageFooterHeight>5</PageFooterHeight><ReportFooterHeight>10</ReportFooterHeight><PageHeaderPosition>Fixed</PageHeaderPosition><ShowReportHeader>FirstPage</ShowReportHeader><ShowPageHeader>EveryPage</ShowPageHeader><ReportFooterPosition>Fixed</ReportFooterPosition><PageFooterPosition>Fixed</PageFooterPosition><ShowReportFooter>LastPage</ShowReportFooter><ShowPageFooter>EveryPage</ShowPageFooter><BodyFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</BodyFontStream></RptBody>\x01<VPText><Text>@@DATE@@</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>18</Height></Size><Left>99</Left><Top>35</Top><LineSpacing>0</LineSpacing></VPText>\x11<VPText><Text>@@AccountName@@</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>700</Width><Height>18</Height></Size><Left>100</Left><Top>75</Top><LineSpacing>0</LineSpacing></VPText>\x11<VPText><Text>##Account Name :##</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>97</Width><Height>18</Height></Size><Left>2</Left><Top>75</Top><LineSpacing>0</LineSpacing></VPText>\x12<VPVar><_DataSource>ReservedWords</_DataSource><_SysColumn>ReportTitle</_SysColumn><ROff>0</ROff><Decimals>2</Decimals><DateFormat>dd MMM yyyy</DateFormat><Commas>Million</Commas><InWords>false</InWords><UseOnce>false</UseOnce><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAQEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><SupressZero>false</SupressZero><SupressFractionZero>false</SupressFractionZero><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>25</Height></Size><Left>2</Left><Top>45</Top><LineSpacing>0</LineSpacing><DataSource>ReservedWords</DataSource><SysColumn>ReportTitle</SysColumn><UniqueID>C1</UniqueID></VPVar>\x11<VPVar><_DataSource>ReservedWords</_DataSource><_SysColumn>CompanyName</_SysColumn><ROff>0</ROff><Decimals>2</Decimals><DateFormat>dd MMM yyyy</DateFormat><Commas>Million</Commas><InWords>false</InWords><UseOnce>false</UseOnce><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAA9UaW1lcyBOZXcgUm9tYW4AAIBBBfz///8YU3lzdGVtLkRyYXdpbmcuRm9udFN0eWxlAQAAAAd2YWx1ZV9fAAgCAAAAAQAAAAX7////G1N5c3RlbS5EcmF3aW5nLkdyYXBoaWNzVW5pdAEAAAAHdmFsdWVfXwAIAgAAAAMAAAAL</FontStream><Alignment>TopLeft</Alignment><SupressZero>false</SupressZero><SupressFractionZero>false</SupressFractionZero><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>30</Height></Size><Left>2</Left><Top>5</Top><LineSpacing>0</LineSpacing><DataSource>ReservedWords</DataSource><SysColumn>CompanyName</SysColumn><UniqueID>C2</UniqueID></VPVar>".split("\x01");m[1]=m[1].Replace("@@AccountName@@",e.J0.EncodeXML(this.Title).TrimStart("[").TrimEnd("]")),m[1]=m[1].Replace("##Account Name :##","Document Name :"),m[1]=m[1].Replace("@@DATE@@",""),D.ReportName=this.Title,D.ReportBody=m[0],D.ReportHeader=m[1].Replace("@@AccountName@@",e.J0.EncodeXML(this.Title).TrimStart("[").TrimEnd("]")),D.PageHeader=m[2],D.PageFooter=m[3],D.ReportFooter=m[4],l.push(D),t.Reportds={},t.Reportds.Tables=[],t.Reportds.Tables.push(l),t.IsExportFromOthers=!0,t.Export(),e.J0.IsEmpty(this.DisplayMessage)&&(this.DisplayMessage="Exported sucessfully")}}importWorker_DoWork(a,t){let r="",l=new P.bT,D=new Array,s=new Array,m=new Array;for(let o=0;o<this.DtImport.length;o++){const C=this.DtImport[o];if(""==e.J0.String(C[1])||"0"==e.J0.String(C[1]))continue;let i=this.EditGrid.Columns.find(n=>n.ID==C[1].toString());if(null!=i){if(null!=i&&"LISTBOX"==i.DataType&&!l.ContainsKey(i.CostCenterID)){for(let d=0;d<this.ExcelTable.length;d++)""!=r&&(r+=","),r+="'"+this.ExcelTable[d][C[0].toString()].toString().Trim().Replace("'","''")+"'";let n=this.GetCCValues(r,i.CostCenterID,this.ImportIsCode?1:0,"CreditAccount_Key"==i.ValueMember||"DebitAccount_Key"==i.ValueMember?" and IsGroup=0 ":"");l.push(i.CostCenterID,n)}i.ReadOnly?D.push(C[0].toString()):(s.push(C[0].toString()),m.push(C[1].toString()))}}if(D.length>0){let o=this.ExcelTable.ToTable(!0,D);if(null!=o&&o.length>0){let u,C="",i="",n="",d="";for(let g=0;g<o.length;g++){i="",n="";for(let c=0;c<o.Columns.length;c++)i.length>0&&(i+=" AND "),i+=" ["+o.Columns[c].toString()+"]='"+o.Rows[g][c].toString()+"' ",n.length>0&&(n+=" AND "),C=this.DtImport.filter(S=>S.FieldName==o.Columns[c].toString())[0].FeatureFieldName.toString(),n+=" "+C+"='"+o[g][c].toString()+"' ";if(i.Trim().length>0){let c=[],S=[];if(null!=S&&S.length>0)for(let A=0;A<S.length;A++)for(let b=0;b<m.length;b++){var h=this.EditGrid.Columns.find(y=>y.ID==m[b]);null!=h&&(null!=h.DataType&&h.CostCenterID>0&&"LISTBOX"==h.DataType?(d="",d=this.ImportIsCode?"Code='"+c[0][s[b]]+"'":"Name='"+c[0][s[b]]+"'",u=l[h.CostCenterID].Select(d),null!=u&&u.length>0&&(S[A][h.DisplayMember+"_Key"]=u[0].ID,S[A][h.DisplayMember]=c[0][s[b]])):null!=h.DataType&&"COMBOBOX"==h.DataType.toUpperCase()?S[A][h.ValueBinding]=c[0][s[b]]:(null!=h.DataType&&"DATE"==h.DataType.toUpperCase()&&!e.J0.StringIsNullOrEmpty(c[0][s[b]].toString())&&(S[A][h.DisplayMember+"_Key"]=c[0][s[b]]),S[A][h.DisplayMember]=c[0][s[b]])),this.EditGrid.updateRow(S)}}}this.EditGrid.RefreshGrid=!0,this.DisplayMessage="Imported successfully.",this.MessageVisibility=!0}}else this.DisplayMessage="No column selected as readonly",this.MessageVisibility=!0}GetCCValues(a,t,r,l=""){Logger.InfoLog("Voucher Generator:: Inside GetCCValues");let D=[],s="";1==r?3==t?s="ProductCode":2==t?s="AccountCode":t>5e4&&(s="Code"):2==r?3==t?s="ProductID":2==t?s="AccountID":t>5e4&&(s="NodeID"):3==t?s="ProductName":2==t?s="AccountName":t>5e4&&(s="Name"),3==t?D.push("Select ProductID ID,ProductCode Code,ProductName name from inv_product WITH(NOLOCK) where "+s+" in("+a+")"):2==t?D.push("Select AccountID ID,AccountCode Code,AccountName name from Acc_Accounts WITH(NOLOCK) where "+s+" in("+a+")"+l):11==t?D.push("Select uomid ID,UNITNAME Code,UNITNAME name,ProductID from COM_UOM WITH(NOLOCK) where UNITNAME in("+a+")"):50051==t?D.push("Select NodeID ID,Code,name from "+this.GetTableName(t)+" WITH(NOLOCK) where (Code in("+a+") or Name in ("+a+"))"):t>5e4&&D.push("Select NodeID ID,Code,name from "+this.GetTableName(t)+" WITH(NOLOCK) where "+s+" in("+a+")"),D.push(p.d.SessionManager.UserID),D.push(p.d.SessionManager.LanguageID);let m=p.d.document.GetCCValues(a,t,r,l);return Logger.InfoLog("Voucher Generator: DBH.GetCCValues "),null!=m&&m.Tables.length>0?m.Tables[0]:null}GetTableName(a){return 2==a?"ACC_Accounts":3==a?"INV_Product":50001==a?"COM_Division":50002==a?"COM_Location":50003==a?"COM_Branch":50004==a?"COM_Department":50005==a?"COM_Salesman":50006==a?"COM_Category":50007==a?"COM_Area":50008==a?"COM_Teritory":"COM_CC"+a}RefreshData(){if(this.DisplayMessage="",2==this.CostCenterID?(this.PrimaryKey="AccountID",this.PrimaryColumns="D.AccountID,D.AccountCode,D.AccountName,D.AccountTypeID,D.IsGroup,D.StatusID,D.GUID"):3==this.CostCenterID?(this.PrimaryKey="ProductID",this.PrimaryColumns="D.ProductID,D.ProductCode,D.ProductName,D.ProductTypeID,D.GUID"):16==this.CostCenterID?(this.PrimaryKey="BatchID",this.PrimaryColumns="D.BatchID,D.BatchCode,D.BatchNumber, CONVERT(DATETIME,D.MfgDate) MfgDate, D.ProductID,CONVERT(DATETIME, D.ExpiryDate) ExpiryDate, D.MRPRate, D.RetailRate, D.StockistRate,CONVERT(DATETIME, D.RetestDate) RetestDate, D.GUID"):this.CostCenterID>5e4?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.NodeID,D.Code,D.Name,D.StatusID,D.GUID"):92==this.CostCenterID?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.*"):93==this.CostCenterID?(this.PrimaryKey="UnitID",this.PrimaryColumns="D.*"):94==this.CostCenterID?(this.PrimaryKey="TenantID",this.PrimaryColumns="D.*"):95==this.CostCenterID||104==this.CostCenterID?(this.PrimaryKey="ContractID",this.PrimaryColumns="D.ContractID,D.SNO,D.ContractNumber,D.StatusID,D.GUID"):103==this.CostCenterID||129==this.CostCenterID?(this.PrimaryKey="QuotationID",this.PrimaryColumns="D.QuotationID,D.SNO,D.Number,D.StatusID,D.GUID"):(this.PrimaryKey=0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",this.PrimaryColumns=this.IsDetailVoucher?0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"D.AccDocDetailsID,D.VoucherNo":"D.InvDocDetailsID,D.VoucherNo":"D.VoucherNo"),this.Report.length>0)return this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,void this.LoadDataFromReport();let l,D,s,m,a="",t="",h=0,C="";this.Entities.Clear(),this.Entities.push(this.MainTableName,"D"),a+=this.PrimaryColumns,t+=this.MainTableName+" D with(nolock)",this.SelectedFields.forEach(d=>{if(s="T"+h,D=e.J0.String(d.SysTableName),l=e.J0.String(d.SysColumnName),2==this.CostCenterID||3==this.CostCenterID||16==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||94==this.CostCenterID||95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID||this.CostCenterID>=50001)if(D=D.toUpperCase(),0==e.J0.stringCompare(D,"ACC_ACCOUNTSEXTENDED")||0==e.J0.stringCompare(D,"INV_PRODUCTEXTENDED")||0==e.J0.stringCompare(D,"REN_PROPERTYEXTENDED")||0==e.J0.stringCompare(D,"REN_UNITSEXTENDED")||0==e.J0.stringCompare(D,"REN_TENANTEXTENDED")||0==e.J0.stringCompare(D,"REN_CONTRACTEXTENDED")||0==e.J0.stringCompare(D,"REN_QUOTATIONEXTENDED"))if(this.Entities.ContainsKey(D)||(this.Entities.push(D,"EXT"),t+=95==this.CostCenterID||104==this.CostCenterID?" INNER JOIN "+D+" EXT with(nolock) ON EXT.NODEID=D."+this.PrimaryKey:" INNER JOIN "+D+" EXT with(nolock) ON EXT."+this.PrimaryKey+"=D."+this.PrimaryKey),l="EXT."+l,"DATE"==e.J0.String(d.ColumnDataType))l="convert(datetime,"+l+")",a+=",'' AS C"+h,a+=","+l+" AS C"+h+"_Key";else if("LISTBOX"==e.J0.String(d.UserColumnType)){let u;if("44"==e.J0.String(d.ColumnCostCenterID))u=",case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+l+") else '' end";else{let g=p.d.report.GetTableColumns(parseInt(d.ColumnCostCenterID));u=g.ColumnName,m=g.PrimaryKey,D=g.TableName,u=",case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT "+u+" FROM "+D+" with(nolock) WHERE "+m+"="+l+") else '' end"}a+=u+" AS C"+h,a+=",case when isnumeric("+l+")=1 then "+l+" else convert(bigint,-1) end AS C"+h+"_Key"}else a+=","+l+" AS C"+h;else 0==e.J0.stringCompare(D,"COM_CCCCDATA")?(this.Entities.ContainsKey("COM_CCCCDATA")||(this.Entities.push("COM_CCCCDATA","CCDATA"),t+=" INNER JOIN COM_CCCCData CCDATA with(nolock) ON CCDATA.NodeID=D."+this.PrimaryKey+" AND CCDATA.CostCenterID="+this.CostCenterID),this.Entities.ContainsKey(l)||(this.Entities.push(l,s),t+=" INNER JOIN "+e.J0.GetTagTableName(parseInt(d.ParentCostCenterID))+" "+s+" with(nolock) ON "+s+".NodeID=CCDATA."+l),a+=","+this.Entities[l]+".Name AS C"+h,a+=",CCDATA."+l+" AS C"+h+"_Key"):0==e.J0.stringCompare(D,"COM_ADDRESS")?(this.Entities.ContainsKey("COM_ADDRESS")||(this.Entities.push("COM_ADDRESS","CCADD"),a+=",CCADD.AddressID",t+=" INNER JOIN COM_ADDRESS CCADD with(nolock) ON CCADD.AddressTypeID=1 and CCADD.FeaturePK=D."+this.PrimaryKey+" AND CCADD.FeatureID="+this.CostCenterID),a+=",CCADD."+l+" C"+h):null!=d.IsForeignKey&&(0,R.yG0)(d.IsForeignKey)?(this.Entities.ContainsKey(l)||(this.Entities.push(l,s),t+=" INNER JOIN "+e.J0.String(d.ParentCostCenterSysName)+" "+this.Entities[l]+" with(nolock) ON "+this.Entities[l]+"."+e.J0.String(d.ParentCostCenterColSysName)+"=D."+l),a+=","+this.Entities[l]+"."+this.GetColumnName(d)+" AS C"+h,a+=",D."+l+" AS C"+h+"_Key"):"Attachments"==l?(a+=",stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.CostCenterID+" AND FeaturePK=D."+this.PrimaryKey+" FOR XML PATH('')),1,1,'') AS C"+h+"_ID",a+=",stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.CostCenterID+" AND FeaturePK=D."+this.PrimaryKey+" FOR XML PATH('')),1,2,'') AS C"+h):"RentAmount"==l&&95==this.CostCenterID?a+=",FORMAT(isnull((select sum(RentAmount) from REN_ContractParticulars WITH(NOLOCK) where contractid=D.ContractID  and CCNodeID=3 ),0),'N0') AS C"+h:(l="D."+l,"DATE"==e.J0.String(d.ColumnDataType)?(l="convert(datetime,"+l+")",a+=",'' AS C"+h,a+=","+l+" AS C"+h+"_Key"):(("D.IsBillwise"==l||"D.Status"==l)&&(l="convert(int,"+l+")"),a+=","+l+" AS C"+h));else if(this.CostCenterID>4e4)if(0==e.J0.stringCompare(D,"COM_DocTextData"))if(this.Entities.ContainsKey("COM_DocTextData")||(this.Entities.push("COM_DocTextData","TXT"),t+=" INNER JOIN COM_DocTextData TXT with(nolock) ON TXT."+this.PrimaryKey+"=D."+this.PrimaryKey),C="TXT."+l,l=this.GetMaxColumn("TXT."+l,e.J0.String(d.ColumnDataType)),"DATE"==e.J0.String(d.ColumnDataType))a+=",'' AS C"+h,a+=",case when isdate("+l+")=1 then convert(datetime,"+l+") else null end AS C"+h+"_Key";else if("LISTBOX"==e.J0.String(d.UserColumnType)){let u;if("44"==e.J0.String(d.ColumnCostCenterID))u=",case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+l+") else '' end";else{let g=p.d.report.GetTableColumns(parseInt(d.ColumnCostCenterID));u=g.ColumnName,m=g.PrimaryKey,D=g.TableName,u=",case when "+l+" is not null and isnumeric("+l+")=1 then (SELECT "+u+" FROM "+D+" with(nolock) WHERE "+m+"="+l+") else '' end"}a+=u+" AS C"+h,a+=",case when isnumeric("+l+")=1 then "+l+" else convert(bigint,-1) end AS C"+h+"_Key"}else"LOOKUP"==e.J0.String(d.UserColumnType)?(a+=","+l+" AS C"+h,a+=","+l+" AS C"+h+"_Key"):"FLOAT"==e.J0.String(d.ColumnDataType)?a+=",case when isnumeric("+l+")=1 then convert(float,"+l+") else null end AS C"+h:a+=","+l+" AS C"+h;else 0==e.J0.stringCompare(D,"COM_DocNumData")?(this.Entities.ContainsKey("COM_DocNumData")||(this.Entities.push("COM_DocNumData","NUM"),t+=" INNER JOIN COM_DocNumData NUM with(nolock) ON NUM."+this.PrimaryKey+"=D."+this.PrimaryKey),l=this.GetMaxColumn("NUM."+l,e.J0.String(d.ColumnDataType)),a+=","+l+" AS C"+h):0==e.J0.stringCompare(D,"COM_DocCCData")?(this.Entities.ContainsKey("COM_DocCCData")||(this.Entities.push("COM_DocCCData","DCC"),m=0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",t+=" INNER JOIN COM_DocCCData DCC with(nolock) ON DCC."+m+"=D."+m),this.Entities.ContainsKey(l)||(this.Entities.push(l,s),t+=" INNER JOIN "+e.J0.GetTagTableName(parseInt(d.ParentCostCenterID))+" "+s+" with(nolock) ON "+s+".NodeID=DCC."+l),"YES"==e.J0.String(d.ShowCode)?a+=","+this.GetMaxColumn(this.Entities[l]+".Code","")+" AS C"+h:a+=","+this.GetMaxColumn(this.Entities[l]+".Name","")+" AS C"+h,a+=","+this.GetMaxColumn("convert(bigint,DCC."+l,"")+") AS C"+h+"_Key"):null!=d.IsForeignKey&&(0,R.yG0)(d.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(l)?(this.Entities.ContainsKey(l)||(this.Entities.push(l,s),t+=" INNER JOIN "+e.J0.String(d.ParentCostCenterSysName)+" "+this.Entities[l]+" with(nolock) ON "+this.Entities[l]+"."+e.J0.String(d.ParentCostCenterColSysName)+"=D."+l,!e.J0.IsEmpty(d.ParentCostCenterSysName)&&"inv_product"==e.J0.String(d.ParentCostCenterSysName).toLowerCase()&&(this.IsProductExists=!0)),a+=","+this.GetMaxColumn(this.Entities[l]+"."+this.GetColumnName(d),"")+" AS C"+h,a+=","+this.GetMaxColumn("D."+l,"")+" AS C"+h+"_Key"):("DebitAmount"==l||"CreditAmount"==l?l=this.GetMaxColumn("case when D."+l.Replace("Amount","Account")+">0 then D.Amount else 0 end",e.J0.String(d.ColumnDataType)):e.J0.IsEmpty(d.ColumnDataType)||"listbox"!=d.ColumnDataType.toString().toLowerCase()||"Unit"!=l?l=this.GetMaxColumn("D."+l,e.J0.String(d.ColumnDataType)):(t+=" INNER JOIN  COM_UOM UM with(nolock) ON UM.UOMID=D."+l,l=this.GetMaxColumn("D."+l,d.ColumnDataType.toString()),l=l.Replace("D.Unit","UM.UnitName")),"DATE"==e.J0.String(d.ColumnDataType)?(l="convert(datetime,"+l+")",a+=",'' AS C"+h,a+=","+l+" AS C"+h+"_Key"):a+=","+l+" AS C"+h);h++}),(3==this.CostCenterID||this.IsProductExists)&&!this.HideProductImage&&(this.ImportVisiblity||(this.ProductImageVisibility=!0),this.ReplaceVisibility=!1,this.ApproveVisibility=!1,a+=this.IsDetailVoucher||3==this.CostCenterID?",f.GUID FileGUID, f.FileExtension FileExtension":",max(f.GUID) FileGUID, max(f.FileExtension) FileExtension",t+=" left join com_files f with(nolock) on F.featureid=3 and featurepk=d.productid  and f.isProductImage=1 and f.isDEfaultImage=1 "),this.IsDocument&&this.CostCenterID>4e4&&this.CostCenterID<5e4&&(a+=",DID.GUID GUID",t+=" Left Join Com_DOCID DID with(nolock) on DID.ID = D.DocID"),this.IsDocument&&this.IsLWApproval&&(a+=",D.WorkflowID"),a="SELECT "+a,a+=" FROM "+t.toString(),a+=" ^",this.CostCenterID>4e4&&this.CostCenterID<5e4&&(a+=" AND D.CostCenterID="+this.CostCenterID,this.FromDate.Visible&&(a+=" AND D.DocDate>=convert(float,convert(datetime,'"+this.FromDate.Date.ToString("dd MMM yyyy")+"'))",a+=" AND D.DocDate<=convert(float,convert(datetime,'"+this.ToDate.Date.ToString("dd MMM yyyy")+"'))"));let i=this.StaticFilter.GetWhere(t,100).Trim();i.length>0&&(a+=" AND ("+i+")");let n=this.Filter.GetWhere(t,500).Trim();n.length>0&&(a+=" AND ("+n+")"),2==this.CostCenterID?a+=" ORDER BY D.AccountName":3==this.CostCenterID?a+=" ORDER BY D.ProductName":16==this.CostCenterID?a+=" ORDER BY D.BatchNumber":92==this.CostCenterID||93==this.CostCenterID?a+=" ORDER BY D.Name":94==this.CostCenterID?a+=" ORDER BY D.FirstName":this.CostCenterID>=50001?a+=" ORDER BY D.Name":this.CostCenterID>4e4&&(this.IsDetailVoucher?a+=" ORDER BY D.DocDate,D.VoucherNo,D.DocSeqNo":(a+=" GROUP BY D.DocDate,D.VoucherNo,DID.GUID",a+=" ORDER BY D.DocDate,D.VoucherNo"));try{this.EditGrid.Clear(),a.length>0&&(this.strWhereforAuctionHistory=" WHERE 1=1 "+a.split("^")[1],this.strWhereforAuctionHistory=this.strWhereforAuctionHistory.Replace("'",""),this.strWhereforAuctionHistory=this.strWhereforAuctionHistory.Replace("%","~")),a=a.Replace("^"," WHERE 1=1"),a=a.Replace("%","~");let u,g,d=p.d.common.GetDataSetQuery(a.toString());d.Columns[0].push("Select"),d.Columns[0].push("Message"),d.Tables[0].forEach(c=>{c.Select=!1,this.DateColIDs.forEach(S=>{u=S+"_Key",!e.J0.IsEmpty(c[u])&&c[u].toString().length>0&&(g=e.J0.ParseDate(c[u]),c[S]=g.ToString(p.d.SessionManager.Preferences["Date Format"]))})});for(let c=0;c<d.Tables[0].length;c++)d.Tables[0][c].id=c+1;this.EditGrid.Table.AddRange(d.Tables[0]),d.Columns&&d.Columns.length>0&&(this.EditGrid.TableColumns=d.Columns[0]),this.EditGrid.refreshDataView()}catch(d){this.DisplayMessage="Error in loading data",Logger.ErrorLog("Bulk Edit-RefreshData:",d.Message)}}ShowEditGrid(){this.ReportFilterVisible=!1,this.EditGrid.Visible=!0}LoadDataFromReport(){if(this.cprimary=null,this.EditGrid.Clear(),this.IsDocument){if(this.EditGrid.TableColumns.Contains("Message")||(this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.EditGrid.TableColumns.Contains("GUID")||this.EditGrid.TableColumns.push("GUID"),this.IsDetailVoucher?(this.cprimary=this.Report[0].BaseReportColumns.find(o=>"2"==o.LinkType.SelectedValue),this.EditGrid.TableColumns.Contains("ReportPK")||this.EditGrid.TableColumns.push("ReportPK"),this.IsLWApproval&&!this.EditGrid.TableColumns.Contains("WorkFlowID")&&this.EditGrid.TableColumns.push("WorkFlowID")):this.cprimary=this.Report[0].BaseReportColumns.find(o=>"1"==o.LinkType.SelectedValue||"2"==o.LinkType.SelectedValue),null==this.cprimary||null==this.cprimary)return void(this.DisplayMessage="Please set voucher no column link type as "+(this.IsDetailVoucher?"'Document Detail'":"'Document'"));var t=this.EditGrid.Columns.find(o=>o.OPParams==this.cprimary.ID);if(null==t&&null==t)return void(this.DisplayMessage="Please select voucher no column");this.strVoucherNo=t.SectionName}else if(this.EditGrid.TableColumns.Contains("ReportPK")||(this.EditGrid.TableColumns.push("ReportPK"),this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.cprimary=this.Report[0].BaseReportColumns.find(o=>(o.CDGDO.CategoryValue==this.CostCenterID||o.CDGDO.ColumnCostCenterID==this.CostCenterID||null!=o.CDGDO.ChildCDGDO&&o.CDGDO.ChildCDGDO.CategoryValue==this.CostCenterID)&&("3"==o.LinkType.SelectedValue||"4"==o.LinkType.SelectedValue)),null==this.cprimary)return void(this.DisplayMessage="Please set dimension column link type");let r,l,D=new P.bT,s=new P.bT;for(let o=0;o<this.EditGrid.Columns.length;o++){const C=this.EditGrid.Columns[o];if(null==C.OPParams)continue;let i=this.Report[0].BaseReportColumns.find(n=>n.ID==C.OPParams);null!=i&&s.push(C.OPParams,i)}for(let o=0;o<this.Report[0].Data.length;o++){const C=this.Report[0].Data[o];if(C.Type==O.QS.Detail){l=this.EditGrid.NewRow(),l.Select=!1,null!=C.DataRow&&this.EditGrid.TableColumns.Contains("ReportPK")&&null!=C.DataRow[this.cprimary.ID+"_ID"]&&""!=e.J0.String(C.DataRow[this.cprimary.ID+"_ID"])&&(l.ReportPK=C.DataRow[this.cprimary.ID+"_ID"]),this.IsLWApproval&&(l.WorkFlowID=C.DataRow.WorkFlowID),null!=C.DataRow&&this.EditGrid.TableColumns.Contains("GUID")&&null!=C.DataRow&&null!=C.DataRow.GUID&&(l.GUID=C.DataRow.GUID),null!=this.Report[0].LevelColumn&&C.IsGroup&&(l.Row_Foreground=null);for(let i=0;i<this.EditGrid.Columns.length;i++){const n=this.EditGrid.Columns[i];if(null!=n.OPParams)if("LISTBOX"==n.DataType){if(null!=C.DataRow&&null!=C.DataRow[n.OPParams])if(l[n.DisplayMember]=C.DataRow[n.OPParams],null!=C.DataRow[n.OPParams+"_ID"])l[n.DisplayMember+"_Key"]=C.DataRow[n.OPParams+"_ID"];else if(D.ContainsKey(n.OPParams)||D.push(n.OPParams,new P.bT),D[n.OPParams].ContainsKey(e.J0.String(C.DataRow[n.OPParams])))l[n.DisplayMember+"_Key"]=D[n.OPParams][e.J0.String(C.DataRow[n.OPParams])];else if(this.dvFields=this.dvFieldsNew.filter(d=>d.CostCenterColID==n.CrRefID),this.dvFields.length>0){let u=p.d.common.GetDataSet3("BULK001",e.J0.String(this.dvFields[0].ParentCostCenterColSysName),e.J0.String(this.dvFields[0].ParentCostCenterSysName),e.J0.String(C.DataRow[n.OPParams])).Tables[0];u.length>0&&!e.J0.IsEmpty(u[0].ID)&&(D[n.OPParams].push(e.J0.String(C.DataRow[n.OPParams]),parseInt(u[0].ID)),l[n.DisplayMember+"_Key"]=D[n.OPParams][e.J0.String(C.DataRow[n.OPParams])])}}else if("DATE"==n.DataType)null!=C.DataRow&&null!=C.DataRow[n.OPParams]&&!e.J0.IsEmpty(C.DataRow[n.OPParams])&&e.J0.String(C.DataRow[n.OPParams]).length>0&&(r=e.J0.ParseDate(C.DataRow[n.OPParams]),l[n.DisplayMember]=r.ToString(p.d.SessionManager.Preferences["Date Format"]),l[n.DisplayMember+"_Key"]=r);else if("TIME"==n.DataType)null!=C.DataRow&&null!=C.DataRow[n.OPParams]&&!e.J0.IsEmpty(C.DataRow[n.OPParams])&&e.J0.String(C.DataRow[n.OPParams]).length>0&&(r=e.J0.ParseDate(C.DataRow[n.OPParams]),l[n.DisplayMember]=r.ToString("hh:mm:ss tt"),l[n.DisplayMember+"_Key"]=r);else if("ComboBox"==n.DataType){if(null!=C.DataRow&&null!=C.DataRow[n.OPParams])if("StatusID"==n.ID&&null!=n.ComboDataTable){let d=n.ComboDataTable.filter(u=>u[n.DisplayMember]==C.DataRow[n.OPParams]);d[n.ValueBinding]=d.length>0?d[0][n.ValueMember]:C.DataRow[n.OPParams]}else l[n.ValueBinding]=C.DataRow[n.OPParams]}else null!=C.DataRow&&null!=C.DataRow[n.OPParams]&&(l[n.DisplayMember]=C.DataRow[n.OPParams],this.EditGrid.TableColumns.Contains(n.DisplayMember+"_ID")&&Object.keys(C.DataRow).Contains(n.OPParams+"_ID")?l[n.DisplayMember+"_ID"]=C.DataRow[n.OPParams+"_ID"]:"MULTI_LINK"==n.DataType&&this.EditGrid.TableColumns.Contains(n.DisplayMember+"_ID")&&(l[n.DisplayMember+"_ID"]=C.DataRow[n.OPParams]))}this.EditGrid.addRow(l)}}}GetColumnName(a){let t,r;return t="parentid"==e.J0.String(a.SysColumnName).toLowerCase()?this.CostCenterID:parseInt(a.ColumnCostCenterID),r=e.J0.IntTryParse(e.J0.String(a.ParentCCDefaultColID)),2==t?238==r?"AccountCode":"AccountName":3==t?261==r?"ProductCode":"ProductName":93==t?25624==r?"Code":"Name":94==t?25697==r?"FirstName":"LastName":16==t?"BatchNumber":"Name"}GetMaxColumn(a,t){return this.IsDetailVoucher||(a="FLOAT"!=t||a.Contains("dcAlpha")||a.Contains("ExchangeRate")?"max("+a+")":"sum("+a+")"),a}SaveDocument(a,t=!1){this.setActionHistroy("Save Document");let r,o,C,l="",D="",s="",m="",h=0;C=0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",o=null!=this.ReportObj?"ReportPK":C;let i=e.J0.NewGuid();if(t){let n=null;if(this.CostCenterID>4e4&&this.CostCenterID<5e4){let d;d=new ae.a(this.CostCenterID,0),n=d.GetScreenInfo(this.CostCenterID),d=null}if(null!=n&&n.Tables.length>0){m="";let d=n.Tables[0].filter(u=>null!=u.LocalReference&&79==u.LocalReference&&49983==u.LinkData);d.length>0&&"TEXT"==d[0].UserColumnType.toString().toUpperCase()&&d[0].SysColumnName.toString().toLowerCase().startsWith("dcalpha")&&(m+=d[0].SysColumnName.toString()+"=N'"+p.d.SessionManager.UserName.toString().Replace("'","''")+"',"),d=n.Tables[0].filter(u=>null!=u.LocalCCID&&-7==u.LocalCCID&&22900==u.LinkData),d.length>0&&n.Tables.length>23&&n.Tables[23].length>0&&"TEXT"==d[0].UserColumnType.toString().toUpperCase()&&d[0].SysColumnName.toString().toLowerCase().startsWith("dcalpha")&&(m+=d[0].SysColumnName.toString()+"=N'"+e.J0.String(n.Tables[23][0].FirstName).Replace("'","''")+"',")}}a.forEach(n=>{if(h++,s="",D="",l="",this.EditColumns.forEach(d=>{"LISTBOX"==d.DataType&&0!=d.CostCenterID&&d.ID.toLowerCase().startsWith("dcccnid")?D+=d.ID+"="+e.J0.String(n[d.ValueMember])+",":d.IsColumnUserDefined?"SELECTIONBOX"==d.DataType?l+=d.ID+"=N'"+e.J0.String(n[d.DisplayMember]).Replace("'","''")+"',":d.DisplayMember.toLowerCase().Contains("dcnum")||("DATE"==d.DataType?e.J0.IsEmpty(n[d.DisplayMember+"_Key"])||(l+=d.ID+"='"+e.J0.ParseDate(n[d.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',"):"DATETIME"==d.DataType||"TIME"==d.DataType?e.J0.IsEmpty(n[d.DisplayMember+"_Key"])||(l+=d.ID+"='"+e.J0.ParseDate(n[d.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',"):l+="ComboBox"==d.DataType?d.ID+"=N'"+e.J0.String(n[d.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==d.DataType?d.ID+"=N'"+e.J0.String(n[d.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==d.DataType&&0!=d.CostCenterID?d.ID+"='"+e.J0.String(n[d.ValueMember]).Replace("'","''")+"',":d.ID+"=N'"+e.J0.String(n[d.DisplayMember]).Replace("'","''")+"',"):this.docAllowCols.Contains(d.ID.toLowerCase())&&("DATE"==d.DataType?e.J0.IsEmpty(n[d.DisplayMember+"_Key"])||(s+=d.ID+"=CONVERT(INT,CONVERT(DATETIME,'"+e.J0.ParseDate(n[d.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"')),"):s+=d.ID+"=N'"+e.J0.String(n[d.DisplayMember]).Replace("'","''")+"',")}),m.length>0&&(l+=m.toString()),l.length>0||D.length>0||s.length>0){l.length>0&&(l=l.substr(0,l.length-1),l=l.Insert(0,"UPDATE TXT SET "),l+=" FROM "+this.MainTableName+" D WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK) ON D."+C+"=TXT."+C,this.IsDetailVoucher?(l+=" WHERE ",0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?l+="D.AccDocDetailsID="+e.J0.String(n[o]):l+="D.InvDocDetailsID="+e.J0.String(n[o])):l+=" WHERE D.VoucherNo='"+e.J0.String(n[this.strVoucherNo])+"'"),D.length>0&&(D=D.substr(0,D.length-1),D=D.Insert(0,"   UPDATE TXT SET "),D+=" FROM "+this.MainTableName+" D WITH(NOLOCK) INNER JOIN COM_DocCCData TXT WITH(NOLOCK) ON D."+C+"=TXT."+C,this.IsDetailVoucher?(D+=" WHERE ",0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?D+="D.AccDocDetailsID="+e.J0.String(n[o]):D+="D.InvDocDetailsID="+e.J0.String(n[o])):D+=" WHERE D.VoucherNo='"+e.J0.String(n[this.strVoucherNo])+"'"),l+=D.toString(),s.length>0&&(s=s.substr(0,s.length-1),s=s.Insert(0,"   UPDATE "+this.MainTableName+" SET "),this.IsDetailVoucher?(s+=" WHERE ",0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?s+="AccDocDetailsID="+e.J0.String(n[o]):s+="InvDocDetailsID="+e.J0.String(n[o])):s+=" WHERE VoucherNo='"+e.J0.String(n[this.strVoucherNo])+"'"),l+=s.toString();try{let u,d=null;u=h==a.length||e.J0.String(n[this.strVoucherNo])!=e.J0.String(a[h][this.strVoucherNo])?p.d.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,i,l.toString(),e.J0.String(n[this.strVoucherNo]),""):p.d.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,i,l.toString(),"",""),d=u,r=e.J0.Int(u.obj),n.Message=r>0?"Success":d&&d.Tables.length>0&&d.Tables[0].length>0&&d.Columns[0].Contains("ServerMessage")?"Failure : "+e.J0.String(d.Tables[0][0].ServerMessage):d&&d.Tables.length>0&&d.Tables[0].length>0&&d.Columns[0].Contains("ErrorMessage")?"Failure : "+e.J0.String(d.Tables[0][0].ErrorMessage):"Failure",this.EditGrid.updateRow(n)}catch(d){Logger.ErrorLog("BulkEdit-SAVE: ",d.Message)}}else n.Message="NO DATA",this.EditGrid.updateRow(n)})}SaveDimension(a){var t=this;return(0,w.A)(function*(){t.setActionHistroy("Save Dimension");let r,l="",D="",s="",m="",h="";for(let C=0;C<a.length;C++){const i=a[C];if(D="",s="",m="",h="",t.EditColumns.forEach(n=>{"SELECTIONBOX"==n.DataType?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+e.J0.String(i[n.DisplayMember]).Replace("'","''")+"',":D+=n.ID+"='"+e.J0.String(i[n.DisplayMember]).Replace("'","''")+"',":"DATE"==n.DataType?e.J0.IsEmpty(i[n.DisplayMember+"_Key"])||(n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+e.J0.ParseDate(i[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',":16==t.CostCenterID&&(n.ID.Contains("MfgDate")||n.ID.Contains("ExpiryDate")||n.ID.Contains("RetestDate"))||(D+=n.ID+"='"+e.J0.ParseDate(i[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"DATETIME"==n.DataType||"TIME"==n.DataType?e.J0.IsEmpty(i[n.DisplayMember+"_Key"])||(n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+e.J0.ParseDate(i[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',":16==t.CostCenterID&&(n.ID.Contains("MfgDate")||n.ID.Contains("ExpiryDate")||n.ID.Contains("RetestDate"))||(D+=n.ID+"='"+e.J0.ParseDate(i[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"ComboBox"==n.DataType?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+e.J0.String(i[n.ValueBinding]).Replace("'","''")+"',":D+=n.ID+"='"+e.J0.String(i[n.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==n.DataType?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+e.J0.String(i[n.ValueBinding+"_Key"]).Replace("'","''")+"',":D+=n.ID+"='"+e.J0.String(i[n.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==n.DataType&&0!=n.CostCenterID?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+e.J0.String(i[n.ValueMember]).Replace("'","''")+"',":n.ID.toLowerCase().startsWith("ccnid")?m+=n.ID+"="+e.J0.String(i[n.ValueMember])+",":D+=n.ID+"="+e.J0.String(i[n.ValueMember])+",":t.AddressFields.Contains(n.SectionName)?h+=n.ID+"='"+e.J0.String(i[n.DisplayMember]).Replace("'","''")+"',":n.IsColumnUserDefined?s+=n.ID+"='"+e.J0.String(i[n.DisplayMember]).Replace("'","''")+"',":D+=n.ID+"='"+e.J0.String(i[n.DisplayMember]).Replace("'","''")+"',"}),D.length>0||s.length>0||m.length>0||h.length>0)try{if(r=0,null!=t.ReportObj){if(null==i.ReportPK)continue;let d=p.d.common.GetDataSet3("BULK002",t.PrimaryColumns,t.MainTableName,t.PrimaryKey+","+e.J0.String(i.ReportPK)).Tables[0];if(0==d.length)continue;d.Columns.forEach(u=>{t.EditGrid.TableColumns.Contains(u.ColumnName)||t.EditGrid.TableColumns.push(u.ColumnName),i[u.ColumnName]=d[0][u.ColumnName]})}if(2==t.CostCenterID){let n={};n.AccountID=parseInt(i.AccountID),n.GUID=e.J0.String(i.GUID);var o=t.EditColumns.find(d=>"AccountCode"==d.ID);n.AccountCode=e.J0.String(null!=o?i[o.DisplayMember]:i.AccountCode),n.CodePrefix=n.AccountCode,o=t.EditColumns.find(d=>"AccountName"==d.ID),n.AccountName=e.J0.String(null!=o?i[o.DisplayMember]:i.AccountName),o=t.EditColumns.find(d=>"StatusID"==d.ID),n.StatusID=null!=o&&e.J0.String(i[o.ValueBinding]).length>0?parseInt(i[o.ValueBinding]):parseInt(i.StatusID),o=t.EditColumns.find(d=>"AccountTypeID"==d.ID),n.AccountTypeID=null!=o&&e.J0.String(i[o.ValueBinding]).length>0?parseInt(i[o.ValueBinding]):parseInt(i.AccountTypeID),n.IsGroup=(0,R.yG0)(i.IsGroup),n.StaticFieldsQuery=D.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),h.length>0&&(h=h.substr(0,h.length-1),h=' <Data><Row Action="MODIFY" AddressID="'+e.J0.String(i.AddressID)+'" AddressTypeID="1"  StaticFields ="'+h,h+='"/></Data>'),n.AddressXML=h.toString(),n.CCMapXML=null,p.d.accounting.SaveAccount(n,"SaveAccountQuick").subscribe(d=>{if(l=d.Message,r=d.RetValue,r>0){i.Message="Success",t.EditGrid.updateRow(i);let g=p.d.common.BulkEditDetals_7(8,r,t.CostCenterID,"","","","").ds;null!=g&&g.Tables.length>0&&g.Tables[0].length>0&&g.Columns[0].Contains("GUID")&&(i.GUID=e.J0.String(g.Tables[0][0].GUID))}else i.Message="Failure : "+l,t.EditGrid.updateRow(i)},d=>{alert(JSON.stringify(d)),console.log("Bulk Edit Account Save : "+JSON.stringify(d))})}else if(3==t.CostCenterID){let n=new te.c;n.ProductID=parseInt(i.ProductID),n.GUID=e.J0.String(i.GUID);let d=t.EditColumns.find(g=>"ProductCode"==g.ID);n.ProductCode=e.J0.String(null!=d?i[d.DisplayMember]:i.ProductCode),n.CodePrefix=n.ProductCode,d=t.EditColumns.find(g=>"ProductName"==g.ID),n.ProductName=e.J0.String(null!=d?i[d.DisplayMember]:i.ProductName),d=t.EditColumns.find(g=>"ProductTypeID"==g.ID),n.ProductType=null!=d&&e.J0.String(i[d.ValueBinding]).length>0?parseInt(i[d.ValueBinding]):parseInt(i.ProductTypeID),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),n.CCCCMapDATA=null;let u=n.SetProductQuick(D.toString());if(!e.J0.IsEmpty(u))if(l=u?.Message,r=u?.RetValue,r>0){i.Message="Success",t.EditGrid.updateRow(i);let c=p.d.common.BulkEditDetals_7(8,r,t.CostCenterID,"","","","").ds;null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&c.Columns[0].Contains("GUID")&&(i.GUID=e.J0.String(c.Tables[0][0].GUID))}else i.Message="Failure : "+l,t.EditGrid.updateRow(i)}else if(16==t.CostCenterID){let n={};n.BatchID=parseInt(i.BatchID),n.GUID=e.J0.String(i.GUID),o=t.EditColumns.find(c=>"BatchCode"==c.ID),n.BatchCode=e.J0.String(null!=o?i[o.DisplayMember]:i.BatchCode),n.CodePrefix=n.BatchCode,n.StaticFieldsQuery=D.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString();let u=[];u.push(e.J0.String(i.BatchNumber)),o=t.EditColumns.find(c=>"MfgDate"==c.ID),u.push(null!=o?e.J0.ParseDate(e.J0.String(i[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):e.J0.IsEmpty(i.MfgDate)?"1/JAN/1900":e.J0.ParseDate(i.MfgDate.toString()).ToString("dd/MMM/yyyy")),o=t.EditColumns.find(c=>"ExpiryDate"==c.ID),u.push(null!=o?e.J0.ParseDate(e.J0.String(i[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):e.J0.IsEmpty(i.ExpiryDate)?"1/JAN/1900":e.J0.ParseDate(i.ExpiryDate.toString()).ToString("dd/MMM/yyyy")),o=t.EditColumns.find(c=>"MRPRate"==c.ID),u.push(null!=o?parseFloat(e.J0.String(i[o.DisplayMember])):parseFloat(e.J0.String(i.MRPRate))),o=t.EditColumns.find(c=>"RetailRate"==c.ID),u.push(null!=o?parseFloat(e.J0.String(i[o.DisplayMember])):parseFloat(e.J0.String(i.RetailRate))),o=t.EditColumns.find(c=>"StockistRate"==c.ID),u.push(null!=o?parseFloat(e.J0.String(i[o.DisplayMember])):parseFloat(e.J0.String(i.StockistRate))),u.push(e.J0.String(i.ProductID)),o=t.EditColumns.find(c=>"RetestDate"==c.ID),u.push(null!=o?e.J0.ParseDate(e.J0.String(i[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):e.J0.IsEmpty(i.RetestDate)?null:e.J0.ParseDate(i.RetestDate.toString()).ToString("dd/MMM/yyyy")),u.push(0),n.StaticFieldsQuery=D.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString()}else if(92==t.CostCenterID){let n={};n.PropertyID=parseInt(i.NodeID),n.GUID=i.GUID.toString(),n.IsGroup=(0,R.yG0)(i.IsGroup);let d=t.EditColumns.find(u=>"Code"==u.ID);n.Code=null!=d?i[d.DisplayMember].toString():i.Code.toString(),d=t.EditColumns.find(u=>"Name"==u.ID),n.Name=null!=d?i[d.DisplayMember].toString():i.Name.toString(),d=t.EditColumns.find(u=>"Status"==u.ID),n.StatusID=null!=d&&i[d.ValueBinding].toString().length>0?parseInt(i[d.ValueBinding]):parseInt(i.Status),n.DetailsXML=D.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),p.d.rental.SaveProperty(n,"SaveProperty").subscribe(u=>{t.DisplayMessage=u.Message,t.MessageVisibility=!0},u=>{console.log(" Property Save : "+JSON.stringify(u))})}else if(93==t.CostCenterID){let n={};n.UnitID=parseInt(i.UnitID),n.GUID=i.GUID.toString(),n.IsGroup=(0,R.yG0)(i.IsGroup),o=t.EditColumns.find(u=>"PropertyID"==u.ID),n.Property=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.PropertyID)&&i.PropertyID.toString().length>0?parseInt(i.PropertyID):0,o=t.EditColumns.find(u=>"Code"==u.ID),n.Code=null!=o?i[o.DisplayMember].toString():i.Code.toString(),o=t.EditColumns.find(u=>"Name"==u.ID),n.Name=null!=o?i[o.DisplayMember].toString():i.Name.toString(),o=t.EditColumns.find(u=>"Status"==u.ID),n.StatusID=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):parseInt(i.Status),o=t.EditColumns.find(u=>"NodeID"==u.ID),n.UnitType=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.NodeID)&&i.NodeID.toString().length>0?parseInt(i.NodeID):0,o=t.EditColumns.find(u=>"UnitType"==u.ID),n.TypeofUnit=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.UnitType)&&i.UnitType.toString().length>0?parseInt(i.UnitType):0,o=t.EditColumns.find(u=>"UnitStatus"==u.ID),n.UnitStatus=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.UnitStatus)&&i.UnitStatus.toString().length>0?parseInt(i.UnitStatus):0,o=t.EditColumns.find(u=>"RentableArea"==u.ID),n.RentalArea=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.RentableArea)&&i.RentableArea.toString().length>0?parseFloat(i.RentableArea):0,o=t.EditColumns.find(u=>"BuildUpArea"==u.ID),n.BuildUpArea=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.BuildUpArea)&&i.BuildUpArea.toString().length>0?parseFloat(i.BuildUpArea):0,o=t.EditColumns.find(u=>"FloorLookupID"==u.ID),n.Floor=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.FloorLookupID)&&i.FloorLookupID.toString().length>0?parseInt(i.FloorLookupID):0,o=t.EditColumns.find(u=>"ViewLookupID"==u.ID),n.View=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.ViewLookupID)&&i.ViewLookupID.toString().length>0?parseInt(i.ViewLookupID):0,o=t.EditColumns.find(u=>"NoOfBathrooms"==u.ID),n.NoOfBathrooms=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.NoOfBathrooms)&&i.NoOfBathrooms.toString().length>0?parseFloat(i.NoOfBathrooms):0,o=t.EditColumns.find(u=>"NoOfParkings"==u.ID),n.NoOfParkings=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.NoOfParkings)&&i.NoOfParkings.toString().length>0?parseFloat(i.NoOfParkings):0,o=t.EditColumns.find(u=>"ElectricityCode"==u.ID),n.ElectricityCode=null!=o?i[o.DisplayMember].toString():e.J0.IsEmpty(i.ElectricityCode)?"":i.ElectricityCode.toString(),o=t.EditColumns.find(u=>"ElectricityKW"==u.ID),n.Electricity=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.ElectricityKW)&&i.ElectricityKW.toString().length>0?parseFloat(i.ElectricityKW):0,o=t.EditColumns.find(u=>"Rent"==u.ID),n.Amount=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.Rent)&&i.Rent.toString().length>0?parseFloat(i.Rent):0,o=t.EditColumns.find(u=>"RentTypeID"==u.ID),n.AmountType=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.RentTypeID)&&i.RentTypeID.toString().length>0?parseInt(i.RentTypeID):0,o=t.EditColumns.find(u=>"DiscountAmount"==u.ID),n.Discount=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.DiscountAmount)&&i.DiscountAmount.toString().length>0?parseFloat(i.DiscountAmount):0,o=t.EditColumns.find(u=>"DiscountPercentage"==u.ID),n.DiscountPercentage=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.DiscountPercentage)&&i.DiscountPercentage.toString().length>0?parseFloat(i.DiscountPercentage):0,o=t.EditColumns.find(u=>"AnnualRent"==u.ID),n.AnnaulRent=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.AnnualRent)&&i.AnnualRent.toString().length>0?parseFloat(i.AnnualRent):0,o=t.EditColumns.find(u=>"MonthlyRent"==u.ID),n.MonthlyRent=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.MonthlyRent)&&i.MonthlyRent.toString().length>0?parseFloat(i.MonthlyRent):0,o=t.EditColumns.find(u=>"RentPerSQFT"==u.ID),n.RentperSqft=null!=o&&i[o.DisplayMember].toString().length>0?parseFloat(i[o.DisplayMember]):!e.J0.IsEmpty(i.RentPerSQFT)&&i.RentPerSQFT.toString().length>0?parseFloat(i.RentPerSQFT):0,o=t.EditColumns.find(u=>"TermsConditions"==u.ID),n.TermsConditions=null!=o?i[o.DisplayMember].toString():e.J0.IsEmpty(i.TermsConditions)?"":i.TermsConditions.toString(),o=t.EditColumns.find(u=>"AccountantID"==u.ID),n.Accountant=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.AccountantID)&&i.AccountantID.toString().length>0?parseInt(i.AccountantID):0,o=t.EditColumns.find(u=>"SalesmanID"==u.ID),n.Salesman=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.SalesmanID)&&i.SalesmanID.toString().length>0?parseInt(i.SalesmanID):0,o=t.EditColumns.find(u=>"LandlordID"==u.ID),n.Landlord=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.LandlordID)&&i.LandlordID.toString().length>0?parseInt(i.LandlordID):0,o=t.EditColumns.find(u=>"RentalIncomeAccountID"==u.ID),n.RentalIncomeAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.RentalIncomeAccountID)&&i.RentalIncomeAccountID.toString().length>0?parseInt(i.RentalIncomeAccountID):0,o=t.EditColumns.find(u=>"PenaltyAccountID"==u.ID),n.PenaltyAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.PenaltyAccountID)&&i.PenaltyAccountID.toString().length>0?parseInt(i.PenaltyAccountID):0,o=t.EditColumns.find(u=>"RentalReceivableAccountID"==u.ID),n.RentalReceivableAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.RentalReceivableAccountID)&&i.RentalReceivableAccountID.toString().length>0?parseInt(i.RentalReceivableAccountID):0,o=t.EditColumns.find(u=>"AdvanceRentAccountID"==u.ID),n.AdvanceRentAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.AdvanceRentAccountID)&&i.AdvanceRentAccountID.toString().length>0?parseInt(i.AdvanceRentAccountID):0,o=t.EditColumns.find(u=>"ProvisionAccountID"==u.ID),n.ProvisionAccountID=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.ProvisionAccountID)&&i.ProvisionAccountID.toString().length>0?parseInt(i.ProvisionAccountID):0,o=t.EditColumns.find(u=>"BankAccount"==u.ID),n.BankAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.BankAccount)&&i.BankAccount.toString().length>0?parseInt(i.BankAccount):0,o=t.EditColumns.find(u=>"BankLoanAccount"==u.ID),n.BankLoanAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.BankLoanAccount)&&i.BankLoanAccount.toString().length>0?parseInt(i.BankLoanAccount):0,o=t.EditColumns.find(u=>"AdvanceReceivableAccountID"==u.ID),n.AdvanceReceivableAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.AdvanceReceivableAccountID)&&i.AdvanceReceivableAccountID.toString().length>0?parseInt(i.AdvanceReceivableAccountID):0,o=t.EditColumns.find(u=>"AdvReceivableCloseAccID"==u.ID),n.AdvReceivableCloseAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.AdvReceivableCloseAccID)&&i.AdvReceivableCloseAccID.toString().length>0?parseInt(i.AdvReceivableCloseAccID):0,o=t.EditColumns.find(u=>"RentalAccount"==u.ID),n.RentAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.RentalAccount)&&i.RentalAccount.toString().length>0?parseInt(i.RentalAccount):0,o=t.EditColumns.find(u=>"RentPayableAccount"==u.ID),n.RentPayableAcc=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.RentPayableAccount)&&i.RentPayableAccount.toString().length>0?parseInt(i.RentPayableAccount):0,o=t.EditColumns.find(u=>"AdvanceRentPaid"==u.ID),n.AdvanceRentPaid=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.AdvanceRentPaid)&&i.AdvanceRentPaid.toString().length>0?parseInt(i.AdvanceRentPaid):0,o=t.EditColumns.find(u=>"TenantID"==u.ID),n.TenantID=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.TenantID)&&i.TenantID.toString().length>0?parseInt(i.TenantID):0,o=t.EditColumns.find(u=>"LocationID"==u.ID),n.LocationID=null!=o&&i[o.ValueBinding].toString().length>0?parseInt(i[o.ValueBinding]):!e.J0.IsEmpty(i.LocationID)&&i.LocationID.toString().length>0?parseInt(i.LocationID):0,o=t.EditColumns.find(u=>"BasedOn"==u.ID),n.BasedOn=null!=o?i[o.DisplayMember].toString():i.BasedOn.toString(),n.PostIncome=e.J0.String(i.PostIncome),n.CustomFieldsQuery=s.toString(),n.CustomCCQuery=m.toString(),p.d.rental.SaveUnits(n,"SaveUnits").subscribe(u=>{t.DisplayMessage=u.Message},u=>{console.log(" Unit Save : "+JSON.stringify(u))})}else if(95==t.CostCenterID||103==t.CostCenterID||104==t.CostCenterID||129==t.CostCenterID){s.length>1&&(s=s.substr(0,s.length-1)),m.length>1&&(m=m.substr(0,m.length-1));let n=null;Object.keys(i).Contains("ContractID")?n=yield p.d.common.BulkEditDetals_7(11,parseInt(i.ContractID),t.CostCenterID,"",s.toString(),m,m.toLowerCase().Replace("ccnid","dcccnid")):i.Table.Columns.Contains("QuotationID")&&(n=yield p.d.common.BulkEditDetals_7(11,parseInt(i.QuotationID),t.CostCenterID,"",s.toString(),m,m.toLowerCase().Replace("ccnid","dcccnid"))),i.Message=n.obj&&n.obj>0?"Success":null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&n.Columns[0].Contains("ServerMessage")?"Failure : "+n.Tables[0][0].ServerMessage.toString():null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&n.Columns[0].Contains("ErrorMessage")?"Failure : "+n.Tables[0][0].ErrorMessage.toString():"Failure",t.EditGrid.updateRow(i)}else if(t.CostCenterID>=50001){let n={};n.NodeID=parseInt(i.NodeID),n.GUID=e.J0.String(i.GUID),n.CostCenterID=t.CostCenterID;let d=t.EditColumns.find(u=>"Code"==u.ID);n.Code=e.J0.String(null!=d?i[d.DisplayMember]:i.Code),d=t.EditColumns.find(u=>"Name"==u.ID),n.Name=e.J0.String(null!=d?i[d.DisplayMember]:i.Name),d=t.EditColumns.find(u=>"StatusID"==u.ID),n.Status=null!=d&&e.J0.String(i[d.ValueBinding]).length>0?parseInt(e.J0.String(i[d.ValueBinding])):parseInt(i.StatusID),n.StaticFieldsQuery=D.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),n.CCXML="",p.d.common.SaveCostCenterQuick(n,"SaveCostCenterQuick").subscribe(u=>{if(l=u.Message,r=u.RetValue,r>0){i.Message="Success",t.EditGrid.updateRow(i);let c=p.d.common.BulkEditDetals_7(8,r,t.CostCenterID,"","","","").ds;null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&c.Columns[0].Contains("GUID")&&(i.GUID=e.J0.String(c.Tables[0][0].GUID))}else i.Message="Failure : "+l,t.EditGrid.updateRow(i)},u=>{alert(JSON.stringify(u)),console.log("Bulk Quick Add CostCenter Save : "+JSON.stringify(u))})}}catch(n){Logger.ErrorLog("BulkEdit-SAVE: ",n.Message)}else i.Message="NO DATA",t.EditGrid.updateRow(i)}})()}TransferUsers(a){let t="";if(a.forEach(r=>{t+=e.J0.String(r.NodeID)+","}),t=t.substr(0,t.length-1),t.length>0){let r=p.d.admin.TransferUser(this.CostCenterID,0,t,this.strOldUserID,this.TargetUserID.SelectedValue.toString());r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Columns[1].Contains("ErrorMessage")&&(this.DisplayMessage=r.Tables[r.Tables.length-1][0].ErrorMessage.toString()),this.RefreshData()}}DeleteDimension(a){this.setActionHistroy("Delete Dimension");let t,r="",l="";r=null!=this.ReportObj?"ReportPK":this.PrimaryKey;let D=0;for(let s=0;s<a.length;s++){const m=a[s];try{if(t=0,null!=this.ReportObj&&e.J0.IsEmpty(m.ReportPK))continue;if(2==this.CostCenterID){let h={};h.AccountID=parseInt(m[r]);let o=p.d.accounting.DeleteAccount(h.AccountID);l=o.Message,t=o.RetValue}else if(3==this.CostCenterID){let h=p.d.inventory.DeleteProduct(parseInt(m[r]));l=h.Message,t=h.RetValue}else if(this.CostCenterID>=50001){let h={};h.NodeID=parseInt(m[r]),h.CostCenterID=this.CostCenterID;let o=p.d.common.DeleteCostCenter(h.CostCenterID,h.NodeID);l=o.Message,t=o.RetValue}else l="Functionality not implemented";t>0?(D++,this.EditGrid.removeRow(m)):(m.Message="Failure : "+l,this.EditGrid.updateRow(m))}catch(h){Logger.ErrorLog("BulkEdit-DELETE: ",h.Message)}}this.DisplayMessage=D+" Records Deleted"}OnRowSelection(a){return!1}OnKeyDown(a,t){!t.ctrlKey&&117==t.which&&(t.preventDefault(),this.onCopy(this.EditGrid.getArgsObj(a)))}onCopy(a){if(null!=a){let r,l,D=a.column.className;a.grid.getEditorLock().commitCurrentEdit(),l=a.column.field;for(let s=0;s<this.EditGrid.Columns.length;s++){const m=this.EditGrid.Columns[s];if(null!=m.SectionName&&m.SectionName.toString()==l.toString()){r=m;for(let o=this.EditGrid.SelectedIndex;o<this.EditGrid.Table.length;o++)if((0,R.yG0)(this.EditGrid.Table[o].Select)){if(this.EditGrid.Table[o][l]=a.item[l].toString(),"DataGridDateTimeColumn"!=D&&"DataGridDateColumn"!=D||!this.EditGrid.TableColumns.Contains(l+"_Key")){if("DataGridPactListBoxColumn"==a.column.className){var t=this.EditGrid.Columns.find(C=>C.DisplayMember==l);null!=t&&(this.EditGrid.Table[o][t.ValueMember]=a.item[t.ValueMember].toString())}}else this.EditGrid.Table[o][l+"_Key"]=a.item[l+"_Key"].toString();this.EditGrid.updateRow(this.EditGrid.Table[o])}break}}}}Cancelclick(){this.ApproveVisibility=!1,p.d.page.HideDialog(this.PopUpGUID),null!=this.DB&&(this.ShowRightPanel=!1)}onClickIkon(a){this.ApprovalClick(a,null)}ApprovalClick(a,t){this.DisplayMessage="";let r="";if("Approve"==a||"Reject"==a||"Suspend"==a){if(this.RemarksApprove&&"Approve"==a&&e.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Approve Remarks Mandatory",-1;if(this.RemarksReject&&"Reject"==a&&e.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Reject Remarks Mandatory",-1;if(this.RemarksSuspend&&"Suspend"==a&&e.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Suspend Remarks Mandatory",-1;if(this.IsDocument&&this.IsLWApproval&&"Suspend"!=a&&!e.J0.IsEmpty(this.strVoucherNo)&&(r=this.strVoucherNo),2==this.CostCenterID?this.strVoucherNo="AccountID":3==this.CostCenterID?this.strVoucherNo="ProductID":93==this.CostCenterID?this.strVoucherNo="UnitID":95==this.CostCenterID||104==this.CostCenterID?this.strVoucherNo="ContractID":103==this.CostCenterID||129==this.CostCenterID?this.strVoucherNo="QuotationID":92==this.CostCenterID||this.CostCenterID>5e4?this.strVoucherNo="NodeID":null!=this.ReportObj&&this.EditGrid.TableColumns.Contains("ReportPK")&&(this.strVoucherNo="ReportPK"),null==t&&(t=this.EditGrid.Table.filter(h=>1==h.Select||1==h.Select)),0==t.length)return this.DisplayMessage="No Rows Selected",-1;let l="",D="",s=!1,m=0;if(s=0!=e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0),"Approve"==a?m=1:"Suspend"==a&&(m=2),this.IsDocument)if(this.IsLWApproval&&"Suspend"!=a){e.J0.IsEmpty(r)||(this.strVoucherNo=r),t.length>0&&(t=t.sort((n,d)=>n[this.strVoucherNo]-d[this.strVoucherNo]));let h=this.PrimaryKey;null!=this.ReportObj&&(h="ReportPK");let C,o=null,i="";t.forEach(n=>{C=e.J0.String(n[this.strVoucherNo]),C!=o&&(i.length>0&&(l.length>0&&(l+="\x11"),l+='<XML No="'+o+'">'+i+"</XML>"),i="",o=C),i+='<Row ID="'+e.J0.String(n[h])+'"  GUID="'+e.J0.String(n.GUID)+'"  Remarks="'+e.J0.EncodeXML(this.Remarks.Text)+'" WID="'+e.J0.String(n.WorkFlowID)+'"/>'}),i.length>0&&(l.length>0&&(l+="\x11"),l+='<XML No="'+o+'">'+i+"</XML>")}else l+="<DOCXML>",t.forEach(h=>{if(l+='<Row VoucherNo="'+e.J0.String(h[this.strVoucherNo])+'" GUID = "'+e.J0.String(h.GUID)+'" />',!e.J0.IsEmpty(h[this.strVoucherNo])&&"BUA-"==h[this.strVoucherNo].toString().substr(0,4)){let o=0,i=p.d.common.GetDataSet3("BULK003",e.J0.String(h[this.strVoucherNo]),"","").Tables[0];if(null!=i&&i.length>0){o=parseInt(i[0].EmpSeqNo);let n=ee.RibbonExtPay.GetAppraisal(i);n.length>0&&(D+='<Row EmpNodeID="'+o+'" ',D+=' VoucherNo ="'+h[this.strVoucherNo].toString()+'" ',D+=' Query ="'+n+'" ',D+="/>")}}}),l+="</DOCXML>",D.length>0&&(D="<Data>"+D+"</Data>");else l+="<DOCXML>",t.forEach(h=>{l+='<Row VoucherNo="'+e.J0.String(h[this.strVoucherNo])+'" GUID = "'+e.J0.String(h.GUID)+'" />'}),l+="</DOCXML>";if(l.length>0){this.setActionHistroy(a);let h=0,o=p.d.common.BulkApprovals(this.CostCenterID,s,this.Remarks.Text,l.toString(),m,this.AppRejDate.Date.ToString("dd/MMM/yyyy"),D);return h=e.J0.Int(o.obj),h>0?(this.IsDocument&&this.IsApproval&&this.UpdateOnApproval&&this.SaveDocument(t,!0),this.Remarks.Text="",t.forEach(C=>{this.EditGrid.removeRow(C)}),"Suspend"==a&&(this.Report.length>0?this.Report[0].Refresh():this.RefreshData()),this.DisplayMessage="Approve"==a?a+"d Successfully":a+"ed Successfully"):this.DisplayMessage="Error in Save",h}}return 0}setActionHistroy(a){let t="";null!=this.Report&&this.Report.length>0&&!e.J0.IsEmpty(this.Report[0].WhereTag)?t=this.Report[0].WhereTag:e.J0.IsEmpty(this.strWhereforAuctionHistory)||(t=this.strWhereforAuctionHistory),p.d.common.GetDataSet3("BULK005","Bulk Edit - "+a,t,p.d.SessionManager.UserName)}BarcodeDocument(a){if(0==this.EditColumns.length)return void(this.DisplayMessage="Please select ateleast one editable column.");if(null==a[0][this.EditColumns[0].DisplayMember])return void(this.DisplayMessage="Selected editable column not found.");let r,l,t="";if(!(this.CostCenterID>4e4&&this.CostCenterID<5e4))return void(this.DisplayMessage="Not implemented");l=0==e.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",r=null!=this.ReportObj?"ReportPK":l;let D,m,s=new P.bT;a.forEach(h=>{D=e.J0.String(h[this.strVoucherNo]),s.ContainsKey(D)||s.push(D,[]),s[D].push(h)}),s.keys.forEach(h=>{let o={Key:h,Value:s[h]};t="",t+="<XML IgnorePositionDialog='1'>",o.Value.forEach(i=>{i.Message=null,m=e.J0.IntTryParse(e.J0.String(i[this.EditColumns[0].DisplayMember])),m>0?t+='<R DocDetailsID="'+e.J0.String(i[r])+'" Qty="'+e.J0.String(i[this.EditColumns[0].DisplayMember])+'"/>':i.Message="Invalid Quantity"}),t+="</XML>";let C=this.PrintBarcode(o.Key,t.toString());o.Value.forEach(i=>{null==i.Message&&(i.Message=C)})})}PrintBarcode(a,t){let s,r=0,l=0,m=p.d.report.GetDocumentDetailsByVoucherNo(a);if(s=e.J0.Int(m.obj),!(s>0))return"Voucher Not Found";{let h;h=m.Tables[0].length>0?m.Tables[0][0]:m.Tables[1][0],r=parseInt(h.CostCenterID),l=parseInt(h.DocID)}return"Success"}OnDateRangesSelectionChanged(a){null!=this.DateRanges.SelectedValue&&X.w.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}}class V{constructor(a,t){this.dsFields=null,this.CostCenterID=0,this.ClassName="BulkEditViewModel",this.dsFields=a,this.Parent=t,(t.ClassName="BulkEditViewModel")&&(this.CostCenterID=t.CostCenterID),this.FilterGrid=new B.vv,this.FilterGrid.Width="",this.FilterGrid.Height=200,this.FilterGrid.CanUserAddRows=!0,this.FilterGrid.CanUserDeleteRows=!0,this.FilterGrid.BeginEdit.Subscribe(this,"OnBeginEditing"),this.FilterGrid.CellEditEnding.Subscribe(this,"OnCellEditCommiting");let r=[],l=new M.O7,D=[],s={AND:"AND",Value:"AND"};D.push(s),s={},s.AND="OR",s.Value="OR",D.push(s),s={},s.AND="(",s.Value="(",D.push(s),s={},s.AND=")",s.Value=")",D.push(s),l=new M.O7,l.ComboData=D,l.DisplayMember="AND",l.ValueMember="Value",l.ValueBinding="And",l.Header="AND/OR",l.DataType="ComboBox",l.Width=80,l.IsVisible=!0,r.push(l),l=new M.O7,null!=a&&(l.ComboData=a.Tables[0]),l.DisplayMember="UserColumnName",l.ValueMember="CostCenterColID",l.ValueBinding="Field",l.DataType="ComboBox",l.Header="Column",l.Width=200,l.IsVisible=!0,r.push(l),l=new M.O7,l.ComboData=this.ReturnCondition(),l.DisplayMember="Condition",l.ValueMember="Value",l.ValueBinding="Condition",l.DataType="ComboBox",l.Header="Condition",l.Width=120,l.IsVisible=!0,r.push(l),l=new M.O7,l.Header="Value",l.DisplayMember="MULTI",l.ValueMember="MULTI_LISTBOX",l.DataType="MULTI_TYPE",l.Width=150,l.IsMultiType=!0,r.push(l),this.FilterGrid.Columns=r,this.FilterGrid.Clear(),this.FilterGrid.TableColumns.push("And"),this.FilterGrid.TableColumns.push("Column"),this.FilterGrid.TableColumns.push("Field"),this.FilterGrid.TableColumns.push("Condition"),this.FilterGrid.TableColumns.push("MULTI"),this.FilterGrid.TableColumns.push("MULTI_TYPE"),this.FilterGrid.TableColumns.push("MULTI_FLOAT"),this.FilterGrid.TableColumns.push("MULTI_DATE"),this.FilterGrid.TableColumns.push("MULTI_LISTBOX"),this.FilterGrid.TableColumns.push("MULTI_COMBOBOX");for(let m=0;m<10;m++){let h=this.FilterGrid.NewRow();this.FilterGrid.addRow(h)}}LoadXML(a){let t=new e.VB;t.LoadXml(a),this.FilterGrid.Clear(),t.DocumentElement.childNodes.length>0&&t.DocumentElement.childNodes.forEach(r=>{let l=this.FilterGrid.NewRow();if(l.And=r.attributes.And.value,e.J0.IsEmpty(r.attributes.Field.value)||(l.Field=r.attributes.Field.value),l.Condition=r.attributes.Condition.value,l.MULTI_TYPE=r.attributes.ValueType.value,l.MULTI=r.attributes.Value.value,null!=r.attributes.Value_Key&&!e.J0.IsEmpty(r.attributes.Value_Key.value))switch(e.J0.String(l.MULTI_TYPE)){case"DATE":case"DATETIME":l.MULTI_DATE=r.attributes.Value_Key.value;break;case"LISTBOX":l.MULTI_LISTBOX=r.attributes.Value_Key.value;break;case"COMBOBOX":l.MULTI_COMBOBOX=r.attributes.Value_Key.value}this.FilterGrid.addRow(l)});for(let r=0;r<10;r++){let l=this.FilterGrid.NewRow();this.FilterGrid.addRow(l)}}GetXML(){let a="";a+="<XML>";let t=0;for(let r=0;r<this.FilterGrid.Table.length;r++){const l=this.FilterGrid.Table[r];if(t++,""!=e.J0.String(l.And)||""!=e.J0.String(l.Field)){switch(a+='<Row And="',(1!=t||"("==e.J0.String(l.And))&&(a+=e.J0.String(l.And)),a+='"',a+=' Field="'+e.J0.String(l.Field)+'"',a+=' Condition="'+e.J0.EncodeXML(e.J0.String(l.Condition))+'"',a+=' ValueType="'+e.J0.EncodeXML(e.J0.String(l.MULTI_TYPE))+'"',a+=' Value="'+e.J0.EncodeXML(e.J0.String(l.MULTI))+'"',e.J0.String(l.MULTI_TYPE)){case"DATE":a+=' Value_Key="'+e.J0.EncodeXML(e.J0.String(l.MULTI_DATE))+'"';break;case"LISTBOX":a+=' Value_Key="'+e.J0.EncodeXML(e.J0.String(l.MULTI_LISTBOX))+'"';break;case"COMBOBOX":a+=' Value_Key="'+e.J0.EncodeXML(e.J0.String(l.MULTI_COMBOBOX))+'"'}a+="/>"}}return a+="</XML>",a.toString()}SetFieldsData(a,t){this.dsFields=a,this.CostCenterID=t;let r=[];this.FilterGrid.Columns[1].ComboData=a.Tables[0],this.FilterGrid.Columns.forEach(l=>{r.push(l)}),this.FilterGrid.Columns=r}ReturnCondition(){let a=[],t={Condition:"Equals",Value:"=",Type:"3"};return a.push(t),t={},t.Condition="Does Not Equals",t.Value="<>",t.Type="3",a.push(t),t={},t.Condition="Is greater than",t.Value=">",t.Type="2",a.push(t),t={},t.Condition="Is greater than or equals to",t.Value=">=",t.Type="2",a.push(t),t={},t.Condition="Is less than",t.Value="<",t.Type="2",a.push(t),t={},t.Condition="Is less than or equals to",t.Value="<=",t.Type="2",a.push(t),t={},t.Condition="Contains",t.Value="LIKE",t.Type="1",a.push(t),t={},t.Condition="Does Not Contains",t.Value="NOT LIKE",t.Type="1",a.push(t),t={},t.Condition="Is Null",t.Value="IS NULL",t.Type="1",a.push(t),t={},t.Condition="Is Not Null",t.Value="IS NOT NULL",t.Type="1",a.push(t),a}OnCellEditCommiting(a){let t=a.item;if("Field"==a.column.field){if(null==this.dsFields)return;let l=""==e.J0.String(t.Field)?[]:this.dsFields.Tables[0].filter(m=>m.CostCenterColID==e.J0.String(t.Field));if(0==l.length)return t.MULTI="",t.MULTI_TYPE="",t.MULTI_FLOAT=null,t.MULTI_DATE=null,t.MULTI_LISTBOX=null,void(t.MULTI_COMBOBOX=null);let D=parseInt(t.Field),s=e.J0.String(l[0].UserColumnType).toUpperCase();t.MULTI_TYPE="DATE"==s?"DATE":"FLOAT"==s||"NUMERIC"==s?"FLOAT":"LISTBOX"==s?"="==e.J0.String(t.Condition)||"<>"==e.J0.String(t.Condition)?"LISTBOX":"":241==D||264==D||252==D||"StatusID"==e.J0.String(l[0].SysColumnName)||93==this.CostCenterID&&"Status"==e.J0.String(l[0].SysColumnName)?"="==e.J0.String(t.Condition)||"<>"==e.J0.String(t.Condition)?"COMBOBOX":"":"TEXT"}this.FilterGrid.onMultiTypeColumnChanged.next(t)}OnCommitCell(a){let t=this.FilterGrid.Columns.find(s=>"MULTI"==s.DisplayMember),r=""==e.J0.String(a.Field)?[]:this.dsFields.Tables[0].filter(s=>s.CostCenterColID==e.J0.String(a.Field));if(0==r.length)return;let l=parseInt(a.Field),D=e.J0.String(r[0].UserColumnType).toUpperCase();if(t.DataType=D,"DATE"==D)a.MULTI_TYPE="DATE",t.DisplayMember="MULTI_DATE";else if("FLOAT"==D||"NUMERIC"==D)a.MULTI_TYPE="FLOAT",t.DisplayMember="MULTI_FLOAT";else if("LISTBOX"==D)t.CostCenterID=parseInt(e.J0.String(r[0].ColumnCostCenterID)),t.TypeID=parseInt(e.J0.String(r[0].ColumnCCListViewTypeID)),t.DisplayMember="MULTI_LISTBOX",a.MULTI_TYPE="="==e.J0.String(a.Condition)||"<>"==e.J0.String(a.Condition)?"LISTBOX":"";else if(241==l||264==l||252==l||"StatusID"==e.J0.String(r[0].SysColumnName)||93==this.CostCenterID&&"Status"==e.J0.String(r[0].SysColumnName))if("="==a.Condition.toString()||"<>"==e.J0.String(a.Condition)){a.MULTI_TYPE="COMBOBOX",t.DisplayMember="MULTI_COMBOBOX";let s=new Array,m=null;241==l||264==l?m=this.dsFields.Tables[4]:252==l?m=V.GetBillWiseTable():"StatusID"==e.J0.String(r[0].SysColumnName)&&(m=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),m.forEach(h=>{s.push(L._p.ComboBoxItems_2(e.J0.String(h[Object.keys(h)[1]]),e.J0.String(h[Object.keys(h)[0]])))}),t.ComboData=t.ComboItems=s}else a.MULTI_TYPE="";else a.MULTI_TYPE="";this.FilterGrid.RefreshColumns()}OnBeginEditing(a){let t=a.args.item,r=this.FilterGrid.Columns.find(D=>"MULTI"==D.DisplayMember),l=a.args.column.field;if("Field"!=l&&"Condition"!=l&&"MULTI"==l){let D=""==e.J0.String(t.Field)?[]:this.dsFields.Tables[0].filter(h=>h.CostCenterColID==e.J0.String(t.Field));if(0==D.length)return void(a.Cancel=!0);let s=parseInt(t.Field),m=e.J0.String(D[0].UserColumnType).toUpperCase();if(a.args.column.DgCol.DataType=m,"DATE"==m)t.MULTI_TYPE="DATE";else if("FLOAT"==m||"NUMERIC"==m)t.MULTI_TYPE="FLOAT";else if("LISTBOX"==m)r.CostCenterID=parseInt(e.J0.String(D[0].ColumnCostCenterID)),r.TypeID=parseInt(e.J0.String(D[0].ColumnCCListViewTypeID)),a.args.column.DataGridColumn.CostCenterID=a.args.column.DgCol.CostCenterID=parseInt(e.J0.String(D[0].ColumnCostCenterID)),a.args.column.DataGridColumn.TypeID=a.args.column.DgCol.TypeID=parseInt(e.J0.String(D[0].ColumnCCListViewTypeID)),t.MULTI_TYPE="="==e.J0.String(t.Condition)||"<>"==e.J0.String(t.Condition)?"LISTBOX":"";else if(241==s||264==s||252==s||"StatusID"==e.J0.String(D[0].SysColumnName)||93==this.CostCenterID&&"Status"==e.J0.String(D[0].SysColumnName))if("="==t.Condition.toString()||"<>"==e.J0.String(t.Condition)){t.MULTI_TYPE="COMBOBOX";let h=new Array,o=null;241==s||264==s?o=this.dsFields.Tables[4]:252==s?o=V.GetBillWiseTable():"StatusID"==e.J0.String(D[0].SysColumnName)&&(o=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),o.forEach(C=>{h.push(L._p.ComboBoxItems_2(e.J0.String(C[Object.keys(C)[1]]),e.J0.String(C[Object.keys(C)[0]])))}),r.ComboData=a.args.column.DgCol.ComboData=a.args.column.DgCol.ComboItems=h}else t.MULTI_TYPE="TEXT";else t.MULTI_TYPE="TEXT";this.FilterGrid.onMultiTypeColumnChanged.next(t)}}GetWhere(a,t){let D,m,h,C,i,n,r="",l=0,s=this.Parent,o="0",d="",u="",g=s.Entities,c=t;if(l=s.CostCenterID,D=s.IsDetailVoucher,s.IsDocument&&(u=0==e.J0.stringCompare(s.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID"),l>4e4&&l<5e4){for(let S=0;S<this.FilterGrid.Table.length;S++){const A=this.FilterGrid.Table[S];if(c++,e.J0.IsEmpty(A.And)&&e.J0.IsEmpty(A.Field))continue;(c!=t+1||"("==e.J0.String(A.And))&&(r+=" "+e.J0.String(A.And)+" ");let b=e.J0.IsEmpty(A.Field)?[]:this.dsFields.Tables[0].filter(T=>T.CostCenterColID==e.J0.String(A.Field));if(0==b.length)continue;let y=b[0];if(n="T"+c.toString(),i=e.J0.String(y.SysTableName),C=e.J0.String(y.SysColumnName),m=h="",0==e.J0.stringCompare(i,"COM_DocTextData"))if(g.ContainsKey("COM_DocTextData")||g.push("COM_DocTextData","TXT"),C="TXT."+C,"DATE"==e.J0.String(y.ColumnDataType)&&"IS NOT NULL"!=e.J0.String(A.Condition)&&"IS NULL"!=e.J0.String(A.Condition))C=" isdate("+C+")=1 and convert(datetime,"+C+")",m=h=C;else if("LISTBOX"==e.J0.String(y.UserColumnType)){let T;if("44"==e.J0.String(y.ColumnCostCenterID))T="case when "+C+" is not null and isnumeric("+C+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+C+") else '' end";else{let J=p.d.report.GetTableColumns(parseInt(y.ColumnCostCenterID));T=J.ColumnName,d=J.PrimaryKey,i=J.TableName,T="case when "+C+" is not null and isnumeric("+C+")=1 then (SELECT "+T+" FROM "+i+" with(nolock) WHERE "+d+"="+C+") else '' end"}m=T,h=C}else"LOOKUP"==e.J0.String(y.UserColumnType)||(m=h=C);else 0==e.J0.stringCompare(i,"COM_DocCCData")?(g.ContainsKey("COM_DocCCData")||g.push("COM_DocCCData","DCC"),g.ContainsKey(C)||(g.push(C,n),e.J0.GetTagTableName(parseInt(y.ParentCostCenterID))),m=null==y||e.J0.IsEmpty(y.ShowCode)||"YES"!=e.J0.String(y.ShowCode)?g[C]+".Name":g[C]+".Code",h="DCC."+C):null!=y.IsForeignKey&&(0,R.yG0)(y.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(C)?(g.ContainsKey(C)||(g.push(C,n),e.J0.String(y.ParentCostCenterSysName),e.J0.String(y.ParentCostCenterColSysName)),m=g[C]+"."+s.GetColumnName(y),h="D."+C):(C="D."+C,"DATE"==e.J0.String(y.ColumnDataType)&&(C="convert(datetime,"+C+")"),m=h=C);let N=e.J0.String(A.MULTI_TYPE);switch(e.J0.String(A.Condition)){case"=":case"<>":if("LISTBOX"==N){let T;T=e.J0.IntTryParse(e.J0.String(A.MULTI_LISTBOX)),r+=" "+h+e.J0.String(A.Condition)+T.toString()}else"COMBOBOX"==N?e.J0.String(A.MULTI_COMBOBOX).length>0&&(r+=" "+h+e.J0.String(A.Condition)+"'"+e.J0.String(A.MULTI_COMBOBOX)+"'"):"DATE"==N?e.J0.IsEmpty(A.MULTI_DATE)?r+=" "+h+e.J0.String(A.Condition)+"''":r+=" "+h+e.J0.String(A.Condition)+"'"+e.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":r+=" "+m+e.J0.String(A.Condition)+"'"+e.J0.String(A.MULTI)+"'";break;case"LIKE":case"NOT LIKE":r+=" "+m+" "+e.J0.String(A.Condition)+" '%"+e.J0.String(A.MULTI)+"%'";break;case"IS NULL":case"IS NOT NULL":r+=" "+m+" "+e.J0.String(A.Condition);break;case">":case">=":case"<":case"<=":r+="DATE"==N?" "+h+e.J0.String(A.Condition)+"'"+e.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+m+e.J0.String(A.Condition)+"'%"+e.J0.String(A.MULTI)+"'%"}}s.IsApproval&&500==t&&(r.length>0&&(r+=" and "),p.d.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"TRUE"==p.d.SessionManager.Preferences.CanApproveFunction.toUpperCase()?r+=" D.WorkFlowID>0 AND dbo.fnExt_CanApprove(D."+u+",D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+p.d.SessionManager.UserID+","+p.d.SessionManager.RoleID+")=1":r+=" D.WorkFlowID>0 AND dbo.[fnRPT_CanApprove](D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+p.d.SessionManager.UserID+","+p.d.SessionManager.RoleID+")=1")}else{for(let S=0;S<this.FilterGrid.Table.length;S++){const A=this.FilterGrid.Table[S];if(c++,e.J0.IsEmpty(A.And)&&e.J0.IsEmpty(A.Field))continue;(c!=t+1||"("==e.J0.String(A.And))&&(r+=" "+e.J0.String(A.And)+" ");let b=""==e.J0.String(A.Field)?[]:this.dsFields.Tables[0].filter(T=>T.CostCenterColID==e.J0.String(A.Field));if(0==b.length)continue;let y=b[0];if(n="T"+c.toString(),i=e.J0.String(y.SysTableName),C=e.J0.String(y.SysColumnName),m=h="",0==e.J0.stringCompare(i,"ACC_AccountsExtended")||0==e.J0.stringCompare(i,"INV_ProductExtended")||0==e.J0.stringCompare(i,"REN_UnitsExtended")||0==e.J0.stringCompare(i,"REN_ContractExtended")||0==e.J0.stringCompare(i,"REN_QuotationExtended"))if(g.ContainsKey(i)||g.push(i,"EXT"),C="EXT."+C,"DATE"==e.J0.String(y.ColumnDataType))C="convert(datetime,"+C+")",m=h=C;else if("LISTBOX"==e.J0.String(y.UserColumnType)){let T;if("44"==e.J0.String(y.ColumnCostCenterID))T="case when "+C+" is not null and isnumeric("+C+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+C+") else '' end";else{let J=p.d.report.GetTableColumns(parseInt(y.ColumnCostCenterID));T=J.ColumnName,d=J.PrimaryKey,i=J.TableName,T="case when "+C+" is not null and isnumeric("+C+")=1 then (SELECT "+T+" FROM "+i+" with(nolock) WHERE "+d+"="+C+") else '' end"}m=T,h=C}else m=h=C;else 0==e.J0.stringCompare(i,"COM_CCCCData")?(g.ContainsKey("COM_CCCCData")||g.push("COM_CCCCData","CCDATA"),g.ContainsKey(C)||(g.push(C,n),e.J0.GetTagTableName(parseInt(y.ParentCostCenterID))),m=g[C]+".Name",h="CCDATA."+C):null!=y.IsForeignKey&&(0,R.yG0)(y.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(C)?(g.ContainsKey(C)||(g.push(C,n),e.J0.String(y.ParentCostCenterSysName),e.J0.String(y.ParentCostCenterColSysName)),m=g[C]+"."+s.GetColumnName(y),h="D."+C):(C="D."+C,"DATE"==e.J0.String(y.ColumnDataType)&&(C="convert(datetime,"+C+")"),m=h=C);let N=e.J0.String(A.MULTI_TYPE);switch(e.J0.String(A.Condition)){case"=":case"<>":if("LISTBOX"==N)if("15408700"==e.J0.String(y.CostCenterColID))r+="("+m+"='"+A.MULTI.toString()+"' OR ",r+=m+" like '"+A.MULTI.toString()+",%' OR ",r+=m+" like '%,"+A.MULTI.toString()+"' OR ",r+=m+" like '%,"+A.MULTI.toString()+",%' ) ";else{let T;T=e.J0.IntTryParse(e.J0.String(A.MULTI_LISTBOX)),r+=" "+h+e.J0.String(A.Condition)+T.toString()}else"COMBOBOX"==N?e.J0.String(A.MULTI_COMBOBOX).length>0&&(r+=" "+h+e.J0.String(A.Condition)+"'"+A.MULTI_COMBOBOX.toString()+"'"):r+="DATE"==N?" "+h+e.J0.String(A.Condition)+"'"+e.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+m+e.J0.String(A.Condition)+"'"+e.J0.String(A.MULTI)+"'";break;case"LIKE":case"NOT LIKE":r+=" "+m+" "+e.J0.String(A.Condition)+" '%"+e.J0.String(A.MULTI)+"%'";break;case">":case">=":case"<":case"<=":r+="DATE"==N?" "+h+e.J0.String(A.Condition)+"'"+e.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+m+e.J0.String(A.Condition)+"'%"+e.J0.String(A.MULTI)+"'%"}}s.IsApproval&&500==t&&(m=2==l?"D.AccountID":3==l?"D.ProductID":93==l?"D.UnitID":94==l?"D.TenantID":95==l||104==l?"D.ContractID":103==l||129==l?"D.QuotationID":"D.NodeID",(2==l||3==l||93==l||94==l||l>5e4)&&(o=50051==l||50054==l?"0":"ISNULL(D.WorkFlowID,0)"),r.length>0&&(r+=" and "),r+=95==l||103==l||104==l||129==l?" D.StatusID IN (470,440,465)":93==l?" D.Status IN (1001,1003)":" D.StatusID IN (1001,1003)",r+=95==l||103==l||104==l||129==l?" AND dbo.[fnREN_CanContractApprove]("+l+","+m+","+p.d.SessionManager.UserID+","+p.d.SessionManager.RoleID+")=1 ":" AND dbo.[fnRPT_CanCostCentetApprove]("+l+","+m+","+p.d.SessionManager.UserID+","+p.d.SessionManager.RoleID+","+o+")=1 ")}return r.toString()}static GetBillWiseTable(){let a=[],t={Value:1,Name:"YES"};return a.push(t),t.Value=0,t.Name="NO",a.push(t),a}}class re{constructor(a,t){this.Title="",this.ApplyToAll=!1,this.Parent=a,this.SourceColumn=t,this.Title=t.Header,this.FindGrid=new B.vv,this.FindGrid.CanUserDeleteRows=!0,this.FindGrid.Columns=[],this.FindGrid.Columns.push(t),this.FindGrid.Columns[0].Header="Find What",this.FindGrid.Columns[0].Width=233,this.FindGrid.Table=a.EditGrid.Table;let r=this.FindGrid.NewRow();this.FindGrid.addRow(r),this.FindGrid.SelectedItem=this.FindGrid.Table[0],this.FindGrid.SelectedIndex=0,this.ReplaceGrid=new B.vv,this.ReplaceGrid.CanUserDeleteRows=!0,this.ReplaceGrid.Columns=[],this.ReplaceGrid.Columns.push(t),this.ReplaceGrid.Columns[0].Header="Replace With",this.ReplaceGrid.Columns[0].Width=233,this.ReplaceGrid.Table=a.EditGrid.Table,r=this.ReplaceGrid.NewRow(),this.ReplaceGrid.addRow(r),this.ReplaceGrid.SelectedItem=this.ReplaceGrid.Table[0],this.ReplaceGrid.SelectedIndex=0}OnButtonClick(a){if(this.Parent.DisplayMessage="","Replace"==a){let t=!1,r=this.SourceColumn.SectionName+"_Key";this.Parent.EditGrid.TableColumns.Contains(r)?t=!0:r=this.SourceColumn.SectionName;let l=e.J0.String(this.FindGrid.Table[0][r]);if(this.ApplyToAll)this.Parent.EditGrid.Table.forEach(D=>{D[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],t&&(D[r]=this.ReplaceGrid.Table[0][r]),D.Select=!0,this.Parent.EditGrid.updateRow(D)}),this.Parent.DisplayMessage=this.Parent.EditGrid.Table.length+" Rows Replaced";else{let D=0;this.Parent.EditGrid.Table.forEach(s=>{0==e.J0.stringCompare(l,e.J0.String(s[r]),!0)&&(s[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],t&&(s[r]=this.ReplaceGrid.Table[0][r]),s.Select=!0,this.Parent.EditGrid.updateRow(s),D++)}),this.Parent.DisplayMessage=0==D?"No Rows Found":D+" Rows Replaced"}}else"Cancel"==a&&(this.Parent.ReplaceVisibility=!1,this.Parent.ApproveVisibility=!1)}}}}]);