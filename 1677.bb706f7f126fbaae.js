"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[1677],{1677:(R,M,S)=>{S.r(M),S.d(M,{BulkDeletionViewModel:()=>F});var y=S(10467),A=S(32647),I=S(83240),u=S(86739),c=S(92701),p=S(24028),C=S(49710),V=S(31820),w=S(23823),d=S(18569),D=S(8787),N=S(48792),f=S(75706),T=S(2360);class F extends w.g{get Dimension_rdoNodes(){return this._Dimension_rdoNodes}set Dimension_rdoNodes(t){t!=this._Dimension_rdoNodes&&(this._Dimension_rdoNodes=t,t&&(this._Dimension_rdoNodesGroups=!1))}get Dimension_rdoNodesGroups(){return this._Dimension_rdoNodesGroups}set Dimension_rdoNodesGroups(t){t!=this._Dimension_rdoNodesGroups&&(this._Dimension_rdoNodesGroups=t,t&&(this._Dimension_rdoNodes=!1))}get Notif_Attach(){return this._Notif_Attach}set Notif_Attach(t){t!=this._Notif_Attach&&(this._Notif_Attach=t,t&&(this._Notif_DataAttach=!1))}get Notif_DataAttach(){return this._Notif_DataAttach}set Notif_DataAttach(t){t!=this._Notif_DataAttach&&(this._Notif_DataAttach=t,t&&(this._Notif_Attach=!1))}constructor(){super(),this.FilterText=new V.Dw(0),this.From=new V.Dw(0),this.TO=new V.Dw(0),this.FromDate=new p.Lc(0),this.ToDate=new p.Lc(0),this.DateWise=!1,this.VoucherWise=!1,this.IsBouncedorPdcPosted=!1,this.AllDimension=!1,this.AllDocuments=!1,this.DeletePrefix=!0,this.DocList=new c.y$(0),this.DimList=new c.y$(0),this.PreserveDate=new p.Lc(0),this.Audit_AllDocuments=!1,this.Audit_AllDimensions=!1,this.Dimension_AllDimensions=!1,this.Notif_AllDocuments=!1,this.RibbonFeatures=!1,this.ProductionFeatures=!1,this.RentalFeatures=!1,this.PayrollDocuments=!1,this.UnusedFeatures=!1,this.msgString="",this.strSeletedVoucherNo="",this.sbNotif="",this.sbNotifDocs="",this.dtMaxDate=new Date,this.Vouchers=new C.vv,this.Dimensions=new C.vv,this.DisplayName=u.d.GetResource("BulkDeletion");let t=N.Document.GetAllDocuments();if(null!=t&&t.Tables.length>0&&t.Tables[0].length>0){this.DocList.Items.push(c._p.ComboBoxItems_3("All","0","true"));for(let s=0;s<t.Tables[0].length;s++)"0"!=t.Tables[0][s].HasAccess.toString()&&this.DocList.Items.push(c._p.ComboBoxItems_3(t.Tables[0][s].ResourceData.toString(),t.Tables[0][s].CostCenterID.toString(),(0,A.yG0)(t.Tables[0][s].Isinventory).toString()))}this.DocPrefixes=new c.y$(0),this.VoucherWise=!1,this.DateWise=!0,this.DocList.Label="Documents",this.From.Label="From",this.TO.Label="To",this.FromDate.Label="From",this.ToDate.Label="To",this.DocPrefixes.Label="Prefix",this.DateRanges=new c.y$,this.DateRanges.Items=I.w.items_DateRanges,this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.DocList.SelectionChangedCommand.Subscribe(this,"onDocChanged"),this.DimList.SelectionChangedCommand.Subscribe(this,"onDimChanged"),this.LoadGrid(),this.initGrid(t);let e=u.d.document.GetFeaturesList();this.Dimension_rdoNodesGroups=!0,this.Dimension_Dimensions=new c.v4,this.Dimension_Dimensions.Items.push(c.oN.CheckedListBoxItem_3("Accounts","2")),this.Dimension_Dimensions.Items.push(c.oN.CheckedListBoxItem_3("Products","3")),this.Dimension_Dimensions.Items.push(c.oN.CheckedListBoxItem_3("Batches","16")),this.Dimension_Dimensions.Items.push(c.oN.CheckedListBoxItem_3("Assets","72")),null!=e&&e.Tables.length>2&&e.Tables[2].length>0&&e.Tables[2].forEach(s=>{parseInt(s.FeatureID)>5e4&&(!(parseInt(s.FeatureID)>=50058&&parseInt(s.FeatureID)<=50070)||50068==parseInt(s.FeatureID)||50069==parseInt(s.FeatureID))&&this.Dimension_Dimensions.Items.push(c.oN.CheckedListBoxItem_3(s.Name.toString(),s.FeatureID.toString()))}),null!=e&&e.Tables.length>2&&e.Tables[2].length>0&&(this.DimList.Items.push(c._p.ComboBoxItems_3("All","0","true")),this.DimList.Items.push(c._p.ComboBoxItems_2("Accounts","2")),this.DimList.Items.push(c._p.ComboBoxItems_2("Products","3")),this.DimList.Items.push(c._p.ComboBoxItems_2("Batches","16")),this.DimList.Items.push(c._p.ComboBoxItems_2("Assets","72")),this.DimList.Items.push(c._p.ComboBoxItems_2("Substitutes","23")),e.Tables[2].forEach(s=>{parseInt(s.FeatureID)>5e4&&(!(parseInt(s.FeatureID)>=50058&&parseInt(s.FeatureID)<=50070)||50068==parseInt(s.FeatureID)||50069==parseInt(s.FeatureID))&&this.DimList.Items.push(c._p.ComboBoxItems_2(s.Name.toString(),s.FeatureID.toString()))})),this.LoadAuditTrial(t,e.Tables.length>2?e.Tables[2]:null),this.Notif_Dimensions=new c.v4,this.NotifPreserveDays="30",this.Notif_Attach=!0;let l=u.d.common.GetDataTable("BULKDVM001","");l&&l.length>0&&l.forEach(s=>{this.Notif_Dimensions.Items.push(c.oN.CheckedListBoxItem_3(s.Name.toString(),s.FeatureID.toString()))}),this.ProductionCostCenters=new c.v4,l=u.d.common.GetDataTable("BULKDVM002",""),l&&l.length>0&&(this.ProductionCostCenters.Items.Clear(),l.forEach(s=>{this.ProductionCostCenters.Items.push(c.oN.CheckedListBoxItem_3(s.ScreenName.toString(),s.FeatureID.toString()))})),this.RentalCostCenters=new c.v4,l=u.d.common.GetDataTable("BULKDVM003",u.d.SessionManager.LangID),l&&l.length>0&&(this.RentalCostCenters.Items.Clear(),l.forEach(s=>{this.RentalCostCenters.Items.push(c.oN.CheckedListBoxItem_3(s.ScreenName.toString(),s.FeatureID.toString()))})),this.PayrollCostCenters=new c.v4;let a=t.Tables[0];a=a.filter(s=>[54,55,56,57,58,59,60,62,63,65,67,68,71,72,73,76,78,80,81].includes(s.DocumentType)),a.length>0&&(this.PayrollCostCenters.Items.Clear(),a.forEach(s=>{this.PayrollCostCenters.Items.push(c.oN.CheckedListBoxItem_3(s.DocumentName.toString(),s.CostCenterID.toString()))}),this.PayrollDocuments=!0),this.RibbonItems=new c.v4;let n=u.d.common.GetDataTable("BULKDVM004","");n&&n.length>0&&(this.RibbonItems.Items.Clear(),n.forEach(s=>{this.RibbonItems.Items.push(c.oN.CheckedListBoxItem_3(s.TabName.toString(),s.TabID.toString()))}),this.RibbonFeatures=!0),this.UnusedMasterItems=new c.v4,this.UnusedMasterItems.Items.Clear(),this.UnusedMasterItems.Items.push(c.oN.CheckedListBoxItem_3("Accounts","2")),this.UnusedMasterItems.Items.push(c.oN.CheckedListBoxItem_3("Products","3"))}initGrid(t){this.FilterGrid=new C.vv,this.FilterGrid.CanUserAddRows=!0,this.FilterGrid.OnBeginEdit.Subscribe(this,"OnBeginEditing"),this.FilterGrid.CellEditEnding.Subscribe(this,"OnCellEditCommiting");let e=[],l=new d.O7,a=[],n={AND:"AND",Value:"AND"};if(a.push(n),n={},n.AND="OR",n.Value="OR",a.push(n),n={},n.AND="(",n.Value="(",a.push(n),n={},n.AND=")",n.Value=")",a.push(n),l=new d.O7,l.ComboData=a,l.DisplayMember="AND",l.ValueMember="Value",l.ValueBinding="And",l.Header="AND/OR",l.DataType="ComboBox",l.Width=200,l.IsVisible=!0,e.push(l),a=[],null!=t&&t.Tables.length>5)for(let s=0;s<t.Tables[5].length;s++)n={},n.Name=t.Tables[5][s].Name.toString(),n.Value="dcCCNID"+(parseInt(t.Tables[5][s].FeatureID.toString())-5e4),a.push(n);n={},n.Name="Debit",n.Value="DebitAccount",a.push(n),n={},n.Name="Credit",n.Value="CreditAccount",a.push(n),n={},n.Name="Credit Account Type",n.Value="CrAccountTypeID",a.push(n),n={},n.Name="Debit Account Type",n.Value="DrAccountTypeID",a.push(n),l=new d.O7,l.ComboData=a,l.DisplayMember="Name",l.ValueMember="Value",l.ValueBinding="TableColumn",l.DataType="ComboBox",l.Header="Column",l.Width=200,l.IsVisible=!0,e.push(l),a=[],n={},n.Condition="Equals",n.Value="=",n.Type="3",a.push(n),n={},n.Condition="Not Equal To",n.Value="Not Equal To",n.Type="1",a.push(n),l=new d.O7,l.ComboData=a,l.DisplayMember="Condition",l.ValueMember="Value",l.ValueBinding="Condition",l.DataType="ComboBox",l.Header="Condition",l.Width=200,l.IsVisible=!0,e.push(l),l=new d.O7,l.DisplayMember="Value",l.Header="Value",l.DataType="TextBlock",l.Width=100,l.IsVisible=!0,e.push(l),l=new d.O7,l.DisplayMember="Name",l.Header="Name",l.DataType="LISTBOX",l.Width=150,e.push(l),this.FilterGrid.Columns=e,this.FilterGrid.Table=[],this.FilterGrid.TableColumns.push("And"),this.FilterGrid.TableColumns.push("Column"),this.FilterGrid.TableColumns.push("TableColumn"),this.FilterGrid.TableColumns.push("Condition"),this.FilterGrid.TableColumns.push("Value"),this.FilterGrid.TableColumns.push("Name"),this.FilterGrid.TableColumns.push("Name_Key"),this.FilterGrid.TableColumns.push("ValueCombo"),this.FilterGrid.TableColumns.push("ValueCombo_Key");for(let s=0;s<=5;s++)this.FilterGrid.addEmptyRow()}OnCellEditCommiting(t){this.FilterText.Text=this.BuildFilterCondition()}BuildFilterCondition(){let t="";for(let e=0;e<this.FilterGrid.Table.length;e++)(0!=e||"("==D.J0.String(this.FilterGrid.Table[e].And))&&(t=t+D.J0.String(this.FilterGrid.Table[e].And)+" "),"DrAccountTypeID"==D.J0.String(this.FilterGrid.Table[e].TableColumn)?t+=" dr.AccountTypeID  ":"CrAccountTypeID"==D.J0.String(this.FilterGrid.Table[e].TableColumn)?t+=" cr.AccountTypeID  ":""!=D.J0.String(this.FilterGrid.Table[e].TableColumn)&&(t=t+this.FilterGrid.Table[e].TableColumn.toString()+" "),""!=D.J0.String(this.FilterGrid.Table[e].Condition)&&"Contains"==this.FilterGrid.Table[e].Condition.toString()?t+=" like '%":""!=D.J0.String(this.FilterGrid.Table[e].Condition)&&"Not Equal To"==this.FilterGrid.Table[e].Condition.toString()?t+=" <> ":""!=D.J0.String(this.FilterGrid.Table[e].Condition)&&(t=t+this.FilterGrid.Table[e].Condition.toString()+" "),""!=D.J0.String(this.FilterGrid.Table[e].TableColumn)&&""==D.J0.String(this.FilterGrid.Table[e].Value)&&""!=D.J0.String(this.FilterGrid.Table[e].Name_Key)?t=t+this.FilterGrid.Table[e].Name_Key.toString()+" ":""!=D.J0.String(this.FilterGrid.Table[e].Value)&&(t="Contains"==D.J0.String(this.FilterGrid.Table[e].Condition)?t+this.FilterGrid.Table[e].Value.toString()+"":t+this.FilterGrid.Table[e].Value.toString()+" "),""!=D.J0.String(this.FilterGrid.Table[e].Condition)&&"Contains"==this.FilterGrid.Table[e].Condition.toString()&&(t+="%' ");return t}OnLostFocus(t){D.J0.Int(this.PreserveDays.Text)>0&&(this.PreserveDate.Date=(new Date).AddDays(-0))}OnselectionChange(t){null!=this.PreserveDate.Date&&(this.PreserveDays.Text=D.J0.GetDateDifference(new Date,this.PreserveDate.Date).toString())}OnBeginEditing(t){}OnButtonClick(t){var e=this;return(0,y.A)(function*(){let l=0,a=0,n="";if(!("OK"!=t&&"Delete"!=t&&"ActivitiesDelete"!=t&&"AttachmentsDelete"!=t&&"NotesDelete"!=t||e.AllDocuments||null==e.DocList||null!=e.DocList.SelectedValue&&""!=e.DocList.SelectedValue))return e.DisplayMessage=u.d.GetResource("SelectDocument"),void(e.MessageVisibility=!0);if("OK"==t){if(e.VoucherWise&&null!=e.DocPrefixes&&""==e.DocPrefixes.SelectedValue)return e.DisplayMessage="Select Prefix",void(e.MessageVisibility=!0);e.Vouchers.SelectAll.IsChecked=!1;let s=0;null!=e.DocList&&null!=e.DocList.SelectedValue&&D.J0.Int(e.DocList.SelectedValue)>0&&(s=parseInt(e.DocList.SelectedValue));let o=0,r=0;null!=e.From.Text&&D.J0.Int(e.From.Text)>0&&(o=parseInt(e.From.Text)),null!=e.TO.Text&&D.J0.Int(e.TO.Text)>0&&(r=parseInt(e.TO.Text));let i="";null==e.FilterText||e.FilterText.Text.Trim().toLowerCase().startsWith("and")?null!=e.FilterText&&null!=e.FilterText.Text&&(i=e.FilterText.Text):D.J0.IsEmptySpace(e.FilterText.Text)||(i=" and ("+e.FilterText.Text+")"),e.Vouchers.Clear();let g=(new N.Document).GetSelectedDocs(e.FromDate.Date,e.ToDate.Date,s,e.VoucherWise,e.DocPrefixes.SelectedValue,o,r,i,!1,!1);if(null!=g&&g.Tables.length>0&&g.Columns[0].Contains("DocID"))for(let h=0;h<g.Tables[0].length;h++){let m=e.Vouchers.NewRow();m.DocID=g.Tables[0][h].DocID,m.CostCenterID=g.Tables[0][h].CostCenterID,m.DocNo=g.Tables[0][h].VoucherNo,m.RefCCID=g.Tables[0][h].RefCCID,m.RefNodeID=g.Tables[0][h].RefNodeid,m.Sno=(h+1).toString(),m.Select=!1,e.Vouchers.addRow(m)}}else if("OKDim"==t){e.Dimensions.SelectAll.IsChecked=!1;let s=0;null!=e.DimList&&null!=e.DimList.SelectedValue&&D.J0.Int(e.DimList.SelectedValue)>0&&(s=parseInt(e.DimList.SelectedValue));let o=0,r=0;null!=e.From.Text&&D.J0.Int(e.From.Text)>0&&(o=parseInt(e.From.Text)),null!=e.TO.Text&&D.J0.Int(e.TO.Text)>0&&(r=parseInt(e.TO.Text));let i="";null==e.FilterText||e.FilterText.Text.Trim().toLowerCase().startsWith("and")?null!=e.FilterText.Text&&(i=e.FilterText.Text):D.J0.IsEmptySpace(e.FilterText.Text)||(i=" and ("+e.FilterText.Text+")"),e.Dimensions.Clear();let g=(new N.Document).GetSelectedDims(s,e.VoucherWise,e.DocPrefixes.SelectedValue,o,r,i.Replace("dcCCNID","CCNID"),1);if(null!=g&&g.Tables.length>0&&g.Columns[0].Contains("NodeID"))for(let h=0;h<g.Tables[0].length;h++){let m=e.Dimensions.NewRow();m.NodeID=g.Tables[0][h].NODEID,m.CCID=g.Tables[0][h].CCID,m.Code=g.Tables[0][h].CODE,m.Name=g.Tables[0][h].NAME,m.Sno=(h+1).toString(),m.Select=!1,e.Dimensions.addRow(m)}}else if("Delete"==t)if(e.msgString="",e.strSeletedVoucherNo="",e.AllDocuments){e.msgString="Documents Tab :: \r\n",e.AllDocuments&&(e.msgString=e.msgString+"All Documents, ",e.DeletePrefix&&(e.msgString=e.msgString+"Delete Prefixes \r\n"));let s=new f.MessageDialogViewModel;s.MessageDialogViewModel_3(e,e.msgString+"Do you want to Delete All Documents","Yes","No"),u.d.page.ShowDialog(s,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let o=u.d.document.DeleteSelectedRows(e.DeletePrefix,l);e.DisplayMessage=o.Message,l=o.RetValue,e.res="No"}})}else{for(let r=0;r<e.Vouchers.Table.length;r++)if("true"==D.J0.String(e.Vouchers.Table[r].Select).toLowerCase()){a+=1;break}if(0==a)return e.DisplayMessage="95"==e.DocList.SelectedValue?"Select Contract to Delete":"Select Document to Delete",void(e.MessageVisibility=!0);a=0;for(let r=0;r<e.Vouchers.Table.length;r++)if("true"==D.J0.String(e.Vouchers.Table[r].Select).toLowerCase()&&"0"!==D.J0.String(e.Vouchers.Table[r].RefNodeID)&&"86"!=D.J0.String(e.Vouchers.Table[r].RefCCID)&&"73"!=D.J0.String(e.Vouchers.Table[r].RefCCID)&&"89"!=D.J0.String(e.Vouchers.Table[r].RefCCID))return e.DisplayMessage="'"+D.J0.String(e.Vouchers.Table[r].DocNo)+"' is Referrence Document it Cannot be deleted",void(e.MessageVisibility=!0);e.DocTabstrMsg();let s="";s="95"==e.DocList.SelectedValue?e.msgString+"Do you want to Delete Selected Contracts ?":e.msgString+"Do you want to Delete Selected Documents ?";let o=new f.MessageDialogViewModel;if(o.MessageDialogViewModel_3(e,s,"Yes","No"),yield u.d.page.openDialog(o,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}),null!=e.res&&"YES"==e.res.toUpperCase()){if(e.strSeletedVoucherNo="","0"==e.DocList.SelectedValue){for(let r=0;r<e.Vouchers.Table.length;r++)"True"==e.Vouchers.Table[r].Select.toString()&&(e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+e.Vouchers.Table[r].DocNo.toString():e.Vouchers.Table[r].DocNo.toString());e.setActionHistroy(t);for(let r=0;r<e.Vouchers.Table.length;r++)if("True"==e.Vouchers.Table[r].Select.toString()){let i=[];i.push(parseInt(e.Vouchers.Table[r].CostCenterID)),i.push(e.Vouchers.Table[r].DocID.toString()),i.push(1);let g=u.d.document.DeleteSelectedRows(i,l);e.DisplayMessage=g.Message,l=g.RetValue,e.Vouchers.Table[r].Status=1==l?"Document '"+e.Vouchers.Table[r].DocNo.toString()+"' Deleted":e.DisplayMessage}}else{for(let g=0;g<e.Vouchers.Table.length;g++)"True"==e.Vouchers.Table[g].Select.toString()&&(n=n+","+e.Vouchers.Table[g].DocID.toString(),e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+e.Vouchers.Table[g].DocNo.toString():e.Vouchers.Table[g].DocNo.toString());e.setActionHistroy(t),n=n.Trim(",");let r=[];r.push(parseInt(e.DocList.SelectedValue)),r.push(n),r.push(1);let i=u.d.document.DeleteSelectedRows(r,l);if(e.DisplayMessage=i.Message,l=i.RetValue,1==l)for(let g=0;g<e.Vouchers.Table.length;g++)"True"==e.Vouchers.Table[g].Select.toString()&&(e.Vouchers.Table[g].Status="95"==e.DocList.SelectedValue?"Contract '"+e.Vouchers.Table[g].DocNo.toString()+"' Deleted":"Document '"+e.Vouchers.Table[g].DocNo.toString()+"' Deleted")}e.res="No"}}else if("DeleteDimensionNodes"==t)if(e.msgString="",e.strSeletedVoucherNo="",e.AllDimension){e.msgString="Dimension Filter Wise Tab :: \r\n",e.AllDimension&&(e.msgString=e.msgString+"All Dimensions, \r\n");let s=new f.MessageDialogViewModel;s.MessageDialogViewModel_3(e,e.msgString+"Do you want to Delete All Documents","Yes","No"),u.d.page.ShowDialog(s,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let o=u.d.document.DeleteAllDocuments(e.DeletePrefix,l);e.DisplayMessage=o.Message,l=o.RetValue,e.res="No"}})}else{for(let i=0;i<e.Dimensions.Table.length;i++)if("True"==e.Dimensions.Table[i].Select.toString()){a+=1;break}if(0==a)return e.DisplayMessage="95"==e.DimList.SelectedValue?"Select Contract to Delete":"Select Dimension to Delete",void(e.MessageVisibility=!0);a=0,e.msgString="Dimension Filter Wise Tab :: \r\n",e.msgString=e.msgString+e.DimList.SelectedItem.Name+"\r\n";let s="";null==e.FilterText||e.FilterText.Text.Trim().toLowerCase().startsWith("and")?null!=e.FilterText.Text&&(s=e.FilterText.Text):D.J0.IsEmptySpace(e.FilterText.Text)||(s=" and ("+e.FilterText.Text+")"),e.msgString=e.msgString+"Filter : "+s+" \r\n\r\n";let o="";o="95"==e.DimList.SelectedValue?e.msgString+"Do you want to Delete Selected Contracts":"23"==e.DimList.SelectedValue?e.msgString+"Do you want to Delete Selected Substitutes":e.msgString+"Do you want to Delete Selected Dimensions";let r=new f.MessageDialogViewModel;if(r.MessageDialogViewModel_3(e,o,"Yes","No"),yield u.d.page.openDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}),null!=e.res&&"YES"==e.res.toUpperCase()){if("0"==e.DimList.SelectedValue){for(let i=0;i<e.Dimensions.Table.length;i++)"True"==e.Dimensions.Table[i].Select.toString()&&(e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+e.Dimensions.Table[i].Code.toString():e.Dimensions.Table[i].Code.toString());e.setActionHistroy(t);for(let i=0;i<e.Dimensions.Table.length;i++)if("True"==e.Dimensions.Table[i].Select.toString()){let g=[];g.push(parseInt(e.Dimensions.Table[i].CCID)),g.push(e.Dimensions.Table[i].NodeID.toString()),g.push(1);let h=u.d.document.DeleteSelectedDimData(g,l);e.DisplayMessage=h.Message,l=h.RetValue,e.Dimensions.Table[i].Status=1==l?"Dimension '"+e.Dimensions.Table[i].Name.toString()+"' Deleted":e.DisplayMessage}}else{for(let h=0;h<e.Dimensions.Table.length;h++)"True"==e.Dimensions.Table[h].Select.toString()&&(n=n+","+e.Dimensions.Table[h].NodeID.toString(),e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+e.Dimensions.Table[h].Code.toString():e.Dimensions.Table[h].Code.toString());e.setActionHistroy(t),n=n.Trim(",");let i=[];i.push(parseInt(e.DimList.SelectedValue)),i.push(n),i.push(1);let g=u.d.document.DeleteSelectedDimData(i,l);if(e.DisplayMessage=g.Message,l=g.RetValue,1==l)for(let h=0;h<e.Dimensions.Table.length;h++)"True"==e.Dimensions.Table[h].Select.toString()&&(e.Dimensions.Table[h].Status="95"==e.DimList.SelectedValue?"Contract '"+e.Dimensions.Table[h].Name.toString()+"' Deleted":"23"==e.DimList.SelectedValue?"Substitutes '"+e.Dimensions.Table[h].Name.toString()+"' Deleted":"Dimension '"+e.Dimensions.Table[h].Name.toString()+"' Deleted")}e.res="No"}}else if("ActivitiesDelete"==t){if(e.msgString="",e.strSeletedVoucherNo="",!e.AllDocuments){for(let o=0;o<e.Vouchers.Table.length;o++)if("TRUE"==D.J0.String(e.Vouchers.Table[o].Select).toUpperCase()){a+=1;break}if(0==a)return e.DisplayMessage="Select Document to Delete",void(e.MessageVisibility=!0);a=0,e.DocTabstrMsg();let s=new f.MessageDialogViewModel;if(s.MessageDialogViewModel_3(e,e.msgString+"Do you want to Delete Selected Document Activities & Schedule ?","Yes","No"),yield u.d.page.openDialog(s,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}),null!=e.res&&"YES"==e.res.toUpperCase()){for(let i=0;i<e.Vouchers.Table.length;i++)"true"==D.J0.String(e.Vouchers.Table[i].Select).toLowerCase()&&(n=n+","+D.J0.String(e.Vouchers.Table[i].DocID),e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+D.J0.String(e.Vouchers.Table[i].DocNo):D.J0.String(e.Vouchers.Table[i].DocNo));e.setActionHistroy(t),n=n.Trim(",");let o=[];o.push(parseInt(e.DocList.SelectedValue)),o.push(n),o.push(2);let r=u.d.document.DeleteSelectedRows(o,l);if(e.DisplayMessage=r.Message,l=r.RetValue,1==l)for(let i=0;i<e.Vouchers.Table.length;i++)"true"==D.J0.String(e.Vouchers.Table[i].Select).toLowerCase()&&(e.Vouchers.Table[i].Status="Activities&Schedule Deleted from Document '"+D.J0.String(e.Vouchers.Table[i].DocNo)+"'");e.res="No"}}}else if("AttachmentsDelete"==t){if(e.msgString="",e.strSeletedVoucherNo="",!e.AllDocuments){for(let o=0;o<e.Vouchers.Table.length;o++)if("True"==D.J0.String(e.Vouchers.Table[o].Select)){a+=1;break}if(0==a)return e.DisplayMessage="Select Document to Delete",void(e.MessageVisibility=!0);a=0,e.DocTabstrMsg();let s=new f.MessageDialogViewModel;if(s.MessageDialogViewModel_3(e,e.msgString+"Do you want to Delete Selected Document Attachments ?","Yes","No"),yield u.d.page.openDialog(s,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}),null!=e.res&&"YES"==e.res.toUpperCase()){for(let i=0;i<e.Vouchers.Table.length;i++)"True"==e.Vouchers.Table[i].Select.toString()&&(n=n+","+e.Vouchers.Table[i].DocID.toString(),e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+e.Vouchers.Table[i].DocNo.toString():e.Vouchers.Table[i].DocNo.toString());e.setActionHistroy(t),n=n.Trim(",");let o=[];o.push(parseInt(e.DocList.SelectedValue)),o.push(n),o.push(3);let r=u.d.document.DeleteSelectedRows(o,l);if(e.DisplayMessage=r.Message,l=r.RetValue,1==l)for(let i=0;i<e.Vouchers.Table.length;i++)"True"==e.Vouchers.Table[i].Select.toString()&&(e.Vouchers.Table[i].Status="Attachments Deleted from Document '"+e.Vouchers.Table[i].DocNo.toString()+"'");e.res="No"}}}else if("NotesDelete"==t){if(e.msgString="",e.strSeletedVoucherNo="",!e.AllDocuments){for(let o=0;o<e.Vouchers.Table.length;o++)if("True"==e.Vouchers.Table[o].Select.toString()){a+=1;break}if(0==a)return e.DisplayMessage="Select Document to Delete",void(e.MessageVisibility=!0);a=0,e.DocTabstrMsg();let s=new f.MessageDialogViewModel;if(s.MessageDialogViewModel_3(e,e.msgString+"Do you want to Delete Selected Document Notes ?","Yes","No"),yield u.d.page.openDialog(s,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}),null!=e.res&&"YES"==e.res.toUpperCase()){for(let i=0;i<e.Vouchers.Table.length;i++)"True"==e.Vouchers.Table[i].Select.toString()&&(n=n+","+e.Vouchers.Table[i].DocID.toString(),e.strSeletedVoucherNo=e.strSeletedVoucherNo.length>0?e.strSeletedVoucherNo+","+e.Vouchers.Table[i].DocNo.toString():e.Vouchers.Table[i].DocNo.toString());e.setActionHistroy(t),n=n.Trim(",");let o=[];o.push(parseInt(e.DocList.SelectedValue)),o.push(n),o.push(4);let r=u.d.document.DeleteSelectedRows(o,l);if(e.DisplayMessage=r.Message,l=r.RetValue,1==l)for(let i=0;i<e.Vouchers.Table.length;i++)"True"==e.Vouchers.Table[i].Select.toString()&&(e.Vouchers.Table[i].Status="Notes Deleted from Document '"+e.Vouchers.Table[i].DocNo.toString()+"'");e.res="No"}}}else if("DeleteDimensions"==t){e.msgString="";let s="",o="";if(e.Dimension_AllDimensions)e.Dimension_Dimensions.Items.forEach(i=>{o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name});else if(e.Dimension_Dimensions.Items.forEach(i=>{i.IsChecked&&(o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name)}),0==o.length)return void(e.DisplayMessage="Please select alteast one dimension to delete data.");e.msgString="Dimensions Tab :: \r\n",e.Dimension_AllDimensions?(e.msgString=e.msgString+"All Dimensions \r\n",e.msgString=e.Dimension_rdoNodes?e.msgString+"Delete : Nodes Only \r\n\r\n":e.msgString+"Delete : Nodes and Groups \r\n\r\n"):(e.msgString=e.Dimension_rdoNodes?e.msgString+"Delete : Nodes Only \r\n":e.msgString+"Delete : Nodes and Groups \r\n",e.msgString=e.msgString+"Dimensions :\r\n",e.msgString=e.msgString+s+" \r\n\r\n");let r=new f.MessageDialogViewModel;r.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete selected list item(s) data ?","Yes","No"),u.d.page.ShowDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let i=u.d.document.DeleteDimensionData(o.toString(),e.Dimension_rdoNodes,l);e.DisplayMessage=i.Message,l=i.RetValue,e.res="No"}})}else if("DeleteAuditTrial"==t||"DeleteAuditTrialArchive"==t||"ArchiveAuditTrial"==t||"RestoreAuditTrial"==t){e.msgString="";let s="",o="",r=D.J0.Int(e.PreserveDays.Text);if(r<=0)return void(e.DisplayMessage="Please enter valid preserve days.");let i="",g="";if(e.Audit_AllDocuments?(i+="ALL",e.Audit_Documents.Items.forEach(m=>{s=s.length>0?s+","+m.Name:m.Name})):e.Audit_Documents.Items.forEach(m=>{m.IsChecked&&(i.length>0&&(i+=","),i+=m.Value,s=s.length>0?s+","+m.Name:m.Name)}),e.Audit_Dimensions.Items.forEach(e.Audit_AllDimensions?m=>{g.length>0&&(g+=","),g+=m.Value,o=o.length>0?o+","+m.Name:m.Name}:m=>{m.IsChecked&&(g.length>0&&(g+=","),g+=m.Value,o=o.length>0?o+","+m.Name:m.Name)}),0==i.length&&0==g.length)return void(e.DisplayMessage="Please select alteast one document/dimension.");e.msgString="Audit Trial Tab :: \r\n",e.Audit_AllDocuments?(e.msgString=e.msgString+"All Documents \r\n",e.msgString=e.msgString+"Preserve Days : "+r+" \r\n"):(e.msgString=e.msgString+"Preserve Days : "+r+" \r\n",e.msgString=e.msgString+"Documents : \r\n",s.length>0&&(e.msgString=e.msgString+s+" \r\n")),e.Audit_AllDimensions?e.msgString=e.msgString+"All Dimensions \r\n\r\n":(e.msgString=e.msgString+"Dimensions : \r\n",o.length>0&&(e.msgString=e.msgString+o+" \r\n\r\n"));let h=(new Date).Date();if(h=h.AddDays(1-r),"RestoreAuditTrial"==t){let m=e.msgString+'Restores audit data from "'+h.ToString(u.d.SessionManager.Preferences["Date Format"])+'".\r\n Do you really want to restore?';if(!confirm(m))return;e.setActionHistroy(t);let b=u.d.document.RestoreAuditData(i.toString(),g.toString(),r,l);e.DisplayMessage=b.Message,l=b.RetValue}else if("DeleteAuditTrialArchive"==t){let m=e.msgString+'Preserves audit data from "'+h.ToString(u.d.SessionManager.Preferences["Date Format"])+'".\r\n Do you really want to delete from archive?';if(!confirm(m))return;e.setActionHistroy(t);let b=u.d.document.DeleteArchiveData(i.toString(),g.toString(),r,l);e.DisplayMessage=b.Message,l=b.RetValue}else{let m=e.msgString+'Preserves audit data from "'+h.ToString(u.d.SessionManager.Preferences["Date Format"])+'".\r\n Do you really want to '+("DeleteAuditTrial"==t?"delete":"archive")+"?";if(!confirm(m))return;let b="ArchiveAuditTrial"==t;e.setActionHistroy(t);let _=u.d.document.DeleteAuditData(b,i.toString(),g.toString(),r,l);e.DisplayMessage=_.Message,l=_.RetValue}}else if("DeleteNotifications"==t){e.msgString="";let s="";if(e.sbNotifDocs="",e.DisplayMessage="",e.iPreserveDays_Notif=D.J0.Int(e.NotifPreserveDays),e.iPreserveDays_Notif<=0)return void(e.DisplayMessage="Please enter valid preserve days.");if(e.Notif_AllDocuments?(e.sbNotifDocs+="ALL",e.Notif_Dimensions.Items.forEach(o=>{s=s.length>0?s+","+o.Name:o.Name})):e.Notif_Dimensions.Items.forEach(o=>{o.IsChecked&&(e.sbNotifDocs.length>0&&(e.sbNotifDocs+=","),e.sbNotifDocs+=o.Value,s=s.length>0?s+","+o.Name:o.Name)}),0==e.sbNotifDocs.length)return void(e.DisplayMessage="Please select alteast one feature to delete notification data.");e.NotificationMsg(s)}else if("DeleteAllNotifications"==t){e.msgString="",e.NotificationMsg("");let o=new f.MessageDialogViewModel;o.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete all the notifications/events ?","Yes","No"),u.d.page.ShowDialog(o,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let r=u.d.document.DeleteAllNotifs(l);e.DisplayMessage=r.Message,l=r.RetValue,e.res="No"}})}else if("ProductionDataDelete"==t){e.msgString="";let s="",o="";if(e.ProductionFeatures)e.ProductionCostCenters.Items.forEach(i=>{o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name});else if(e.ProductionCostCenters.Items.forEach(i=>{i.IsChecked&&(o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name)}),0==o.length)return void(e.DisplayMessage="Please select alteast one item from the list to delete data.");e.msgString="Production Tab :: \r\n",e.ProductionFeatures&&(e.msgString=e.msgString+"All Features \r\n"),e.msgString=e.msgString+s+" \r\n\r\n";let r=new f.MessageDialogViewModel;r.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete selected list item(s) data ?","Yes","No"),u.d.page.ShowDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let i=u.d.admin.DeleteProductionData(4,o.toString(),l);e.DisplayMessage=i.Message,l=i.RetValue,e.res="No"}})}else if("RentalDataDelete"==t){e.msgString="";let s="",o="";if(e.RentalFeatures)e.RentalCostCenters.Items.forEach(i=>{o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name});else if(e.RentalCostCenters.Items.forEach(i=>{i.IsChecked&&(o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name)}),0==o.length)return void(e.DisplayMessage="Please select alteast one item from the list to delete data.");e.msgString="Rentals Tab :: \r\n",e.RentalFeatures&&(e.msgString=e.msgString+"All Features \r\n"),e.msgString=e.msgString+s+" \r\n\r\n";let r=new f.MessageDialogViewModel;r.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete selected list item(s) data ?","Yes","No"),u.d.page.ShowDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let i=u.d.admin.DeleteRentalData(o.toString(),l);e.DisplayMessage=i.Message,l=i.RetValue,e.res="No"}})}else if("PayrollDataDelete"==t){e.msgString="";let s="",o="";e.PayrollDocuments&&e.PayrollCostCenters.Items.forEach(i=>{o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name}),e.msgString="Payroll Tab :: \r\n",e.PayrollDocuments&&(e.msgString=e.msgString+"Documents \r\n",e.msgString=e.msgString+s+" \r\n\r\n");let r=new f.MessageDialogViewModel;r.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete the document data ?","Yes","No"),u.d.page.ShowDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let i=u.d.admin.DeleteProductionData(13,o.toString(),l);e.DisplayMessage=i.Message,l=i.RetValue,e.res="No"}})}else if("AllDataDelete"==t){e.msgString="";let s="",o="";e.RibbonFeatures&&e.RibbonItems.Items.forEach(i=>{o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name}),e.msgString="All Data Delete Tab :: \r\n",e.RibbonFeatures&&(e.msgString=e.msgString+"Modules \r\n",e.msgString=e.msgString+s+" \r\n\r\n");let r=new f.MessageDialogViewModel;r.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete all the documents and dimensions data ?","Yes","No"),u.d.page.ShowDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let i=u.d.admin.DeleteAllData(l);e.DisplayMessage=i.Message,l=i.RetValue,e.res="No"}})}else if("UnusedNodesDelete"==t){e.msgString="";let s="",o="";if(e.UnusedFeatures)e.UnusedMasterItems.Items.forEach(i=>{o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name});else if(e.UnusedMasterItems.Items.forEach(i=>{i.IsChecked&&(o.length>0&&(o+=","),o+=i.Value,s=s.length>0?s+","+i.Name:i.Name)}),0==o.length)return void(e.DisplayMessage="Please select alteast one item from the list to delete data.");e.msgString="Unused Nodes Delete Tab :: \r\n",e.UnusedFeatures?(e.msgString=e.msgString+"Masters \r\n",e.msgString=e.msgString+s+" \r\n"):e.msgString=e.msgString+s+" \r\n\r\n";let r=new f.MessageDialogViewModel;r.MessageDialogViewModel_3(e,e.msgString+"Do you want to delete all the unused nodes ?","Yes","No"),u.d.page.ShowDialog(r,T.MessageDialogViewModelComponent,{ShowCenter:!0,Title:"Warning"}).subscribe(()=>{if(null!=e.res&&"YES"==e.res.toUpperCase()){e.setActionHistroy(t);let i=u.d.admin.DeleteUnusedNodesData(o.toString(),l);e.DisplayMessage=i.Message,l=i.RetValue,e.res="No"}})}else"PreserveDays"==t&&(u.d.SessionManager.Preferences.ContainsKey("AuditCutoffDate")?(u.d.common.GetDataSet("BULKDVM005",e.PreserveDate.Date.ToString("dd MMM yyyy")),u.d.SessionManager.Preferences.AuditCutoffDate=e.PreserveDate.Date.ToString("dd MMM yyyy"),e.DisplayMessage="Updated Successfully."):e.DisplayMessage="Update Failed.",e.MessageVisibility=!0)})()}NotificationMsg(t){this.msgString="Notifications Tab :: \r\n",this.Notif_AllDocuments?(this.msgString=this.msgString+"All Features \r\n",this.msgString=this.msgString+"Preserve Days : "+this.iPreserveDays_Notif+" \r\n",this.msgString=this.Notif_Attach?this.msgString+"Delete : Attachments \r\n":this.msgString+"Delete : Data & Attachments \r\n",this.msgString=this.msgString+t+" \r\n\r\n"):(this.msgString=this.msgString+"Preserve Days : "+this.iPreserveDays_Notif+" \r\n",this.msgString=this.Notif_Attach?this.msgString+"Delete : Attachments \r\n":this.msgString+"Delete : Data & Attachments \r\n",this.msgString=this.msgString+t+" \r\n\r\n")}setActionHistroy(t){u.d.admin.setActionHistroy("BulkDeletion -- "+t,this.msgString)}DocTabstrMsg(){this.msgString="Documents Tab :: \r\n",this.msgString=this.msgString+this.DocList.SelectedItem.Name+"\r\n",this.DateWise&&(this.msgString=this.msgString+this.FromDate.Label+": "+this.FromDate.Date.ToString(this.FromDate.CustomFormat)+" ",this.msgString=this.msgString+this.ToDate.Label+": "+this.ToDate.Date.ToString(this.ToDate.CustomFormat)+"\r\n"),this.VoucherWise&&(this.msgString=this.msgString+this.DocPrefixes.Label+": "+this.DocPrefixes.SelectedItem.Name+" ",this.msgString=this.msgString+this.From.Label+" : "+this.From.Text+" ",this.msgString=this.msgString+this.TO.Label+" : "+this.TO.Text+"\r\n");let t="";null==this.FilterText||this.FilterText.Text.Trim().toLowerCase().startsWith("and")?null!=this.FilterText.Text&&(t=this.FilterText.Text):D.J0.IsEmptySpace(this.FilterText.Text)||(t=" and ("+this.FilterText.Text+")"),this.msgString=this.msgString+"Filter : "+t+" \r\n\r\n"}notifWorker_RunWorkerCompleted(t,e){}notifWorker_DoWork(t,e){}OnMessageCallBack(){this.res="YES"}LoadGrid(){this.Vouchers=new C.vv,this.Vouchers.SearchVisible=!0,this.Vouchers.SearchColStartIndex=2,this.Vouchers.SelectAll.Visible=!0,this.Vouchers.CanUserDeleteRows=!0,this.Vouchers.Table=[],this.Vouchers.TableColumns.push("Select"),this.Vouchers.TableColumns.push("Sno"),this.Vouchers.TableColumns.push("DocNo"),this.Vouchers.TableColumns.push("Status"),this.Vouchers.TableColumns.push("DocID"),this.Vouchers.TableColumns.push("CostCenterID"),this.Vouchers.TableColumns.push("RefCCID"),this.Vouchers.TableColumns.push("RefNodeID");let t=new d.O7;this.Vouchers.Columns=[],t=new d.O7,t.Header="Select",t.DisplayMember="Select",t.DataType="CheckBox",t.Width=50,t.CheckedChanged.Subscribe(this,"OnCheckedChanged"),this.Vouchers.Columns.push(t),t=new d.O7,t.Header="S No",t.DisplayMember="Sno",t.DataType="TextBlock",t.Width=50,t.ReadOnly=!0,this.Vouchers.Columns.push(t),t=new d.O7,t.Header="Doc No",t.DataType="TextBlock",t.DisplayMember="DocNo",t.Width=250,t.ReadOnly=!0,this.Vouchers.Columns.push(t),t=new d.O7,t.Header="Status",t.DisplayMember="Status",t.DataType="TextBlock",t.Width=250,t.ReadOnly=!0,this.Vouchers.Columns.push(t),this.Dimensions=new C.vv,this.Dimensions.SearchVisible=!0,this.Dimensions.SearchColStartIndex=2,this.Dimensions.SelectAll.Visible=!0,this.Dimensions.CanUserDeleteRows=!0,this.Dimensions.Table=[],this.Dimensions.TableColumns.push("Select"),this.Dimensions.TableColumns.push("Sno"),this.Dimensions.TableColumns.push("Code"),this.Dimensions.TableColumns.push("Name"),this.Dimensions.TableColumns.push("Status"),this.Dimensions.TableColumns.push("NodeID"),this.Dimensions.TableColumns.push("CCID"),t=new d.O7,this.Dimensions.Columns=[],t=new d.O7,t.Header="Select",t.DisplayMember="Select",t.DataType="CheckBox",t.Width=50,t.CheckedChanged.Subscribe(this,"OnCheckedChanged"),this.Dimensions.Columns.push(t),t=new d.O7,t.Header="S No",t.DisplayMember="Sno",t.DataType="TextBlock",t.Width=50,t.ReadOnly=!0,this.Dimensions.Columns.push(t),t=new d.O7,t.Header="Code",t.DataType="TextBlock",t.DisplayMember="Code",t.Width=250,t.ReadOnly=!0,this.Dimensions.Columns.push(t),t=new d.O7,t.Header="Name",t.DataType="TextBlock",t.DisplayMember="Name",t.Width=250,t.ReadOnly=!0,this.Dimensions.Columns.push(t),t=new d.O7,t.Header="Status",t.DisplayMember="Status",t.DataType="TextBlock",t.Width=250,t.ReadOnly=!0,this.Dimensions.Columns.push(t)}onDimChanged(t){}onDocChanged(t){null!=this.DocList&&null!=this.DocList.SelectedValue&&(this.DocPrefixes.Items.Clear(),"0"!=this.DocList.SelectedValue&&u.d.document.Getprefixes(this.DocList.SelectedValue).Tables[0].forEach(l=>{this.DocPrefixes.Items.push(c._p.ComboBoxItems_4(l.CodePrefix.toString(),l.CodePrefix.toString(),"",l.CodeNumberLength.toString()))}))}LoadAuditTrial(t,e){this.PreserveDays=new V.Dw(0),this.PreserveDays.DataType="INT",u.d.SessionManager.Preferences.ContainsKey("AuditCutoffDate")&&""!=u.d.SessionManager.Preferences.AuditCutoffDate&&D.J0.isValidDate(u.d.SessionManager.Preferences.AuditCutoffDate)&&(this.PreserveDate.Date=D.J0.ParseDate(u.d.SessionManager.Preferences.AuditCutoffDate),this.OnselectionChange(null)),D.J0.IsEmpty(this.PreserveDays.Text)&&(this.PreserveDays.Text="90",this.OnLostFocus(null)),this.PreserveDate.SelectedDateChanged.Subscribe(this,"OnselectionChange"),this.PreserveDays.LostFocusCommand.Subscribe(this,"OnLostFocus"),this.Audit_Documents=new c.v4;let l=t.Tables[0];l.Sort="ResourceData";for(let a=0;a<l.length;a++){const n=l[a];"0"!=n.HasAccess.toString()&&this.Audit_Documents.Items.push(c.oN.CheckedListBoxItem_4(n.ResourceData.toString(),n.CostCenterID.toString(),n.Isinventory.toString()))}this.Audit_Dimensions=new c.v4,null!=e&&e.length>0&&e.forEach(a=>{(2==parseInt(a.FeatureID)||3==parseInt(a.FeatureID)||93==parseInt(a.FeatureID)||94==parseInt(a.FeatureID)||95==parseInt(a.FeatureID)||parseInt(a.FeatureID)>5e4&&(!(parseInt(a.FeatureID)>=50058&&parseInt(a.FeatureID)<=50070)||50068==parseInt(a.FeatureID)||50069==parseInt(a.FeatureID)))&&this.Audit_Dimensions.Items.push(c.oN.CheckedListBoxItem_3(a.Name.toString(),a.FeatureID.toString()))})}OnDateRangesSelectionChanged(t){null!=this.DateRanges.SelectedValue&&I.w.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}}}}]);