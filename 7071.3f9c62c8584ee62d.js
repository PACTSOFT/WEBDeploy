"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[7071],{37071:(R,f,r)=>{r.r(f),r.d(f,{CommonFieldPopupViewModel:()=>O});var a=r(86739),l=r(8787),d=r(92701),g=r(23823),u=r(18569),I=r(49710),b=r(95050),S=r(56856),V=r(24028),m=r(31820);class O extends g.g{get ColumnSource(){return this.GridObj.Columns}set ColumnSource(e){this.GridObj.Columns=e}get GridData(){return this.GridObj.Table}set GridData(e){this.GridObj.Table=e}get SelectedRow(){return this.GridObj.SelectedItem}set SelectedRow(e){this.GridObj.SelectedItem=e}constructor(e,i=!1,n=!1,c=!1,o=!1,C=0,P=!1,G=null){if(super(),this.BudgetProfile=new d.y$(0),this.JVDocs=new d.y$(0),this.ReverseType=new d.y$(0),this.txtChqAccountNumber=new m.Dw(0),this.txtChqAccountName=new m.Dw(0),this.txtChqAmount=new m.Dw(0),this.txtChequeNo=new m.Dw(0),this.dtpChequeDate=new V.P6(0),this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsViewReverseDocument=!1,this.IsReverseDocument=!1,this.IsScanCheque=!1,this.GridObj=new I.vv,this.parent=e,this.IsBudgetProfileDoc=i,this.IsJVVoucher=n,this.IsScanCheque=P,this.IsBudgetProfileDoc)this.IsBudgetProfileDoc=!0,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.BindBudgetProfiles();else if(c){this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!0,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.ReverseType.Items.push(d._p.ComboBoxItems_2("Document Wise","0")),this.ReverseType.Items.push(d._p.ComboBoxItems_2("Line Wise","1")),this.ReverseType.SelectedValue="1";let p=[],h=new u.O7;h.Header="\u221a",h.DisplayMember="Select",h.DataType="CheckBox",h.Width=25,h.CheckedChanged.Subscribe(this,"OnCheckedChanged"),p.push(h),this.GridObj.Columns=[],this.GridObj.Table=[],e.ColumnSource.forEach(s=>{p.push(s)}),p.forEach(s=>{this.ColumnSource.push(s)}),this.GridData=e.ScreenObject.GridData.Copy(),this.GridObj.TableColumns.push("Select"),this.GridObj.TableColumns.Contains("Row_Background")||this.GridObj.TableColumns.push("Row_Background"),this.GridObj.TableColumns.Contains("Posted")||this.GridObj.TableColumns.push("Posted");let D,t=0;this.parent.ScreenObject.Preferences.ContainsKey("ReverseDocument")&&!l.J0.IsEmpty(this.parent.ScreenObject.Preferences.ReverseDocument)&&(t=parseInt(this.parent.ScreenObject.Preferences.ReverseDocument)),D=this.parent.ScreenObject.IsInventory?a.d.common.GetDataSet3("RVINVVIEWDOC",l.J0.String(C),l.J0.String(this.parent.ScreenObject.CostCenterID),l.J0.String(t)):a.d.common.GetDataSet("RVACCVIEWDOC",l.J0.String(C));for(let s=0;s<this.GridData.length;s++)null!=D&&D.Tables.length>0&&parseInt(this.GridData[s].DocDetailsID)>0&&D.Tables[0].filter(_=>_.DocDetailsID==parseInt(this.GridData[s].DocDetailsID)).length>0?(this.GridData[s].Row_Background="#e3938d",this.GridData[s].Select="False",this.GridData[s].Posted="1"):(this.GridData[s].Select="False",this.GridData[s].Posted="0",this.GridData[s].Row_Background="#FFFFFF"),this.GridObj.updateRow(this.GridData[s]);this.GridObj.refreshDataView(),this.GridObj.RefreshGrid=!0}else if(o){this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!0,this.IsScanCheque=!1;let h=[];this.GridObj=new I.vv,this.GridObj.OnLinkClick.Subscribe(this,"OnLinkClickEvent");let t=new u.O7;t.Header="Document",t.DisplayMember="DocumentName",t.ReadOnly=!0,t.DisableTab=!0,t.Width=100,h.push(t),t=new u.O7,t.Header="VoucherNo",t.DisplayMember="VoucherNo",t.ReadOnly=!0,t.DataType="LINK",t.DisableTab=!0,t.Width=125,h.push(t),t=new u.O7,t.Header="CCID",t.DisplayMember="CostCenterID",t.ReadOnly=!0,t.DisableTab=!0,t.IsVisible=!1,t.Width=100,h.push(t),this.GridObj.Columns=h;let s,D=0;this.parent.ScreenObject.Preferences.ContainsKey("ReverseDocument")&&!l.J0.IsEmpty(this.parent.ScreenObject.Preferences.ReverseDocument)&&(D=parseInt(this.parent.ScreenObject.Preferences.ReverseDocument)),s=this.parent.ScreenObject.IsInventory?a.d.common.GetDataSet3("RVINVDOC",l.J0.String(C),l.J0.String(this.parent.ScreenObject.CostCenterID),l.J0.String(D)):a.d.common.GetDataSet("RVACCDOC",l.J0.String(C)),null!=s&&s.Tables.length>0&&(this.GridObj.Table=s.Tables[0])}else this.IsJVVoucher?(this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!0,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.BindJVDocs()):this.IsScanCheque&&(this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!0,this.FillChequeDetails(G))}OnCheckedChanged(e){try{let i=e.item;"Select"==e.columnDef.field&&"1"==i.Posted&&(i.Select="False")}catch{}}BindBudgetProfiles(){this.BudgetProfile.Items.Clear();let e=a.d.common.GetDataSet("BDP01","");null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(i=>{this.BudgetProfile.Items.push(d._p.ComboBoxItems_2(i.BudgetName.toString(),i.BudgetDefID.toString()))})}BindJVDocs(){this.JVDocs.Items.Clear();let e=a.d.common.GetDataSet("JVD01","");null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(i=>{this.JVDocs.Items.push(d._p.ComboBoxItems_2(i.DocName.toString(),i.CostCenterID.toString()))})}FillChequeDetails(e){try{let i;this.txtChqAccountNumber.Text=this.GetObjectValue(e.results[0].ocr,"Account Number"),this.txtChqAccountName.Text=this.GetObjectValue(e.results[0].ocr,"Account Name"),this.txtChqAmount.Text=this.GetObjectValue(e.results[0].ocr,"Amount"),this.txtChequeNo.Text=this.GetObjectValue(e.results[0].ocr,"Cheque Number"),i=this.parent.GetDateonCustomFormat(this.GetObjectValue(e.results[0].ocr,"Date"),"dd/MM/yyyy"),this.dtpChequeDate.Date=l.J0.ParseDate(i)}catch(i){this.parent.sJVDtls="Please verify the Cheque Details",Logger.ErrorLog("CommonFieldPopupViewModel","FillChequeDetails",i)}}GetObjectValue(e,i){return 0===Object.keys(e[i]?e[i]:"").length?"":e[i]}OnLinkClickEvent(e,i,n){try{b.RibbonExtViewModel.LoadDocument_VoucherNo(l.J0.String(e.VoucherNo)),this.parent.sJVDtls="",a.d.page.HideDialog(this.PopUpGUID)}catch(c){Logger.ErrorLog("CommonFieldPopupViewModel","OnLinkClickEvent",c)}}onSave(e){if("BudgetProfile"==e)l.J0.IsEmpty(this.BudgetProfile.SelectedValue)||(this.parent.iBudgetProfileID=parseInt(this.BudgetProfile.SelectedValue),a.d.page.HideDialog(this.PopUpGUID));else if("Cancel"==e)this.parent.iBudgetProfileID=0,a.d.page.HideDialog(this.PopUpGUID);else if("JVSave"==e)l.J0.IsEmpty(this.JVDocs.SelectedValue)||(this.parent.sJVDtls=this.parent.sJVDtls+"~"+this.JVDocs.SelectedValue,a.d.page.HideDialog(this.PopUpGUID));else if("JVCancel"==e)this.parent.sJVDtls="",a.d.page.HideDialog(this.PopUpGUID);else if("ChequeSave"==e)this.parent.sJVDtls="Success",a.d.page.HideDialog(this.PopUpGUID);else if("ChequeCancel"==e)this.parent.sJVDtls="",a.d.page.HideDialog(this.PopUpGUID);else if("ReverseSave"==e){let n="",c="";if(this.GridData.length>0)for(let o=0;o<this.GridData.length;o++)!l.J0.IsEmpty(this.GridData[o].Select)&&(0,S.parseBoolean)(this.GridData[o].Select)&&(this.GridData[o].Select=!1,l.J0.IsEmpty(n)?(n=this.GridData[o].DocDetailsID.toString(),c=this.GridData[o].DocSeqNo.toString()):(n=n+","+this.GridData[o].DocDetailsID.toString(),c=c+","+this.GridData[o].DocSeqNo.toString()));this.parent.sJVDtls=this.ReverseType.SelectedValue+"~"+n+"~"+c,a.d.page.HideDialog(this.PopUpGUID)}else("ReverseCancel"==e||"ViewReverseCancel"==e)&&(this.parent.sJVDtls="",a.d.page.HideDialog(this.PopUpGUID))}}}}]);