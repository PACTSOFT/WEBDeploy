"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[7071],{37071:(R,p,r)=>{r.r(p),r.d(p,{CommonFieldPopupViewModel:()=>V});var l=r(86739),a=r(8787),D=r(92701),g=r(23823),d=r(18569),f=r(49710),b=r(95050),O=r(56856),S=r(24028),m=r(31820);class V extends g.g{get ColumnSource(){return this.GridObj.Columns}set ColumnSource(e){this.GridObj.Columns=e}get GridData(){return this.GridObj.Table}set GridData(e){this.GridObj.Table=e}get SelectedRow(){return this.GridObj.SelectedItem}set SelectedRow(e){this.GridObj.SelectedItem=e}constructor(e,i=!1,o=!1,c=!1,h=!1,C=0,G=!1,P=null){if(super(),this.BudgetProfile=new D.y$(0),this.JVDocs=new D.y$(0),this.ReverseType=new D.y$(0),this.txtChqAccountNumber=new m.Dw(0),this.txtChqAccountName=new m.Dw(0),this.txtChqAmount=new m.Dw(0),this.txtChequeNo=new m.Dw(0),this.dtpChequeDate=new S.P6(0),this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsViewReverseDocument=!1,this.IsHideChqOkButton=!0,this.IsReverseDocument=!1,this.IsScanCheque=!1,this.VMsg="",this.GridObj=new f.vv,this.parent=e,this.IsBudgetProfileDoc=i,this.IsJVVoucher=o,this.IsScanCheque=G,this.IsBudgetProfileDoc)this.IsBudgetProfileDoc=!0,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.BindBudgetProfiles();else if(c){this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!0,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.ReverseType.Items.push(D._p.ComboBoxItems_2("Document Wise","0")),this.ReverseType.Items.push(D._p.ComboBoxItems_2("Line Wise","1")),this.ReverseType.SelectedValue="1";let I=[],n=new d.O7;n.Header="\u221a",n.DisplayMember="Select",n.DataType="CheckBox",n.Width=25,n.CheckedChanged.Subscribe(this,"OnCheckedChanged"),I.push(n),this.GridObj.Columns=[],this.GridObj.Table=[],e.ColumnSource.forEach(s=>{I.push(s)}),I.forEach(s=>{this.ColumnSource.push(s)}),this.GridData=e.ScreenObject.GridData.Copy(),this.GridObj.TableColumns.push("Select"),this.GridObj.TableColumns.Contains("Row_Background")||this.GridObj.TableColumns.push("Row_Background"),this.GridObj.TableColumns.Contains("Posted")||this.GridObj.TableColumns.push("Posted");let u,t=0;this.parent.ScreenObject.Preferences.ContainsKey("ReverseDocument")&&!a.J0.IsEmpty(this.parent.ScreenObject.Preferences.ReverseDocument)&&(t=parseInt(this.parent.ScreenObject.Preferences.ReverseDocument)),u=this.parent.ScreenObject.IsInventory?l.d.common.GetDataSet3("RVINVVIEWDOC",a.J0.String(C),a.J0.String(this.parent.ScreenObject.CostCenterID),a.J0.String(t)):l.d.common.GetDataSet("RVACCVIEWDOC",a.J0.String(C));for(let s=0;s<this.GridData.length;s++)null!=u&&u.Tables.length>0&&parseInt(this.GridData[s].DocDetailsID)>0&&u.Tables[0].filter(_=>_.DocDetailsID==parseInt(this.GridData[s].DocDetailsID)).length>0?(this.GridData[s].Row_Background="#e3938d",this.GridData[s].Select="False",this.GridData[s].Posted="1"):(this.GridData[s].Select="False",this.GridData[s].Posted="0",this.GridData[s].Row_Background="#FFFFFF"),this.GridObj.updateRow(this.GridData[s]);this.GridObj.refreshDataView(),this.GridObj.RefreshGrid=!0}else if(h){this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!0,this.IsScanCheque=!1;let n=[];this.GridObj=new f.vv,this.GridObj.OnLinkClick.Subscribe(this,"OnLinkClickEvent");let t=new d.O7;t.Header="Document",t.DisplayMember="DocumentName",t.ReadOnly=!0,t.DisableTab=!0,t.Width=100,n.push(t),t=new d.O7,t.Header="VoucherNo",t.DisplayMember="VoucherNo",t.ReadOnly=!0,t.DataType="LINK",t.DisableTab=!0,t.Width=125,n.push(t),t=new d.O7,t.Header="CCID",t.DisplayMember="CostCenterID",t.ReadOnly=!0,t.DisableTab=!0,t.IsVisible=!1,t.Width=100,n.push(t),this.GridObj.Columns=n;let s,u=0;this.parent.ScreenObject.Preferences.ContainsKey("ReverseDocument")&&!a.J0.IsEmpty(this.parent.ScreenObject.Preferences.ReverseDocument)&&(u=parseInt(this.parent.ScreenObject.Preferences.ReverseDocument)),s=this.parent.ScreenObject.IsInventory?l.d.common.GetDataSet3("RVINVDOC",a.J0.String(C),a.J0.String(this.parent.ScreenObject.CostCenterID),a.J0.String(u)):l.d.common.GetDataSet("RVACCDOC",a.J0.String(C)),null!=s&&s.Tables.length>0&&(this.GridObj.Table=s.Tables[0])}else this.IsJVVoucher?(this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!0,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.BindJVDocs()):this.IsScanCheque&&(this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!0,this.FillChequeDetails(P))}OnCheckedChanged(e){try{let i=e.item;"Select"==e.columnDef.field&&"1"==i.Posted&&(i.Select="False")}catch{}}BindBudgetProfiles(){this.BudgetProfile.Items.Clear();let e=l.d.common.GetDataSet("BDP01","");null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(i=>{this.BudgetProfile.Items.push(D._p.ComboBoxItems_2(i.BudgetName.toString(),i.BudgetDefID.toString()))})}BindJVDocs(){this.JVDocs.Items.Clear();let e=l.d.common.GetDataSet("JVD01","");null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(i=>{this.JVDocs.Items.push(D._p.ComboBoxItems_2(i.DocName.toString(),i.CostCenterID.toString()))})}FillChequeDetails(e){try{let i;if(this.txtChqAccountNumber.Text=this.GetObjectValue(e.results[0].ocr,"Account Number"),this.txtChqAccountName.Text=this.GetObjectValue(e.results[0].ocr,"Account Name"),this.txtChqAmount.Text=this.GetObjectValue(e.results[0].ocr,"Amount"),this.txtChequeNo.Text=this.GetObjectValue(e.results[0].ocr,"Cheque Number"),i=this.parent.GetDateonCustomFormat(this.GetObjectValue(e.results[0].ocr,"Date"),"dd/MM/yyyy"),this.dtpChequeDate.Date=a.J0.ParseDate(i),a.J0.IsEmpty(this.txtChqAmount.Text)||!a.J0.IsEmpty(this.txtChqAmount.Text)&&parseInt(this.txtChqAmount.Text)<=0)this.IsHideChqOkButton=!1;else{let o=l.d.common.GetDataSet3("CHEQACCID",this.GetObjectValue(e.results[0].ocr,"Account Name"),this.GetObjectValue(e.results[0].ocr,"Account Name"),"");if(!(null!=o&&o.Tables.length>0&&o.Tables[0].length>0&&o.Columns[0].Contains("AccountID")))return this.IsHideChqOkButton=!1,void(this.VMsg="Account not found");this.parent.sJVDtls="Success~"+a.J0.String(o.Tables[0][0].AccountID)}}catch(i){this.parent.sJVDtls="Please verify the Cheque Details",Logger.ErrorLog("CommonFieldPopupViewModel","FillChequeDetails",i)}}GetObjectValue(e,i){return 0===Object.keys(e[i]?e[i]:"").length?"":e[i]}OnLinkClickEvent(e,i,o){try{b.RibbonExtViewModel.LoadDocument_VoucherNo(a.J0.String(e.VoucherNo)),this.parent.sJVDtls="",l.d.page.HideDialog(this.PopUpGUID)}catch(c){Logger.ErrorLog("CommonFieldPopupViewModel","OnLinkClickEvent",c)}}onSave(e){if("BudgetProfile"==e)a.J0.IsEmpty(this.BudgetProfile.SelectedValue)||(this.parent.iBudgetProfileID=parseInt(this.BudgetProfile.SelectedValue),l.d.page.HideDialog(this.PopUpGUID));else if("Cancel"==e)this.parent.iBudgetProfileID=0,l.d.page.HideDialog(this.PopUpGUID);else if("JVSave"==e)a.J0.IsEmpty(this.JVDocs.SelectedValue)||(this.parent.sJVDtls=this.parent.sJVDtls+"~"+this.JVDocs.SelectedValue,l.d.page.HideDialog(this.PopUpGUID));else if("JVCancel"==e)this.parent.sJVDtls="",l.d.page.HideDialog(this.PopUpGUID);else if("ChequeSave"==e)l.d.page.HideDialog(this.PopUpGUID);else if("ChequeCancel"==e)this.parent.sJVDtls="",l.d.page.HideDialog(this.PopUpGUID);else if("ReverseSave"==e){let o="",c="";if(this.GridData.length>0)for(let h=0;h<this.GridData.length;h++)!a.J0.IsEmpty(this.GridData[h].Select)&&(0,O.parseBoolean)(this.GridData[h].Select)&&(this.GridData[h].Select=!1,a.J0.IsEmpty(o)?(o=this.GridData[h].DocDetailsID.toString(),c=this.GridData[h].DocSeqNo.toString()):(o=o+","+this.GridData[h].DocDetailsID.toString(),c=c+","+this.GridData[h].DocSeqNo.toString()));this.parent.sJVDtls=this.ReverseType.SelectedValue+"~"+o+"~"+c,l.d.page.HideDialog(this.PopUpGUID)}else("ReverseCancel"==e||"ViewReverseCancel"==e)&&(this.parent.sJVDtls="",l.d.page.HideDialog(this.PopUpGUID))}}}}]);