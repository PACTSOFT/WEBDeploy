"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[7071],{37071:(v,p,l)=>{l.r(p),l.d(p,{CommonFieldPopupViewModel:()=>O});var i=l(86739),o=l(8787),c=l(92701),g=l(23823),D=l(18569),I=l(49710),V=l(95050),P=l(56856),S=l(24028),d=l(31820);class O extends g.g{get ColumnSource(){return this.GridObj.Columns}set ColumnSource(e){this.GridObj.Columns=e}get GridData(){return this.GridObj.Table}set GridData(e){this.GridObj.Table=e}get SelectedRow(){return this.GridObj.SelectedItem}set SelectedRow(e){this.GridObj.SelectedItem=e}constructor(e,s=!1,h=!1,n=!1,a=!1,C=0,b=!1,_=null){if(super(),this.BudgetProfile=new c.y$(0),this.JVDocs=new c.y$(0),this.ReverseType=new c.y$(0),this.txtChqAccountNumber=new d.Dw(0),this.txtChqAccountName=new d.Dw(0),this.txtChqAmount=new d.Dw(0),this.txtChequeNo=new d.Dw(0),this.dtpChequeDate=new S.P6(0),this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsViewReverseDocument=!1,this.IsReverseDocument=!1,this.IsScanCheque=!1,this.GridObj=new I.vv,this.parent=e,this.IsBudgetProfileDoc=s,this.IsJVVoucher=h,this.IsScanCheque=b,this.IsBudgetProfileDoc)this.IsBudgetProfileDoc=!0,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.BindBudgetProfiles();else if(n){this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!0,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.ReverseType.Items.push(c._p.ComboBoxItems_2("Document Wise","0")),this.ReverseType.Items.push(c._p.ComboBoxItems_2("Line Wise","1")),this.ReverseType.SelectedValue="1";let m=[],r=new D.O7;r.Header="\u221a",r.DisplayMember="Select",r.DataType="CheckBox",r.Width=25,m.push(r),this.GridObj.Columns=[],this.GridObj.Table=[],e.ColumnSource.forEach(t=>{m.push(t)}),m.forEach(t=>{this.ColumnSource.push(t)}),this.GridData=e.ScreenObject.GridData.Copy(),this.GridObj.TableColumns.push("Select");for(let t=0;t<this.GridData.length;t++)this.GridData[t].select="False"}else if(a){this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!0,this.IsScanCheque=!1;let r=[];this.GridObj=new I.vv,this.GridObj.OnLinkClick.Subscribe(this,"OnLinkClickEvent");let t=new D.O7;t.Header="Document",t.DisplayMember="DocumentName",t.ReadOnly=!0,t.DisableTab=!0,t.Width=100,r.push(t),t=new D.O7,t.Header="VoucherNo",t.DisplayMember="VoucherNo",t.ReadOnly=!0,t.DataType="LINK",t.DisableTab=!0,t.Width=125,r.push(t),t=new D.O7,t.Header="CCID",t.DisplayMember="CostCenterID",t.ReadOnly=!0,t.DisableTab=!0,t.IsVisible=!1,t.Width=100,r.push(t),this.GridObj.Columns=r;let u,f=0;this.parent.ScreenObject.Preferences.ContainsKey("ReverseDocument")&&!o.J0.IsEmpty(this.parent.ScreenObject.Preferences.ReverseDocument)&&(f=parseInt(this.parent.ScreenObject.Preferences.ReverseDocument)),u=this.parent.ScreenObject.IsInventory?i.d.common.GetDataSet3("RVINVDOC",o.J0.String(C),o.J0.String(this.parent.ScreenObject.CostCenterID),o.J0.String(f)):i.d.common.GetDataSet("RVACCDOC",o.J0.String(C)),null!=u&&u.Tables.length>0&&(this.GridObj.Table=u.Tables[0])}else this.IsJVVoucher?(this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!0,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!1,this.BindJVDocs()):this.IsScanCheque&&(this.IsBudgetProfileDoc=!1,this.IsJVVoucher=!1,this.IsReverseDocument=!1,this.IsViewReverseDocument=!1,this.IsScanCheque=!0,this.FillChequeDetails(_))}BindBudgetProfiles(){this.BudgetProfile.Items.Clear();let e=i.d.common.GetDataSet("BDP01","");null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(s=>{this.BudgetProfile.Items.push(c._p.ComboBoxItems_2(s.BudgetName.toString(),s.BudgetDefID.toString()))})}BindJVDocs(){this.JVDocs.Items.Clear();let e=i.d.common.GetDataSet("JVD01","");null!=e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Tables[0].forEach(s=>{this.JVDocs.Items.push(c._p.ComboBoxItems_2(s.DocName.toString(),s.CostCenterID.toString()))})}FillChequeDetails(e){try{let s;this.txtChqAccountNumber.Text=this.GetObjectValue(e.results[0].ocr,"Account Number"),this.txtChqAccountName.Text=this.GetObjectValue(e.results[0].ocr,"Account Name"),this.txtChqAmount.Text=this.GetObjectValue(e.results[0].ocr,"Amount"),this.txtChequeNo.Text=this.GetObjectValue(e.results[0].ocr,"Cheque Number"),s=this.parent.GetDateonCustomFormat(this.GetObjectValue(e.results[0].ocr,"Date"),"dd/MM/yyyy"),this.dtpChequeDate.Date=o.J0.ParseDate(s)}catch(s){this.parent.sJVDtls="Please verify the Cheque Details",Logger.ErrorLog("CommonFieldPopupViewModel","FillChequeDetails",s)}}GetObjectValue(e,s){return 0===Object.keys(e[s]?e[s]:"").length?"":e[s]}OnLinkClickEvent(e,s,h){try{V.RibbonExtViewModel.LoadDocument_VoucherNo(o.J0.String(e.VoucherNo)),this.parent.sJVDtls="",i.d.page.HideDialog(this.PopUpGUID)}catch(n){Logger.ErrorLog("CommonFieldPopupViewModel","OnLinkClickEvent",n)}}onSave(e){if("BudgetProfile"==e)o.J0.IsEmpty(this.BudgetProfile.SelectedValue)||(this.parent.iBudgetProfileID=parseInt(this.BudgetProfile.SelectedValue),i.d.page.HideDialog(this.PopUpGUID));else if("Cancel"==e)this.parent.iBudgetProfileID=0,i.d.page.HideDialog(this.PopUpGUID);else if("JVSave"==e)o.J0.IsEmpty(this.JVDocs.SelectedValue)||(this.parent.sJVDtls=this.parent.sJVDtls+"~"+this.JVDocs.SelectedValue,i.d.page.HideDialog(this.PopUpGUID));else if("JVCancel"==e)this.parent.sJVDtls="",i.d.page.HideDialog(this.PopUpGUID);else if("ChequeSave"==e)this.parent.sJVDtls="Success",i.d.page.HideDialog(this.PopUpGUID);else if("ChequeCancel"==e)this.parent.sJVDtls="",i.d.page.HideDialog(this.PopUpGUID);else if("ReverseSave"==e){let h="",n="";if(this.GridData.length>0)for(let a=0;a<this.GridData.length;a++)!o.J0.IsEmpty(this.GridData[a].Select)&&(0,P.parseBoolean)(this.GridData[a].Select)&&(this.GridData[a].Select=!1,o.J0.IsEmpty(h)?(h=this.GridData[a].DocDetailsID.toString(),n=this.GridData[a].DocSeqNo.toString()):(h=h+","+this.GridData[a].DocDetailsID.toString(),n=n+","+this.GridData[a].DocSeqNo.toString()));this.parent.sJVDtls=this.ReverseType.SelectedValue+"~"+h+"~"+n,i.d.page.HideDialog(this.PopUpGUID)}else("ReverseCancel"==e||"ViewReverseCancel"==e)&&(this.parent.sJVDtls="",i.d.page.HideDialog(this.PopUpGUID))}}}}]);