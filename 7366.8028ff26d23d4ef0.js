"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[7366],{97366:(re,W,f)=>{f.r(W),f.d(W,{BulkEditFilter:()=>V,BulkEditReplace:()=>oe,BulkEditViewModel:()=>ae});var w=f(10467),I=f(9120),t=f(31168),P=f(18088),R=f(55028),H=f(81228),v=f(1647),x=f(9439),Y=f(46204),L=f(27329),M=f(40950),B=f(15082),O=f(61240),U=f(48955),G=f(58106),X=f(60859),j=f(11798),p=f(32057),_=f(82558),Z=f(805),Q=f(96336);function z(E,l){if(1&E&&(p.j41(0,"div",3),p.EFF(1,"\n            "),p.eu8(2,10),p.EFF(3,"\n        "),p.k0s()),2&E){const i=p.XpG();p.R7$(2),p.Y8G("obj",i.obj.AppRejDate)("group",i.form)}}function $(E,l){if(1&E){const i=p.RV6();p.j41(0,"button",6),p.bIt("click",function(){p.eBV(i);const a=p.XpG();return p.Njj(a.obj.onClickIkon("Suspend"))}),p.EFF(1),p.nI1(2,"translate"),p.k0s()}2&E&&(p.R7$(),p.JRh(p.bMT(2,1,"Suspend")))}let q=(()=>{class E{constructor(){}ngOnInit(){this.form=new j.gE({})}static#e=this.\u0275fac=function(r){return new(r||E)};static#t=this.\u0275cmp=p.VBU({type:E,selectors:[["app-bulk-edit-approve-component"]],inputs:{obj:"obj"},decls:35,vars:12,consts:[[1,"master-screen",2,"padding-bottom","4px","min-width","400px"],[1,"PACTHeaderFields","dialogSubBody"],["class","form-group row form-row col-xl-12 col-md-12 col-sm-12 col-xs-12 PACTControl",4,"ngIf"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],["class","primary-btn-wicon",3,"click",4,"ngIf"],[1,"fa-light","fa-rectangle-xmark"],["FieldDirective","",3,"obj","group"]],template:function(r,a){1&r&&(p.j41(0,"div",0),p.EFF(1,"\n    "),p.j41(2,"div",1),p.EFF(3,"\n        "),p.DNE(4,z,4,2,"div",2),p.EFF(5,"\n        "),p.j41(6,"div",3),p.EFF(7,"\n            "),p.eu8(8,4),p.EFF(9,"\n        "),p.k0s(),p.EFF(10,"\n        \n    "),p.k0s(),p.EFF(11,"\n    "),p.j41(12,"div",5),p.EFF(13,"\n      "),p.j41(14,"div"),p.EFF(15,"\n        "),p.j41(16,"button",6),p.bIt("click",function(){return a.obj.onClickIkon("Approve")}),p.EFF(17),p.nI1(18,"translate"),p.k0s(),p.EFF(19,"\n        "),p.j41(20,"button",7),p.bIt("click",function(){return a.obj.onClickIkon("Reject")}),p.EFF(21),p.nI1(22,"translate"),p.k0s(),p.EFF(23,"\n        "),p.DNE(24,$,3,3,"button",8),p.EFF(25,"\n        "),p.EFF(26,"\n        "),p.j41(27,"button",7),p.bIt("click",function(){return a.obj.Cancelclick()}),p.nrm(28,"i",9),p.EFF(29),p.nI1(30,"translate"),p.k0s(),p.EFF(31,"\n      "),p.k0s(),p.EFF(32,"\n      \n  "),p.k0s(),p.EFF(33,"\n"),p.k0s(),p.EFF(34,"\n")),2&r&&(p.R7$(4),p.Y8G("ngIf",a.obj.AppRejDate.Visible),p.R7$(4),p.Y8G("obj",a.obj.Remarks),p.R7$(9),p.JRh(p.bMT(18,6,"btnApprove")),p.R7$(4),p.JRh(p.bMT(22,8,"btnReject")),p.R7$(3),p.Y8G("ngIf",a.obj.SuspendVisiblity),p.R7$(5),p.JRh(p.bMT(30,10,"Cancel")))},dependencies:[_.bT,Z._,Q.D9],encapsulation:2})}return E})();var ee=f(48565),F=f(87143),te=f(20346),ie=f(16029),se=f(5011),K=f(21375),ne=f(51607),le=f(21050),k=f(17924);class ae extends Y.g{get AppDisplayMessage(){return this._AppDisplayMessage}set AppDisplayMessage(l){l!=this._AppDisplayMessage&&(this._AppDisplayMessage=l,this.AppMessageVisibility=!t.J0.IsEmpty(this._AppDisplayMessage))}constructor(l,i=null){super(),this.ButtonApprove=new H.v,this.AppMessageVisibility=!1,this.HeaderAppearance=new O.bA,this.TextDataAppearance=new O.bA,this.NumberDataAppearance=new O.bA,this.SavePDF=new k.u("LW Document",10,"Group1"),this.SaveXLS=new k.u("LW Document",10,"Group1"),this.SaveXLSX=new k.u("LW Document",10,"Group1"),this._AppDisplayMessage="",this.VoucherData=new Array,this.TrasUserVisibility=!1,this.TranserUserVisiblity=!1,this.strOldUserID="",this.Remarks=new x.Dw(0),this.AppRejDate=new v.Lc(0),this.SuspendVisiblity=!1,this.CostCenterName="",this.ReplaceVisibility=!1,this.DeleteVisibility=!1,this.ShowRightPanel=!0,this.SaveButtonVisible=!1,this.ExportButtonVisible=!1,this.IsBarcode=!1,this.HideTitle=!1,this.Replace=null,this.IsLWApproval=!1,this.ID=0,this.intLinkDimCC=0,this.CostCenterID=0,this.MainTableName="",this.dvFields=null,this.dvFieldsNew=null,this.IsDetailVoucher=!1,this.IsSelectOnRowLeave=!0,this.IsApproval=!1,this.IsProductExists=!1,this.HideFilterDialog=!1,this.HideProductImage=!1,this.ShowFilter=!1,this.RemarksApprove=!1,this.RemarksReject=!1,this.RemarksSuspend=!1,this.SelectedFields=[],this.DateColIDs=new Array,this.EditColumns=new Array,this.EditColumnsDr=[],this.Entities=new P.bT,this.strWhereforAuctionHistory="",this.ProductImageVisibility=!1,this.ApproveVisibility=!1,this.PhotoTextVisibility=!1,this.ProductID=0,this.ProductPhoto="",this.ImportIsCode=!1,this.ImportVisiblity=!1,this.ExportVisibility=!1,this.ReportID=0,this.DB=null,this.IsDocument=!1,this.PrimaryKey="",this.PrimaryColumns="",this.ReportObj=null,this.Report=[],this.AddressFields=new Array,this.docAllowCols=["billno","billdate","linenarration","commonnarration","chequenumber","chequematuritydate"],this.ReportFilterVisible=!1,this.oDocPayroll=null,this.vnofield="",this.dimfield="",this.cprimary=null,this.strVoucherNo="VoucherNo",this.dicBarLayouts=new P.bT,this.ClassName="BulkEditViewModel",this.FromDate=new v.Lc,this.FromDate.Label=I.d.GetResource("Calender_FromDate"),this.ToDate=new v.Lc,this.ToDate.Label=I.d.GetResource("Calender_ToDate"),this.FromDate.CustomFormat=I.d.SessionManager.Preferences["Date Format"],this.ToDate.CustomFormat=I.d.SessionManager.Preferences["Date Format"],this.FromDate.Date=t.J0.ParseDate(I.d.SessionManager.AccountingDate),this.ToDate.Date=new Date,this.DateRanges=X.w.getDateRanges(),this.DateRanges.SelectionChangedCommand.Subscribe(this,"OnDateRangesSelectionChanged"),this.AppRejDate.CustomFormat=I.d.SessionManager.Preferences["Date Format"],this.AppRejDate.Date=new Date,this.SavePDF.Label="PDF",this.SaveXLS.Label="Spreadsheet (xlsx)",this.SaveXLSX.Label="Spreadsheet (Open xlsx)",this.ID=l,this.DB=i,this.TargetUserID=new le.y$(0),this.TargetUserID.CCID=7,this.TargetUserID.TypeID=4,this.InitGrids(),this.EditGrid.SelectAll.Visible=!0,this.Margin="2",null!=i&&(this.HideFilterDialog=!0,this.ShowRightPanel=!1,this.HideTitle=!0,this.EditGrid.SearchCols.Width="140",this.EditGrid.SearchOptions.Width="100",this.EditGrid.SearchText.Width="130",this.Margin="2"),this.HideFilterDialog&&(this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,(null!=this.ReportObj&&this.ReportObj.IsDefaultSortColumnExists||I.d.SessionManager.IsWebApplication)&&(this.bgWorker_DoWork(null,null),this.bgWorker_RunWorkerCompleted(null,null)))}bgWorker_DoWork(l,i){null!=this.ReportObj?null!=this.ReportObj.oReportDialog?this.ReportObj.oReportDialog.OnOkClick("OK"):this.ReportObj.Filter.OnButtonClick("OK"):this.RefreshData()}bgWorker_RunWorkerCompleted(l,i){this.DisplayName=this.Title,null==this.DB&&this.HideFilterDialog&&null!=this.EditGrid.Table&&0==this.EditGrid.Table.length&&(this.DisplayMessage="No Data Available.")}AddAddressColumns(l,i){let r,a=["ContactPerson","Address1","Address2","Address3","City","State","Zip","Country","Phone1","Phone2","Fax","Email1","Email2","URL","AddressName"],u="Account",s=l.filter(m=>m.CostCenterID==i);s.length>0&&(u=s[0].CostCenterName.toString());for(let m=0;m<a.length;m++)r={},r.SysTableName="COM_Address",r.UserColumnName=r.SysColumnName=a[m],r.ColumnCostCenterID=r.CostCenterID=i,r.CostCenterName=u,r.CostCenterColID=4e5+m+200*i,r.IsForeignKey=!1,r.IsColumnUserDefined=!1,l.push(r)}AddPmsUserColumns(l,i){let r,u="User",s=l.filter(m=>m.CostCenterID==i);s.length>0&&(u=s[0].CostCenterName.toString()),r={},r.SysTableName="ADM_Users",r.UserColumnName="Transer User",r.SysColumnName="ccAlpha13",r.CostCenterID=i,r.CostCenterName=u,r.CostCenterColID=15408700,r.IsForeignKey=!1,r.IsColumnUserDefined=!1,r.UserColumnType="LISTBOX",r.ColumnDataType="LISTBOX",r.ParentCostCenterID=7,r.ColumnCostCenterID=7,r.ColumnCCListViewTypeID=4,l.push(r)}InitGrids(){this.SaveButtonVisible=!0,this.ExportButtonVisible=I.d.SessionManager.IsActionAssigned(49,"Bulk Export Data");let l=I.d.common.BulkEditDetals(6,this.ID,0);null!=l&&l.Tables.length>3&&l.Tables[3].length>0&&!t.J0.IsEmpty(l.Tables[3][0].PrefValue.toString())&&(this.intLinkDimCC=t.J0.IntTryParse(t.J0.String(l.Tables[3][0].PrefValue))),this.CostCenterID=parseInt(l.Tables[0][0].CostCenterID),this.DisplayName=t.J0.String(l.Tables[0][0].Name),this.Title=this.DisplayName,this.MainTableName=t.J0.String(l.Tables[1][0].TableName),this.CostCenterName=t.J0.String(l.Tables[1][0].Name);let i=I.d.common.BulkEditDetals(2,0,this.CostCenterID);2==this.CostCenterID&&this.AddAddressColumns(i.Tables[0],this.CostCenterID),this.intLinkDimCC==this.CostCenterID&&this.AddPmsUserColumns(i.Tables[0],this.intLinkDimCC);let r=new t.VB,a=new t.VB;r.LoadXml(t.J0.String(l.Tables[0][0].Options)),this.IsSelectOnRowLeave=null!=r.SelectSingleNode("XML/SelectOnRowLeave"),this.IsDetailVoucher=null!=r.SelectSingleNode("XML/DetailsVoucher"),this.HideFilterDialog=null!=r.SelectSingleNode("XML/HideFilterDialog"),this.HideProductImage=null!=r.SelectSingleNode("XML/HideProductImage"),this.IsApproval=null!=r.SelectSingleNode("XML/ApproveDocuments"),this.ShowFilter=null!=r.SelectSingleNode("XML/ShowFilter"),this.IsApproval&&(this.RemarksApprove=null!=r.SelectSingleNode("XML/RemarksApprove"),this.RemarksReject=null!=r.SelectSingleNode("XML/RemarksReject"),this.RemarksSuspend=null!=r.SelectSingleNode("XML/RemarksSuspend"),this.ExportButtonVisible=!1),this.IsBarcode=null!=r.SelectSingleNode("XML/BarcodePrint"),this.IsBarcode&&(this.SaveButtonVisible=!1,this.IsDetailVoucher=!0,this.ExportButtonVisible=!1),3==this.CostCenterID&&!this.HideProductImage&&(this.ProductImageVisibility=!0),this.CostCenterID>4e4&&this.CostCenterID<5e4?(this.IsDocument=!0,this.IsLWApproval=!!(this.IsDetailVoucher&&l.Tables[2].length>0&&1==parseInt(l.Tables[2][0].IsLineWise)),this.AppRejDate.Visible=i.Tables[3].filter(d=>"AppDate"==d.PrefName&&"True"==d.PrefValue).length>0):this.AppRejDate.Visible=!1;let s,u=i.Tables[0];this.dvFields=u,this.dvFieldsNew=u,null!=r.SelectSingleNode("XML/Report")?(this.ReportID=parseInt(r.SelectSingleNode("XML/Report").innerHTML),this.InitReport()):this.ReportID=0,(this.IsDocument||2==this.CostCenterID||3==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID||this.CostCenterID>5e4)&&this.IsApproval&&I.d.SessionManager.IsActionAssigned(49,"Document Bulk Approval")?(this.ButtonApprove.Visible=!0,this.SaveButtonVisible=!1,this.IsDocument&&this.IsLWApproval&&(this.SuspendVisiblity=I.d.SessionManager.IsActionAssigned(this.CostCenterID,"Suspend"))):this.ButtonApprove.Visible=!1,(2==this.CostCenterID||3==this.CostCenterID||this.CostCenterID>5e4)&&(this.DeleteVisibility=I.d.SessionManager.IsActionAssigned(49,"Bulk Delete"),this.DeleteVisibility&&(this.DeleteVisibility=I.d.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"))),this.EditGrid=new L.vv,this.EditGrid.Width="",this.EditGrid.Height=void 0,this.EditGrid.CanUserDeleteRows=!1,this.EditGrid.Columns=[],this.EditGrid.SearchVisible=!0,this.EditGrid.SearchColStartIndex=1,this.EditGrid.CanUserSortColumns=!0,this.EditGrid.Visible=!1,this.EditGrid.CellEditEnding.Subscribe(this,"EditGridOnCellEditEnding"),this.EditGrid.OnPreviewKeyDown.Subscribe(this,"OnKeyDown"),this.Report.length>0&&this.EditGrid.Clear(),s=new M.O7,s.Header="Select",s.DisplayMember="Select",s.DataType="CheckBox",s.Width=50,s.IsFrozen=!I.d.IsNativeMobile,s.DisableTab=!0,this.EditGrid.Columns.push(s);let m=0;r.LoadXml(t.J0.String(l.Tables[0][0].FieldsXML));let D=new Array;if(this.IsDocument){let d=new U.PE,e=[];i.Tables[1].forEach(n=>{e.Clear(),d.ParseFormula(t.J0.String(n.Formula),e);let C=null;for(let h=e.length-1;h>=0;h--)C=e[h],C.getTokenClass()==U.C3.OPERAND&&C.getTokenType()==U.Wz.REFERENCE&&!D.Contains(C.tokenValue.toString())&&D.push(C.tokenValue.toString())})}if(this.intLinkDimCC==this.CostCenterID){a.LoadXml(t.J0.String(l.Tables[0][0].FilterXML));for(let d=0;d<a.DocumentElement.children.length;d++){const e=a.DocumentElement.children[d];!t.J0.IsEmpty(e.attributes.Field.value)&&"15408700"==e.attributes.Field.value&&(t.J0.IsEmpty(e.attributes.Value_Key.value)||(this.strOldUserID=e.attributes.Value_Key.value,this.TrasUserVisibility=!0))}}for(let d=0;d<r.DocumentElement.children.length;d++){const e=r.DocumentElement.children[d];if(this.dvFields=t.J0.IsEmpty(e.attributes.ID.value)?[]:this.dvFieldsNew.filter(n=>n.CostCenterColID==e.attributes.ID.value),0!=this.dvFields.length){if(this.SelectedFields.push(this.dvFields[0]),m=parseInt(this.dvFields[0].CostCenterColID),s=new M.O7,s.DisplayMember="C"+(this.SelectedFields.length-1),s.SectionName=s.DisplayMember,s.Header=t.J0.String(this.dvFields[0].UserColumnName),s.Width=parseInt(e.attributes.Width.value),s.ReadOnly="YES"!=e.attributes.Edit.value,!t.J0.IsEmpty(e.attributes.ShowCode)&&"YES"==e.attributes.ShowCode.value&&(this.dvFields[0].ShowCode="YES"),this.ButtonApprove.Visible&&(s.ReadOnly=!0),s.ID=t.J0.String(this.dvFields[0].SysColumnName),"COM_ADDRESS"==t.J0.String(this.dvFields[0].SysTableName).toUpperCase()&&this.AddressFields.push(s.SectionName),s.CrRefID=m,null!=this.ReportObj&&(s.OPParams=e.attributes.RPTID.value),!s.ReadOnly&&!this.IsBarcode)if(this.IsDocument)if(s.ID.startsWith("dcAlpha")||s.ID.toLowerCase().startsWith("dcccnid")||this.docAllowCols.Contains(s.ID.toLowerCase())){(0!=i.Tables[1].filter(h=>h.CostCenterColID==m.toString()).length||D.Contains(s.Header))&&(alert(s.Header+" Used in formula hence its not editable"),s.ReadOnly=!0);let C=i.Tables[0].filter(h=>h.CostCenterColID==m.toString());0!=C.Length&&("dcCCNID2"==s.ID&&I.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"TRUE"==I.d.SessionManager.Preferences.EnableLocationWise.toUpperCase()?(alert(s.Header+" Used in Location wise"),s.ReadOnly=!0):"dcCCNID1"==s.ID&&I.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"TRUE"==I.d.SessionManager.Preferences.EnableDivisionWise.toUpperCase()?(alert(s.Header+" Used in Dimension wise"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise stock")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise stock"].toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise stock"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Batches")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise Batches"].toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Batches"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise AverageRate")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise AverageRate"].toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise AverageRate"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("Maintain Dimensionwise Bills")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences["Maintain Dimensionwise Bills"].toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Bills"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimensionwiseBins")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimensionwiseBins.toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Bins"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimensionwiseAssets")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimensionwiseAssets.toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Assets"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimWiseCreditDebit")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimWiseCreditDebit.toString()==C[0].ColumnCostCenterID.toString()?(alert(s.Header+" Used in Dimension wise Credit Debit"),s.ReadOnly=!0):I.d.SessionManager.Preferences.ContainsKey("DimensionwiseCurrency")&&!t.J0.IsEmpty(C[0].ColumnCostCenterID)&&parseInt(C[0].ColumnCostCenterID)>5e4&&I.d.SessionManager.Preferences.DimensionwiseCurrency.toString()==C[0].ColumnCostCenterID.toString()&&(alert(s.Header+" Used in Dimension wise Currency"),s.ReadOnly=!0))}else s.ReadOnly=!0;else if(2==this.CostCenterID&&s.ID.startsWith("AccountCode")){let n=i.Tables[2].filter(C=>0==C.IsGroupCode&&0==C.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==t.J0.String(n[0].IsEnable).toLowerCase()}else if(3==this.CostCenterID&&s.ID.startsWith("ProductCode")){let n=i.Tables[2].filter(C=>0==C.IsGroupCode&&0==C.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==t.J0.String(n[0].IsEnable).toLowerCase()}else if(16==this.CostCenterID&&s.ID.startsWith("BatchCode")){let n=i.Tables[3].filter(C=>"BatchCodeAutoGen"==C.Name);(n.length>0&&"true"==t.J0.String(n[0].Value).toLowerCase()||i.Tables[2].length>0&&!t.J0.IsEmpty(i.Tables[2][0].IsParentCodeInherited)&&(0,R.yG0)(i.Tables[2][0].IsParentCodeInherited))&&(s.ReadOnly=!0)}else if(93==this.CostCenterID&&s.ID.startsWith("Code")){let n=i.Tables[2].filter(C=>0==C.IsGroupCode&&0==C.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==n[0].IsEnable.toString().toLowerCase()}else if(this.CostCenterID>=50001&&s.ID.startsWith("Code")){let n=i.Tables[2].filter(C=>0==C.IsGroupCode&&0==C.IsName);s.ReadOnly=null!=n&&n.length>0&&"true"==t.J0.String(n[0].IsEnable).toLowerCase()}if(this.SelectedFields.length<3&&(s.IsFrozen=!I.d.IsNativeMobile),s.IsColumnUserDefined=!!(0,R.yG0)(this.dvFields[0].IsColumnUserDefined),s.DataType=t.J0.String(this.dvFields[0].UserColumnType).toUpperCase(),241==m)s.ValueMember="AccountTypeID",s.DisplayMember="AccountType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=i.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(264==m)s.ValueMember="ProductTypeID",s.DisplayMember="ProductType",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=i.Tables[4],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if(252==m)s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=V.GetBillWiseTable(),s.DataType="ComboBox";else if("StatusID"==s.ID||93==this.CostCenterID&&"Status"==s.ID)s.ValueMember="ID",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=this.IsDocument?i.Tables[2]:i.Tables[1],s.DataType="ComboBox",this.dvFields[0].IsForeignKey=!1;else if("Attachments"==s.ID)s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onAttachClick");else if(95!=this.CostCenterID&&103!=this.CostCenterID&&104!=this.CostCenterID&&129!=this.CostCenterID||"SNO"!=s.ID){if(s.ReadOnly||!t.J0.IsEmpty(this.dvFields[0].IsForeignKey)&&(0,R.yG0)(this.dvFields[0].IsForeignKey)&&parseInt(this.dvFields[0].ColumnCostCenterID)>0&&(s.DataType="LISTBOX",s.CostCenterID=parseInt(this.dvFields[0].ColumnCostCenterID),3==s.CostCenterID&&!this.HideProductImage&&(this.IsProductExists=!0,this.ProductImageVisibility=!0),s.TypeID=parseInt(this.dvFields[0].ColumnCCListViewTypeID)),"DATE"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if(s.IsColumnUserDefined)if("DATE"==s.DataType||"DATETIME"==s.DataType)s.DataType="DATE",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("TIME"==s.DataType)s.DataType="TIME",this.DateColIDs.push("C"+(this.SelectedFields.length-1));else if("NUMERIC"==s.DataType)s.DataType="FLOAT";else if("SELECTIONBOX"==s.DataType||"editablecombobox"==s.DataType)s.DataType="SELECTIONBOX",s.CostCenterID=this.CostCenterID;else if("COMBOBOX"==s.DataType){let n=[],C={};this.dvFields[0].UserProbableValues.toString().split(";").forEach(h=>{C={},C.Value=h,C.Name=h,n.push(C)}),s.ValueMember="Value",s.DisplayMember="Name",s.ValueBinding="C"+(this.SelectedFields.length-1),s.ComboData=n,s.DataType="ComboBox"}else if("LISTBOX"==s.DataType)s.DataType="LISTBOX",I.d.SessionManager.IsWebApplication&&(s.ValueMember="C"+(this.SelectedFields.length-1)+"_Key"),s.CostCenterID=parseInt(t.J0.String(this.dvFields[0].ColumnCostCenterID)),s.TypeID=parseInt(t.J0.String(this.dvFields[0].ColumnCCListViewTypeID));else if("LOOKUP"==s.DataType){s.ValueBinding=s.ID,s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value";let n=I.d.common.GetDataSet("DOC019",parseInt(this.dvFields[0].ColumnCCListViewTypeID).toString());if(null!=n){let C=[];for(let h=0;h<n.length;h++)C.push(B._p.ComboBoxItems_2(n[h].Name.toString(),n[h].NodeID.toString()));s.ComboData=C}}}else s.DataType="LINK",s.Click.Subscribe(this,"onDimClick");if("FLOAT"==t.J0.String(this.dvFields[0].ColumnDataType)){s.DataType="FLOAT";let n=t.J0.String(this.dvFields[0].Decimal);s.ID.toLowerCase().Contains("dcnum")?!t.J0.IsEmpty(n)&&parseFloat(n)>=0?s.DecimalPoints=n:I.d.SessionManager.Preferences.ContainsKey("DecimalsinExtraFields")&&""!=I.d.SessionManager.Preferences.DecimalsinExtraFields&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinExtraFields):"Quantity"==s.ID?""!=n&&parseFloat(n)>=0?s.DecimalPoints=n:I.d.SessionManager.Preferences.ContainsKey("DecimalsinQty")&&""!=I.d.SessionManager.Preferences.DecimalsinQty&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinQty):"Gross"==s.ID||"Rate"==s.ID?""!=n&&parseFloat(n)>=0?s.DecimalPoints=n:I.d.SessionManager.Preferences.ContainsKey("DecimalsinRate")&&""!=I.d.SessionManager.Preferences.DecimalsinRate&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinRate):"Amount"==s.ID||"DebitAmount"==s.ID||"CreditAmount"==s.ID?""!=n&&parseFloat(n)>=0?s.DecimalPoints=n:I.d.SessionManager.Preferences.ContainsKey("DecimalsinAmount")&&""!=I.d.SessionManager.Preferences.DecimalsinAmount&&(s.DecimalPoints=I.d.SessionManager.Preferences.DecimalsinAmount):""!=n&&parseFloat(n)>=0&&(s.DecimalPoints=n)}else"COMBOTEXT"==t.J0.String(this.dvFields[0].ColumnDataType)&&(s.DataType="LINK",s.Click.Subscribe(this,"onDocClick"),this.vnofield=s.DisplayMember);95!=this.CostCenterID&&103!=this.CostCenterID&&104!=this.CostCenterID&&129!=this.CostCenterID||s.ReadOnly||s.ID.toLowerCase().Contains("alpha")||s.ID.toLowerCase().Contains("ccnid")||(s.ReadOnly=!0),s.ReadOnly?s.DisableTab=!0:(this.EditColumns.push(s),this.EditColumnsDr.push(this.dvFields[0].Row),s.DisableTab=!1),this.EditGrid.Columns.push(s),null!=this.ReportObj&&("LISTBOX"==s.DataType||"DATE"==s.DataType?(this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):this.EditGrid.TableColumns.push("FLOAT"==s.DataType?s.DisplayMember:"ComboBox"==s.DataType?s.ValueBinding:s.DisplayMember))}else if(null!=this.ReportObj){var o=this.ReportObj.ReportColumns.find(n=>n.ID==e.attributes.RPTID.value);if(null==o||null==o)continue;s=new M.O7,s.DisplayMember="RC"+this.EditGrid.TableColumns.length,s.OPParams=e.attributes.RPTID.value,s.SectionName=s.DisplayMember,s.Header=o.HeaderText,s.Width=parseInt(e.attributes.Width.value),s.ReadOnly=!0,s.DataType=o.DataAppearance.ColumnType,this.EditGrid.Columns.push(s),"DATE"==s.DataType||"DATETIME"==s.DataType?(s.DataType="DATE",this.DateColIDs.push(s.SectionName),this.EditGrid.TableColumns.push(s.DisplayMember),this.EditGrid.TableColumns.push(s.DisplayMember+"_Key")):"FLOAT"==s.DataType?(s.DecimalPoints=o.DataFormat.DecimalsPoints.ToString(),this.EditGrid.TableColumns.push(s.DisplayMember),o.LinkType==F.T6.Dimension&&(s.DataType="LINK",s.Click.Subscribe(this,"onDimClick"),this.dimfield=s.DisplayMember+"_ID",this.EditGrid.TableColumns.push(s.DisplayMember+"_ID"))):(this.EditGrid.TableColumns.push(s.DisplayMember),(o.LinkType==F.T6.Attachment||o.LinkType==F.T6.Dimension||"11414"==o.FieldName&&o.LinkType==F.T6.Document)&&(s.DataType="LINK",o.LinkType==F.T6.Attachment?(s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onAttachClick")):o.LinkType==F.T6.Dimension?(s.Click.Subscribe(this,"onDimClick"),this.dimfield=s.DisplayMember+"_ID"):o.LinkType==F.T6.Document&&(s.DataType="MULTI_LINK",s.Click.Subscribe(this,"onDocClick")),this.EditGrid.TableColumns.push(s.DisplayMember+"_ID")))}}s=new M.O7,s.Header="Message",s.DisplayMember="Message",s.Width=250,s.ReadOnly=!0,s.DisableTab=!0,this.EditGrid.Columns.push(s),this.EditGrid.AddSearchCols(),this.Filter=new V(i,this),this.StaticFilter=new V(i,this),this.ShowFilter?this.Filter.LoadXML(t.J0.String(l.Tables[0][0].FilterXML)):this.StaticFilter.LoadXML(t.J0.String(l.Tables[0][0].FilterXML)),this.IsDocument?(this.FromDate.Visible=!0,this.ToDate.Visible=!0):(this.FromDate.Visible=!1,this.ToDate.Visible=!1)}GetColumn(l,i,r,a,u){let s=new O.yL;"Millions"==I.d.SessionManager.Preferences.Commas?s.Commas=1:"Lakhs"==I.d.SessionManager.Preferences.Commas&&(s.Commas=2),s.DateType=I.d.SessionManager.Preferences["Date Format"];let m=new F.D_;return m.gridLines=3,m.ID=l,m.FieldName=l,m.HeaderText=I.d.GetResource(i),m.HeaderAppearance=a,m.DataAppearance=a,m.HeaderHeight=22,m.width=u,m.DataFormat=s,m.ColumnType=r,m}SetCellValue(l,i,r,a,u){G.ReportViewModel.SetCellValue(l,i,r,-1,a,u)}EditGridOnCellEditEnding(l){0!=l.cell&&this.IsSelectOnRowLeave&&(l.item.Select=!0)}onDocClick(l){var i=this;return(0,w.A)(function*(){if(null!=i.EditGrid.SelectedItem&&i.EditGrid.TableColumns.Contains(i.vnofield)){let r,a;if(a=t.J0.String(l?.command).Contains("-")?I.d.report.GetDocumentDetailsByVoucherNo(t.J0.String(l.command.trimLeft())):I.d.report.GetDocumentDetailsByVoucherNo(i.EditGrid.SelectedItem[i.vnofield].toString()),r=t.J0.Int(a.obj),r>0){let u;if(u=a.Tables[0].length>0?a.Tables[0][0]:a.Tables[1][0],40054==parseInt(u.CostCenterID)){const{MonthlyPayrollComponent:s}=yield Promise.resolve().then(f.bind(f,27953)),{MonthlyPayrollViewModel:m}=yield Promise.resolve().then(f.bind(f,53401));i.oDocPayroll=new m(u.DocumentName.toString(),"",u.VoucherNo.toString()),I.d.page.addNewTab({title:u.DocumentName.toString(),component:s,params:{obj:i.oDocPayroll}})}else if(40095==parseInt(u.CostCenterID)){const{FinalSettlementComponent:s}=yield Promise.resolve().then(f.bind(f,31623)),{FinalSettlementViewModel:m}=yield Promise.resolve().then(f.bind(f,47853));i.oDocPayroll=new m(u.DocumentName.toString(),u.VoucherNo.toString()),I.d.page.addNewTab({title:u.DocumentName.toString(),component:s,params:{obj:i.oDocPayroll}})}else{const{AddEditDocumentComponent:s}=yield Promise.resolve().then(f.bind(f,19214)),{AddEditDocumentViewModel:m}=yield Promise.resolve().then(f.bind(f,32668));let D=new m(parseInt(u.CostCenterID),u.DocumentName.toString(),!0);D.ScreenObject.DocPrefix.ComboBox.SelectedValue=u.DocPrefix.toString(),D.ScreenObject.DocPrefix.TextBox.Text=u.DocNumber.toString(),D.OnDocPrefixChanged("lostFocus"),D.ScreenObject.FillDocumentPrefix(!0),I.d.page.addNewTab({component:s,params:{obj:D}})}}}})()}onDimClick(l){if(t.J0.IsEmpty(this.dimfield)&&(this.dimfield=this.PrimaryKey),null!=this.EditGrid.SelectedItem&&this.EditGrid.TableColumns.Contains(this.dimfield)){this.EditGrid.TableColumns.Contains(l)&&(l=this.EditGrid.SelectedItem[l].toString());let i=new ne.DocumentViewerViewModel;i.DocumentViewerViewModel_ByVoucherNo_3(l,parseInt(t.J0.IsEmpty(this.EditGrid.SelectedItem[this.dimfield])?"0":this.EditGrid.SelectedItem[this.dimfield]),this.CostCenterID),i.IsDocumentFound?I.d.page.addNewTab({component:K.DocumentViewerComponent,params:{obj:i}}):(i.DocumentViewerViewModel_ByVoucherNo_3(l,0,this.CostCenterID),i.IsDocumentFound&&I.d.page.addNewTab({component:K.DocumentViewerComponent,params:{obj:i}}))}}onAttachClick(l){return(0,w.A)(function*(){if(null!=(l=l.command)){let i=t.J0.GetPath(l);I.d.IsMobile&&I.d.IsNativeMobile?yield se.P.open({url:i,isPDF:!1,isExport:!1}):window.open(i)}})()}InitReport(){let l=new G.ReportViewModel;l.ReportViewModel_1(this.ReportID,null!=this.DB,!0),this.ReportObj=l,this.ReportObj.ScreenName="BULK",this.ReportObj.BulkEdit=this,this.Report.push(this.ReportObj),this.ReportFilterVisible=!this.HideFilterDialog}OnButtonClick(l){if(this.DisplayMessage="","Save"==l){if(null==this.EditGrid.Table)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4?this.SaveDocument(i):this.SaveDimension(i),this.DisplayMessage=95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID?"Saved successfully":"Posting Completed"}else if("Delete"==l){if(!this.DeleteVisibility)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");if(!confirm("Do you want to delete selected rows?"))return;this.CostCenterID>4e4&&this.CostCenterID<5e4||this.DeleteDimension(i)}else if("ShowAssigningUser"==l){if(this.strOldUserID.length<=0)return void(this.DisplayMessage="Please select user from filter before transfer");this.TranserUserVisiblity=!0,I.d.page.ShowDialog(this,ie.s,{ShowCenter:!1,HideClose:!0,NoWidth:!0,Title:"Transer User"})}else if("HideAssignUserPanel"==l)this.TranserUserVisiblity=!1,I.d.page.HideDialog(this.PopUpGUID);else if("TransferUser"==l){if(this.intLinkDimCC>0){if(null==this.EditGrid.Table)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");if(this.strOldUserID.length<=0)return void(this.DisplayMessage="Please select the before transfer");if(0==this.TargetUserID.SelectedValue)return void(this.DisplayMessage="Please select the user before transfer");if(t.J0.IntTryParse(this.strOldUserID.toString())==this.TargetUserID.SelectedValue)return void(this.DisplayMessage="Both Users are same");this.TransferUsers(i)}}else if("BACK"==l)this.EditGrid.Visible=!0;else if("OK"==l)this.EditGrid.Visible=!0,this.Filter.FilterGrid.commitEdit(),this.RefreshData();else if("Filter"==l)this.EditGrid.Visible=!1,this.Report.length>0&&(this.Report[0].ShowFilter=!0,this.ReportFilterVisible=!0);else if("Refresh"==l)this.Report.length>0?this.Report[0].Refresh():this.RefreshData();else if("Import"==l){let i=[];this.DtImport=[];let r=new M.O7;r.DisplayMember="FieldName",r.Header=I.d.GetResource("Import_FieldName"),r.DataType="TextBlock",r.Width=100,r.ReadOnly=!0,i.push(r),this.DtImport.Columns.push("FieldName"),r=new M.O7,r.DisplayMember="Name",r.ValueMember="Value",r.ValueBinding="FeatureFieldName",r.Header=I.d.GetResource("Import_FeatureFieldName"),r.DataType="ComboBox",r.Width=120;let a=new Array;a.push(B._p.ComboBoxItems_2("","")),this.EditGrid.Columns.forEach(u=>{null!=u.ID&&"DocDate"!=u.ID&&a.push(B._p.ComboBoxItems_2(u.Header,u.ID))}),r.ComboData=a,i.push(r),this.DtImport.Columns.push("FeatureFieldName"),this.IsImport=!0,this.ImportCols=i,this.ImportVisiblity=!0,this.ProductImageVisibility=!1,this.ExportVisibility=!1}else if("openfile"!=l)if("ImportOK"==l)null!=this.ExcelTable&&this.ExcelTable.length>0&&this.importWorker_DoWork(null,null);else if("ImportCancel"==l)this.ImportVisiblity=!1,3==this.CostCenterID&&!this.HideProductImage&&(this.ProductImageVisibility=!0);else if("PopUp"==l);else if("Approve"==l)this.ShowRightPanel=!0,this.ProductImageVisibility=!1,this.ReplaceVisibility=!1,this.ApproveVisibility=!0,this.AppDisplayMessage="",this.AppMessageVisibility=!1,this.Remarks.Text="",this.ExportVisibility=!1,I.d.page.ShowDialog(this,q,{ShowCenter:!0,HideClose:!0,NoWidth:!0,Title:I.d.GetResource("ApproveReject")});else if("CancelAction"==l)this.ApproveVisibility=!1,I.d.page.HideDialog(this.PopUpGUID),null!=this.DB&&(this.ShowRightPanel=!1);else if("Barcode"==l){if(null==this.EditGrid.Table)return;let i=this.EditGrid.Table.filter(r=>1==r.Select||1==r.Select);if(0==i.length)return void(this.DisplayMessage="No Rows Selected");this.CostCenterID>4e4&&this.CostCenterID<5e4&&this.BarcodeDocument(i)}else if("Export"==l)this.ExportVisibility=!0,this.ImportVisiblity=!1,this.ProductImageVisibility=!1,this.TranserUserVisiblity=!1;else if("CancelExport"==l)this.ExportVisibility=!1;else if("ExportData"==l){let r,i=new G.ReportViewModel;this.VoucherColumns=new Array,this.HeaderAppearance.Alignment="Left",this.HeaderAppearance.FontSize=12,this.HeaderAppearance.IsBold=!0,this.HeaderAppearance.BackColor="White",this.HeaderAppearance.ForeColor="Black",this.TextDataAppearance.Alignment="Left",this.TextDataAppearance.FontSize=12,this.TextDataAppearance.BackColor="White",this.TextDataAppearance.ForeColor="Black",this.NumberDataAppearance.Alignment="Right",this.NumberDataAppearance.FontSize=12,this.NumberDataAppearance.BackColor="White",this.NumberDataAppearance.ForeColor="Black";for(let D=0;D<this.EditGrid.Columns.length;D++)t.J0.IsEmpty(this.EditGrid.Columns[D].ID)||(r=this.GetColumn(this.EditGrid.Columns[D].DisplayMember,this.EditGrid.Columns[D].Header,this.EditGrid.Columns[D].DataType,this.TextDataAppearance,100),r.HeaderText=this.EditGrid.Columns[D].Header,null!=this.EditGrid.Columns[D].DataType&&"float"==this.EditGrid.Columns[D].DataType.toLowerCase()&&(r.DataFormat.DecimalsPoints=parseInt(this.EditGrid.Columns[D].DecimalPoints)),this.VoucherColumns.push(r));this.VoucherData.Clear(),this.EditGrid.Table.forEach(D=>{this.oRow=new O.Ji(this.VoucherColumns.length,22),this.oRow.Height=22;for(let o=0;o<this.VoucherColumns.length;o++){let d=this.VoucherColumns[o];t.J0.IsEmpty(D[d.ID])||G.ReportViewModel.SetCellValue(D[d.ID],d.DataFormat,d.ColumnType,-1,this.oRow.Cells[o],d.ID)}this.VoucherData.push(this.oRow)}),i.ReportColumns=this.VoucherColumns,i.Data=this.VoucherData,i.ScreenName=this.Title,i.SaveXLS=this.SaveXLS,i.SavePDF=this.SavePDF,i.SaveXLSX=this.SaveXLSX;let a=[],u={},m="<RptBody><LevelTree>None</LevelTree><LevelNo>10</LevelNo><_ColumnHeaderFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_ColumnHeaderFontStream><_GroupFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_GroupFontStream><_SubTotalFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_SubTotalFontStream><_GrandTotalFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</_GrandTotalFontStream><BodyHeaderHeight>50</BodyHeaderHeight><ShowHeaderBackColors>true</ShowHeaderBackColors><ShowBodyHorizontalLines>true</ShowBodyHorizontalLines><ShowBodyVerticalLines>true</ShowBodyVerticalLines><ShowBodyBorders>false</ShowBodyBorders><ShowBodyBackColors>true</ShowBodyBackColors><CenterOnPage>false</CenterOnPage><VerticalAlignment>Center</VerticalAlignment><BodyPosition>Fixed</BodyPosition><BodyBottom>Fixed</BodyBottom><BodyHeight>800</BodyHeight><LeftMargin>15</LeftMargin><PageWidth>829</PageWidth><IsLandscape>false</IsLandscape><IgnoreBody>false</IgnoreBody><ReportHeaderHeight>101</ReportHeaderHeight><PageHeaderHeight>5</PageHeaderHeight><PageFooterHeight>5</PageFooterHeight><ReportFooterHeight>10</ReportFooterHeight><PageHeaderPosition>Fixed</PageHeaderPosition><ShowReportHeader>FirstPage</ShowReportHeader><ShowPageHeader>EveryPage</ShowPageHeader><ReportFooterPosition>Fixed</ReportFooterPosition><PageFooterPosition>Fixed</PageFooterPosition><ShowReportFooter>LastPage</ShowReportFooter><ShowPageFooter>EveryPage</ShowPageFooter><BodyFontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAAEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</BodyFontStream></RptBody>\x01<VPText><Text>@@DATE@@</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>18</Height></Size><Left>99</Left><Top>35</Top><LineSpacing>0</LineSpacing></VPText>\x11<VPText><Text>@@AccountName@@</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>700</Width><Height>18</Height></Size><Left>100</Left><Top>75</Top><LineSpacing>0</LineSpacing></VPText>\x11<VPText><Text>##Account Name :##</Text><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAEEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAAAAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>97</Width><Height>18</Height></Size><Left>2</Left><Top>75</Top><LineSpacing>0</LineSpacing></VPText>\x12<VPVar><_DataSource>ReservedWords</_DataSource><_SysColumn>ReportTitle</_SysColumn><ROff>0</ROff><Decimals>2</Decimals><DateFormat>dd MMM yyyy</DateFormat><Commas>Million</Commas><InWords>false</InWords><UseOnce>false</UseOnce><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAAVBcmlhbAAAQEEF/P///xhTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABfv///8bU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAs=</FontStream><Alignment>TopLeft</Alignment><SupressZero>false</SupressZero><SupressFractionZero>false</SupressFractionZero><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>25</Height></Size><Left>2</Left><Top>45</Top><LineSpacing>0</LineSpacing><DataSource>ReservedWords</DataSource><SysColumn>ReportTitle</SysColumn><UniqueID>C1</UniqueID></VPVar>\x11<VPVar><_DataSource>ReservedWords</_DataSource><_SysColumn>CompanyName</_SysColumn><ROff>0</ROff><Decimals>2</Decimals><DateFormat>dd MMM yyyy</DateFormat><Commas>Million</Commas><InWords>false</InWords><UseOnce>false</UseOnce><FontStream>AAEAAAD/////AQAAAAAAAAAMAgAAAFFTeXN0ZW0uRHJhd2luZywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWIwM2Y1ZjdmMTFkNTBhM2EFAQAAABNTeXN0ZW0uRHJhd2luZy5Gb250BAAAAAROYW1lBFNpemUFU3R5bGUEVW5pdAEABAQLGFN5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZQIAAAAbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0AgAAAAIAAAAGAwAAAA9UaW1lcyBOZXcgUm9tYW4AAIBBBfz///8YU3lzdGVtLkRyYXdpbmcuRm9udFN0eWxlAQAAAAd2YWx1ZV9fAAgCAAAAAQAAAAX7////G1N5c3RlbS5EcmF3aW5nLkdyYXBoaWNzVW5pdAEAAAAHdmFsdWVfXwAIAgAAAAMAAAAL</FontStream><Alignment>TopLeft</Alignment><SupressZero>false</SupressZero><SupressFractionZero>false</SupressFractionZero><FieldAlignment>None</FieldAlignment><PrintAt>Default</PrintAt><Size><Width>800</Width><Height>30</Height></Size><Left>2</Left><Top>5</Top><LineSpacing>0</LineSpacing><DataSource>ReservedWords</DataSource><SysColumn>CompanyName</SysColumn><UniqueID>C2</UniqueID></VPVar>".split("\x01");m[1]=m[1].Replace("@@AccountName@@",t.J0.EncodeXML(this.Title).TrimStart("[").TrimEnd("]")),m[1]=m[1].Replace("##Account Name :##","Document Name :"),m[1]=m[1].Replace("@@DATE@@",""),u.ReportName=this.Title,u.ReportBody=m[0],u.ReportHeader=m[1].Replace("@@AccountName@@",t.J0.EncodeXML(this.Title).TrimStart("[").TrimEnd("]")),u.PageHeader=m[2],u.PageFooter=m[3],u.ReportFooter=m[4],a.push(u),i.Reportds={},i.Reportds.Tables=[],i.Reportds.Tables.push(a),i.IsExportFromOthers=!0,i.Export(),t.J0.IsEmpty(this.DisplayMessage)&&(this.DisplayMessage="Exported sucessfully")}}importWorker_DoWork(l,i){let r="",a=new P.bT,u=new Array,s=new Array,m=new Array;for(let o=0;o<this.DtImport.length;o++){const d=this.DtImport[o];if(""==t.J0.String(d[1])||"0"==t.J0.String(d[1]))continue;let e=this.EditGrid.Columns.find(n=>n.ID==d[1].toString());if(null!=e){if(null!=e&&"LISTBOX"==e.DataType&&!a.ContainsKey(e.CostCenterID)){for(let C=0;C<this.ExcelTable.length;C++)""!=r&&(r+=","),r+="'"+this.ExcelTable[C][d[0].toString()].toString().Trim().Replace("'","''")+"'";let n=this.GetCCValues(r,e.CostCenterID,this.ImportIsCode?1:0,"CreditAccount_Key"==e.ValueMember||"DebitAccount_Key"==e.ValueMember?" and IsGroup=0 ":"");a.push(e.CostCenterID,n)}e.ReadOnly?u.push(d[0].toString()):(s.push(d[0].toString()),m.push(d[1].toString()))}}if(u.length>0){let o=this.ExcelTable.ToTable(!0,u);if(null!=o&&o.length>0){let h,d="",e="",n="",C="";for(let g=0;g<o.length;g++){e="",n="";for(let c=0;c<o.Columns.length;c++)e.length>0&&(e+=" AND "),e+=" ["+o.Columns[c].toString()+"]='"+o.Rows[g][c].toString()+"' ",n.length>0&&(n+=" AND "),d=this.DtImport.filter(S=>S.FieldName==o.Columns[c].toString())[0].FeatureFieldName.toString(),n+=" "+d+"='"+o[g][c].toString()+"' ";if(e.Trim().length>0){let c=[],S=[];if(null!=S&&S.length>0)for(let A=0;A<S.length;A++)for(let b=0;b<m.length;b++){var D=this.EditGrid.Columns.find(y=>y.ID==m[b]);null!=D&&(null!=D.DataType&&D.CostCenterID>0&&"LISTBOX"==D.DataType?(C="",C=this.ImportIsCode?"Code='"+c[0][s[b]]+"'":"Name='"+c[0][s[b]]+"'",h=a[D.CostCenterID].Select(C),null!=h&&h.length>0&&(S[A][D.DisplayMember+"_Key"]=h[0].ID,S[A][D.DisplayMember]=c[0][s[b]])):null!=D.DataType&&"COMBOBOX"==D.DataType.toUpperCase()?S[A][D.ValueBinding]=c[0][s[b]]:(null!=D.DataType&&"DATE"==D.DataType.toUpperCase()&&!t.J0.StringIsNullOrEmpty(c[0][s[b]].toString())&&(S[A][D.DisplayMember+"_Key"]=c[0][s[b]]),S[A][D.DisplayMember]=c[0][s[b]])),this.EditGrid.updateRow(S)}}}this.EditGrid.RefreshGrid=!0,this.DisplayMessage="Imported successfully.",this.MessageVisibility=!0}}else this.DisplayMessage="No column selected as readonly",this.MessageVisibility=!0}GetCCValues(l,i,r,a=""){Logger.InfoLog("Voucher Generator:: Inside GetCCValues");let u=[],s="";1==r?3==i?s="ProductCode":2==i?s="AccountCode":i>5e4&&(s="Code"):2==r?3==i?s="ProductID":2==i?s="AccountID":i>5e4&&(s="NodeID"):3==i?s="ProductName":2==i?s="AccountName":i>5e4&&(s="Name"),3==i?u.push("Select ProductID ID,ProductCode Code,ProductName name from inv_product WITH(NOLOCK) where "+s+" in("+l+")"):2==i?u.push("Select AccountID ID,AccountCode Code,AccountName name from Acc_Accounts WITH(NOLOCK) where "+s+" in("+l+")"+a):11==i?u.push("Select uomid ID,UNITNAME Code,UNITNAME name,ProductID from COM_UOM WITH(NOLOCK) where UNITNAME in("+l+")"):50051==i?u.push("Select NodeID ID,Code,name from "+this.GetTableName(i)+" WITH(NOLOCK) where (Code in("+l+") or Name in ("+l+"))"):i>5e4&&u.push("Select NodeID ID,Code,name from "+this.GetTableName(i)+" WITH(NOLOCK) where "+s+" in("+l+")"),u.push(I.d.SessionManager.UserID),u.push(I.d.SessionManager.LanguageID);let m=I.d.document.GetCCValues(l,i,r,a);return Logger.InfoLog("Voucher Generator: DBH.GetCCValues "),null!=m&&m.Tables.length>0?m.Tables[0]:null}GetTableName(l){return 2==l?"ACC_Accounts":3==l?"INV_Product":50001==l?"COM_Division":50002==l?"COM_Location":50003==l?"COM_Branch":50004==l?"COM_Department":50005==l?"COM_Salesman":50006==l?"COM_Category":50007==l?"COM_Area":50008==l?"COM_Teritory":"COM_CC"+l}RefreshData(){if(this.DisplayMessage="",2==this.CostCenterID?(this.PrimaryKey="AccountID",this.PrimaryColumns="D.AccountID,D.AccountCode,D.AccountName,D.AccountTypeID,D.IsGroup,D.StatusID,D.GUID"):3==this.CostCenterID?(this.PrimaryKey="ProductID",this.PrimaryColumns="D.ProductID,D.ProductCode,D.ProductName,D.ProductTypeID,D.GUID"):16==this.CostCenterID?(this.PrimaryKey="BatchID",this.PrimaryColumns="D.BatchID,D.BatchCode,D.BatchNumber, CONVERT(DATETIME,D.MfgDate) MfgDate, D.ProductID,CONVERT(DATETIME, D.ExpiryDate) ExpiryDate, D.MRPRate, D.RetailRate, D.StockistRate,CONVERT(DATETIME, D.RetestDate) RetestDate, D.GUID"):this.CostCenterID>5e4?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.NodeID,D.Code,D.Name,D.StatusID,D.GUID"):92==this.CostCenterID?(this.PrimaryKey="NodeID",this.PrimaryColumns="D.*"):93==this.CostCenterID?(this.PrimaryKey="UnitID",this.PrimaryColumns="D.*"):94==this.CostCenterID?(this.PrimaryKey="TenantID",this.PrimaryColumns="D.*"):95==this.CostCenterID||104==this.CostCenterID?(this.PrimaryKey="ContractID",this.PrimaryColumns="D.ContractID,D.SNO,D.ContractNumber,D.StatusID,D.GUID"):103==this.CostCenterID||129==this.CostCenterID?(this.PrimaryKey="QuotationID",this.PrimaryColumns="D.QuotationID,D.SNO,D.Number,D.StatusID,D.GUID"):(this.PrimaryKey=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",this.PrimaryColumns=this.IsDetailVoucher?0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"D.AccDocDetailsID,D.VoucherNo":"D.InvDocDetailsID,D.VoucherNo":"D.VoucherNo"),this.Report.length>0)return this.ReportFilterVisible=!1,this.EditGrid.Visible=!0,void this.LoadDataFromReport();let a,u,s,m,l="",i="",D=0,d="";this.Entities.Clear(),this.Entities.push(this.MainTableName,"D"),l+=this.PrimaryColumns,i+=this.MainTableName+" D with(nolock)",this.SelectedFields.forEach(C=>{if(s="T"+D,u=t.J0.String(C.SysTableName),a=t.J0.String(C.SysColumnName),2==this.CostCenterID||3==this.CostCenterID||16==this.CostCenterID||92==this.CostCenterID||93==this.CostCenterID||94==this.CostCenterID||95==this.CostCenterID||103==this.CostCenterID||104==this.CostCenterID||129==this.CostCenterID||this.CostCenterID>=50001)if(u=u.toUpperCase(),0==t.J0.stringCompare(u,"ACC_ACCOUNTSEXTENDED")||0==t.J0.stringCompare(u,"INV_PRODUCTEXTENDED")||0==t.J0.stringCompare(u,"REN_PROPERTYEXTENDED")||0==t.J0.stringCompare(u,"REN_UNITSEXTENDED")||0==t.J0.stringCompare(u,"REN_TENANTEXTENDED")||0==t.J0.stringCompare(u,"REN_CONTRACTEXTENDED")||0==t.J0.stringCompare(u,"REN_QUOTATIONEXTENDED"))if(this.Entities.ContainsKey(u)||(this.Entities.push(u,"EXT"),i+=95==this.CostCenterID||104==this.CostCenterID?" INNER JOIN "+u+" EXT with(nolock) ON EXT.NODEID=D."+this.PrimaryKey:" INNER JOIN "+u+" EXT with(nolock) ON EXT."+this.PrimaryKey+"=D."+this.PrimaryKey),a="EXT."+a,"DATE"==t.J0.String(C.ColumnDataType))a="convert(datetime,"+a+")",l+=",'' AS C"+D,l+=","+a+" AS C"+D+"_Key";else if("LISTBOX"==t.J0.String(C.UserColumnType)){let h;if("44"==t.J0.String(C.ColumnCostCenterID))h=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+a+") else '' end";else{let g=I.d.report.GetTableColumns(parseInt(C.ColumnCostCenterID));h=g.ColumnName,m=g.PrimaryKey,u=g.TableName,h=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT "+h+" FROM "+u+" with(nolock) WHERE "+m+"="+a+") else '' end"}l+=h+" AS C"+D,l+=",case when isnumeric("+a+")=1 then "+a+" else convert(bigint,-1) end AS C"+D+"_Key"}else l+=","+a+" AS C"+D;else 0==t.J0.stringCompare(u,"COM_CCCCDATA")?(this.Entities.ContainsKey("COM_CCCCDATA")||(this.Entities.push("COM_CCCCDATA","CCDATA"),i+=" INNER JOIN COM_CCCCData CCDATA with(nolock) ON CCDATA.NodeID=D."+this.PrimaryKey+" AND CCDATA.CostCenterID="+this.CostCenterID),this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.GetTagTableName(parseInt(C.ParentCostCenterID))+" "+s+" with(nolock) ON "+s+".NodeID=CCDATA."+a),l+=","+this.Entities[a]+".Name AS C"+D,l+=",CCDATA."+a+" AS C"+D+"_Key"):0==t.J0.stringCompare(u,"COM_ADDRESS")?(this.Entities.ContainsKey("COM_ADDRESS")||(this.Entities.push("COM_ADDRESS","CCADD"),l+=",CCADD.AddressID",i+=" INNER JOIN COM_ADDRESS CCADD with(nolock) ON CCADD.AddressTypeID=1 and CCADD.FeaturePK=D."+this.PrimaryKey+" AND CCADD.FeatureID="+this.CostCenterID),l+=",CCADD."+a+" C"+D):null!=C.IsForeignKey&&(0,R.yG0)(C.IsForeignKey)?(this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.String(C.ParentCostCenterSysName)+" "+this.Entities[a]+" with(nolock) ON "+this.Entities[a]+"."+t.J0.String(C.ParentCostCenterColSysName)+"=D."+a),l+=","+this.Entities[a]+"."+this.GetColumnName(C)+" AS C"+D,l+=",D."+a+" AS C"+D+"_Key"):"Attachments"==a?(l+=",stuff((select ','+[GUID]+'.'+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.CostCenterID+" AND FeaturePK=D."+this.PrimaryKey+" FOR XML PATH('')),1,1,'') AS C"+D+"_ID",l+=",stuff((select ', '+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID="+this.CostCenterID+" AND FeaturePK=D."+this.PrimaryKey+" FOR XML PATH('')),1,2,'') AS C"+D):"RentAmount"==a&&95==this.CostCenterID?l+=",FORMAT(isnull((select sum(RentAmount) from REN_ContractParticulars WITH(NOLOCK) where contractid=D.ContractID  and CCNodeID=3 ),0),'N0') AS C"+D:(a="D."+a,"DATE"==t.J0.String(C.ColumnDataType)?(a="convert(datetime,"+a+")",l+=",'' AS C"+D,l+=","+a+" AS C"+D+"_Key"):(("D.IsBillwise"==a||"D.Status"==a)&&(a="convert(int,"+a+")"),l+=","+a+" AS C"+D));else if(this.CostCenterID>4e4)if(0==t.J0.stringCompare(u,"COM_DocTextData"))if(this.Entities.ContainsKey("COM_DocTextData")||(this.Entities.push("COM_DocTextData","TXT"),i+=" INNER JOIN COM_DocTextData TXT with(nolock) ON TXT."+this.PrimaryKey+"=D."+this.PrimaryKey),d="TXT."+a,a=this.GetMaxColumn("TXT."+a,t.J0.String(C.ColumnDataType)),"DATE"==t.J0.String(C.ColumnDataType))l+=",'' AS C"+D,l+=",case when isdate("+a+")=1 then convert(datetime,"+a+") else null end AS C"+D+"_Key";else if("LISTBOX"==t.J0.String(C.UserColumnType)){let h;if("44"==t.J0.String(C.ColumnCostCenterID))h=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+a+") else '' end";else{let g=I.d.report.GetTableColumns(parseInt(C.ColumnCostCenterID));h=g.ColumnName,m=g.PrimaryKey,u=g.TableName,h=",case when "+a+" is not null and isnumeric("+a+")=1 then (SELECT "+h+" FROM "+u+" with(nolock) WHERE "+m+"="+a+") else '' end"}l+=h+" AS C"+D,l+=",case when isnumeric("+a+")=1 then "+a+" else convert(bigint,-1) end AS C"+D+"_Key"}else"LOOKUP"==t.J0.String(C.UserColumnType)?(l+=","+a+" AS C"+D,l+=","+a+" AS C"+D+"_Key"):"FLOAT"==t.J0.String(C.ColumnDataType)?l+=",case when isnumeric("+a+")=1 then convert(float,"+a+") else null end AS C"+D:l+=","+a+" AS C"+D;else 0==t.J0.stringCompare(u,"COM_DocNumData")?(this.Entities.ContainsKey("COM_DocNumData")||(this.Entities.push("COM_DocNumData","NUM"),i+=" INNER JOIN COM_DocNumData NUM with(nolock) ON NUM."+this.PrimaryKey+"=D."+this.PrimaryKey),a=this.GetMaxColumn("NUM."+a,t.J0.String(C.ColumnDataType)),l+=","+a+" AS C"+D):0==t.J0.stringCompare(u,"COM_DocCCData")?(this.Entities.ContainsKey("COM_DocCCData")||(this.Entities.push("COM_DocCCData","DCC"),m=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",i+=" INNER JOIN COM_DocCCData DCC with(nolock) ON DCC."+m+"=D."+m),this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.GetTagTableName(parseInt(C.ParentCostCenterID))+" "+s+" with(nolock) ON "+s+".NodeID=DCC."+a),"YES"==t.J0.String(C.ShowCode)?l+=","+this.GetMaxColumn(this.Entities[a]+".Code","")+" AS C"+D:l+=","+this.GetMaxColumn(this.Entities[a]+".Name","")+" AS C"+D,l+=","+this.GetMaxColumn("convert(bigint,DCC."+a,"")+") AS C"+D+"_Key"):null!=C.IsForeignKey&&(0,R.yG0)(C.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(a)?(this.Entities.ContainsKey(a)||(this.Entities.push(a,s),i+=" INNER JOIN "+t.J0.String(C.ParentCostCenterSysName)+" "+this.Entities[a]+" with(nolock) ON "+this.Entities[a]+"."+t.J0.String(C.ParentCostCenterColSysName)+"=D."+a,!t.J0.IsEmpty(C.ParentCostCenterSysName)&&"inv_product"==t.J0.String(C.ParentCostCenterSysName).toLowerCase()&&(this.IsProductExists=!0)),l+=","+this.GetMaxColumn(this.Entities[a]+"."+this.GetColumnName(C),"")+" AS C"+D,l+=","+this.GetMaxColumn("D."+a,"")+" AS C"+D+"_Key"):("DebitAmount"==a||"CreditAmount"==a?a=this.GetMaxColumn("case when D."+a.Replace("Amount","Account")+">0 then D.Amount else 0 end",t.J0.String(C.ColumnDataType)):t.J0.IsEmpty(C.ColumnDataType)||"listbox"!=C.ColumnDataType.toString().toLowerCase()||"Unit"!=a?a=this.GetMaxColumn("D."+a,t.J0.String(C.ColumnDataType)):(i+=" INNER JOIN  COM_UOM UM with(nolock) ON UM.UOMID=D."+a,a=this.GetMaxColumn("D."+a,C.ColumnDataType.toString()),a=a.Replace("D.Unit","UM.UnitName")),"DATE"==t.J0.String(C.ColumnDataType)?(a="convert(datetime,"+a+")",l+=",'' AS C"+D,l+=","+a+" AS C"+D+"_Key"):l+=","+a+" AS C"+D);D++}),(3==this.CostCenterID||this.IsProductExists)&&!this.HideProductImage&&(this.ImportVisiblity||(this.ProductImageVisibility=!0),this.ReplaceVisibility=!1,this.ApproveVisibility=!1,l+=this.IsDetailVoucher||3==this.CostCenterID?",f.GUID FileGUID, f.FileExtension FileExtension":",max(f.GUID) FileGUID, max(f.FileExtension) FileExtension",i+=" left join com_files f with(nolock) on F.featureid=3 and featurepk=d.productid  and f.isProductImage=1 and f.isDEfaultImage=1 "),this.IsDocument&&this.CostCenterID>4e4&&this.CostCenterID<5e4&&(l+=",DID.GUID GUID",i+=" Left Join Com_DOCID DID with(nolock) on DID.ID = D.DocID"),this.IsDocument&&this.IsLWApproval&&(l+=",D.WorkflowID"),l="SELECT "+l,l+=" FROM "+i.toString(),l+=" ^",this.CostCenterID>4e4&&this.CostCenterID<5e4&&(l+=" AND D.CostCenterID="+this.CostCenterID,this.FromDate.Visible&&(l+=" AND D.DocDate>=convert(float,convert(datetime,'"+this.FromDate.Date.ToString("dd MMM yyyy")+"'))",l+=" AND D.DocDate<=convert(float,convert(datetime,'"+this.ToDate.Date.ToString("dd MMM yyyy")+"'))"));let e=this.StaticFilter.GetWhere(i,100).Trim();e.length>0&&(l+=" AND ("+e+")");let n=this.Filter.GetWhere(i,500).Trim();n.length>0&&(l+=" AND ("+n+")"),2==this.CostCenterID?l+=" ORDER BY D.AccountName":3==this.CostCenterID?l+=" ORDER BY D.ProductName":16==this.CostCenterID?l+=" ORDER BY D.BatchNumber":92==this.CostCenterID||93==this.CostCenterID?l+=" ORDER BY D.Name":94==this.CostCenterID?l+=" ORDER BY D.FirstName":this.CostCenterID>=50001?l+=" ORDER BY D.Name":this.CostCenterID>4e4&&(this.IsDetailVoucher?l+=" ORDER BY D.DocDate,D.VoucherNo,D.DocSeqNo":(l+=" GROUP BY D.DocDate,D.VoucherNo,DID.GUID",l+=" ORDER BY D.DocDate,D.VoucherNo"));try{this.EditGrid.Clear(),l.length>0&&(this.strWhereforAuctionHistory=" WHERE 1=1 "+l.split("^")[1],this.strWhereforAuctionHistory=this.strWhereforAuctionHistory.Replace("'",""),this.strWhereforAuctionHistory=this.strWhereforAuctionHistory.Replace("%","~")),l=l.Replace("^"," WHERE 1=1"),l=l.Replace("%","~");let h,g,C=I.d.common.GetDataSetQuery(l.toString());C.Columns[0].push("Select"),C.Columns[0].push("Message"),C.Tables[0].forEach(c=>{c.Select=!1,this.DateColIDs.forEach(S=>{h=S+"_Key",!t.J0.IsEmpty(c[h])&&c[h].toString().length>0&&(g=t.J0.ParseDate(c[h]),c[S]=g.ToString(I.d.SessionManager.Preferences["Date Format"]))})});for(let c=0;c<C.Tables[0].length;c++)C.Tables[0][c].id=c+1;this.EditGrid.Table.AddRange(C.Tables[0]),C.Columns&&C.Columns.length>0&&(this.EditGrid.TableColumns=C.Columns[0]),this.EditGrid.refreshDataView()}catch(C){this.DisplayMessage="Error in loading data",Logger.ErrorLog("Bulk Edit-RefreshData:",C.Message)}}ShowEditGrid(){this.ReportFilterVisible=!1,this.EditGrid.Visible=!0}LoadDataFromReport(){if(this.cprimary=null,this.EditGrid.Clear(),this.IsDocument){if(this.EditGrid.TableColumns.Contains("Message")||(this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.EditGrid.TableColumns.Contains("GUID")||this.EditGrid.TableColumns.push("GUID"),this.IsDetailVoucher?(this.cprimary=this.Report[0].BaseReportColumns.find(o=>"2"==o.LinkType.SelectedValue),this.EditGrid.TableColumns.Contains("ReportPK")||this.EditGrid.TableColumns.push("ReportPK"),this.IsLWApproval&&!this.EditGrid.TableColumns.Contains("WorkFlowID")&&this.EditGrid.TableColumns.push("WorkFlowID")):this.cprimary=this.Report[0].BaseReportColumns.find(o=>"1"==o.LinkType.SelectedValue||"2"==o.LinkType.SelectedValue),null==this.cprimary||null==this.cprimary)return void(this.DisplayMessage="Please set voucher no column link type as "+(this.IsDetailVoucher?"'Document Detail'":"'Document'"));var i=this.EditGrid.Columns.find(o=>o.OPParams==this.cprimary.ID);if(null==i&&null==i)return void(this.DisplayMessage="Please select voucher no column");this.strVoucherNo=i.SectionName}else if(this.EditGrid.TableColumns.Contains("ReportPK")||(this.EditGrid.TableColumns.push("ReportPK"),this.EditGrid.TableColumns.push("Select"),this.EditGrid.TableColumns.push("Message")),this.cprimary=this.Report[0].BaseReportColumns.find(o=>(o.CDGDO.CategoryValue==this.CostCenterID||o.CDGDO.ColumnCostCenterID==this.CostCenterID||null!=o.CDGDO.ChildCDGDO&&o.CDGDO.ChildCDGDO.CategoryValue==this.CostCenterID)&&("3"==o.LinkType.SelectedValue||"4"==o.LinkType.SelectedValue)),null==this.cprimary)return void(this.DisplayMessage="Please set dimension column link type");let r,a,u=new P.bT,s=new P.bT;for(let o=0;o<this.EditGrid.Columns.length;o++){const d=this.EditGrid.Columns[o];if(null==d.OPParams)continue;let e=this.Report[0].BaseReportColumns.find(n=>n.ID==d.OPParams);null!=e&&s.push(d.OPParams,e)}for(let o=0;o<this.Report[0].Data.length;o++){const d=this.Report[0].Data[o];if(d.Type==O.QS.Detail){a=this.EditGrid.NewRow(),a.Select=!1,null!=d.DataRow&&this.EditGrid.TableColumns.Contains("ReportPK")&&null!=d.DataRow[this.cprimary.ID+"_ID"]&&""!=t.J0.String(d.DataRow[this.cprimary.ID+"_ID"])&&(a.ReportPK=d.DataRow[this.cprimary.ID+"_ID"]),this.IsLWApproval&&(a.WorkFlowID=d.DataRow.WorkFlowID),null!=d.DataRow&&this.EditGrid.TableColumns.Contains("GUID")&&null!=d.DataRow&&null!=d.DataRow.GUID&&(a.GUID=d.DataRow.GUID),null!=this.Report[0].LevelColumn&&d.IsGroup&&(a.Row_Foreground=null);for(let e=0;e<this.EditGrid.Columns.length;e++){const n=this.EditGrid.Columns[e];if(null!=n.OPParams)if("LISTBOX"==n.DataType){if(null!=d.DataRow&&null!=d.DataRow[n.OPParams])if(a[n.DisplayMember]=d.DataRow[n.OPParams],null!=d.DataRow[n.OPParams+"_ID"])a[n.DisplayMember+"_Key"]=d.DataRow[n.OPParams+"_ID"];else if(u.ContainsKey(n.OPParams)||u.push(n.OPParams,new P.bT),u[n.OPParams].ContainsKey(t.J0.String(d.DataRow[n.OPParams])))a[n.DisplayMember+"_Key"]=u[n.OPParams][t.J0.String(d.DataRow[n.OPParams])];else if(this.dvFields=this.dvFieldsNew.filter(C=>C.CostCenterColID==n.CrRefID),this.dvFields.length>0){let h=I.d.common.GetDataSet3("BULK001",t.J0.String(this.dvFields[0].ParentCostCenterColSysName),t.J0.String(this.dvFields[0].ParentCostCenterSysName),t.J0.String(d.DataRow[n.OPParams])).Tables[0];h.length>0&&!t.J0.IsEmpty(h[0].ID)&&(u[n.OPParams].push(t.J0.String(d.DataRow[n.OPParams]),parseInt(h[0].ID)),a[n.DisplayMember+"_Key"]=u[n.OPParams][t.J0.String(d.DataRow[n.OPParams])])}}else if("DATE"==n.DataType)null!=d.DataRow&&null!=d.DataRow[n.OPParams]&&!t.J0.IsEmpty(d.DataRow[n.OPParams])&&t.J0.String(d.DataRow[n.OPParams]).length>0&&(r=t.J0.ParseDate(d.DataRow[n.OPParams]),a[n.DisplayMember]=r.ToString(I.d.SessionManager.Preferences["Date Format"]),a[n.DisplayMember+"_Key"]=r);else if("TIME"==n.DataType)null!=d.DataRow&&null!=d.DataRow[n.OPParams]&&!t.J0.IsEmpty(d.DataRow[n.OPParams])&&t.J0.String(d.DataRow[n.OPParams]).length>0&&(r=t.J0.ParseDate(d.DataRow[n.OPParams]),a[n.DisplayMember]=r.ToString("hh:mm:ss tt"),a[n.DisplayMember+"_Key"]=r);else if("ComboBox"==n.DataType){if(null!=d.DataRow&&null!=d.DataRow[n.OPParams])if("StatusID"==n.ID&&null!=n.ComboDataTable){let C=n.ComboDataTable.filter(h=>h[n.DisplayMember]==d.DataRow[n.OPParams]);C[n.ValueBinding]=C.length>0?C[0][n.ValueMember]:d.DataRow[n.OPParams]}else a[n.ValueBinding]=d.DataRow[n.OPParams]}else null!=d.DataRow&&null!=d.DataRow[n.OPParams]&&(a[n.DisplayMember]=d.DataRow[n.OPParams],this.EditGrid.TableColumns.Contains(n.DisplayMember+"_ID")&&Object.keys(d.DataRow).Contains(n.OPParams+"_ID")?a[n.DisplayMember+"_ID"]=d.DataRow[n.OPParams+"_ID"]:"MULTI_LINK"==n.DataType&&this.EditGrid.TableColumns.Contains(n.DisplayMember+"_ID")&&(a[n.DisplayMember+"_ID"]=d.DataRow[n.OPParams]))}this.EditGrid.addRow(a)}}}GetColumnName(l){let i,r;return i="parentid"==t.J0.String(l.SysColumnName).toLowerCase()?this.CostCenterID:parseInt(l.ColumnCostCenterID),r=t.J0.IntTryParse(t.J0.String(l.ParentCCDefaultColID)),2==i?238==r?"AccountCode":"AccountName":3==i?261==r?"ProductCode":"ProductName":93==i?25624==r?"Code":"Name":94==i?25697==r?"FirstName":"LastName":16==i?"BatchNumber":"Name"}GetMaxColumn(l,i){return this.IsDetailVoucher||(l="FLOAT"!=i||l.Contains("dcAlpha")||l.Contains("ExchangeRate")?"max("+l+")":"sum("+l+")"),l}SaveDocument(l){this.setActionHistroy("Save Document");let i,m,D,r="",a="",u="",s=0;D=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",m=null!=this.ReportObj?"ReportPK":D;let o=t.J0.NewGuid();l.forEach(d=>{if(s++,u="",a="",r="",this.EditColumns.forEach(e=>{"LISTBOX"==e.DataType&&0!=e.CostCenterID&&e.ID.toLowerCase().startsWith("dcccnid")?a+=e.ID+"="+t.J0.String(d[e.ValueMember])+",":e.IsColumnUserDefined?"SELECTIONBOX"==e.DataType?r+=e.ID+"=N'"+t.J0.String(d[e.DisplayMember]).Replace("'","''")+"',":e.DisplayMember.toLowerCase().Contains("dcnum")||("DATE"==e.DataType?t.J0.IsEmpty(d[e.DisplayMember+"_Key"])||(r+=e.ID+"='"+t.J0.ParseDate(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',"):"DATETIME"==e.DataType||"TIME"==e.DataType?t.J0.IsEmpty(d[e.DisplayMember+"_Key"])||(r+=e.ID+"='"+t.J0.ParseDate(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',"):r+="ComboBox"==e.DataType?e.ID+"=N'"+t.J0.String(d[e.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==e.DataType?e.ID+"=N'"+t.J0.String(d[e.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==e.DataType&&0!=e.CostCenterID?e.ID+"='"+t.J0.String(d[e.ValueMember]).Replace("'","''")+"',":e.ID+"=N'"+t.J0.String(d[e.DisplayMember]).Replace("'","''")+"',"):this.docAllowCols.Contains(e.ID.toLowerCase())&&("DATE"==e.DataType?t.J0.IsEmpty(d[e.DisplayMember+"_Key"])||(u+=e.ID+"=CONVERT(INT,CONVERT(DATETIME,'"+t.J0.ParseDate(d[e.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"')),"):u+=e.ID+"=N'"+t.J0.String(d[e.DisplayMember]).Replace("'","''")+"',")}),r.length>0||a.length>0||u.length>0){r.length>0&&(r=r.substr(0,r.length-1),r=r.Insert(0,"UPDATE TXT SET "),r+=" FROM "+this.MainTableName+" D WITH(NOLOCK) INNER JOIN COM_DocTextData TXT WITH(NOLOCK) ON D."+D+"=TXT."+D,this.IsDetailVoucher?(r+=" WHERE ",0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?r+="D.AccDocDetailsID="+t.J0.String(d[m]):r+="D.InvDocDetailsID="+t.J0.String(d[m])):r+=" WHERE D.VoucherNo='"+t.J0.String(d[this.strVoucherNo])+"'"),a.length>0&&(a=a.substr(0,a.length-1),a=a.Insert(0,"   UPDATE TXT SET "),a+=" FROM "+this.MainTableName+" D WITH(NOLOCK) INNER JOIN COM_DocCCData TXT WITH(NOLOCK) ON D."+D+"=TXT."+D,this.IsDetailVoucher?(a+=" WHERE ",0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?a+="D.AccDocDetailsID="+t.J0.String(d[m]):a+="D.InvDocDetailsID="+t.J0.String(d[m])):a+=" WHERE D.VoucherNo='"+t.J0.String(d[this.strVoucherNo])+"'"),r+=a.toString(),u.length>0&&(u=u.substr(0,u.length-1),u=u.Insert(0,"   UPDATE "+this.MainTableName+" SET "),this.IsDetailVoucher?(u+=" WHERE ",0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?u+="AccDocDetailsID="+t.J0.String(d[m]):u+="InvDocDetailsID="+t.J0.String(d[m])):u+=" WHERE VoucherNo='"+t.J0.String(d[this.strVoucherNo])+"'"),r+=u.toString();try{let n,e=null;n=s==l.length||t.J0.String(d[this.strVoucherNo])!=t.J0.String(l[s][this.strVoucherNo])?I.d.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,o,r.toString(),t.J0.String(d[this.strVoucherNo]),""):I.d.common.BulkEditDetals_7(7,this.ID,this.CostCenterID,o,r.toString(),"",""),e=n,i=t.J0.Int(n.obj),d.Message=i>0?"Success":e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("ServerMessage")?"Failure : "+t.J0.String(e.Tables[0][0].ServerMessage):e&&e.Tables.length>0&&e.Tables[0].length>0&&e.Columns[0].Contains("ErrorMessage")?"Failure : "+t.J0.String(e.Tables[0][0].ErrorMessage):"Failure",this.EditGrid.updateRow(d)}catch(e){Logger.ErrorLog("BulkEdit-SAVE: ",e.Message)}}else d.Message="NO DATA",this.EditGrid.updateRow(d)})}SaveDimension(l){var i=this;return(0,w.A)(function*(){i.setActionHistroy("Save Dimension");let r,a="",u="",s="",m="",D="";for(let d=0;d<l.length;d++){const e=l[d];if(u="",s="",m="",D="",i.EditColumns.forEach(n=>{"SELECTIONBOX"==n.DataType?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+t.J0.String(e[n.DisplayMember]).Replace("'","''")+"',":u+=n.ID+"='"+t.J0.String(e[n.DisplayMember]).Replace("'","''")+"',":"DATE"==n.DataType?t.J0.IsEmpty(e[n.DisplayMember+"_Key"])||(n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+t.J0.ParseDate(e[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',":16==i.CostCenterID&&(n.ID.Contains("MfgDate")||n.ID.Contains("ExpiryDate")||n.ID.Contains("RetestDate"))||(u+=n.ID+"='"+t.J0.ParseDate(e[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"DATETIME"==n.DataType||"TIME"==n.DataType?t.J0.IsEmpty(e[n.DisplayMember+"_Key"])||(n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+t.J0.ParseDate(e[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy hh:mm:ss tt")+"',":16==i.CostCenterID&&(n.ID.Contains("MfgDate")||n.ID.Contains("ExpiryDate")||n.ID.Contains("RetestDate"))||(u+=n.ID+"='"+t.J0.ParseDate(e[n.DisplayMember+"_Key"].toString()).ToString("dd/MMM/yyyy")+"',")):"ComboBox"==n.DataType?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+t.J0.String(e[n.ValueBinding]).Replace("'","''")+"',":u+=n.ID+"='"+t.J0.String(e[n.ValueBinding]).Replace("'","''")+"',":"PactComboBox"==n.DataType?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+t.J0.String(e[n.ValueBinding+"_Key"]).Replace("'","''")+"',":u+=n.ID+"='"+t.J0.String(e[n.ValueBinding+"_Key"]).Replace("'","''")+"',":"LISTBOX"==n.DataType&&0!=n.CostCenterID?n.ID.toLowerCase().Contains("alpha")?s+=n.ID+"='"+t.J0.String(e[n.ValueMember]).Replace("'","''")+"',":n.ID.toLowerCase().startsWith("ccnid")?m+=n.ID+"="+t.J0.String(e[n.ValueMember])+",":u+=n.ID+"="+t.J0.String(e[n.ValueMember])+",":i.AddressFields.Contains(n.SectionName)?D+=n.ID+"='"+t.J0.String(e[n.DisplayMember]).Replace("'","''")+"',":n.IsColumnUserDefined?s+=n.ID+"='"+t.J0.String(e[n.DisplayMember]).Replace("'","''")+"',":u+=n.ID+"='"+t.J0.String(e[n.DisplayMember]).Replace("'","''")+"',"}),u.length>0||s.length>0||m.length>0||D.length>0)try{if(r=0,null!=i.ReportObj){if(null==e.ReportPK)continue;let C=I.d.common.GetDataSet3("BULK002",i.PrimaryColumns,i.MainTableName,i.PrimaryKey+","+t.J0.String(e.ReportPK)).Tables[0];if(0==C.length)continue;C.Columns.forEach(h=>{i.EditGrid.TableColumns.Contains(h.ColumnName)||i.EditGrid.TableColumns.push(h.ColumnName),e[h.ColumnName]=C[0][h.ColumnName]})}if(2==i.CostCenterID){let n={};n.AccountID=parseInt(e.AccountID),n.GUID=t.J0.String(e.GUID);var o=i.EditColumns.find(C=>"AccountCode"==C.ID);n.AccountCode=t.J0.String(null!=o?e[o.DisplayMember]:e.AccountCode),n.CodePrefix=n.AccountCode,o=i.EditColumns.find(C=>"AccountName"==C.ID),n.AccountName=t.J0.String(null!=o?e[o.DisplayMember]:e.AccountName),o=i.EditColumns.find(C=>"StatusID"==C.ID),n.StatusID=null!=o&&t.J0.String(e[o.ValueBinding]).length>0?parseInt(e[o.ValueBinding]):parseInt(e.StatusID),o=i.EditColumns.find(C=>"AccountTypeID"==C.ID),n.AccountTypeID=null!=o&&t.J0.String(e[o.ValueBinding]).length>0?parseInt(e[o.ValueBinding]):parseInt(e.AccountTypeID),n.IsGroup=(0,R.yG0)(e.IsGroup),n.StaticFieldsQuery=u.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),D.length>0&&(D=D.substr(0,D.length-1),D=' <Data><Row Action="MODIFY" AddressID="'+t.J0.String(e.AddressID)+'" AddressTypeID="1"  StaticFields ="'+D,D+='"/></Data>'),n.AddressXML=D.toString(),n.CCMapXML=null,I.d.accounting.SaveAccount(n,"SaveAccountQuick").subscribe(C=>{if(a=C.Message,r=C.RetValue,r>0){e.Message="Success",i.EditGrid.updateRow(e);let g=I.d.common.BulkEditDetals_7(8,r,i.CostCenterID,"","","","").ds;null!=g&&g.Tables.length>0&&g.Tables[0].length>0&&g.Columns[0].Contains("GUID")&&(e.GUID=t.J0.String(g.Tables[0][0].GUID))}else e.Message="Failure : "+a,i.EditGrid.updateRow(e)},C=>{alert(JSON.stringify(C)),console.log("Bulk Edit Account Save : "+JSON.stringify(C))})}else if(3==i.CostCenterID){let n=new te.c;n.ProductID=parseInt(e.ProductID),n.GUID=t.J0.String(e.GUID);let C=i.EditColumns.find(g=>"ProductCode"==g.ID);n.ProductCode=t.J0.String(null!=C?e[C.DisplayMember]:e.ProductCode),n.CodePrefix=n.ProductCode,C=i.EditColumns.find(g=>"ProductName"==g.ID),n.ProductName=t.J0.String(null!=C?e[C.DisplayMember]:e.ProductName),C=i.EditColumns.find(g=>"ProductTypeID"==g.ID),n.ProductType=null!=C&&t.J0.String(e[C.ValueBinding]).length>0?parseInt(e[C.ValueBinding]):parseInt(e.ProductTypeID),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),n.CCCCMapDATA=null;let h=n.SetProductQuick(u.toString());if(!t.J0.IsEmpty(h))if(a=h?.Message,r=h?.RetValue,r>0){e.Message="Success",i.EditGrid.updateRow(e);let c=I.d.common.BulkEditDetals_7(8,r,i.CostCenterID,"","","","").ds;null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&c.Columns[0].Contains("GUID")&&(e.GUID=t.J0.String(c.Tables[0][0].GUID))}else e.Message="Failure : "+a,i.EditGrid.updateRow(e)}else if(16==i.CostCenterID){let n={};n.BatchID=parseInt(e.BatchID),n.GUID=t.J0.String(e.GUID),o=i.EditColumns.find(c=>"BatchCode"==c.ID),n.BatchCode=t.J0.String(null!=o?e[o.DisplayMember]:e.BatchCode),n.CodePrefix=n.BatchCode,n.StaticFieldsQuery=u.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString();let h=[];h.push(t.J0.String(e.BatchNumber)),o=i.EditColumns.find(c=>"MfgDate"==c.ID),h.push(null!=o?t.J0.ParseDate(t.J0.String(e[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):t.J0.IsEmpty(e.MfgDate)?"1/JAN/1900":t.J0.ParseDate(e.MfgDate.toString()).ToString("dd/MMM/yyyy")),o=i.EditColumns.find(c=>"ExpiryDate"==c.ID),h.push(null!=o?t.J0.ParseDate(t.J0.String(e[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):t.J0.IsEmpty(e.ExpiryDate)?"1/JAN/1900":t.J0.ParseDate(e.ExpiryDate.toString()).ToString("dd/MMM/yyyy")),o=i.EditColumns.find(c=>"MRPRate"==c.ID),h.push(null!=o?parseFloat(t.J0.String(e[o.DisplayMember])):parseFloat(t.J0.String(e.MRPRate))),o=i.EditColumns.find(c=>"RetailRate"==c.ID),h.push(null!=o?parseFloat(t.J0.String(e[o.DisplayMember])):parseFloat(t.J0.String(e.RetailRate))),o=i.EditColumns.find(c=>"StockistRate"==c.ID),h.push(null!=o?parseFloat(t.J0.String(e[o.DisplayMember])):parseFloat(t.J0.String(e.StockistRate))),h.push(t.J0.String(e.ProductID)),o=i.EditColumns.find(c=>"RetestDate"==c.ID),h.push(null!=o?t.J0.ParseDate(t.J0.String(e[o.DisplayMember+"_Key"])).ToString("dd/MMM/yyyy"):t.J0.IsEmpty(e.RetestDate)?null:t.J0.ParseDate(e.RetestDate.toString()).ToString("dd/MMM/yyyy")),h.push(0),n.StaticFieldsQuery=u.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString()}else if(92==i.CostCenterID){let n={};n.PropertyID=parseInt(e.NodeID),n.GUID=e.GUID.toString(),n.IsGroup=(0,R.yG0)(e.IsGroup);let C=i.EditColumns.find(h=>"Code"==h.ID);n.Code=null!=C?e[C.DisplayMember].toString():e.Code.toString(),C=i.EditColumns.find(h=>"Name"==h.ID),n.Name=null!=C?e[C.DisplayMember].toString():e.Name.toString(),C=i.EditColumns.find(h=>"Status"==h.ID),n.StatusID=null!=C&&e[C.ValueBinding].toString().length>0?parseInt(e[C.ValueBinding]):parseInt(e.Status),n.DetailsXML=u.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),I.d.rental.SaveProperty(n,"SaveProperty").subscribe(h=>{i.DisplayMessage=h.Message,i.MessageVisibility=!0},h=>{console.log(" Property Save : "+JSON.stringify(h))})}else if(93==i.CostCenterID){let n={};n.UnitID=parseInt(e.UnitID),n.GUID=e.GUID.toString(),n.IsGroup=(0,R.yG0)(e.IsGroup),o=i.EditColumns.find(h=>"PropertyID"==h.ID),n.Property=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.PropertyID)&&e.PropertyID.toString().length>0?parseInt(e.PropertyID):0,o=i.EditColumns.find(h=>"Code"==h.ID),n.Code=null!=o?e[o.DisplayMember].toString():e.Code.toString(),o=i.EditColumns.find(h=>"Name"==h.ID),n.Name=null!=o?e[o.DisplayMember].toString():e.Name.toString(),o=i.EditColumns.find(h=>"Status"==h.ID),n.StatusID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):parseInt(e.Status),o=i.EditColumns.find(h=>"NodeID"==h.ID),n.UnitType=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.NodeID)&&e.NodeID.toString().length>0?parseInt(e.NodeID):0,o=i.EditColumns.find(h=>"UnitType"==h.ID),n.TypeofUnit=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.UnitType)&&e.UnitType.toString().length>0?parseInt(e.UnitType):0,o=i.EditColumns.find(h=>"UnitStatus"==h.ID),n.UnitStatus=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.UnitStatus)&&e.UnitStatus.toString().length>0?parseInt(e.UnitStatus):0,o=i.EditColumns.find(h=>"RentableArea"==h.ID),n.RentalArea=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.RentableArea)&&e.RentableArea.toString().length>0?parseFloat(e.RentableArea):0,o=i.EditColumns.find(h=>"BuildUpArea"==h.ID),n.BuildUpArea=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.BuildUpArea)&&e.BuildUpArea.toString().length>0?parseFloat(e.BuildUpArea):0,o=i.EditColumns.find(h=>"FloorLookupID"==h.ID),n.Floor=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.FloorLookupID)&&e.FloorLookupID.toString().length>0?parseInt(e.FloorLookupID):0,o=i.EditColumns.find(h=>"ViewLookupID"==h.ID),n.View=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.ViewLookupID)&&e.ViewLookupID.toString().length>0?parseInt(e.ViewLookupID):0,o=i.EditColumns.find(h=>"NoOfBathrooms"==h.ID),n.NoOfBathrooms=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.NoOfBathrooms)&&e.NoOfBathrooms.toString().length>0?parseFloat(e.NoOfBathrooms):0,o=i.EditColumns.find(h=>"NoOfParkings"==h.ID),n.NoOfParkings=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.NoOfParkings)&&e.NoOfParkings.toString().length>0?parseFloat(e.NoOfParkings):0,o=i.EditColumns.find(h=>"ElectricityCode"==h.ID),n.ElectricityCode=null!=o?e[o.DisplayMember].toString():t.J0.IsEmpty(e.ElectricityCode)?"":e.ElectricityCode.toString(),o=i.EditColumns.find(h=>"ElectricityKW"==h.ID),n.Electricity=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.ElectricityKW)&&e.ElectricityKW.toString().length>0?parseFloat(e.ElectricityKW):0,o=i.EditColumns.find(h=>"Rent"==h.ID),n.Amount=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.Rent)&&e.Rent.toString().length>0?parseFloat(e.Rent):0,o=i.EditColumns.find(h=>"RentTypeID"==h.ID),n.AmountType=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentTypeID)&&e.RentTypeID.toString().length>0?parseInt(e.RentTypeID):0,o=i.EditColumns.find(h=>"DiscountAmount"==h.ID),n.Discount=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.DiscountAmount)&&e.DiscountAmount.toString().length>0?parseFloat(e.DiscountAmount):0,o=i.EditColumns.find(h=>"DiscountPercentage"==h.ID),n.DiscountPercentage=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.DiscountPercentage)&&e.DiscountPercentage.toString().length>0?parseFloat(e.DiscountPercentage):0,o=i.EditColumns.find(h=>"AnnualRent"==h.ID),n.AnnaulRent=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.AnnualRent)&&e.AnnualRent.toString().length>0?parseFloat(e.AnnualRent):0,o=i.EditColumns.find(h=>"MonthlyRent"==h.ID),n.MonthlyRent=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.MonthlyRent)&&e.MonthlyRent.toString().length>0?parseFloat(e.MonthlyRent):0,o=i.EditColumns.find(h=>"RentPerSQFT"==h.ID),n.RentperSqft=null!=o&&e[o.DisplayMember].toString().length>0?parseFloat(e[o.DisplayMember]):!t.J0.IsEmpty(e.RentPerSQFT)&&e.RentPerSQFT.toString().length>0?parseFloat(e.RentPerSQFT):0,o=i.EditColumns.find(h=>"TermsConditions"==h.ID),n.TermsConditions=null!=o?e[o.DisplayMember].toString():t.J0.IsEmpty(e.TermsConditions)?"":e.TermsConditions.toString(),o=i.EditColumns.find(h=>"AccountantID"==h.ID),n.Accountant=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AccountantID)&&e.AccountantID.toString().length>0?parseInt(e.AccountantID):0,o=i.EditColumns.find(h=>"SalesmanID"==h.ID),n.Salesman=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.SalesmanID)&&e.SalesmanID.toString().length>0?parseInt(e.SalesmanID):0,o=i.EditColumns.find(h=>"LandlordID"==h.ID),n.Landlord=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.LandlordID)&&e.LandlordID.toString().length>0?parseInt(e.LandlordID):0,o=i.EditColumns.find(h=>"RentalIncomeAccountID"==h.ID),n.RentalIncomeAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentalIncomeAccountID)&&e.RentalIncomeAccountID.toString().length>0?parseInt(e.RentalIncomeAccountID):0,o=i.EditColumns.find(h=>"PenaltyAccountID"==h.ID),n.PenaltyAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.PenaltyAccountID)&&e.PenaltyAccountID.toString().length>0?parseInt(e.PenaltyAccountID):0,o=i.EditColumns.find(h=>"RentalReceivableAccountID"==h.ID),n.RentalReceivableAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentalReceivableAccountID)&&e.RentalReceivableAccountID.toString().length>0?parseInt(e.RentalReceivableAccountID):0,o=i.EditColumns.find(h=>"AdvanceRentAccountID"==h.ID),n.AdvanceRentAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvanceRentAccountID)&&e.AdvanceRentAccountID.toString().length>0?parseInt(e.AdvanceRentAccountID):0,o=i.EditColumns.find(h=>"ProvisionAccountID"==h.ID),n.ProvisionAccountID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.ProvisionAccountID)&&e.ProvisionAccountID.toString().length>0?parseInt(e.ProvisionAccountID):0,o=i.EditColumns.find(h=>"BankAccount"==h.ID),n.BankAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.BankAccount)&&e.BankAccount.toString().length>0?parseInt(e.BankAccount):0,o=i.EditColumns.find(h=>"BankLoanAccount"==h.ID),n.BankLoanAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.BankLoanAccount)&&e.BankLoanAccount.toString().length>0?parseInt(e.BankLoanAccount):0,o=i.EditColumns.find(h=>"AdvanceReceivableAccountID"==h.ID),n.AdvanceReceivableAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvanceReceivableAccountID)&&e.AdvanceReceivableAccountID.toString().length>0?parseInt(e.AdvanceReceivableAccountID):0,o=i.EditColumns.find(h=>"AdvReceivableCloseAccID"==h.ID),n.AdvReceivableCloseAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvReceivableCloseAccID)&&e.AdvReceivableCloseAccID.toString().length>0?parseInt(e.AdvReceivableCloseAccID):0,o=i.EditColumns.find(h=>"RentalAccount"==h.ID),n.RentAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentalAccount)&&e.RentalAccount.toString().length>0?parseInt(e.RentalAccount):0,o=i.EditColumns.find(h=>"RentPayableAccount"==h.ID),n.RentPayableAcc=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.RentPayableAccount)&&e.RentPayableAccount.toString().length>0?parseInt(e.RentPayableAccount):0,o=i.EditColumns.find(h=>"AdvanceRentPaid"==h.ID),n.AdvanceRentPaid=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.AdvanceRentPaid)&&e.AdvanceRentPaid.toString().length>0?parseInt(e.AdvanceRentPaid):0,o=i.EditColumns.find(h=>"TenantID"==h.ID),n.TenantID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.TenantID)&&e.TenantID.toString().length>0?parseInt(e.TenantID):0,o=i.EditColumns.find(h=>"LocationID"==h.ID),n.LocationID=null!=o&&e[o.ValueBinding].toString().length>0?parseInt(e[o.ValueBinding]):!t.J0.IsEmpty(e.LocationID)&&e.LocationID.toString().length>0?parseInt(e.LocationID):0,o=i.EditColumns.find(h=>"BasedOn"==h.ID),n.BasedOn=null!=o?e[o.DisplayMember].toString():e.BasedOn.toString(),n.PostIncome=t.J0.String(e.PostIncome),n.CustomFieldsQuery=s.toString(),n.CustomCCQuery=m.toString(),I.d.rental.SaveUnits(n,"SaveUnits").subscribe(h=>{i.DisplayMessage=h.Message},h=>{console.log(" Unit Save : "+JSON.stringify(h))})}else if(95==i.CostCenterID||103==i.CostCenterID||104==i.CostCenterID||129==i.CostCenterID){s.length>1&&(s=s.substr(0,s.length-1)),m.length>1&&(m=m.substr(0,m.length-1));let n=null;Object.keys(e).Contains("ContractID")?n=yield I.d.common.BulkEditDetals_7(11,parseInt(e.ContractID),i.CostCenterID,"",s.toString(),m,m.toLowerCase().Replace("ccnid","dcccnid")):e.Table.Columns.Contains("QuotationID")&&(n=yield I.d.common.BulkEditDetals_7(11,parseInt(e.QuotationID),i.CostCenterID,"",s.toString(),m,m.toLowerCase().Replace("ccnid","dcccnid"))),e.Message=n.obj&&n.obj>0?"Success":null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&n.Columns[0].Contains("ServerMessage")?"Failure : "+n.Tables[0][0].ServerMessage.toString():null!=n&&n.Tables.length>0&&n.Tables[0].length>0&&n.Columns[0].Contains("ErrorMessage")?"Failure : "+n.Tables[0][0].ErrorMessage.toString():"Failure",i.EditGrid.updateRow(e)}else if(i.CostCenterID>=50001){let n={};n.NodeID=parseInt(e.NodeID),n.GUID=t.J0.String(e.GUID),n.CostCenterID=i.CostCenterID;let C=i.EditColumns.find(h=>"Code"==h.ID);n.Code=t.J0.String(null!=C?e[C.DisplayMember]:e.Code),C=i.EditColumns.find(h=>"Name"==h.ID),n.Name=t.J0.String(null!=C?e[C.DisplayMember]:e.Name),C=i.EditColumns.find(h=>"StatusID"==h.ID),n.Status=null!=C&&t.J0.String(e[C.ValueBinding]).length>0?parseInt(t.J0.String(e[C.ValueBinding])):parseInt(e.StatusID),n.StaticFieldsQuery=u.toString(),n.CustomFieldsQuery=s.toString(),n.CustomCostCenterFieldsQuery=m.toString(),n.CCXML="",I.d.common.SaveCostCenterQuick(n,"SaveCostCenterQuick").subscribe(h=>{if(a=h.Message,r=h.RetValue,r>0){e.Message="Success",i.EditGrid.updateRow(e);let c=I.d.common.BulkEditDetals_7(8,r,i.CostCenterID,"","","","").ds;null!=c&&c.Tables.length>0&&c.Tables[0].length>0&&c.Columns[0].Contains("GUID")&&(e.GUID=t.J0.String(c.Tables[0][0].GUID))}else e.Message="Failure : "+a,i.EditGrid.updateRow(e)},h=>{alert(JSON.stringify(h)),console.log("Bulk Quick Add CostCenter Save : "+JSON.stringify(h))})}}catch(n){Logger.ErrorLog("BulkEdit-SAVE: ",n.Message)}else e.Message="NO DATA",i.EditGrid.updateRow(e)}})()}TransferUsers(l){let i="";if(l.forEach(r=>{i+=t.J0.String(r.NodeID)+","}),i=i.substr(0,i.length-1),i.length>0){let r=I.d.admin.TransferUser(this.CostCenterID,0,i,this.strOldUserID,this.TargetUserID.SelectedValue.toString());r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Columns[1].Contains("ErrorMessage")&&(this.DisplayMessage=r.Tables[r.Tables.length-1][0].ErrorMessage.toString()),this.RefreshData()}}DeleteDimension(l){this.setActionHistroy("Delete Dimension");let i,r="",a="";r=null!=this.ReportObj?"ReportPK":this.PrimaryKey;let u=0;for(let s=0;s<l.length;s++){const m=l[s];try{if(i=0,null!=this.ReportObj&&t.J0.IsEmpty(m.ReportPK))continue;if(2==this.CostCenterID){let D={};D.AccountID=parseInt(m[r]);let o=I.d.accounting.DeleteAccount(D.AccountID);a=o.Message,i=o.RetValue}else if(3==this.CostCenterID){let D=I.d.inventory.DeleteProduct(parseInt(m[r]));a=D.Message,i=D.RetValue}else if(this.CostCenterID>=50001){let D={};D.NodeID=parseInt(m[r]),D.CostCenterID=this.CostCenterID;let o=I.d.common.DeleteCostCenter(D.CostCenterID,D.NodeID);a=o.Message,i=o.RetValue}else a="Functionality not implemented";i>0?(u++,this.EditGrid.removeRow(m)):(m.Message="Failure : "+a,this.EditGrid.updateRow(m))}catch(D){Logger.ErrorLog("BulkEdit-DELETE: ",D.Message)}}this.DisplayMessage=u+" Records Deleted"}OnRowSelection(l){return!1}OnKeyDown(l,i){!i.ctrlKey&&117==i.which&&(i.preventDefault(),this.onCopy(this.EditGrid.getArgsObj(l)))}onCopy(l){if(null!=l){let r,a,u=l.column.className;l.grid.getEditorLock().commitCurrentEdit(),a=l.column.field;for(let s=0;s<this.EditGrid.Columns.length;s++){const m=this.EditGrid.Columns[s];if(null!=m.SectionName&&m.SectionName.toString()==a.toString()){r=m;for(let o=this.EditGrid.SelectedIndex;o<this.EditGrid.Table.length;o++)if((0,R.yG0)(this.EditGrid.Table[o].Select)){if(this.EditGrid.Table[o][a]=l.item[a].toString(),"DataGridDateTimeColumn"!=u&&"DataGridDateColumn"!=u||!this.EditGrid.TableColumns.Contains(a+"_Key")){if("DataGridPactListBoxColumn"==l.column.className){var i=this.EditGrid.Columns.find(d=>d.DisplayMember==a);null!=i&&(this.EditGrid.Table[o][i.ValueMember]=l.item[i.ValueMember].toString())}}else this.EditGrid.Table[o][a+"_Key"]=l.item[a+"_Key"].toString();this.EditGrid.updateRow(this.EditGrid.Table[o])}break}}}}Cancelclick(){this.ApproveVisibility=!1,I.d.page.HideDialog(this.PopUpGUID),null!=this.DB&&(this.ShowRightPanel=!1)}onClickIkon(l){this.ApprovalClick(l,null)}ApprovalClick(l,i){this.DisplayMessage="";let r="";if("Approve"==l||"Reject"==l||"Suspend"==l){if(this.RemarksApprove&&"Approve"==l&&t.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Approve Remarks Mandatory",-1;if(this.RemarksReject&&"Reject"==l&&t.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Reject Remarks Mandatory",-1;if(this.RemarksSuspend&&"Suspend"==l&&t.J0.IsEmptySpace(this.Remarks.Text))return this.DisplayMessage="Suspend Remarks Mandatory",-1;if(this.IsDocument&&this.IsLWApproval&&"Suspend"!=l&&!t.J0.IsEmpty(this.strVoucherNo)&&(r=this.strVoucherNo),2==this.CostCenterID?this.strVoucherNo="AccountID":3==this.CostCenterID?this.strVoucherNo="ProductID":93==this.CostCenterID?this.strVoucherNo="UnitID":95==this.CostCenterID||104==this.CostCenterID?this.strVoucherNo="ContractID":103==this.CostCenterID||129==this.CostCenterID?this.strVoucherNo="QuotationID":92==this.CostCenterID||this.CostCenterID>5e4?this.strVoucherNo="NodeID":null!=this.ReportObj&&this.EditGrid.TableColumns.Contains("ReportPK")&&(this.strVoucherNo="ReportPK"),null==i&&(i=this.EditGrid.Table.filter(D=>1==D.Select||1==D.Select)),0==i.length)return this.DisplayMessage="No Rows Selected",-1;let a="",u="",s=!1,m=0;if(s=0!=t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0),"Approve"==l?m=1:"Suspend"==l&&(m=2),this.IsDocument)if(this.IsLWApproval&&"Suspend"!=l){t.J0.IsEmpty(r)||(this.strVoucherNo=r);let D=this.PrimaryKey;null!=this.ReportObj&&(D="ReportPK");let d,o=null,e="";i.forEach(n=>{d=t.J0.String(n[this.strVoucherNo]),d!=o&&(e.length>0&&(a.length>0&&(a+="\x11"),a+='<XML No="'+o+'">'+e+"</XML>"),e="",o=d),e+='<Row ID="'+t.J0.String(n[D])+'"  GUID="'+t.J0.String(n.GUID)+'"  Remarks="'+t.J0.EncodeXML(this.Remarks.Text)+'" WID="'+t.J0.String(n.WorkFlowID)+'"/>'}),e.length>0&&(a.length>0&&(a+="\x11"),a+='<XML No="'+o+'">'+e+"</XML>")}else a+="<DOCXML>",i.forEach(D=>{if(a+='<Row VoucherNo="'+t.J0.String(D[this.strVoucherNo])+'" GUID = "'+t.J0.String(D.GUID)+'" />',!t.J0.IsEmpty(D[this.strVoucherNo])&&"BUA-"==D[this.strVoucherNo].toString().substr(0,4)){let o=0,e=I.d.common.GetDataSet3("BULK003",t.J0.String(D[this.strVoucherNo]),"","").Tables[0];if(null!=e&&e.length>0){o=parseInt(e[0].EmpSeqNo);let n=ee.RibbonExtPay.GetAppraisal(e);n.length>0&&(u+='<Row EmpNodeID="'+o+'" ',u+=' VoucherNo ="'+D[this.strVoucherNo].toString()+'" ',u+=' Query ="'+n+'" ',u+="/>")}}}),a+="</DOCXML>",u.length>0&&(u="<Data>"+u+"</Data>");else a+="<DOCXML>",i.forEach(D=>{a+='<Row VoucherNo="'+t.J0.String(D[this.strVoucherNo])+'" GUID = "'+t.J0.String(D.GUID)+'" />'}),a+="</DOCXML>";if(a.length>0){this.setActionHistroy(l);let D=0,o=I.d.common.BulkApprovals(this.CostCenterID,s,this.Remarks.Text,a.toString(),m,this.AppRejDate.Date.ToString("dd/MMM/yyyy"),u);return D=t.J0.Int(o.obj),D>0?(this.Remarks.Text="",i.forEach(d=>{this.EditGrid.removeRow(d)}),"Suspend"==l&&(this.Report.length>0?this.Report[0].Refresh():this.RefreshData()),this.DisplayMessage="Approve"==l?l+"d Successfully":l+"ed Successfully"):this.DisplayMessage="Error in Save",D}}return 0}setActionHistroy(l){let i="";null!=this.Report&&this.Report.length>0&&!t.J0.IsEmpty(this.Report[0].WhereTag)?i=this.Report[0].WhereTag:t.J0.IsEmpty(this.strWhereforAuctionHistory)||(i=this.strWhereforAuctionHistory),I.d.common.GetDataSet3("BULK005","Bulk Edit - "+l,i,I.d.SessionManager.UserName)}BarcodeDocument(l){if(0==this.EditColumns.length)return void(this.DisplayMessage="Please select ateleast one editable column.");if(null==l[0][this.EditColumns[0].DisplayMember])return void(this.DisplayMessage="Selected editable column not found.");let r,a,i="";if(!(this.CostCenterID>4e4&&this.CostCenterID<5e4))return void(this.DisplayMessage="Not implemented");a=0==t.J0.stringCompare(this.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID",r=null!=this.ReportObj?"ReportPK":a;let u,m,s=new P.bT;l.forEach(D=>{u=t.J0.String(D[this.strVoucherNo]),s.ContainsKey(u)||s.push(u,[]),s[u].push(D)}),s.keys.forEach(D=>{let o={Key:D,Value:s[D]};i="",i+="<XML IgnorePositionDialog='1'>",o.Value.forEach(e=>{e.Message=null,m=t.J0.IntTryParse(t.J0.String(e[this.EditColumns[0].DisplayMember])),m>0?i+='<R DocDetailsID="'+t.J0.String(e[r])+'" Qty="'+t.J0.String(e[this.EditColumns[0].DisplayMember])+'"/>':e.Message="Invalid Quantity"}),i+="</XML>";let d=this.PrintBarcode(o.Key,i.toString());o.Value.forEach(e=>{null==e.Message&&(e.Message=d)})})}PrintBarcode(l,i){let s,r=0,a=0,m=I.d.report.GetDocumentDetailsByVoucherNo(l);if(s=t.J0.Int(m.obj),!(s>0))return"Voucher Not Found";{let D;D=m.Tables[0].length>0?m.Tables[0][0]:m.Tables[1][0],r=parseInt(D.CostCenterID),a=parseInt(D.DocID)}return"Success"}OnDateRangesSelectionChanged(l){null!=this.DateRanges.SelectedValue&&X.w.SetDateRanges(this.DateRanges.SelectedValue,this.FromDate,this.ToDate)}}class V{constructor(l,i){this.dsFields=null,this.CostCenterID=0,this.ClassName="BulkEditViewModel",this.dsFields=l,this.Parent=i,(i.ClassName="BulkEditViewModel")&&(this.CostCenterID=i.CostCenterID),this.FilterGrid=new L.vv,this.FilterGrid.Width="",this.FilterGrid.Height=200,this.FilterGrid.CanUserAddRows=!0,this.FilterGrid.CanUserDeleteRows=!0,this.FilterGrid.BeginEdit.Subscribe(this,"OnBeginEditing"),this.FilterGrid.CellEditEnding.Subscribe(this,"OnCellEditCommiting");let r=[],a=new M.O7,u=[],s={AND:"AND",Value:"AND"};u.push(s),s={},s.AND="OR",s.Value="OR",u.push(s),s={},s.AND="(",s.Value="(",u.push(s),s={},s.AND=")",s.Value=")",u.push(s),a=new M.O7,a.ComboData=u,a.DisplayMember="AND",a.ValueMember="Value",a.ValueBinding="And",a.Header="AND/OR",a.DataType="ComboBox",a.Width=80,a.IsVisible=!0,r.push(a),a=new M.O7,null!=l&&(a.ComboData=l.Tables[0]),a.DisplayMember="UserColumnName",a.ValueMember="CostCenterColID",a.ValueBinding="Field",a.DataType="ComboBox",a.Header="Column",a.Width=200,a.IsVisible=!0,r.push(a),a=new M.O7,a.ComboData=this.ReturnCondition(),a.DisplayMember="Condition",a.ValueMember="Value",a.ValueBinding="Condition",a.DataType="ComboBox",a.Header="Condition",a.Width=120,a.IsVisible=!0,r.push(a),a=new M.O7,a.Header="Value",a.DisplayMember="MULTI",a.ValueMember="MULTI_LISTBOX",a.DataType="MULTI_TYPE",a.Width=150,a.IsMultiType=!0,r.push(a),this.FilterGrid.Columns=r,this.FilterGrid.Clear(),this.FilterGrid.TableColumns.push("And"),this.FilterGrid.TableColumns.push("Column"),this.FilterGrid.TableColumns.push("Field"),this.FilterGrid.TableColumns.push("Condition"),this.FilterGrid.TableColumns.push("MULTI"),this.FilterGrid.TableColumns.push("MULTI_TYPE"),this.FilterGrid.TableColumns.push("MULTI_FLOAT"),this.FilterGrid.TableColumns.push("MULTI_DATE"),this.FilterGrid.TableColumns.push("MULTI_LISTBOX"),this.FilterGrid.TableColumns.push("MULTI_COMBOBOX");for(let m=0;m<10;m++){let D=this.FilterGrid.NewRow();this.FilterGrid.addRow(D)}}LoadXML(l){let i=new t.VB;i.LoadXml(l),this.FilterGrid.Clear(),i.DocumentElement.childNodes.length>0&&i.DocumentElement.childNodes.forEach(r=>{let a=this.FilterGrid.NewRow();if(a.And=r.attributes.And.value,t.J0.IsEmpty(r.attributes.Field.value)||(a.Field=r.attributes.Field.value),a.Condition=r.attributes.Condition.value,a.MULTI_TYPE=r.attributes.ValueType.value,a.MULTI=r.attributes.Value.value,null!=r.attributes.Value_Key&&!t.J0.IsEmpty(r.attributes.Value_Key.value))switch(t.J0.String(a.MULTI_TYPE)){case"DATE":case"DATETIME":a.MULTI_DATE=r.attributes.Value_Key.value;break;case"LISTBOX":a.MULTI_LISTBOX=r.attributes.Value_Key.value;break;case"COMBOBOX":a.MULTI_COMBOBOX=r.attributes.Value_Key.value}this.FilterGrid.addRow(a)});for(let r=0;r<10;r++){let a=this.FilterGrid.NewRow();this.FilterGrid.addRow(a)}}GetXML(){let l="";l+="<XML>";let i=0;for(let r=0;r<this.FilterGrid.Table.length;r++){const a=this.FilterGrid.Table[r];if(i++,""!=t.J0.String(a.And)||""!=t.J0.String(a.Field)){switch(l+='<Row And="',(1!=i||"("==t.J0.String(a.And))&&(l+=t.J0.String(a.And)),l+='"',l+=' Field="'+t.J0.String(a.Field)+'"',l+=' Condition="'+t.J0.EncodeXML(t.J0.String(a.Condition))+'"',l+=' ValueType="'+t.J0.EncodeXML(t.J0.String(a.MULTI_TYPE))+'"',l+=' Value="'+t.J0.EncodeXML(t.J0.String(a.MULTI))+'"',t.J0.String(a.MULTI_TYPE)){case"DATE":l+=' Value_Key="'+t.J0.EncodeXML(t.J0.String(a.MULTI_DATE))+'"';break;case"LISTBOX":l+=' Value_Key="'+t.J0.EncodeXML(t.J0.String(a.MULTI_LISTBOX))+'"';break;case"COMBOBOX":l+=' Value_Key="'+t.J0.EncodeXML(t.J0.String(a.MULTI_COMBOBOX))+'"'}l+="/>"}}return l+="</XML>",l.toString()}SetFieldsData(l,i){this.dsFields=l,this.CostCenterID=i;let r=[];this.FilterGrid.Columns[1].ComboData=l.Tables[0],this.FilterGrid.Columns.forEach(a=>{r.push(a)}),this.FilterGrid.Columns=r}ReturnCondition(){let l=[],i={Condition:"Equals",Value:"=",Type:"3"};return l.push(i),i={},i.Condition="Does Not Equals",i.Value="<>",i.Type="3",l.push(i),i={},i.Condition="Is greater than",i.Value=">",i.Type="2",l.push(i),i={},i.Condition="Is greater than or equals to",i.Value=">=",i.Type="2",l.push(i),i={},i.Condition="Is less than",i.Value="<",i.Type="2",l.push(i),i={},i.Condition="Is less than or equals to",i.Value="<=",i.Type="2",l.push(i),i={},i.Condition="Contains",i.Value="LIKE",i.Type="1",l.push(i),i={},i.Condition="Does Not Contains",i.Value="NOT LIKE",i.Type="1",l.push(i),i={},i.Condition="Is Null",i.Value="IS NULL",i.Type="1",l.push(i),i={},i.Condition="Is Not Null",i.Value="IS NOT NULL",i.Type="1",l.push(i),l}OnCellEditCommiting(l){let i=l.item;if("Field"==l.column.field){if(null==this.dsFields)return;let a=""==t.J0.String(i.Field)?[]:this.dsFields.Tables[0].filter(m=>m.CostCenterColID==t.J0.String(i.Field));if(0==a.length)return i.MULTI="",i.MULTI_TYPE="",i.MULTI_FLOAT=null,i.MULTI_DATE=null,i.MULTI_LISTBOX=null,void(i.MULTI_COMBOBOX=null);let u=parseInt(i.Field),s=t.J0.String(a[0].UserColumnType).toUpperCase();i.MULTI_TYPE="DATE"==s?"DATE":"FLOAT"==s||"NUMERIC"==s?"FLOAT":"LISTBOX"==s?"="==t.J0.String(i.Condition)||"<>"==t.J0.String(i.Condition)?"LISTBOX":"":241==u||264==u||252==u||"StatusID"==t.J0.String(a[0].SysColumnName)||93==this.CostCenterID&&"Status"==t.J0.String(a[0].SysColumnName)?"="==t.J0.String(i.Condition)||"<>"==t.J0.String(i.Condition)?"COMBOBOX":"":"TEXT"}this.FilterGrid.onMultiTypeColumnChanged.next(i)}OnCommitCell(l){let i=this.FilterGrid.Columns.find(s=>"MULTI"==s.DisplayMember),r=""==t.J0.String(l.Field)?[]:this.dsFields.Tables[0].filter(s=>s.CostCenterColID==t.J0.String(l.Field));if(0==r.length)return;let a=parseInt(l.Field),u=t.J0.String(r[0].UserColumnType).toUpperCase();if(i.DataType=u,"DATE"==u)l.MULTI_TYPE="DATE",i.DisplayMember="MULTI_DATE";else if("FLOAT"==u||"NUMERIC"==u)l.MULTI_TYPE="FLOAT",i.DisplayMember="MULTI_FLOAT";else if("LISTBOX"==u)i.CostCenterID=parseInt(t.J0.String(r[0].ColumnCostCenterID)),i.TypeID=parseInt(t.J0.String(r[0].ColumnCCListViewTypeID)),i.DisplayMember="MULTI_LISTBOX",l.MULTI_TYPE="="==t.J0.String(l.Condition)||"<>"==t.J0.String(l.Condition)?"LISTBOX":"";else if(241==a||264==a||252==a||"StatusID"==t.J0.String(r[0].SysColumnName)||93==this.CostCenterID&&"Status"==t.J0.String(r[0].SysColumnName))if("="==l.Condition.toString()||"<>"==t.J0.String(l.Condition)){l.MULTI_TYPE="COMBOBOX",i.DisplayMember="MULTI_COMBOBOX";let s=new Array,m=null;241==a||264==a?m=this.dsFields.Tables[4]:252==a?m=V.GetBillWiseTable():"StatusID"==t.J0.String(r[0].SysColumnName)&&(m=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),m.forEach(D=>{s.push(B._p.ComboBoxItems_2(t.J0.String(D[Object.keys(D)[1]]),t.J0.String(D[Object.keys(D)[0]])))}),i.ComboData=i.ComboItems=s}else l.MULTI_TYPE="";else l.MULTI_TYPE="";this.FilterGrid.RefreshColumns()}OnBeginEditing(l){let i=l.args.item,r=this.FilterGrid.Columns.find(u=>"MULTI"==u.DisplayMember),a=l.args.column.field;if("Field"!=a&&"Condition"!=a&&"MULTI"==a){let u=""==t.J0.String(i.Field)?[]:this.dsFields.Tables[0].filter(D=>D.CostCenterColID==t.J0.String(i.Field));if(0==u.length)return void(l.Cancel=!0);let s=parseInt(i.Field),m=t.J0.String(u[0].UserColumnType).toUpperCase();if(l.args.column.DgCol.DataType=m,"DATE"==m)i.MULTI_TYPE="DATE";else if("FLOAT"==m||"NUMERIC"==m)i.MULTI_TYPE="FLOAT";else if("LISTBOX"==m)r.CostCenterID=parseInt(t.J0.String(u[0].ColumnCostCenterID)),r.TypeID=parseInt(t.J0.String(u[0].ColumnCCListViewTypeID)),l.args.column.DataGridColumn.CostCenterID=l.args.column.DgCol.CostCenterID=parseInt(t.J0.String(u[0].ColumnCostCenterID)),l.args.column.DataGridColumn.TypeID=l.args.column.DgCol.TypeID=parseInt(t.J0.String(u[0].ColumnCCListViewTypeID)),i.MULTI_TYPE="="==t.J0.String(i.Condition)||"<>"==t.J0.String(i.Condition)?"LISTBOX":"";else if(241==s||264==s||252==s||"StatusID"==t.J0.String(u[0].SysColumnName)||93==this.CostCenterID&&"Status"==t.J0.String(u[0].SysColumnName))if("="==i.Condition.toString()||"<>"==t.J0.String(i.Condition)){i.MULTI_TYPE="COMBOBOX";let D=new Array,o=null;241==s||264==s?o=this.dsFields.Tables[4]:252==s?o=V.GetBillWiseTable():"StatusID"==t.J0.String(u[0].SysColumnName)&&(o=this.CostCenterID>4e4&&this.CostCenterID<5e4?this.dsFields.Tables[2]:this.dsFields.Tables[1]),o.forEach(d=>{D.push(B._p.ComboBoxItems_2(t.J0.String(d[Object.keys(d)[1]]),t.J0.String(d[Object.keys(d)[0]])))}),r.ComboData=l.args.column.DgCol.ComboData=l.args.column.DgCol.ComboItems=D}else i.MULTI_TYPE="TEXT";else i.MULTI_TYPE="TEXT";this.FilterGrid.onMultiTypeColumnChanged.next(i)}}GetWhere(l,i){let u,m,D,d,e,n,r="",a=0,s=this.Parent,o="0",C="",h="",g=s.Entities,c=i;if(a=s.CostCenterID,u=s.IsDetailVoucher,s.IsDocument&&(h=0==t.J0.stringCompare(s.MainTableName,"ACC_DocDetails",!0)?"AccDocDetailsID":"InvDocDetailsID"),a>4e4&&a<5e4){for(let S=0;S<this.FilterGrid.Table.length;S++){const A=this.FilterGrid.Table[S];if(c++,t.J0.IsEmpty(A.And)&&t.J0.IsEmpty(A.Field))continue;(c!=i+1||"("==t.J0.String(A.And))&&(r+=" "+t.J0.String(A.And)+" ");let b=t.J0.IsEmpty(A.Field)?[]:this.dsFields.Tables[0].filter(T=>T.CostCenterColID==t.J0.String(A.Field));if(0==b.length)continue;let y=b[0];if(n="T"+c.toString(),e=t.J0.String(y.SysTableName),d=t.J0.String(y.SysColumnName),m=D="",0==t.J0.stringCompare(e,"COM_DocTextData"))if(g.ContainsKey("COM_DocTextData")||g.push("COM_DocTextData","TXT"),d="TXT."+d,"DATE"==t.J0.String(y.ColumnDataType)&&"IS NOT NULL"!=t.J0.String(A.Condition)&&"IS NULL"!=t.J0.String(A.Condition))d=" isdate("+d+")=1 and convert(datetime,"+d+")",m=D=d;else if("LISTBOX"==t.J0.String(y.UserColumnType)){let T;if("44"==t.J0.String(y.ColumnCostCenterID))T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+d+") else '' end";else{let J=I.d.report.GetTableColumns(parseInt(y.ColumnCostCenterID));T=J.ColumnName,C=J.PrimaryKey,e=J.TableName,T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT "+T+" FROM "+e+" with(nolock) WHERE "+C+"="+d+") else '' end"}m=T,D=d}else"LOOKUP"==t.J0.String(y.UserColumnType)||(m=D=d);else 0==t.J0.stringCompare(e,"COM_DocCCData")?(g.ContainsKey("COM_DocCCData")||g.push("COM_DocCCData","DCC"),g.ContainsKey(d)||(g.push(d,n),t.J0.GetTagTableName(parseInt(y.ParentCostCenterID))),m=null==y||t.J0.IsEmpty(y.ShowCode)||"YES"!=t.J0.String(y.ShowCode)?g[d]+".Name":g[d]+".Code",D="DCC."+d):null!=y.IsForeignKey&&(0,R.yG0)(y.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(d)?(g.ContainsKey(d)||(g.push(d,n),t.J0.String(y.ParentCostCenterSysName),t.J0.String(y.ParentCostCenterColSysName)),m=g[d]+"."+s.GetColumnName(y),D="D."+d):(d="D."+d,"DATE"==t.J0.String(y.ColumnDataType)&&(d="convert(datetime,"+d+")"),m=D=d);let N=t.J0.String(A.MULTI_TYPE);switch(t.J0.String(A.Condition)){case"=":case"<>":if("LISTBOX"==N){let T;T=t.J0.IntTryParse(t.J0.String(A.MULTI_LISTBOX)),r+=" "+D+t.J0.String(A.Condition)+T.toString()}else"COMBOBOX"==N?t.J0.String(A.MULTI_COMBOBOX).length>0&&(r+=" "+D+t.J0.String(A.Condition)+"'"+t.J0.String(A.MULTI_COMBOBOX)+"'"):"DATE"==N?t.J0.IsEmpty(A.MULTI_DATE)?r+=" "+D+t.J0.String(A.Condition)+"''":r+=" "+D+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":r+=" "+m+t.J0.String(A.Condition)+"'"+t.J0.String(A.MULTI)+"'";break;case"LIKE":case"NOT LIKE":r+=" "+m+" "+t.J0.String(A.Condition)+" '%"+t.J0.String(A.MULTI)+"%'";break;case"IS NULL":case"IS NOT NULL":r+=" "+m+" "+t.J0.String(A.Condition);break;case">":case">=":case"<":case"<=":r+="DATE"==N?" "+D+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+m+t.J0.String(A.Condition)+"'%"+t.J0.String(A.MULTI)+"'%"}}s.IsApproval&&500==i&&(r.length>0&&(r+=" and "),I.d.SessionManager.Preferences.ContainsKey("CanApproveFunction")&&"TRUE"==I.d.SessionManager.Preferences.CanApproveFunction.toUpperCase()?r+=" D.WorkFlowID>0 AND dbo.fnExt_CanApprove(D."+h+",D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+")=1":r+=" D.WorkFlowID>0 AND dbo.[fnRPT_CanApprove](D.CostCenterID,D.WorkflowID,D.WorkFlowLevel,D.StatusID,D.CreatedDate,"+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+")=1")}else{for(let S=0;S<this.FilterGrid.Table.length;S++){const A=this.FilterGrid.Table[S];if(c++,t.J0.IsEmpty(A.And)&&t.J0.IsEmpty(A.Field))continue;(c!=i+1||"("==t.J0.String(A.And))&&(r+=" "+t.J0.String(A.And)+" ");let b=""==t.J0.String(A.Field)?[]:this.dsFields.Tables[0].filter(T=>T.CostCenterColID==t.J0.String(A.Field));if(0==b.length)continue;let y=b[0];if(n="T"+c.toString(),e=t.J0.String(y.SysTableName),d=t.J0.String(y.SysColumnName),m=D="",0==t.J0.stringCompare(e,"ACC_AccountsExtended")||0==t.J0.stringCompare(e,"INV_ProductExtended")||0==t.J0.stringCompare(e,"REN_UnitsExtended")||0==t.J0.stringCompare(e,"REN_ContractExtended")||0==t.J0.stringCompare(e,"REN_QuotationExtended"))if(g.ContainsKey(e)||g.push(e,"EXT"),d="EXT."+d,"DATE"==t.J0.String(y.ColumnDataType))d="convert(datetime,"+d+")",m=D=d;else if("LISTBOX"==t.J0.String(y.UserColumnType)){let T;if("44"==t.J0.String(y.ColumnCostCenterID))T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT Name FROM COM_Lookup with(nolock) WHERE NodeID="+d+") else '' end";else{let J=I.d.report.GetTableColumns(parseInt(y.ColumnCostCenterID));T=J.ColumnName,C=J.PrimaryKey,e=J.TableName,T="case when "+d+" is not null and isnumeric("+d+")=1 then (SELECT "+T+" FROM "+e+" with(nolock) WHERE "+C+"="+d+") else '' end"}m=T,D=d}else m=D=d;else 0==t.J0.stringCompare(e,"COM_CCCCData")?(g.ContainsKey("COM_CCCCData")||g.push("COM_CCCCData","CCDATA"),g.ContainsKey(d)||(g.push(d,n),t.J0.GetTagTableName(parseInt(y.ParentCostCenterID))),m=g[d]+".Name",D="CCDATA."+d):null!=y.IsForeignKey&&(0,R.yG0)(y.IsForeignKey)&&0==["AccountTypeID","StatusID"].Contains(d)?(g.ContainsKey(d)||(g.push(d,n),t.J0.String(y.ParentCostCenterSysName),t.J0.String(y.ParentCostCenterColSysName)),m=g[d]+"."+s.GetColumnName(y),D="D."+d):(d="D."+d,"DATE"==t.J0.String(y.ColumnDataType)&&(d="convert(datetime,"+d+")"),m=D=d);let N=t.J0.String(A.MULTI_TYPE);switch(t.J0.String(A.Condition)){case"=":case"<>":if("LISTBOX"==N)if("15408700"==t.J0.String(y.CostCenterColID))r+="("+m+"='"+A.MULTI.toString()+"' OR ",r+=m+" like '"+A.MULTI.toString()+",%' OR ",r+=m+" like '%,"+A.MULTI.toString()+"' OR ",r+=m+" like '%,"+A.MULTI.toString()+",%' ) ";else{let T;T=t.J0.IntTryParse(t.J0.String(A.MULTI_LISTBOX)),r+=" "+D+t.J0.String(A.Condition)+T.toString()}else"COMBOBOX"==N?t.J0.String(A.MULTI_COMBOBOX).length>0&&(r+=" "+D+t.J0.String(A.Condition)+"'"+A.MULTI_COMBOBOX.toString()+"'"):r+="DATE"==N?" "+D+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+m+t.J0.String(A.Condition)+"'"+t.J0.String(A.MULTI)+"'";break;case"LIKE":case"NOT LIKE":r+=" "+m+" "+t.J0.String(A.Condition)+" '%"+t.J0.String(A.MULTI)+"%'";break;case">":case">=":case"<":case"<=":r+="DATE"==N?" "+D+t.J0.String(A.Condition)+"'"+t.J0.ParseDate(A.MULTI_DATE).ToString("dd MMM yyyy")+"'":" "+m+t.J0.String(A.Condition)+"'%"+t.J0.String(A.MULTI)+"'%"}}s.IsApproval&&500==i&&(m=2==a?"D.AccountID":3==a?"D.ProductID":93==a?"D.UnitID":94==a?"D.TenantID":95==a||104==a?"D.ContractID":103==a||129==a?"D.QuotationID":"D.NodeID",(2==a||3==a||93==a||94==a||a>5e4)&&(o=50051==a||50054==a?"0":"ISNULL(D.WorkFlowID,0)"),r.length>0&&(r+=" and "),r+=95==a||103==a||104==a||129==a?" D.StatusID IN (470,440,465)":93==a?" D.Status IN (1001,1003)":" D.StatusID IN (1001,1003)",r+=95==a||103==a||104==a||129==a?" AND dbo.[fnREN_CanContractApprove]("+a+","+m+","+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+")=1 ":" AND dbo.[fnRPT_CanCostCentetApprove]("+a+","+m+","+I.d.SessionManager.UserID+","+I.d.SessionManager.RoleID+","+o+")=1 ")}return r.toString()}static GetBillWiseTable(){let l=[],i={Value:1,Name:"YES"};return l.push(i),i.Value=0,i.Name="NO",l.push(i),l}}class oe{constructor(l,i){this.Title="",this.ApplyToAll=!1,this.Parent=l,this.SourceColumn=i,this.Title=i.Header,this.FindGrid=new L.vv,this.FindGrid.CanUserDeleteRows=!0,this.FindGrid.Columns=[],this.FindGrid.Columns.push(i),this.FindGrid.Columns[0].Header="Find What",this.FindGrid.Columns[0].Width=233,this.FindGrid.Table=l.EditGrid.Table;let r=this.FindGrid.NewRow();this.FindGrid.addRow(r),this.FindGrid.SelectedItem=this.FindGrid.Table[0],this.FindGrid.SelectedIndex=0,this.ReplaceGrid=new L.vv,this.ReplaceGrid.CanUserDeleteRows=!0,this.ReplaceGrid.Columns=[],this.ReplaceGrid.Columns.push(i),this.ReplaceGrid.Columns[0].Header="Replace With",this.ReplaceGrid.Columns[0].Width=233,this.ReplaceGrid.Table=l.EditGrid.Table,r=this.ReplaceGrid.NewRow(),this.ReplaceGrid.addRow(r),this.ReplaceGrid.SelectedItem=this.ReplaceGrid.Table[0],this.ReplaceGrid.SelectedIndex=0}OnButtonClick(l){if(this.Parent.DisplayMessage="","Replace"==l){let i=!1,r=this.SourceColumn.SectionName+"_Key";this.Parent.EditGrid.TableColumns.Contains(r)?i=!0:r=this.SourceColumn.SectionName;let a=t.J0.String(this.FindGrid.Table[0][r]);if(this.ApplyToAll)this.Parent.EditGrid.Table.forEach(u=>{u[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],i&&(u[r]=this.ReplaceGrid.Table[0][r]),u.Select=!0,this.Parent.EditGrid.updateRow(u)}),this.Parent.DisplayMessage=this.Parent.EditGrid.Table.length+" Rows Replaced";else{let u=0;this.Parent.EditGrid.Table.forEach(s=>{0==t.J0.stringCompare(a,t.J0.String(s[r]),!0)&&(s[this.SourceColumn.SectionName]=this.ReplaceGrid.Table[0][this.SourceColumn.SectionName],i&&(s[r]=this.ReplaceGrid.Table[0][r]),s.Select=!0,this.Parent.EditGrid.updateRow(s),u++)}),this.Parent.DisplayMessage=0==u?"No Rows Found":u+" Rows Replaced"}}else"Cancel"==l&&(this.Parent.ReplaceVisibility=!1,this.Parent.ApproveVisibility=!1)}}}}]);