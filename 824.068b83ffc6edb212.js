"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[824],{39559:(Pt,Le,V)=>{V.d(Le,{h:()=>B});class B{constructor(){this.EmpCode="",this.EmpName="",this.EmpAliasName="",this.Gender="",this.CodePrefix="",this.ParentName="",this.CCMapXML="",this.HistoryXML="",this.PayQuery="",this.CustomFieldsQuery="",this.CustomCostCenterFieldsQuery="",this.NotesXML="",this.ContactsXML="",this.AddressXML="",this.AttachmetsXML="",this.AccLinkXML="",this.PrimaryContactQuery="",this.StaticFieldsQuery="",this.CompanyGUID="",this.GUID="",this.UserName="",this.DocumentsXML="",this.EmpYear="",this.Regime="",this.RotationalLeave="",this.NodeID=0,this.CodeNumber=0,this.StatusID=0,this.EmpTypeID=0,this.ParentID=0,this.CurrencyID=0,this.SelectedNodeID=0,this.ProbationDays=0,this.RptManager=0,this.UserId=0,this.LanguageId=0,this.GroupSeqNoLength=0,this.WID=0,this.IsGroup=!1,this.IDHistoryXML="",this.PaymentModeXML=""}}},5661:(Pt,Le,V)=>{V.d(Le,{N:()=>De});var B=V(86739),pe=V(8787),Je=V(23823),o=V(24028),Me=V(92701),Ve=V(72743),lt=V(35275),ae=V(7023),a=V(26531),ce=V(29788),ye=V(81669),Ne=V(61994);class De extends Je.g{constructor(le){super(),this.ProgressVisibility=!1,this.ProgressValue=0,this.ProgressMax=0,this.dtpPayrollMonth=new o.Lc(0),this.cmbPayslipLayout=new Me.y$(0),this.cmbSortOn=new Me.y$(0),this.PrintCallBack=new ye.Yk,this.dtPrintLayouts=null,this.sFilter="",this.drSelectedPrintLayout=null,this.sDocIDs="",this.IsPDFExport=!1,this.iCostCenterID=40054,this.ExportSeperate=!1;try{if(this.DisplayName=B.d.GetResource(le),this.Title=B.d.GetResource(le),this.DisplayMessage="",this.dtpPayrollMonth.CustomFormat="MMM/yyyy",this.dtpPayrollMonth.Date=B.d.SessionManager.PayrollMonth,this.dtPrintLayouts=B.d.common.GetDataTable("PAY064",this.iCostCenterID.toString()+"~"+B.d.SessionManager.RoleID+"~"+B.d.SessionManager.UserID+"~"+B.d.SessionManager.LocationID),null!=this.dtPrintLayouts&&this.dtPrintLayouts.length>0){let Q="-1";for(let $=0;$<this.dtPrintLayouts.length;$++)this.cmbPayslipLayout.Items.push(Me._p.ComboBoxItems_2(this.dtPrintLayouts[$].Name.toString(),this.dtPrintLayouts[$].DocPrintLayoutID.toString())),"true"==this.dtPrintLayouts[$].IsDefault.toString().toLowerCase()&&(Q=this.dtPrintLayouts[$].DocPrintLayoutID.toString());this.cmbPayslipLayout.SelectedValue=Q,"-1"==Q&&!pe.J0.IsEmpty(this.dtPrintLayouts[0].DocPrintLayoutID)&&(Q=this.dtPrintLayouts[0].DocPrintLayoutID.toString(),this.cmbPayslipLayout.SelectedValue=Q)}if(this.cmbSortOn.Items.Clear(),this.cmbSortOn.Items.push(Me._p.ComboBoxItems_2("EmpCode","1")),this.cmbSortOn.Items.push(Me._p.ComboBoxItems_2("EmpName","2")),this.cmbSortOn.Items.push(Me._p.ComboBoxItems_2("TreeView","3")),this.cmbSortOn.SelectedValue="1",this.dtpPayrollMonth.Label=B.d.GetResource("Payroll_Month"),this.cmbPayslipLayout.Label=B.d.GetResource("PayslipLayout"),this.cmbSortOn.Label=B.d.GetResource("SortOn"),B.d.SessionManager.IsEmpUser&&!B.d.SessionManager.IsRptManagerUser){let Q="";pe.J0.IsEmpty(B.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(Q="  AND EmpSeqNo IN ("+B.d.SessionManager.sWHEmpFilteredEmpSeqNos+")");let $=[];$.push(B.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")),$.push(Q),$.push(1),$.push(B.d.SessionManager.RoleID),$.push(B.d.SessionManager.UserID),$.push(B.d.SessionManager.LanguageID),this.dsEmps=B.d.empService.GetData($,"spPAY_GetEmpMasterCCDetails")}else this.btnFilter_Click();this.PrintCallBack.Subscribe(this,"PrintVoucher")}catch(Q){Logger.ErrorLog("PayslipViewModel::EXCEPTION PayslipViewModel()",Q)}}Button_Click(le){this.IsPDFExport=!1,"Preview"==le.toString()?this.btnPreview_Click(0):"Print"==le.toString()?this.btnPreview_Click(1):"Export"==le.toString()?(this.IsPDFExport=!0,this.btnPreview_Click(3)):"EMail"==le.toString()?this.btnPreview_Click(2):"Filter"==le.toString()&&this.btnFilter_Click(),Logger.InfoLog("PayslipViewModel::Exiting Button_Click()")}btnPreview_Click(le){if(null!=this.dsEmps&&0!=this.dsEmps.Tables.length)try{let Q=this.dsEmps.Tables[0],$=0,me=0;if(null!=Q&&Q.length>0){let K="",Se="";for(let m=0;m<Q.length;m++)K+=Q[m].EmpSeqNo.toString()+",",me++;if(K.length>0&&me>0){K=K.substr(0,K.length-1),Se="TreeView"==this.cmbSortOn.GetselectedItem().Name?" ORDER BY e.lft":" ORDER BY e."+this.cmbSortOn.GetselectedItem().Name.Replace("Emp","");let m=B.d.common.GetDataSet3("PAY065",this.iCostCenterID.toString(),this.dtpPayrollMonth.Date.ToString("01/MMM/yyyy"),K+"~"+Se);if(null!=m&&m.Tables[0].length>0&&pe.J0.IntTryParse(this.cmbPayslipLayout.SelectedValue)>0){$=m.Tables[0].length,this.sDocIDs="";let ie=this.dtPrintLayouts.filter(j=>j.DocPrintLayoutID==this.cmbPayslipLayout.SelectedValue);for(let j=0;j<m.Tables[0].length;j++)this.sDocIDs+=m.Tables[0][j].DocID.toString()+",";if(this.sDocIDs.length>0)if(this.drSelectedPrintLayout=ie[0],this.sDocIDs=this.sDocIDs.substr(0,this.sDocIDs.length-1),0==le)this.PrintCallBack.Call(!0);else if(1==le)this.PrintCallBack.Call(!1);else if(3==le)if(this.ExportSeperate)for(let j=0;j<m.Tables[0].length;j++)this.sDocIDs=m.Tables[0][j].DocID.toString(),this.PrintCallBack.Call(!1);else this.PrintCallBack.Call(!1);else 2==le&&this.SendPaySlipsToEMail()}else 0==m.Tables[0].length?this.DisplayMessage="Payroll Not Processed For Selected Employees On This Payroll Month":-1==pe.J0.IntTryParse(this.cmbPayslipLayout.SelectedValue)&&(this.DisplayMessage="Please select Payslip Layout")}}else this.DisplayMessage="No Employees found to generate preview.";Logger.InfoLog("PayslipViewModel::Exiting btnPreview_Click()")}catch(Q){Logger.ErrorLog("PayslipViewModel::EXCEPTION btnPreview_Click()"+Q.stack)}else this.DisplayMessage="First filter the Employees, then Preview"}SendPaySlipsToEMail(){try{Logger.InfoLog("PayslipViewModel::Entering SendPaySlipsToEMail()"),null!=this.sDocIDs&&this.sDocIDs.length>0?B.d.page.ShowDialog(new a.SendEmailSMSViewModel(!0,this.iCostCenterID,0,this),ce.SendEmailSMSComponent):this.DisplayMessage="No Employees found to Send Email.",Logger.InfoLog("PayslipViewModel::Exiting SendPaySlipsToEMail()")}catch(le){Logger.ErrorLog("PayslipViewModel::EXCEPTION SendPaySlipsToEMail()"+le.stack)}}btnFilter_Click(){try{this.sFilter="",B.d.SessionManager.Preferences.ContainsKey("PayslipFilter")&&parseInt(B.d.SessionManager.Preferences.PayslipFilter)>0&&"Widget"!=this.DisplayName?null==this.objEmpFilter?this.objEmpFilter=new Ve.t("",0,4):(this.objEmpFilter.CostCenterFilters.length>0?this.objEmpFilter.CostCenters.SelectedValue=this.objEmpFilter.CostCenterFilters[0].CostCenterID.toString():(this.objEmpFilter.Filter=4,this.objEmpFilter.InitControls()),this.objEmpFilter.CostCenters.Enable=!0):null==this.objEmpFilter?this.objEmpFilter=new Ve.t("",0,0):(this.objEmpFilter.Filter=0,this.objEmpFilter.InitControls()),this.objEmpFilter.Filter>0?B.d.page.ShowDialog(this.objEmpFilter,Ne.m,{ShowCenter:!0,HideHeader:!0}).subscribe(()=>{this.btnFilter_Click_CallBack()}):this.btnFilter_Click_CallBack()}catch(le){Logger.ErrorLog("PayslipViewModel::EXCEPTION btnFilter_Click()",le)}}btnFilter_Click_CallBack(){if(this.objEmpFilter.IsCompleted){if(this.objEmpFilter.CostCenterFilters.length>0){let Q=1,$="",me="",K="";for(let Se=0;Se<this.objEmpFilter.CostCenterFilters.length;Se++){let m=this.objEmpFilter.CostCenterFilters[Se];if(m.CostCenterID>5e4&&(Q=2,$="NodeID",me=50051==m.CostCenterID?"EmpSeqNo":"CCNID"+(m.CostCenterID-5e4)),m.SelectedNodes.length>0){if(1==m.SelectedNodes.length)K+=" AND ",K+=me+"="+m.SelectedNodes[0].Id;else if(!m.SelectedNodes.find(ie=>ie.Id==Q&&ie.IsGroup))if(K+=" AND ",lt.IPrefetchFilter.IsGroupTree(m)){let ie="";for(let j=0;j<m.SelectedNodes.length;j++)(null==m.SelectedNodes[j].Parent||!m.SelectedNodes[j].Parent.IsSelected)&&(ie.length>0&&(ie+=","),ie+=m.SelectedNodes[j].Id);0==ie.length&&(ie+=-12912),K+=me+" IN ",K+=" (select T."+$+" GTID from "+ae.A.GetTagTableName(m.CostCenterID)+" T with(nolock),",ae.A.GetTagTableName(m.CostCenterID),K+=ie.toString()+")  group by T."+$+")"}else{K+=me+" IN (";for(let ie=0;ie<m.SelectedNodes.length;ie++)ie>0&&(K+=","),K+=m.SelectedNodes[ie].Id;K+=")"}}else m.DeleteButtonVisibility||(K+=" AND ",K+=me+"=-12912")}this.sFilter=K.toString()}if(this.objEmpFilter.Filter>0){B.d.SessionManager.LocationID>0&&B.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&B.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(this.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+B.d.SessionManager.LocationID+")"),pe.J0.IsEmpty(B.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(this.sFilter+="  AND EmpSeqNo IN ("+B.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),4==this.objEmpFilter.Filter&&"All"!=this.objEmpFilter.PaymentModes.SelectedValue&&(this.sFilter+=" AND EMP.PaymentMode ='"+this.objEmpFilter.PaymentModes.SelectedValue+"' ");let Q=[];Q.push(B.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")),Q.push(this.sFilter),Q.push(1),Q.push(B.d.SessionManager.RoleID),Q.push(B.d.SessionManager.UserID),Q.push(B.d.SessionManager.LanguageID),this.dsEmps=B.d.empService.GetData(Q,"spPAY_GetEmpMasterCCDetails")}}}PrintVoucher(le){let $=this;if($.DisplayMessage="",!pe.J0.IsEmpty($.sDocIDs)){let me=null;me=$.drSelectedPrintLayout,null!=me&&B.d.report.VoucherExport_PDF(40054,$.IsPDFExport,$.sDocIDs,"",$.IsPDFExport,pe.J0.IntTryParse(this.cmbPayslipLayout.SelectedValue)).subscribe(K=>{console.log(K),$.IsPDFExport?le?B.d.SessionManager.printTab(K.FileName):B.d.SessionManager.Download(K.FileName,K.FileName):setTimeout(()=>{B.d.SessionManager.printTab(K.FileName)},500),pe.J0.IsEmpty(K.Message)&&!pe.J0.IsEmpty(K.FileName)&&(this.DisplayMessage="Exported Successfully")},K=>{console.log(K)})}return""}}},70824:(Pt,Le,V)=>{V.r(Le),V.d(Le,{RibbonExtPay:()=>As});var B=V(10467),pe=V(62846),Je=V(15091),o=V(86739),Me=V(72974),Ve=V(75782),lt=V(50334),ae=V(89417),a=V(54438),ce=V(60177),ye=V(8495),Ne=V(36688),De=V(73955);const it=()=>({standalone:!0});function le(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",7),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Process"))}),a.nrm(1,"i",22),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Process")))}function Q(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",7),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Post"))}),a.nrm(1,"i",23),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Post")))}function $(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",7),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("UnPost"))}),a.nrm(1,"i",24),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"UnPost")))}function me(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",7),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Export"))}),a.nrm(1,"i",25),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Export")))}function K(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",7),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Report"))}),a.nrm(1,"i",26),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Report")))}let Se=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){this.obj=this.params.obj}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-consolidated-monthly-payroll"]],decls:89,vars:32,consts:[[1,"maincontainer"],[1,"page-header"],[1,"page-title_div"],[1,"page-title"],[1,"page-Subtitle",3,"dblclick"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-filter"],[1,"fa-light","fa-search"],[1,"main_div",2,"display","flex","flex-direction","column","padding","10px"],[1,"row",2,"height","30px"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12",2,"padding-left","inherit"],["FieldDirective","",3,"obj"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12","divChk",2,"padding-left","inherit"],["type","checkbox",3,"ngModelChange","ngModel","ngModelOptions"],[3,"click"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12","divChk"],[1,"documentgrid",2,"flex","1","overflow","auto"],[2,"width","100%","height","100%",3,"obj"],[1,"fa-light","fa-gears"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-times"],[1,"fa-light","fa-file-export"],[1,"fa-light","fa-file-chart-line"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n      "),a.j41(2,"div",1),a.EFF(3,"\n        "),a.j41(4,"div",2),a.EFF(5,"\n          "),a.j41(6,"span",3),a.EFF(7),a.j41(8,"span",4),a.bIt("dblclick",function(r){return i.obj.sPayrollMonth_MouseDoubleClick(r)}),a.EFF(9),a.k0s(),a.EFF(10,"\n          "),a.k0s(),a.EFF(11,"\n        "),a.k0s(),a.EFF(12,"\n\n        "),a.j41(13,"div",5),a.EFF(14,"\n          "),a.DNE(15,le,4,3,"span",6),a.EFF(16,"\n          "),a.DNE(17,Q,4,3,"span",6),a.EFF(18,"\n          "),a.j41(19,"span",7),a.bIt("click",function(){return i.obj.Button_Click("Clear")}),a.nrm(20,"i",8),a.EFF(21),a.nI1(22,"translate"),a.k0s(),a.EFF(23,"\n          "),a.DNE(24,$,4,3,"span",6),a.EFF(25,"\n          "),a.j41(26,"span",7),a.bIt("click",function(){return i.obj.Button_Click("Filter")}),a.nrm(27,"i",9),a.EFF(28),a.nI1(29,"translate"),a.k0s(),a.EFF(30,"\n          "),a.j41(31,"span",7),a.bIt("click",function(){return i.obj.Button_Click("Load")}),a.nrm(32,"i",10),a.EFF(33),a.nI1(34,"translate"),a.k0s(),a.EFF(35,"\n          "),a.DNE(36,me,4,3,"span",6),a.EFF(37,"\n          "),a.DNE(38,K,4,3,"span",6),a.EFF(39,"           \n        "),a.k0s(),a.EFF(40,"\n      "),a.k0s(),a.EFF(41,"\n    "),a.j41(42,"div",11),a.EFF(43,"\n      "),a.j41(44,"div",12),a.EFF(45,"\n        "),a.j41(46,"div",13),a.EFF(47,"\n          "),a.eu8(48,14),a.EFF(49,"\n        "),a.k0s(),a.EFF(50,"\n        "),a.j41(51,"div",15),a.EFF(52,"\n          "),a.eu8(53,14),a.EFF(54,"\n        "),a.k0s(),a.EFF(55,"\n        "),a.j41(56,"div",15),a.EFF(57,"\n          "),a.eu8(58,14),a.EFF(59,"\n        "),a.k0s(),a.EFF(60,"\n      "),a.k0s(),a.EFF(61,"\n      "),a.j41(62,"div",12),a.EFF(63,"\n        "),a.j41(64,"div",16),a.EFF(65,"\n          "),a.j41(66,"input",17),a.mxI("ngModelChange",function(r){return a.DH7(i.obj.IsProcessWithArrears,r)||(i.obj.IsProcessWithArrears=r),r}),a.k0s(),a.EFF(67,"\n          "),a.j41(68,"label",18),a.bIt("click",function(){return i.obj.IsProcessWithArrears=!i.obj.IsProcessWithArrears}),a.EFF(69),a.nI1(70,"translate"),a.k0s(),a.EFF(71,"\n        "),a.k0s(),a.EFF(72,"\n        "),a.j41(73,"div",19),a.EFF(74,"\n          "),a.j41(75,"input",17),a.mxI("ngModelChange",function(r){return a.DH7(i.obj.IsProcessWithAdjustments,r)||(i.obj.IsProcessWithAdjustments=r),r}),a.k0s(),a.EFF(76,"\n          "),a.j41(77,"label",18),a.bIt("click",function(){return i.obj.IsProcessWithAdjustments=!i.obj.IsProcessWithAdjustments}),a.EFF(78),a.nI1(79,"translate"),a.k0s(),a.EFF(80,"\n        "),a.k0s(),a.EFF(81,"\n      "),a.k0s(),a.EFF(82,"\n        \n        "),a.j41(83,"div",20),a.EFF(84,"\n          "),a.nrm(85,"app-PactGridView",21),a.EFF(86,"  \n        "),a.k0s(),a.EFF(87,"\n    "),a.k0s(),a.EFF(88,"\n"),a.k0s()),2&t&&(a.R7$(7),a.SpI("\n            ",i.obj.Title,"\n            "),a.R7$(2),a.SpI("\n              ",i.obj.sPayrollMonth,"\n            "),a.R7$(6),a.Y8G("ngIf",i.obj.PostVisiblility),a.R7$(2),a.Y8G("ngIf",i.obj.PostVisiblility),a.R7$(4),a.JRh(a.bMT(22,20,"Clear")),a.R7$(3),a.Y8G("ngIf",i.obj.UnPostVisiblility),a.R7$(4),a.JRh(a.bMT(29,22,"Filter")),a.R7$(5),a.JRh(a.bMT(34,24,"Load")),a.R7$(3),a.Y8G("ngIf",i.obj.ExportVisiblility),a.R7$(2),a.Y8G("ngIf",i.obj.ReportInfoVisibility),a.R7$(10),a.Y8G("obj",i.obj.chkPostBasedOnDailyAttendance),a.R7$(5),a.Y8G("obj",i.obj.chkIncludeOTHours),a.R7$(5),a.Y8G("obj",i.obj.chkPostBasedOnAttDimWise),a.R7$(8),a.R50("ngModel",i.obj.IsProcessWithArrears),a.Y8G("ngModelOptions",a.lJ4(30,it)),a.R7$(3),a.JRh(a.bMT(70,26,"ProcesswithArrears")),a.R7$(6),a.R50("ngModel",i.obj.IsProcessWithAdjustments),a.Y8G("ngModelOptions",a.lJ4(31,it)),a.R7$(3),a.JRh(a.bMT(79,28,"ProcesswithAdjustments")),a.R7$(7),a.Y8G("obj",i.obj.dgvEmployees))},dependencies:[ce.bT,ye._,ae.Zm,ae.BC,Ne.X,ae.vS,De.D9],encapsulation:2})}return F})();var m=V(8787),ie=V(95707),j=V(32647),ue=V(49710),Re=V(23823),yt=V(33547),L=V(18569),X=V(92701),Oe=V(72743),Ue=V(35275),xe=V(7023),fe=V(5464),Mt=V(62288);class Ut extends Re.g{constructor(s){super(),this.DialogResult=!1,this.dtData=null,this.dtDataColumns=null,this.ExcelData=[],this.DisplayMessage="",this.Parent=s[0],this.Parent.Opacity=.3,this.dgv=new ue.vv,this.dgv.Columns=new Array,this.dgv.Width="450",this.dgv.Table=[]}Button_Click(s){if("Load"==s.toString()){if(0==this.dgv.Table.length)return this.DisplayMessage="View the data before loading.",void(this.MessageVisibility=!0);try{let t;this.dtData=[],this.dtDataColumns=[];for(let i=0;i<this.dgv.Columns.length;i++)this.dtDataColumns.push(this.dgv.TableColumns[i]);for(let i=0;i<this.dgv.Table.length;i++){t={};for(let n=0;n<this.dgv.Columns.length;n++)null!=this.dgv.Table[i][n]&&null!=this.dgv.Table[i][n]&&(t[n]=this.dgv.Table[i][n].toString());this.dtData.push(t)}this.dtData=this.dgv.Table}catch{}null!=this.Parent&&(this.Parent.Opacity=1,this.Parent.DialogResult=!0),this.DialogResult=!0,o.d.page.HideDialog(this.PopUpGUID)}else if("View"==s.toString()){let t;this.dgv.Columns.Clear(),this.dgv.TableColumns.Clear(),this.dgv.Clear();var l=new Array;if(null!=this.ExcelTable&&this.ExcelTable.length>0){for(let n=0;n<this.ExcelTableColumns.length;n++)t=new L.O7,t.Header=this.ExcelTableColumns[n],t.DisplayMember=this.ExcelTableColumns[n],t.ID=this.ExcelTableColumns[n],t.Width=100,t.ReadOnly=!0,l.push(t),this.dgv.TableColumns.push(this.ExcelTableColumns[n]);let i;this.dgv.Columns=l;for(let n=1;n<this.ExcelTable.length;n++){i=this.dgv.NewRow();for(let r=0;r<this.ExcelTableColumns.length;r++)i[this.ExcelTableColumns[r]]=this.ExcelTable[n][r];this.dgv.Table.push(i),this.dgv.updateRow(i)}this.dgv.RefreshGrid=!0,this.dgv.refreshDataView()}}else"Browse"==s.toString()||"Cancel"==s.toString()&&(null!=this.Parent&&(this.Parent.Opacity=1,this.Parent.DialogResult=!1),this.DialogResult=!1,o.d.page.HideDialog(this.PopUpGUID));Logger.InfoLog("ConsMPLoadViewModel::Exiting Button_Click")}OpenFile(s){if(1!==s.target.files.length)throw new Error("Cannot use multiple files");const l=new FileReader,t=s.target.files[0];this.fileExt=t.name.split(".").pop(),this.fileName=t.name,l.onload=i=>{const d=Mt.LF(l.result,{type:"binary"});if(this.ExcelData=Mt.Wp.sheet_to_json(d.Sheets[d.SheetNames[0]],{header:1}),!m.J0.IsEmpty(this.ExcelData)&&this.ExcelData.length>0)try{this.ExcelTable=this.ExcelData,this.ExcelTableColumns=this.ExcelData[0],this.ActualFileName=this.fileName}catch(c){return void(this.DisplayMessage=c.Message)}},l.readAsBinaryString(t)}}let Yt=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-cons-mpload"]],decls:52,vars:18,consts:[["fileUpload",""],[1,"master-screen",2,"padding-bottom","4px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row","form-row",2,"margin-bottom","10px","flex-direction","row","display","flex","align-items","center"],[1,"col-md-auto","col-sm-12","col-xs-12"],[1,"input_cntrl_label",2,"margin-right","10px"],["type","text","readonly","",3,"ngModelChange","ngModel"],[1,"col-xl-2","col-md-2","col-sm-12","col-xs-12",2,"display","flex !important"],["type","file","accept",".xlsx,.xls,.csv","name","upload",2,"display","none",3,"change"],[1,"secondary-btn-wicon",2,"border","0px !important",3,"click"],[1,"fa-light","fa-search"],[1,"form-group","row","form-row","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(t,i){if(1&t){const n=a.RV6();a.j41(0,"div",1),a.EFF(1,"\n    "),a.j41(2,"div",2),a.EFF(3,"\n        "),a.j41(4,"div",3),a.EFF(5,"\n            "),a.j41(6,"div",4),a.EFF(7,"\n                "),a.j41(8,"label",5),a.EFF(9),a.nI1(10,"translate"),a.k0s(),a.EFF(11,"\n                "),a.j41(12,"input",6),a.mxI("ngModelChange",function(d){return a.eBV(n),a.DH7(i.obj.ActualFileName,d)||(i.obj.ActualFileName=d),a.Njj(d)}),a.k0s(),a.EFF(13,"\n            "),a.k0s(),a.EFF(14,"\n            "),a.j41(15,"div",7),a.EFF(16,"\n                "),a.j41(17,"input",8,0),a.bIt("change",function(d){return a.eBV(n),a.Njj(i.obj.OpenFile(d))}),a.k0s(),a.EFF(19,"               \n                "),a.j41(20,"span",9),a.bIt("click",function(){a.eBV(n);const d=a.sdS(18);return a.Njj(d.click())}),a.nrm(21,"i",10),a.EFF(22),a.nI1(23,"translate"),a.k0s(),a.EFF(24,"\n             \n            "),a.k0s(),a.EFF(25,"\n        "),a.k0s(),a.EFF(26,"  \n            \n        "),a.j41(27,"div",11),a.EFF(28,"\n            "),a.eu8(29,12),a.EFF(30,"\n        "),a.k0s(),a.EFF(31,"\n    "),a.k0s(),a.EFF(32,"\n    "),a.j41(33,"div",13),a.EFF(34,"\n        "),a.j41(35,"div"),a.EFF(36,"\n            "),a.j41(37,"button",14),a.bIt("click",function(){return a.eBV(n),a.Njj(i.obj.Button_Click("Load"))}),a.EFF(38),a.nI1(39,"translate"),a.k0s(),a.EFF(40,"\n            "),a.j41(41,"button",15),a.bIt("click",function(){return a.eBV(n),a.Njj(i.obj.Button_Click("View"))}),a.EFF(42),a.nI1(43,"translate"),a.k0s(),a.EFF(44,"\n            "),a.j41(45,"button",15),a.bIt("click",function(){return a.eBV(n),a.Njj(i.obj.Button_Click("Cancel"))}),a.nrm(46,"i",16),a.EFF(47),a.nI1(48,"translate"),a.k0s(),a.EFF(49,"\n           \n        "),a.k0s(),a.EFF(50,"\n    "),a.k0s(),a.EFF(51,"\n"),a.k0s()}2&t&&(a.R7$(9),a.JRh(a.bMT(10,8,"Com_Attachments_FileName")),a.R7$(3),a.R50("ngModel",i.obj.ActualFileName),a.R7$(10),a.JRh(a.bMT(23,10,"Browse")),a.R7$(7),a.Y8G("obj",i.obj.dgv)("group",i.form),a.R7$(9),a.JRh(a.bMT(39,12,"Load")),a.R7$(4),a.JRh(a.bMT(43,14,"View")),a.R7$(5),a.JRh(a.bMT(48,16,"Cancel")))},dependencies:[ye._,ae.me,ae.BC,ae.vS,De.D9],encapsulation:2})}return F})();var Ye=V(61994),nt=V(2578),Xe=V(38816),Ce=V(72099),St=V(39032),qe=V(98669),Ke=V(36466);class je extends Re.g{get SelectAll(){return this._SelectAll}set SelectAll(s){s!=this._SelectAll&&(this._SelectAll=s,this.SelectUnselectAll(s))}SerializeGridColumnType(){this.GridColumnType.ContainsKey("id")||this.GridColumnType.push("id","Int64");for(let s=0;s<this.dgvEmployees.TableColumns.length;s++);}get ReportInfoVisibility(){return this._ReportInfoVisibility}set ReportInfoVisibility(s){s!=this._ReportInfoVisibility&&(this._ReportInfoVisibility=s)}constructor(s){super(),this.Opacity=1,this.DialogResult=!1,this.ProgressVisibility=!1,this.ProgressValue=0,this.ProgressMax=0,this._SelectAll=!1,this.IsProcessWithArrears=!1,this.IsProcessWithAdjustments=!1,this.chkPostBasedOnDailyAttendance=new Ce.c,this.chkPostBasedOnAttDimWise=new Ce.c,this.chkIncludeOTHours=new Ce.c,this.PostVisiblility=!0,this.UnPostVisiblility=!0,this.ExportVisiblility=!0,this.GridColumnType=new ie.bT,this.dsDailyAttendanceData=null,this.ReportsList=[],this.dsData=null,this._ReportInfoVisibility=!0,this.ButtonReport=new Ke.v,this.CostCenterID=0,this.sCrAccount="0",this.sDrAccount="0",this.dtRes=null,this.drwRes=null,this.dtCust=null,this.SelectUnCheck=0,this.objCMPLData=null,this.IsProcessed=!1,this.sFilter="",this.iColId=0,this.sBGWorkType="",this.dtArrData=null,this.dtAdjData=[],this.sAdjsCalcMonths="",this.sAdjCalcMonthPaydays="",this.iEmpIndex=0,this.strResult="",this.Failed="",this.FailedCount=0,this.DefProdID=0,this.ErrorMessage="Missing Report Parameter ' ";try{Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering ConsolidatedMonthlyPayrollViewModel()"),this.ClassName="ConsolidatedMonthlyPayrollViewModel",this.CostCenterID=40054,this.dtRes=o.d.common.GetDataTable("PAY073",o.d.SessionManager.LangID),this.DisplayName=o.d.GetResource(s.Replace(" ","")),this.Title=o.d.GetResource(s.Replace(" ","")),this.DisplayMessage="",this.sPayrollMonth=" / ["+o.d.SessionManager.PayrollMonth.ToString("MMM-yyyy")+"]",this.lblPayrollMonth=o.d.SessionManager.PayrollMonth.ToString("MMM, yyyy"),this.lblPayrollMonthStart=o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy"),this.lblPayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy"),this.PostVisiblility=o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Create"),this.UnPostVisiblility=o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"),this.ExportVisiblility=o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Export"),this.chkPostBasedOnDailyAttendance.Label=o.d.GetResource("PostbasedonDailyAttendance"),this.chkIncludeOTHours.Label=o.d.GetResource("IncludeOverTimeHours"),this.chkPostBasedOnAttDimWise.Label=o.d.GetResource("PostbasedonAttendanceDimensionwise"),this.LoadGrid(),this.btnFilter_Click(),o.d.SessionManager.Preferences.ContainsKey("DefaultPostbasedonAttendanceDimensionWise")&&"True"==o.d.SessionManager.Preferences.DefaultPostbasedonAttendanceDimensionWise?this.chkPostBasedOnAttDimWise.IsChecked=!0:"True"==o.d.SessionManager.Preferences.GetDailyAttendanceDataInMonthlyPayroll&&(this.chkPostBasedOnDailyAttendance.IsChecked=!0,this.chkIncludeOTHours.IsChecked=!0),this.ReportView()}catch(l){Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION ConsolidatedMonthlyPayrollViewModel()",l)}}sPayrollMonth_MouseDoubleClick(s){let l=new Je.SetPayrollDateViewModel;o.d.page.ShowDialog(l,Me.SetPayrollDateComponent,{ShowCenter:!0,Title:o.d.GetResource("Pay_SetPayrollDate")}).subscribe(()=>{l.DialogResult&&this.btnClear_Click()})}dgvEmployees_EndEdit(s,l,t){let i=this.dgvEmployees.Table.indexOf(s);if(this.iEmpIndex=this.lstSelectedEmps.indexOf(i),!(this.iEmpIndex<0)){if(o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)for(let n=0;n<this.oCMP.GradeMPFls.length;n++)this.oCMP.GradeMPFls[n].lstGradeEmps.Contains(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo))&&(o.d.SessionManager.PayrollMonth=this.oCMP.GradeMPFls[n].GradePayrollMonth,o.d.SessionManager.PayrollMonthStart=this.oCMP.GradeMPFls[n].GradePayrollMonthStart,o.d.SessionManager.PayrollMonthEnd=this.oCMP.GradeMPFls[n].GradePayrollMonthEnd);"DaysAttended"==l?(this.oCMP.SetDaysAttended(this.iEmpIndex,"Days Attended",parseFloat(s[l])),this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays<0?(this.DisplayMessage=o.d.GetResource("EnterValidDaysAttended"),this.MessageVisibility=!0):this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP>0&&parseFloat(this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays.ToString("N1"))<parseFloat(this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP.ToString("N1"))?(this.DisplayMessage="Employee Should have atleast "+this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP+" LOP Days",this.MessageVisibility=!0):this.DisplayMessage="",s.LOPDays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays.ToString("0.0")):"LOPDays"==l?this.oCMP.SetDaysAttended(this.iEmpIndex,"LOP",parseFloat(s[l])):l.startsWith("EarningOTHrs")?this.oCMP.ReEvaluateData(this.iEmpIndex,1,parseInt(l.Replace("EarningOTHrs","")),s[l].toString()):l.startsWith("Earning")&&!l.endsWith("_Arr")?this.oCMP.ReEvaluateData(this.iEmpIndex,0,parseInt(l.Replace("Earning","")),s[l].toString()):l.startsWith("DeductionOTHrs")?this.oCMP.ReEvaluateData(this.iEmpIndex,3,parseInt(l.Replace("DeductionOTHrs","")),s[l].toString()):l.startsWith("Deduction")&&!l.endsWith("_Arr")?this.oCMP.ReEvaluateData(this.iEmpIndex,2,parseInt(l.Replace("Deduction","")),s[l].toString()):l.startsWith("dcAlpha")?l.endsWith("_Key")?this.oCMP.UpdateExtraFieldData(this.iEmpIndex,l.Replace("_Key",""),m.J0.ParseDate(s[l]).ToString("dd/MMM/yyyy")):this.oCMP.UpdateExtraFieldData(this.iEmpIndex,l,s[l].toString()):l.startsWith("dcCCNID")&&(Object.keys(s).Contains(l+"_Key")?this.oCMP.UpdateExtraFieldData(this.iEmpIndex,l,s[l+"_Key"].toString()):this.oCMP.UpdateExtraFieldData(this.iEmpIndex,l,s[l].toString())),this.dgvEmployees.updateRow(s),this.FillProcessedData(i)}}GetResource(s,l){let t=s;return this.drwRes=this.dtRes.filter(i=>i.CCID==l&&i.Code==s),null!=this.drwRes&&this.drwRes.length>0?1==o.d.SessionManager.LanguageID?this.drwRes[0].Name.toString():this.drwRes[0].AliasName.toString():t}LoadGrid(){let l,s=new yt.ControlGenerator;this.dsDocDesig=s.GetScreenInfo(this.CostCenterID),l=this.dsDocDesig.Tables[0].filter(n=>"CreditAccount"==n.SysColumnName),null!=l&&l.length>0&&!m.J0.IsEmptySpace(l[0].UserDefaultValue)&&(this.sCrAccount=l[0].UserDefaultValue.toString()),l=this.dsDocDesig.Tables[0].filter(n=>"DebitAccount"==n.SysColumnName),null!=l&&l.length>0&&!m.J0.IsEmptySpace(l[0].UserDefaultValue)&&(this.sDrAccount=l[0].UserDefaultValue.toString()),this.dgvEmployees=new ue.vv,this.dgvEmployees.gridtype="CMP",this.dgvEmployees.Height=0,this.dgvEmployees.SelectAll.Visible=!0,this.dgvEmployees.OnCellEditEnding.Subscribe(this,"dgvEmployees_EndEdit"),this.dgvEmployees.CanUserDeleteRows=!0,this.dgvEmployees.UpdateFooter(),this.dgvEmployees.UpdateTotals();let t=new L.O7;if(this.dgvEmployees.Columns=new Array,this.dgvEmployees.Table=[],t=new L.O7,t.Header=this.GetResource("Select",40054),t.DisplayMember="Select",t.ID="Select",t.DataType="CheckBox",t.Width=50,t.IsFrozen=!0,t.CheckedChanged.Subscribe(this,"dgColSelect_CheckedChanged"),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("Select"),this.dgvEmployees.DataTypes.Bool.push("Select"),t=new L.O7,t.Header=this.GetResource("S No",40054),t.DisplayMember="SNo",t.ID="SNo",t.DataType="TextBlock",t.Width=50,t.ReadOnly=!0,t.IsFrozen=!0,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("SNo"),t=new L.O7,t.Header="EmpSeqNo",t.DisplayMember="EmpSeqNo",t.ID="EmpSeqNo",t.DataType="TextBlock",t.Width=50,t.ReadOnly=!0,t.IsFrozen=!0,t.IsVisible=!1,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("EmpSeqNo"),t=new L.O7,t.Header=this.GetResource("Employee Code",40054),t.DisplayMember="EmpCode",t.ID="EmpCode",t.CrRefColName="dcCCNID51",t.DataType="TextBlock",t.Width=150,t.ReadOnly=!0,t.IsFrozen=!0,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("EmpCode"),t=new L.O7,t.Header=this.GetResource("Employee Name",40054),t.DisplayMember="EmpName",t.ID="EmpName",t.CrRefColName="dcCCNID51",t.DataType="TextBlock",t.Width=250,t.ReadOnly=!0,t.IsFrozen=!0,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("EmpName"),t=new L.O7,t.Header="GradeID",t.DisplayMember="GradeID",t.ID="GradeID",t.DataType="TextBlock",t.Width=250,t.ReadOnly=!0,t.IsFrozen=!0,t.IsVisible=!1,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("GradeID"),t=new L.O7,t.Header=this.GetResource("dcAlpha3",40054),t.DisplayMember="NetSalary",t.ID="NetSalary",t.CrRefColName="dcAlpha3",t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.Width=90,t.ReadOnly=!0,t.IsFontBold=!0,t.IsFrozen=!0,t.ShowTotal=!0,t.IsCalculated=1,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("NetSalary"),this.dgvEmployees.DataTypes.Double.push("NetSalary"),t=new L.O7,t.Header=this.GetResource("Month Days",40054),t.DisplayMember="MonthDays",t.ID="MonthDays",t.CrRefColName="dcAlpha4",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("MonthDays"),this.dgvEmployees.DataTypes.Double.push("MonthDays"),t=new L.O7,t.Header=this.GetResource("dcAlpha5",40054),t.DisplayMember="DaysAttended",t.ID="DaysAttended",t.CrRefColName="dcAlpha5",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!1,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("DaysAttended"),this.dgvEmployees.DataTypes.Double.push("DaysAttended"),t=new L.O7,t.Header=this.GetResource("dcAlpha24",40054),t.DisplayMember="PaidLeaves",t.ID="PaidLeaves",t.CrRefColName="dcAlpha24",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,t.ForeColor="Gray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("PaidLeaves"),this.dgvEmployees.DataTypes.Double.push("PaidLeaves"),t=new L.O7,t.Header=this.GetResource("dcAlpha6",40054),t.DisplayMember="TotalLeaves",t.ID="TotalLeaves",t.CrRefColName="dcAlpha6",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,t.ForeColor="Gray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("TotalLeaves"),this.dgvEmployees.DataTypes.Double.push("TotalLeaves"),t=new L.O7,t.Header=this.GetResource("dcAlpha7",40054),t.DisplayMember="WeeklyOffs",t.ID="WeeklyOffs",t.CrRefColName="dcAlpha7",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,t.ForeColor="Gray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("WeeklyOffs"),this.dgvEmployees.DataTypes.Double.push("WeeklyOffs"),t=new L.O7,t.Header=this.GetResource("dcAlpha8",40054),t.DisplayMember="Holidays",t.ID="Holidays",t.CrRefColName="dcAlpha8",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,t.ForeColor="Gray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("Holidays"),this.dgvEmployees.DataTypes.Double.push("Holidays"),t=new L.O7,t.Header=this.GetResource("dcAlpha9",40054),t.DisplayMember="LOPDays",t.ID="LOPDays",t.CrRefColName="dcAlpha9",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!1,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("LOPDays"),this.dgvEmployees.DataTypes.Double.push("LOPDays"),t=new L.O7,t.Header=this.GetResource("dcAlpha10",40054),t.DisplayMember="UnpaidDays",t.ID="UnpaidDays",t.CrRefColName="dcAlpha10",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,t.ForeColor="Gray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("UnpaidDays"),this.dgvEmployees.DataTypes.Double.push("UnpaidDays"),t=new L.O7,t.Header=this.GetResource("dcAlpha4",40054),t.DisplayMember="TotalDays",t.ID="TotalDays",t.CrRefColName="dcAlpha4",t.DataType="FLOAT",t.DecimalPoints="1",t.Width=60,t.ReadOnly=!0,t.ForeColor="Gray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("TotalDays"),this.dgvEmployees.DataTypes.Double.push("TotalDays"),this.dsStructure=o.d.common.GetDataSet("PAY058",o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")),null!=this.dsStructure&&this.dsStructure.Tables.length>0){if(l=this.dsStructure.Tables[0].filter(n=>1==n.Type&&"Yes"==n.Applicable),l.SortBy(["SNo"]),null!=l&&l.length>0)for(let n=0;n<l.length;n++)!m.J0.IsEmpty(l[n].Behaviour)&&("Accruals"==l[n].Behaviour.toString()||"Accruals-AccumulateForPreviousYears"==l[n].Behaviour.toString())||(t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052),t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="Earning"+l[n].SNo.toString(),t.ID="Earning"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="LightBlue",t.Width=80,"OverTime"==l[n].FieldType.toString()?(t.DisplayMember="EarningOTHrs"+l[n].SNo.toString(),t.ID="EarningOTHrs"+l[n].SNo.toString(),t.DecimalPoints="2",t.Width=60,t.ReadOnly=!1):"Monthly"==l[n].FieldType.toString()?t.ReadOnly=!1:t.ForeColor="Gray","-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember),"OverTime"==l[n].FieldType.toString()&&(t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052)+"_Amount",t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="EarningOTAmt"+l[n].SNo.toString(),t.ID="EarningOTAmt"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.Width=80,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.ForeColor="Gray",t.HeaderBackColor="LightBlue","-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember)));if(t=new L.O7,t.Header=this.GetResource("dcAlpha11",40054),t.DisplayMember="TotalEarnings",t.ID="TotalEarnings",t.CrRefColName="dcAlpha11",t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="LightBlue",t.Width=90,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember),null!=l&&l.length>0)for(let n=0;n<l.length;n++)!m.J0.IsEmpty(l[n].Behaviour)&&("Accruals"==l[n].Behaviour.toString()||"Accruals-AccumulateForPreviousYears"==l[n].Behaviour.toString())&&(t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052),t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="Earning"+l[n].SNo.toString(),t.ID="Earning"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="GreenYellow",t.Width=80,"Monthly"==l[n].FieldType.toString()?t.ReadOnly=!1:t.ForeColor="Gray","-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember));if(l=this.dsStructure.Tables[0].filter(n=>2==n.Type&&"Yes"==n.Applicable),l.SortBy(["SNo"]),null!=l&&l.length>0)for(let n=0;n<l.length;n++)t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052),t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="Deduction"+l[n].SNo.toString(),t.ID="Deduction"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="LightCoral",t.Width=80,"OverTime"==l[n].FieldType.toString()?(t.DisplayMember="DeductionOTHrs"+l[n].SNo.toString(),t.ID="DeductionOTHrs"+l[n].SNo.toString(),t.DecimalPoints="2",t.Width=60,t.ReadOnly=!1):"Monthly"==l[n].FieldType.toString()?t.ReadOnly=!1:t.ForeColor="Gray","-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember),"OverTime"==l[n].FieldType.toString()&&(t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052)+"_Amount",t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="DeductionOTAmt"+l[n].SNo.toString(),t.ID="DeductionOTAmt"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.Width=80,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.ForeColor="Gray",t.HeaderBackColor="LightCoral","-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember));if(l=this.dsStructure.Tables[0].filter(n=>3==n.Type),l.SortBy(["SNo"]),null!=l&&l.length>0)for(let n=0;n<l.length;n++)t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052),t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="Loan"+l[n].SNo.toString(),t.ID="Loan"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.ForeColor="Gray",t.HeaderBackColor="LightGoldenrodYellow",t.Width=80,"-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember);if(t=new L.O7,t.Header=this.GetResource("dcAlpha12",40054),t.DisplayMember="TotalDeductions",t.ID="TotalDeductions",t.CrRefColName="dcAlpha12",t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="LightCoral",t.Width=90,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember),l=this.dsStructure.Tables[0].filter(n=>4==n.Type),l.SortBy(["SNo"]),null!=l&&l.length>0)for(let n=0;n<l.length;n++)t=new L.O7,t.Header=this.GetResource(l[n].ComponentCode.toString(),50052),t.CrRefColID=parseInt(l[n].ComponentID),t.DisplayMember="Leave"+l[n].SNo.toString(),t.ID="Leave"+l[n].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints="1",t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.ForeColor="Gray",t.HeaderBackColor="LightGreen",t.Width=60,"-1"!=l[n].Visible.toString()&&(t.IsVisible="1"==l[n].Visible.toString()),"-1"!=l[n].Width.toString()&&(t.Width=parseInt(l[n].Width)),"-1"!=l[n].IndexValue.toString()&&(t.DisplayIndex=parseInt(l[n].IndexValue)),"-1"!=l[n].ReadOnly.toString()&&(t.ReadOnly="1"==l[n].ReadOnly.toString()),"-1"!=l[n].Mandatory.toString()&&(t.Mandatory="1"==l[n].Mandatory.toString()),this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push(t.DisplayMember),this.dgvEmployees.DataTypes.Double.push(t.DisplayMember)}let i=this.dsDocDesig.Tables[0].filter(n=>1==n.IsColumnUserDefined&&(2==n.SectionID&&"H"==n.SectionName||3==n.SectionID));if(null!=i&&i.length>0)for(let n=0;n<i.length;n++){switch(t=new L.O7,t.Header=this.GetResource(i[n].SysColumnName.toString(),40054),t.DisplayMember=i[n].SysColumnName.toString(),t.ID=i[n].SysColumnName.toString(),t.CrRefColName=i[n].SysColumnName.toString(),t.DataType=i[n].ColumnDataType.toString(),t.IsColumnUserDefined=(0,j.yG0)(i[n].IsColumnUserDefined),t.Mandatory=(0,j.yG0)(i[n].IsMandatory),t.DataType.toUpperCase()){case"LISTBOX":t.ValueMember=t.ID+"_Key",this.dgvEmployees.TableColumns.push(t.ID),this.dgvEmployees.TableColumns.push(t.ID+"_Key"),this.dgvEmployees.DataTypes.Int.push(t.ID+"_Key"),t.CostCenterID=parseInt(i[n].ColumnCostCenterID.toString()),t.TypeID=parseInt(i[n].ColumnCCListViewTypeID.toString()),m.J0.IsEmpty(i[n].FetchMaxRows)?m.J0.IsEmpty(i[n].UserProbableValues)||(t.FilterColumn=i[n].UserProbableValues.toString()):t.GridViewID=parseInt(i[n].FetchMaxRows.toString());break;case"TEXT":case"STRING":case"COMBOBOX":if(this.dgvEmployees.TableColumns.push(t.ID),t.IsColumnUserDefined)if("Date"==i[n].UserColumnType.toString()&&(t.DataType="DATE",this.dgvEmployees.TableColumns.push(t.ID+"_Key"),this.dgvEmployees.DataTypes.Date.push(t.ID+"_Key")),"DateTime"==i[n].UserColumnType.toString())t.DataType="DATETIME",this.dgvEmployees.TableColumns.push(t.ID+"_Key");else if("Time"==i[n].UserColumnType.toString())t.DataType="TIME",this.dgvEmployees.TableColumns.push(t.ID+"_Key");else if("Numeric"==i[n].UserColumnType.toString())t.DataType="FLOAT";else if("SELECTIONBOX"==i[n].UserColumnType.toString()||"editablecombobox"==i[n].UserColumnType.toString().toLowerCase())t.DataType="SELECTIONBOX",t.CostCenterID=this.CostCenterID;else if("combobox"==i[n].UserColumnType.toString().toLowerCase()){if(t.ValueBinding=t.ID,!m.J0.IsEmpty(i[n].linkData)&&22803==parseInt(i[n].linkData.toString())||"@YEAR"==t.DefaultValue){t.DataType="PactComboBox";let r=[];for(let d=1980;d<2100;d++){let C={};C.Year=d.toString(),r.push(C)}t.DisplayMember="Year",t.ValueMember="Year",t.ComboData=r,"@YEAR"==t.DefaultValue&&(t.DefaultValue="")}else{t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value";let r=[],d=i[n].UserProbableValues.toString().Trim();if(d.length>0){let C=d.split(";");for(let h=0;h<C.length;h++)r.push(X._p.ComboBoxItems_2(C[h],C[h]))}t.ComboData=r}this.dgvEmployees.TableColumns.push(t.ID+"_Key")}else if("LISTBOX"==i[n].UserColumnType.toString())if(44==parseInt(i[n].ColumnCostCenterID.toString())){t.ValueBinding=t.ID,t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value";let r=je.GetLookupData(parseInt(i[n].ColumnCCListViewTypeID));if(null!=r){let d=[];for(let C=0;C<r.length;C++)d.push(X._p.ComboBoxItems_2(r[C].Name.toString(),r[C].NodeID.toString()));t.ComboData=d}this.dgvEmployees.TableColumns.push(t.ID+"_Key")}else t.DataType="LISTBOX",t.ValueMember=t.ID+"_Key",this.dgvEmployees.TableColumns.push(t.ID+"_Key"),t.CostCenterID=parseInt(i[n].ColumnCostCenterID.toString()),t.TypeID=parseInt(i[n].ColumnCCListViewTypeID.toString());else if("Attachment"==i[n].UserColumnType.toString())t.DataType="LINK",t.ReadOnly=!0,t.FilterCondition=i[n].BasedOnXml.toString(),t.Dependantinuse=!1;else if("Image"==i[n].UserColumnType.toString())t.DataType="LINK",t.ReadOnly=!0,t.Dependantinuse=!0;else if("LOOKUP"==i[n].UserColumnType.toString()){t.ValueBinding=t.ID,t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value";let r=je.GetLookupData(parseInt(i[n].ColumnCCListViewTypeID));if(null!=r){let d=[];for(let C=0;C<r.length;C++)d.push(X._p.ComboBoxItems_2(r[C].Name.toString(),r[C].NodeID.toString()));t.ComboData=d}this.dgvEmployees.TableColumns.push(t.ID+"_Key")}break;case"DATE":t.DataType="DATE",this.dgvEmployees.TableColumns.push(t.ID),this.dgvEmployees.TableColumns.push(t.ID+"_Key"),this.dgvEmployees.DataTypes.Date.push(t.ID+"_Key")}t.Width=100,t.HeaderBackColor="LightGray",this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.Contains(i[n].SysColumnName.toString())||this.dgvEmployees.TableColumns.push(i[n].SysColumnName.toString())}if(this.dtCust=o.d.common.GetDataTable("PAY059",o.d.SessionManager.RoleID),null!=this.dtCust&&this.dtCust.length>0){let n=new m.VB;if(n.ReadXml(this.dtCust[0].ValueXml.toString()),null!=n&&n.Tables.length>0&&n.Tables[0].length>0){let r,d=3;for(let C=0;C<this.dgvEmployees.Columns.length;C++)r=n.Tables[0].filter(h=>h.SysColumnName==this.dgvEmployees.Columns[C].CrRefColName),r.length>0?(this.dgvEmployees.Columns[C].DisplayIndex=parseInt(r[0].Index)+d,this.dgvEmployees.Columns[C].Width=parseInt(r[0].Width),this.dgvEmployees.Columns[C].ReadOnly=null!=r[0].ReadOnly&&null!=r[0].ReadOnly&&"1"==r[0].ReadOnly.toString(),this.dgvEmployees.Columns[C].Mandatory=null!=r[0].Mandatory&&null!=r[0].Mandatory&&"1"==r[0].Mandatory.toString(),this.dgvEmployees.Columns[C].IsVisible=null!=r[0].Visible&&null!=r[0].Visible&&"1"==r[0].Visible.toString()):(r=n.Tables[0].filter(h=>h.ID==this.dgvEmployees.Columns[C].CrRefColID),null!=r&&r.length>0?(this.dgvEmployees.Columns[C].DisplayIndex=parseInt(r[0].Index)+d,this.dgvEmployees.Columns[C].Width=parseInt(r[0].Width),this.dgvEmployees.Columns[C].ReadOnly=null!=r[0].ReadOnly&&null!=r[0].ReadOnly&&"1"==r[0].ReadOnly.toString(),this.dgvEmployees.Columns[C].Mandatory=null!=r[0].Mandatory&&null!=r[0].Mandatory&&"1"==r[0].Mandatory.toString(),this.dgvEmployees.Columns[C].IsVisible=null!=r[0].Visible&&null!=r[0].Visible&&"1"==r[0].Visible.toString()):(r=n.Tables[0].filter(h=>h.ID==-this.dgvEmployees.Columns[C].CrRefColID),null!=r&&r.length>0?(this.dgvEmployees.Columns[C].DisplayIndex=parseInt(r[0].Index)+d,this.dgvEmployees.Columns[C].Width=parseInt(r[0].Width),this.dgvEmployees.Columns[C].ReadOnly=null!=r[0].ReadOnly&&null!=r[0].ReadOnly&&"1"==r[0].ReadOnly.toString(),this.dgvEmployees.Columns[C].Mandatory=null!=r[0].Mandatory&&null!=r[0].Mandatory&&"1"==r[0].Mandatory.toString(),this.dgvEmployees.Columns[C].IsVisible=null!=r[0].Visible&&null!=r[0].Visible&&"1"==r[0].Visible.toString()):this.dgvEmployees.Columns[C].DisplayIndex=C))}this.dgvEmployees.Columns.SortBy([{name:"DisplayIndex",parser:parseInt}])}t=new L.O7,t.Header=this.GetResource("Result",40054),t.DisplayMember="Result",t.ID="Result",t.DataType="TextBlock",t.Width=250,t.ReadOnly=!0,this.dgvEmployees.Columns.push(t),this.dgvEmployees.TableColumns.push("Result"),this.dgvEmployees.OnPreviewKeyDown.Subscribe(this,"OnPreviewKeyDown")}OnPreviewKeyDown(s,l,t){if("F5"==l.key){var i=this.dgvEmployees.Columns.find(n=>n.DisplayMember==t);if(null!=i){if(i.ReadOnly||"sno"==t.toLowerCase()||!confirm("Do you want to override all.?"))return!0;for(let n=0;n<this.dgvEmployees.Table.length;n++)this.dgvEmployees.Table[n][t]=s[t].toString(),this.dgvEmployees.TableColumns.Contains(t+"_Key")&&(this.dgvEmployees.Table[n][t+"_Key"]=s[t+"_Key"].toString()),this.dgvEmployees.updateRow(this.dgvEmployees.Table[n]),this.dgvEmployees_EndEdit(this.dgvEmployees.Table[n],t,-1)}}else if(l.ctrlKey)if("F"==l.key)this.dgvEmployees.SearchVisible?this.dgvEmployees.SearchVisible=!1:(this.dgvEmployees.SearchVisible=!0,this.dgvEmployees.AddSearchCols()),l.Handled=!0;else if("E"==l.key){let n=this.GetRawExportHTML().toString();const r=new Blob([n],{type:"text/plain;charser=utf-8"});nt.saveAs(r,this.ScreenName+"_XlsExport_"+(new Date).getTime()+".xls"),l.Handled=!0}return!1}static GetLookupData(s){let l=o.d.common.GetDataSet("PAY060",s.toString());return null!=l&&l.Tables.length>0&&l.Columns[0].Contains("NodeID")?l.Tables[0]:null}dgColSelect_CheckedChanged(s,l){l||1==this.SelectAll&&(this.SelectUnCheck=1,this.SelectAll=!1)}SelectUnselectAll(s){for(let l=0;l<this.dgvEmployees.Table.length;l++)0==this.SelectUnCheck&&(this.dgvEmployees.Table[l].Select=s);this.SelectUnCheck=0}Button_Click(s){if(Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering Button_Click()"),"Post"==s.toString()){if(!this.IsProcessed)return this.DisplayMessage="Data has been modified, Please Process the Payroll again, then Post...",void(this.MessageVisibility=!0);this.btnPost_Click()}else"Clear"==s.toString()?this.btnClear_Click():"UnPost"==s.toString()?this.btnUnPost_Click():"Filter"==s.toString()?this.btnFilter_Click():"Process"==s.toString()?this.btnProcess_Click():"Load"==s.toString()?this.btnLoad_Click():"Export"==s.toString()?this.btnExport_Click():"Report"==s.toString()&&(this.ReportInfoVisibility=!0,o.d.page.ShowDialog(this,St.L,{Title:"Reports"}));Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting Button_Click()")}btnExport_Click(){this.dgvEmployees.Excelexportdelegate.Call()}btnLoad_Click(){try{Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering btnLoad_Click()"),this.objCMPLData=null;let s=[];s.push(this);let l=new Ut(s);o.d.page.ShowDialog(l,Yt,{Title:"Load Data"}).subscribe(()=>{if(l.DialogResult){if(!l.dtDataColumns.Contains("Employee Code"))return this.DisplayMessage="'Employee Code' Column not found.",void(this.MessageVisibility=!0);this.objCMPLData=l.dtData,this.sBGWorkType="LOAD",this.bgworker_DoWork(null,null),this.bgworker_RunWorkerCompleted(null,null)}Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting btnLoad_Click()")})}catch(s){Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION btnLoad_Click()",s)}}LoadXLData(s){Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering LoadXLData()"),this.InProgress="";let l=0;if(null!=s&&s.length>0){l=s.length,this.ProgressVisibility=!0,this.ProgressValue=0,this.ProgressMax=l,this.ProgressMessage="Loading Excel Data, please wait ...";let t,i="",n=-1;for(let r=0;r<this.dgvEmployees.Table.length;r++)if(!m.J0.IsEmpty(this.dgvEmployees.Table[r].EmpCode)&&(i="",t=s.filter(d=>d["Employee Code"].toLowerCase()==this.dgvEmployees.Table[r].EmpCode.toString().toLowerCase()),t.length>0)){for(let d=1;d<Object.keys(s[0]).length;d++){let C=Object.keys(s[0])[d];for(let h=0;h<this.dgvEmployees.TableColumns.length;h++)if(this.dgvEmployees.Columns[h].Header==C&&this.dgvEmployees.TableColumns.Contains(this.dgvEmployees.Columns[h].ID)){this.dgvEmployees.Table[r][this.dgvEmployees.Columns[h].ID]=t[0][Object.keys(t[0])[d]].toString();{let c=this.dgvEmployees.Table.indexOf(this.dgvEmployees.Table[r]);this.iEmpIndex=this.lstSelectedEmps.indexOf(c);let g=0,e=-1;this.dgvEmployees.Columns[h].ID.startsWith("EarningOTHrs")?(g=1,e=parseInt(this.dgvEmployees.Columns[h].ID.Replace("EarningOTHrs","")),i=this.dgvEmployees.Columns[h].ID,n=h):this.dgvEmployees.Columns[h].ID.startsWith("Earning")?(g=0,e=parseInt(this.dgvEmployees.Columns[h].ID.Replace("Earning","")),i=this.dgvEmployees.Columns[h].ID,n=h):this.dgvEmployees.Columns[h].ID.startsWith("DeductionOTHrs")?(g=3,e=parseInt(this.dgvEmployees.Columns[h].ID.Replace("DeductionOTHrs","")),i=this.dgvEmployees.Columns[h].ID,n=h):this.dgvEmployees.Columns[h].ID.startsWith("Deduction")&&(g=2,e=parseInt(this.dgvEmployees.Columns[h].ID.Replace("Deduction","")),i=this.dgvEmployees.Columns[h].ID,n=h);let p=this.oCMP.arrLstCPFields[this.iEmpIndex][g].find(u=>u.SNo==e);null!=p&&(p.dActual=parseFloat(t[0][Object.keys(t[0])[d]].toString()).ToString(o.d.SessionManager.sPayrollDecimals)),this.oCMP.othMPField=this.oCMP.arrLstOthMPFields[this.iEmpIndex],("DaysAttended"==this.dgvEmployees.Columns[h].ID||"LOPDays"==this.dgvEmployees.Columns[h].ID)&&this.dgvEmployees_EndEdit(this.dgvEmployees.Table[r],this.dgvEmployees.Columns[h].ID,h)}break}}n>=0&&this.dgvEmployees_EndEdit(this.dgvEmployees.Table[r],i,n),this.ProgressValue=r+1,this.InProgress=r+1+" of "+l}this.DisplayMessage="Data Loaded Successfully",this.MessageVisibility=!0}Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting LoadXLData()")}btnProcess_Click(){this.AddArrearColumns(),this.sBGWorkType="PROCESS",this.bgworker_DoWork(null,null),this.bgworker_RunWorkerCompleted(null,null)}AddArrearColumns(){if(this.IsProcessWithArrears||this.IsProcessWithAdjustments){let t=this.dsStructure.Tables[0].filter(i=>1==i.Type&&"Yes"==i.Applicable&&"OverTime"!=i.FieldType);t.sort((i,n)=>i.SNo-n.SNo),this.AddEarDedArrearColumns(t,"Earning"),t=this.dsStructure.Tables[0].filter(i=>2==i.Type&&"Yes"==i.Applicable&&"OverTime"!=i.FieldType),t.sort((i,n)=>i.SNo-n.SNo),this.AddEarDedArrearColumns(t,"Deduction")}else{let t=this.dsStructure.Tables[0].filter(i=>1==i.Type&&"Yes"==i.Applicable&&"OverTime"!=i.FieldType);if(t.sort((i,n)=>i.SNo-n.SNo),null!=t&&t.length>0)for(let i=0;i<t.length;i++)this.dgvEmployees.TableColumns.Contains("Earning"+t[i].SNo+"_Arr")&&(this.dgvEmployees.TableColumns.Remove("Earning"+t[i].SNo+"_Arr"),null!=(s=this.dgvEmployees.Columns.find(n=>n.DisplayMember=="Earning"+t[i].SNo+"_Arr"))&&this.dgvEmployees.Columns.Remove(s)),this.dgvEmployees.TableColumns.Contains("Earning"+t[i].SNo+"_Adj")&&(this.dgvEmployees.TableColumns.Remove("Earning"+t[i].SNo+"_Adj"),null!=(s=this.dgvEmployees.Columns.find(r=>r.DisplayMember=="Earning"+t[i].SNo+"_Adj"))&&this.dgvEmployees.Columns.Remove(s));if(t=this.dsStructure.Tables[0].filter(i=>2==i.Type&&"Yes"==i.Applicable&&"OverTime"!=i.FieldType),null!=t&&t.length>0)for(let i=0;i<t.length;i++){var s;this.dgvEmployees.TableColumns.Contains("Deduction"+t[i].SNo+"_Arr")&&(this.dgvEmployees.TableColumns.Remove("Deduction"+t[i].SNo+"_Arr"),null!=(s=this.dgvEmployees.Columns.find(r=>r.DisplayMember=="Deduction"+t[i].SNo+"_Arr"))&&this.dgvEmployees.Columns.Remove(s)),this.dgvEmployees.TableColumns.Contains("Deduction"+t[i].SNo+"_Adj")&&(this.dgvEmployees.TableColumns.Remove("Deduction"+t[i].SNo+"_Adj"),null!=(s=this.dgvEmployees.Columns.find(r=>r.DisplayMember=="Deduction"+t[i].SNo+"_Adj"))&&this.dgvEmployees.Columns.Remove(s))}}let l=[];for(let t=0;t<this.dgvEmployees.Columns.length;t++)l.push(this.dgvEmployees.Columns[t]);this.dgvEmployees.Columns=l}AddEarDedArrearColumns(s,l){if(null!=s&&s.length>0){let t;if(this.IsProcessWithArrears)for(let i=0;i<s.length;i++)if(this.dgvEmployees.TableColumns.Contains(l+s[i].SNo)){if(this.dgvEmployees.TableColumns.Contains(l+s[i].SNo+"_Arr"))break;if(!m.J0.IsEmpty(s[i].Behaviour)&&("Accruals"==s[i].Behaviour.toString()||"Accruals-AccumulateForPreviousYears"==s[i].Behaviour.toString()))continue;t=new L.O7,t.Header=this.GetResource(s[i].ComponentCode.toString(),50052)+"_Arr",t.DisplayMember=l+s[i].SNo.toString()+"_Arr",t.ID=l+s[i].SNo.toString()+"_Arr",t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="Earning"==l?"LightBlue":"LightCoral",t.Width=80,"-1"!=m.J0.String(s[i].Visible)&&(t.IsVisible="1"==m.J0.String(s[i].Visible)),"-1"!=m.J0.String(s[i].Width)&&(t.Width=parseInt(s[i].Width)),"-1"!=m.J0.String(s[i].IndexValue)&&(t.DisplayIndex=parseInt(s[i].IndexValue)),"-1"!=m.J0.String(s[i].Mandatory)&&(t.Mandatory="1"==m.J0.String(s[i].Mandatory));let n=this.dgvEmployees.Columns.find(r=>r.DisplayMember==l+s[i].SNo.toString());null!=n&&(this.dgvEmployees.Columns.Insert(this.dgvEmployees.Columns.indexOf(n)+1,t),this.dgvEmployees.TableColumns.push(t.DisplayMember))}if(this.IsProcessWithAdjustments)for(let i=0;i<s.length;i++)if(this.dgvEmployees.TableColumns.Contains(l+s[i].SNo)){if(this.dgvEmployees.TableColumns.Contains(l+s[i].SNo+"_Adj"))break;if(!m.J0.IsEmpty(s[i].Behaviour)&&("Accruals"==s[i].Behaviour.toString()||"Accruals-AccumulateForPreviousYears"==s[i].Behaviour.toString()))continue;t=new L.O7,t.Header=this.GetResource(s[i].ComponentCode.toString(),50052)+"_Adj",t.DisplayMember=l+s[i].SNo.toString()+"_Adj",t.ID=l+s[i].SNo.toString()+"_Adj",t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="Earning"==l?"LightBlue":"LightCoral",t.Width=80,"-1"!=m.J0.String(s[i].Visible)&&(t.IsVisible="1"==m.J0.String(s[i].Visible)),"-1"!=m.J0.String(s[i].Width)&&(t.Width=parseInt(s[i].Width)),"-1"!=m.J0.String(s[i].IndexValue)&&(t.DisplayIndex=parseInt(s[i].IndexValue)),"-1"!=m.J0.String(s[i].Mandatory)&&(t.Mandatory="1"==m.J0.String(s[i].Mandatory));let n=this.dgvEmployees.Columns.find(r=>r.DisplayMember==l+s[i].SNo.toString());null!=n&&(this.dgvEmployees.Columns.Insert(this.dgvEmployees.Columns.indexOf(n)+1,t),this.dgvEmployees.TableColumns.push(t.DisplayMember))}}}btnUnPost_Click(){this.sBGWorkType="UNPOST",this.bgworker_DoWork(null,null),this.bgworker_RunWorkerCompleted(null,null)}btnClear_Click(){this.oCMP=null,this.dgvEmployees.Clear(),this.dgvEmployees.UpdateTotals(),this.sPayrollMonth=" / ["+o.d.SessionManager.PayrollMonth.ToString("MMM-yyyy")+"]",this.lblPayrollMonth=o.d.SessionManager.PayrollMonth.ToString("MMM, yyyy"),this.lblPayrollMonthStart=o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy"),this.lblPayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy"),this.SelectAll=!1,this.chkIncludeOTHours.IsChecked=!1,this.chkPostBasedOnDailyAttendance.IsChecked=!1,this.chkPostBasedOnAttDimWise.IsChecked=!1,this.FailedCount=0,this.Failed="",this.sBGWorkType="",this.lstSelectedEmps=new Array,this.IsProcessed=!1,o.d.SessionManager.Preferences.ContainsKey("DefaultPostbasedonAttendanceDimensionWise")&&"True"==o.d.SessionManager.Preferences.DefaultPostbasedonAttendanceDimensionWise?this.chkPostBasedOnAttDimWise.IsChecked=!0:"True"==o.d.SessionManager.Preferences.GetDailyAttendanceDataInMonthlyPayroll&&(this.chkPostBasedOnDailyAttendance.IsChecked=!0,this.chkIncludeOTHours.IsChecked=!0)}btnPost_Click(){this.sBGWorkType="POST",this.bgworker_DoWork(null,null),this.bgworker_RunWorkerCompleted(null,null)}btnFilter_Click(){this.sFilter="",o.d.SessionManager.Preferences.ContainsKey("ConsolidatedPayrollFilter")&&parseInt(o.d.SessionManager.Preferences.ConsolidatedPayrollFilter)>0?null==this.objEmpFilter?this.objEmpFilter=new Oe.t("",0,3):(this.objEmpFilter.CostCenterFilters.length>0?this.objEmpFilter.CostCenters.SelectedValue=this.objEmpFilter.CostCenterFilters[0].CostCenterID.toString():(this.objEmpFilter.Filter=3,this.objEmpFilter.InitControls()),this.objEmpFilter.CostCenters.Enable=!0):null==this.objEmpFilter?this.objEmpFilter=new Oe.t("",0,0):(this.objEmpFilter.Filter=0,this.objEmpFilter.InitControls()),o.d.page.ShowDialog(this.objEmpFilter,Ye.m,{ShowCenter:!0,HideHeader:!0}).subscribe(()=>{if(this.DialogResult=this.objEmpFilter.IsCompleted,this.objEmpFilter.IsCompleted){if(this.objEmpFilter.CostCenterFilters.length>0){let l=1,t="",i="",n="";for(let r=0;r<this.objEmpFilter.CostCenterFilters.length;r++){let d=this.objEmpFilter.CostCenterFilters[r];if(d.CostCenterID>5e4&&(l=2,t="NodeID",i=50051==d.CostCenterID?"EmpSeqNo":"CCNID"+(d.CostCenterID-5e4)),d.SelectedNodes.length>0){if(1==d.SelectedNodes.length)n+=" AND ",n+=i+"="+d.SelectedNodes[0].Id;else if(!d.SelectedNodes.find(C=>C.Id==l&&C.IsGroup))if(n+=" AND ",Ue.IPrefetchFilter.IsGroupTree(d)){let C="";for(let h=0;h<d.SelectedNodes.length;h++)(null==d.SelectedNodes[h].Parent||!d.SelectedNodes[h].Parent.IsSelected)&&(C.length>0&&(C+=","),C+=d.SelectedNodes[h].Id);0==C.length&&(C+=-12912),n+=i+" IN ",n+=" (select T."+t+" GTID from "+xe.A.GetTagTableName(d.CostCenterID)+" T with(nolock),"+xe.A.GetTagTableName(d.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP."+t+" IN (",n+=C.toString()+")  group by T."+t+")"}else{n+=i+" IN (";for(let C=0;C<d.SelectedNodes.length;C++)C>0&&(n+=","),n+=d.SelectedNodes[C].Id;n+=")"}}else d.DeleteButtonVisibility||(n+=" AND ",n+=i+"=-12912")}this.sFilter=n.toString()}if(this.objEmpFilter.Filter>0){this.sFilter+=" AND ( CONVERT(DATETIME,EMP.DOJ) <='"+o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")+"' AND CONVERT(DATETIME,EMP.DORelieve)  >='"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"' ) ","True"==o.d.SessionManager.Preferences.NPDontAllowPayrollProcessing&&(this.sFilter+=" AND EmpSeqNo NOT IN ( Select NodeID From COM_CC50051 WITH(NOLOCK) \n                        Where ResignStatus='Posted' AND DateDiff(day,ISNULL(CONVERT(DATETIME,DORelieve),'01-Jan-9000'),'"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"')<=0\n                        AND DateDiff(day,CONVERT(DATETIME,CONVERT(DATETIME,('01-'+CONVERT(NVARCHAR(3),DATENAME(MONTH,ISNULL(CONVERT(DATETIME,DOResign),'01-Jan-9000')))+'-'+CONVERT(NVARCHAR,YEAR(ISNULL(CONVERT(DATETIME,DOResign),'01-Jan-9000'))))) ),'"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"')>=0 )"),"True"==o.d.SessionManager.Preferences.DontConsiderEmpsForPayroll&&parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)>0&&(this.sFilter+=" AND NOT ( MONTH(CONVERT(DATETIME,EMP.DOJ))="+o.d.SessionManager.PayrollMonth.iMonth()+" AND YEAR(CONVERT(DATETIME,EMP.DOJ))="+o.d.SessionManager.PayrollMonth.getFullYear()+" AND DAY(CONVERT(DATETIME,EMP.DOJ))>="+parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)+" ) "),o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(this.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(this.sFilter+="  AND EmpSeqNo IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),"Processed"==this.objEmpFilter.StatusModes.SelectedValue?this.sFilter+=" AND EmpSeqNo IN (SELECT DISTINCT C51.NODEID FROM INV_DocDetails I\n                                                    JOIN COM_DocCCData CC ON CC.InvDocDetailsID=I.InvDocDetailsID\n                                                    JOIN COM_CC50051 C51 ON C51.NODEID=CC.DCCCNID51\n                                                    WHERE I.CostCenterID=40054  AND  CONVERT(DATETIME,I.DueDate)=CONVERT(DATETIME,'"+o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")+"'))":"UnProcessed"==this.objEmpFilter.StatusModes.SelectedValue&&(this.sFilter+=" AND EmpSeqNo NOT IN (SELECT DISTINCT C51.NODEID FROM INV_DocDetails I\n                                                    JOIN COM_DocCCData CC ON CC.InvDocDetailsID=I.InvDocDetailsID\n                                                    JOIN COM_CC50051 C51 ON C51.NODEID=CC.DCCCNID51\n                                                    WHERE I.CostCenterID=40054  AND  CONVERT(DATETIME,I.DueDate)=CONVERT(DATETIME,'"+o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")+"'))");let l=o.d.SessionManager.Preferences.ConsolidateMonthlyPayrollSort;""!=l.Trim()&&"None"!=l&&(this.sFilter+="TreeView"==l?" ORDER BY EMP.lft ":" ORDER BY EMP."+l);let t=[];t.push(o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")),t.push(this.sFilter),t.push(0),t.push(o.d.SessionManager.RoleID),t.push(o.d.SessionManager.UserID),t.push(o.d.SessionManager.LanguageID);let n,i=o.d.empService.GetData(t,"spPAY_GetEmpMasterCCDetails");if(this.btnClear_Click(),null!=i&&i.Tables.length>0&&i.Tables[0].length>0){if(n=i.Tables[0],o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade){let r=o.d.SessionManager.dtPayrollPreferences.Tables[0].filter(d=>"DontConsiderEmpsForPayroll"==d.Name&&d.GradeID==i.Tables[0][0].CCNID53);if(null!=r&&r.length>0&&null!=r[0].Value&&null!=r[0].Value&&""!=r[0].Value.toString()&&"True"==r[0].Value.toString()&&(r=o.d.SessionManager.dtPayrollPreferences.Tables[0].filter(d=>"DontConsiderEmpsForPayrollDays"==d.Name&&d.GradeID==i.Tables[0][0].CCNID53),null!=r&&r.length>0&&null!=r[0].Value&&null!=r[0].Value&&""!=r[0].Value.toString())){let d=0;if(d=parseInt(r[0].Value),d>0){let C=new Date(o.d.SessionManager.PayrollMonth.getFullYear(),o.d.SessionManager.PayrollMonth.getMonth(),d),h=i.Tables[0].filter(c=>new Date(c.DOJ)<=C);null!=h&&h.length>0&&(i=[],i=h)}}i.sort((d,C)=>C.CCNID53-d.CCNID53),n=i}this.AddGradeApplicableColumns(n);for(let r=0;r<n.length;r++){let d=this.dgvEmployees.NewRow();d.EmpSeqNo=n[r].EmpSeqNo,d.EmpCode=n[r].EmpCode,d.EmpName=n[r].EmpName,d.GradeID=n[r].CCNID53,d.SNo=(r+1).toString(),d.Select=!1;let C,h="";for(let c=0;c<this.dgvEmployees.TableColumns.length;c++)h=this.dgvEmployees.TableColumns[c],(h.startsWith("dcAlpha")||h.startsWith("dcCCNID"))&&(C=this.dsDocDesig.Tables[0].filter(g=>g.SysColumnName==h),null!=C&&C.length>0&&(m.J0.IsEmpty(C[0].UserColumnType)||("LISTBOX"==C[0].UserColumnType.toString().toUpperCase()?m.J0.IsEmpty(C[0].UserDefaultValue)||(d[h+"_Key"]=C[0].UserDefaultValue.toString()):"TEXT"==C[0].UserColumnType.toString().toUpperCase()||"COMBOBOX"==C[0].UserColumnType.toString().toUpperCase()?m.J0.IsEmpty(C[0].UserDefaultValue)||(d[h]=C[0].UserDefaultValue.toString()):"DATE"==C[0].UserColumnType.toString().toUpperCase()&&(m.J0.IsEmpty(C[0].UserDefaultValue)||"TODAY"==C[0].UserDefaultValue.toString().toUpperCase()&&(d[h]=(new Date).ToString(o.d.SessionManager.Preferences["Date Format"]),this.dgvEmployees.TableColumns.Contains(h+"_Key")&&(d[h+"_Key"]=new Date))))));this.dgvEmployees.addRow(d),this.dgvEmployees.RefreshGrid=!0}}}}}),Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting Filter_Click()")}AddGradeApplicableColumns(s){let l,t="";if(null!=(s=s.ToTable(!0,["CCNID53"]))&&s.length>0)for(let n=0;n<s.length;n++)!m.J0.IsEmpty(t)&&t.length>0&&(t+=","),t+=s[n].CCNID53.toString();if(!m.J0.IsEmpty(t)&&t.length>0&&(l=o.d.common.GetDataSet3("PAY125",t,o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy"),"")),null!=l&&l.Tables.length>0){let n=this.dsStructure.Tables[0].filter(C=>1==C.Type);if(n.sort((C,h)=>C.SNo-h.SNo),null!=n&&n.length>0)for(let C=0;C<n.length;C++)this.dgvEmployees.TableColumns.Contains("Earning"+n[C].SNo)?(this.dgvEmployees.TableColumns.Remove("Earning"+n[C].SNo),null!=(i=this.dgvEmployees.Columns.find(h=>h.DisplayMember=="Earning"+n[C].SNo))&&this.dgvEmployees.Columns.Remove(i)):this.dgvEmployees.TableColumns.Contains("EarningOTHrs"+n[C].SNo)&&(this.dgvEmployees.TableColumns.Remove("EarningOTHrs"+n[C].SNo),null!=(i=this.dgvEmployees.Columns.find(c=>c.DisplayMember=="EarningOTHrs"+n[C].SNo))&&this.dgvEmployees.Columns.Remove(i),this.dgvEmployees.TableColumns.Contains("EarningOTAmt"+n[C].SNo)&&(this.dgvEmployees.TableColumns.Remove("EarningOTAmt"+n[C].SNo),null!=(i=this.dgvEmployees.Columns.find(c=>c.DisplayMember=="EarningOTAmt"+n[C].SNo))&&this.dgvEmployees.Columns.Remove(i)));if(n=this.dsStructure.Tables[0].filter(C=>2==C.Type),null!=n&&n.length>0)for(let C=0;C<n.length;C++)if(this.dgvEmployees.TableColumns.Contains("Deduction"+n[C].SNo))this.dgvEmployees.TableColumns.Remove("Deduction"+n[C].SNo),null!=(i=this.dgvEmployees.Columns.find(c=>c.DisplayMember=="Deduction"+n[C].SNo))&&this.dgvEmployees.Columns.Remove(i);else if(this.dgvEmployees.TableColumns.Contains("DeductionOTHrs"+n[C].SNo)){var i;this.dgvEmployees.TableColumns.Remove("DeductionOTHrs"+n[C].SNo),null!=(i=this.dgvEmployees.Columns.find(c=>c.DisplayMember=="DeductionOTHrs"+n[C].SNo))&&this.dgvEmployees.Columns.Remove(i),this.dgvEmployees.TableColumns.Contains("DeductionOTAmt"+n[C].SNo)&&(this.dgvEmployees.TableColumns.Remove("DeductionOTAmt"+n[C].SNo),null!=(i=this.dgvEmployees.Columns.find(g=>g.DisplayMember=="DeductionOTAmt"+n[C].SNo))&&this.dgvEmployees.Columns.Remove(i))}let r=this.dgvEmployees.Columns.find(C=>"TotalDays"==C.DisplayMember);null!=r&&(this.iColId=this.dgvEmployees.Columns.indexOf(r)),n=l.Tables[0].filter(C=>1==C.Type),n.sort((C,h)=>C.SNo-h.SNo),this.AddEarDedColumns(n,"Earning"),r=this.dgvEmployees.Columns.find(C=>"TotalEarnings"==C.DisplayMember),null!=r&&(this.iColId=this.dgvEmployees.Columns.indexOf(r)),n=l.Tables[0].filter(C=>2==C.Type),n.sort((C,h)=>C.SNo-h.SNo),this.AddEarDedColumns(n,"Deduction");let d=[];for(let C=0;C<this.dgvEmployees.Columns.length;C++)d.push(this.dgvEmployees.Columns[C]);if(this.dgvEmployees.Columns=d,this.dtCust=o.d.common.GetDataTable("PAY059",o.d.SessionManager.RoleID),null!=this.dtCust&&this.dtCust.length>0){let C=new m.VB;if(C.ReadXml(this.dtCust[0].ValueXml.toString()),null!=C&&C.Tables.length>0&&C.Tables[0].length>0){let h,c=3;for(let g=0;g<this.dgvEmployees.Columns.length;g++)h=C.Tables[0].filter(e=>e.SysColumnName==this.dgvEmployees.Columns[g].CrRefColName),h.length>0?(this.dgvEmployees.Columns[g].DisplayIndex=parseInt(h[0].Index)+c,this.dgvEmployees.Columns[g].Width=parseInt(h[0].Width),this.dgvEmployees.Columns[g].ReadOnly=null!=h[0].ReadOnly&&null!=h[0].ReadOnly&&"1"==h[0].ReadOnly.toString(),this.dgvEmployees.Columns[g].Mandatory=null!=h[0].Mandatory&&null!=h[0].Mandatory&&"1"==h[0].Mandatory.toString(),this.dgvEmployees.Columns[g].IsVisible=null!=h[0].Visible&&null!=h[0].Visible&&"1"==h[0].Visible.toString()):(h=C.Tables[0].filter(e=>e.ID==this.dgvEmployees.Columns[g].CrRefColID),null!=h&&h.length>0?(this.dgvEmployees.Columns[g].DisplayIndex=parseInt(h[0].Index)+c,this.dgvEmployees.Columns[g].Width=parseInt(h[0].Width),this.dgvEmployees.Columns[g].ReadOnly=null!=h[0].ReadOnly&&null!=h[0].ReadOnly&&"1"==h[0].ReadOnly.toString(),this.dgvEmployees.Columns[g].Mandatory=null!=h[0].Mandatory&&null!=h[0].Mandatory&&"1"==h[0].Mandatory.toString(),this.dgvEmployees.Columns[g].IsVisible=null!=h[0].Visible&&null!=h[0].Visible&&"1"==h[0].Visible.toString()):(h=C.Tables[0].filter(e=>e.ID==-this.dgvEmployees.Columns[g].CrRefColID),null!=h&&h.length>0?(this.dgvEmployees.Columns[g].DisplayIndex=parseInt(h[0].Index)+c,this.dgvEmployees.Columns[g].Width=parseInt(h[0].Width),this.dgvEmployees.Columns[g].ReadOnly=null!=h[0].ReadOnly&&null!=h[0].ReadOnly&&"1"==h[0].ReadOnly.toString(),this.dgvEmployees.Columns[g].Mandatory=null!=h[0].Mandatory&&null!=h[0].Mandatory&&"1"==h[0].Mandatory.toString(),this.dgvEmployees.Columns[g].IsVisible=null!=h[0].Visible&&null!=h[0].Visible&&"1"==h[0].Visible.toString()):this.dgvEmployees.Columns[g].DisplayIndex=g))}this.dgvEmployees.Columns.SortBy([{name:"DisplayIndex",parser:parseInt}])}}}AddEarDedColumns(s,l){if(null!=s&&s.length>0){let t;for(let i=0;i<s.length;i++)m.J0.IsEmpty(s[i].Behaviour)||"Accruals"!=s[i].Behaviour.toString()&&"Accruals-AccumulateForPreviousYears"!=s[i].Behaviour.toString()?(t=new L.O7,t.Header=this.GetResource(s[i].ComponentCode.toString(),50052),t.DisplayMember=l+s[i].SNo.toString(),t.ID=l+s[i].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="Earning"==l?"LightBlue":"LightCoral",t.Width=80,"OverTime"==s[i].FieldType.toString()?(t.DisplayMember="EarningOTHrs"+s[i].SNo.toString(),t.ID="EarningOTHrs"+s[i].SNo.toString(),t.DecimalPoints="2",t.Width=60,t.ReadOnly=!1):"Monthly"==s[i].FieldType.toString()?t.ReadOnly=!1:t.ForeColor="Gray","-1"!=m.J0.String(s[i].Visible)&&(t.IsVisible="1"==m.J0.String(s[i].Visible)),"-1"!=m.J0.String(s[i].Width)&&(t.Width=parseInt(s[i].Width)),"-1"!=m.J0.String(s[i].IndexValue)&&(t.DisplayIndex=parseInt(s[i].IndexValue)),"-1"!=s[i].ReadOnly.toString()&&(t.ReadOnly="1"==s[i].ReadOnly.toString()),"-1"!=m.J0.String(s[i].Mandatory)&&(t.Mandatory="1"==m.J0.String(s[i].Mandatory)),this.iColId=this.iColId+1,this.dgvEmployees.Columns.Insert(this.iColId,t),this.dgvEmployees.TableColumns.push(t.DisplayMember),"OverTime"==s[i].FieldType.toString()&&(t=new L.O7,t.Header=this.GetResource(s[i].ComponentCode.toString(),50052)+"_Amount",t.CrRefColID=parseInt(s[i].ComponentID),t.DisplayMember=l+"OTAmt"+s[i].SNo.toString(),t.ID=l+"OTAmt"+s[i].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.Width=80,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.ForeColor="Gray",t.HeaderBackColor="LightBlue","-1"!=s[i].Visible.toString()&&(t.IsVisible="1"==s[i].Visible.toString()),"-1"!=s[i].Width.toString()&&(t.Width=parseInt(s[i].Width)),"-1"!=s[i].IndexValue.toString()&&(t.DisplayIndex=parseInt(s[i].IndexValue)),"-1"!=s[i].ReadOnly.toString()&&(t.ReadOnly="1"==s[i].ReadOnly.toString()),"-1"!=s[i].Mandatory.toString()&&(t.Mandatory="1"==s[i].Mandatory.toString()),this.iColId=this.iColId+1,this.dgvEmployees.Columns.Insert(this.iColId,t),this.dgvEmployees.TableColumns.push(t.DisplayMember))):(t=new L.O7,t.Header=this.GetResource(s[i].ComponentCode.toString(),50052),t.DisplayMember=l+s[i].SNo.toString(),t.ID=l+s[i].SNo.toString(),t.DataType="FLOAT",t.DecimalPoints=o.d.SessionManager.Preferences.PayrollNoOfDecimals,t.ReadOnly=!0,t.ShowTotal=!0,t.IsCalculated=1,t.HeaderBackColor="GreenYellow",t.Width=80,"Monthly"==s[i].FieldType.toString()?t.ReadOnly=!1:t.ForeColor="Gray","-1"!=m.J0.String(s[i].Visible)&&(t.IsVisible="1"==m.J0.String(s[i].Visible)),"-1"!=m.J0.String(s[i].Width)&&(t.Width=parseInt(s[i].Width)),"-1"!=m.J0.String(s[i].IndexValue)&&(t.DisplayIndex=parseInt(s[i].IndexValue)),"-1"!=s[i].ReadOnly.toString()&&(t.ReadOnly="1"==s[i].ReadOnly.toString()),"-1"!=m.J0.String(s[i].Mandatory)&&(t.Mandatory="1"==m.J0.String(s[i].Mandatory)),this.iColId=this.iColId+1,this.dgvEmployees.Columns.Insert(this.iColId,t),this.dgvEmployees.TableColumns.push(t.DisplayMember))}}bgworker_DoWork(s,l){Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering bgworker_DoWork()"),"PROCESS"==this.sBGWorkType?this.ProcessPayrollData():"POST"==this.sBGWorkType?this.PostPayrollData():"UNPOST"==this.sBGWorkType?this.UnPostPayrollData():"LOAD"==this.sBGWorkType&&this.LoadXLData(this.objCMPLData),this.dgvEmployees.UpdateTotals(),Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting bgworker_DoWork()")}ProcessPayrollData(){Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering ProcessPayrollData()"),this.InProgress="";let s=0,l=0;if(null!=this.dgvEmployees.Table&&this.dgvEmployees.Table.length>0){this.lstSelectedEmps=new Array;let r,t="",i="",n=new Array,d=!1,C=0;for(let h=0;h<this.dgvEmployees.Table.length;h++)if((0,j.yG0)(this.dgvEmployees.Table[h].Select)&&(t+=this.dgvEmployees.Table[h].EmpSeqNo.toString()+",",this.lstSelectedEmps.push(h),l++,d=!1,C=0,o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)){for(let c=0;c<n.length;c++)if(n[c].GradeID==parseInt(this.dgvEmployees.Table[h].GradeID)){C=c,d=!0;break}d?(i=n[C].sEmpIds,i+=","+this.dgvEmployees.Table[h].EmpSeqNo.toString(),n[C].sEmpIds=i,n[C].lstGradeEmps.push(parseInt(this.dgvEmployees.Table[h].EmpSeqNo))):(r=new Xe.ii,r.GradeID=parseInt(this.dgvEmployees.Table[h].GradeID),r.sEmpIds=this.dgvEmployees.Table[h].EmpSeqNo.toString(),r.lstGradeEmps=new Array,r.lstGradeEmps.push(parseInt(this.dgvEmployees.Table[h].EmpSeqNo)),n.push(r))}if(t.length>0&&l>0){if(t=t.substr(0,t.length-1),s=l,this.FailedCount=0,this.Failed="",this.ProgressVisibility=!0,this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Payroll is processing, please wait ...",this.chkPostBasedOnDailyAttendance.IsChecked&&o.d.SessionManager.Preferences.ContainsKey("CaputureDimensionData")&&"True"==o.d.SessionManager.Preferences.CaputureDimensionData.toString()){let h=[];h.push(t),h.push(o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")),h.push(o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")),h.push(this.chkIncludeOTHours.IsChecked?1:0),h.push(m.J0.IntTryParse(o.d.SessionManager.UserID)),h.push(o.d.SessionManager.LanguageID),this.dsDailyAttendanceData=o.d.empService.GetData(h,"spPAY_PostDailyAttendancetoPayroll")}if(this.oCMP=new fe.O,this.oCMP.oParent=this,this.oCMP.sSelectedEmpSeqNos=t,o.d.SessionManager.Preferences.ContainsKey("CaputureDimensionData")&&"True"==o.d.SessionManager.Preferences.CaputureDimensionData.toString()&&(this.oCMP.IsPostFullAttendance=!0,this.chkPostBasedOnDailyAttendance.IsChecked&&(this.oCMP.IsPostBasedOnDailyAttendance=!0),this.chkPostBasedOnAttDimWise.IsChecked&&(this.oCMP.IsPostBasedOnAttDimWise=!0),this.chkIncludeOTHours.IsChecked&&(this.oCMP.IncludeOTHours=!0)),this.oCMP.PayrollMonth=o.d.SessionManager.PayrollMonth,this.oCMP.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,this.oCMP.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,this.oCMP.GradeMPFls=n,this.oCMP.ProcessPayroll(),this.oCMP.IsCompleted){for(this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Filling data, please wait ...",this.iEmpIndex=0;this.iEmpIndex<this.oCMP.arrLstOthMPFields.length;this.iEmpIndex++)if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.length>0){if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.endsWith("NumFields"))return this.DisplayMessage=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.Replace("NumFields",""),void(this.MessageVisibility=!0);this.strResult=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage,this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++,this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]].Result=this.strResult}else{if(o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)for(let c=0;c<n.length;c++)n[c].lstGradeEmps.Contains(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo))&&(o.d.SessionManager.PayrollMonth=n[c].GradePayrollMonth,o.d.SessionManager.PayrollMonthStart=n[c].GradePayrollMonthStart,o.d.SessionManager.PayrollMonthEnd=n[c].GradePayrollMonthEnd);this.strResult="",this.CalculateAccruals(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo);let h=null;if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].IsAlreadyProcessed){if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(h=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(c=>c.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&11==c.VoucherType)),this.IsProcessWithArrears){if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&null!=h&&h.length>0)if(m.J0.IsEmpty(h[0].dcAlpha21)||""==m.J0.String(h[0].dcAlpha21).Trim())this.CalculateArrears(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo));else{null!=h[0].dcAlpha21&&null!=h[0].dcAlpha21&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths=h[0].dcAlpha21.toString()),null!=h[0].dcAlpha22&&null!=h[0].dcAlpha22&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays=h[0].dcAlpha22.toString());let c=o.d.common.GetDataTable("PAY099",m.J0.ParseDate(o.d.SessionManager.PayrollMonth).ToString("dd MMM yyyy"));if(null!=c&&c.length>0){let g=o.d.common.GetDataTable("PAY100",this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo);for(let e=0;e<c.length;e++){let p=m.J0.ParseDate(c[e].ArrearsCalcMonths);if(null!=g&&g.length>0){let u=g.filter(P=>P.ArrAdjMonth==p);if(null!=u&&u.length>0){for(let P=0;P<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;P++)null!=u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo]&&null!=u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo]&&""!=u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo].toString()&&(this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].ArrData+=p.ToString("dd MMM yyyy")+","+parseFloat(u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo])+",");for(let P=0;P<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;P++)null!=u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo]&&null!=u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo]&&""!=u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo].toString()&&(this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].ArrData+=p.ToString("dd MMM yyyy")+","+parseFloat(u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo])+",")}}}}}}else if(null!=h&&h.length>0){for(let c=0;c<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;c++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][c].dArrear="0";for(let c=0;c<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;c++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][c].dArrear="0";this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarArrears=0,this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedArrears=0,this.oCMP.iEmpIndex=this.iEmpIndex,this.oCMP.othMPField=this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.ExecuteAllFormulas(),this.oCMP.CalculateNet(),null!=h[0].dcAlpha21&&null!=h[0].dcAlpha21&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths=""),null!=h[0].dcAlpha22&&null!=h[0].dcAlpha22&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays="")}if(this.IsProcessWithAdjustments){if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&null!=h&&h.length>0)if(m.J0.IsEmpty(h[0].dcAlpha32)||""==m.J0.String(h[0].dcAlpha32).Trim())this.AdjustmentsClick(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo));else{null!=h[0].dcAlpha32&&null!=h[0].dcAlpha32&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths=h[0].dcAlpha32.toString()),null!=h[0].dcAlpha33&&null!=h[0].dcAlpha33&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays=h[0].dcAlpha33.toString());let c=o.d.common.GetDataTable("PAY113",m.J0.ParseDate(o.d.SessionManager.PayrollMonth).ToString("dd MMM yyyy")+"~"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo);if(null!=c&&c.length>0){let g=o.d.common.GetDataTable("PAY114",this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo);for(let e=0;e<c.length;e++){let p=m.J0.ParseDate(c[e].AdjMonth);if(null!=g&&g.length>0){let u=g.filter(P=>P.ArrAdjMonth==p);if(null!=u&&u.length>0){for(let P=0;P<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;P++)null!=u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo]&&null!=u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo]&&""!=u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo].toString()&&(this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].AdjData+=p.ToString("dd MMM yyyy")+","+parseFloat(u[0]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][P].SNo])+",");for(let P=0;P<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;P++)null!=u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo]&&null!=u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo]&&""!=u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo].toString()&&(this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].AdjData+=p.ToString("dd MMM yyyy")+","+parseFloat(u[0]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][P].SNo])+",")}}}}}}else if(null!=h&&h.length>0){for(let c=0;c<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;c++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][c].dAdjusted="0";for(let c=0;c<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;c++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][c].dAdjusted="0";this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments=0,this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments=0,this.oCMP.iEmpIndex=this.iEmpIndex,this.oCMP.othMPField=this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.ExecuteAllFormulas(),this.oCMP.CalculateNet(),null!=h[0].dcAlpha32&&null!=h[0].dcAlpha32&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths=""),null!=h[0].dcAlpha33&&null!=h[0].dcAlpha33&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays="")}}else this.IsProcessWithArrears&&this.CalculateArrears(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo)),this.IsProcessWithAdjustments&&this.AdjustmentsClick(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo));this.FillProcessedData(this.lstSelectedEmps[this.iEmpIndex]),this.ProgressValue=this.iEmpIndex+1,this.InProgress=this.iEmpIndex+1+" of "+s}this.MessageVisibility=!0,this.FailedCount>0&&this.Failed.length>1?(this.Failed=this.Failed.substr(0,this.Failed.length-1),this.DisplayMessage="Failed count : "+this.FailedCount+", Emp.Codes : ( "+this.Failed+" )"):null!=this.dgvEmployees&&null!=this.dgvEmployees.Table&&this.dgvEmployees.Table.length>0&&this.dgvEmployees.Table.filter(c=>(0,j.yG0)(c.Select)).length>0&&(this.DisplayMessage="Processed Successfully")}}else this.DisplayMessage="Select atleast one Employee."}else this.DisplayMessage="No Employees found to process payroll.";this.MessageVisibility=!0,this.CheckViewForUser(0),Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting ProcessPayrollData()")}CalculateArrears(s){try{Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering CalculateArrears()"),this.dtArrData=[];let l=new Array,t=o.d.empService.GetQueryData(s,"ARE001",o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),"","");if(null!=t&&t.Tables[0].length>0){let i=m.J0.ParseDate(t.Tables[0][0].DtApplyFrom.toString()),n=m.J0.ParseDate(t.Tables[0][0].DtEffectFrom.toString()),r=t.Tables[1][0].ArrCalcMonths.toString().Replace("/"," ");if(n>i&&o.d.SessionManager.PayrollMonth>=n){let d=i;for(;d<n;)r.Contains(d.ToString("dd MMM yyyy"))||l.push(d.ToString("dd MMM yyyy")),d=d.AddMonths(1)}}if(l.length>0){let n,r,i="";for(let c=0;c<l.length;c++)i.length>0&&(i+=";"),i+=l[c],n={},n.PayrollMonth=l[c],this.dtArrData.push(n);let d="'"+i.Replace(";","','")+"'",C=o.d.common.GetDataSet3("PAY079",s.toString(),d).Tables[0];if(null!=C&&C.length>0){r=C.filter(c=>11==c.VoucherType);for(let c=0;c<r.length;c++)this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays.length>0&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays+=";"),this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays+m.J0.String(r[c].PaidDays)}this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths=i;let h=i.split(";");if(h.length>0){for(let M=0;M<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;M++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][M].dArrear="0";for(let M=0;M<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;M++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][M].dArrear="0";this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarArrears=0,this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedArrears=0;let e,p,c=o.d.common.GetDataTable("PAY098",""),g=o.d.common.GetDataSet3("PAY101",s.toString(),o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")),P=0;for(let M=0;M<h.length;M++)if(null!=h[M]&&""!=h[M]&&(r=C.filter(A=>new Date(A.PayrollMonth).ToString("dd MMM yyyy")==new Date(h[M]).ToString("dd MMM yyyy")),r.length>0)){let A=c.filter(S=>S.GradeID==r[0].dcCCNID53&&new Date(S.CPayrollDate)<=new Date(h[M])).Compute("max","CPayrollDate"),T=c.filter(S=>S.GradeID==r[0].dcCCNID53&&new Date(S.CPayrollDate)==new Date(A.ToString())),I=new fe.O;if(I.oParent=this,I.sSelectedEmpSeqNos=s.toString(),I.PayrollMonth=o.d.SessionManager.PayrollMonth,I.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,I.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,I.drcArrStructure=T,I.IsArrearclick=!0,I.ArrGradeID=parseInt(r[0].dcCCNID53),I.ProcessPayroll(),I.IsCompleted){I.arrLstOthMPFields[0].TotalDays=parseFloat(r[0].TotalDays),I.arrLstOthMPFields[0].MonthDays=parseFloat(r[0].TotalDays),I.arrLstOthMPFields[0].PaidLeaves=parseFloat(r[0].dcAlpha24),I.arrLstOthMPFields[0].TotalLeaves=parseFloat(r[0].LeavesTaken),I.arrLstOthMPFields[0].WeeklyOffs=parseFloat(r[0].WOffs),I.arrLstOthMPFields[0].Holidays=parseFloat(r[0].Holidays);let S=parseFloat(r[0].TotalDays.toString())-parseFloat(r[0].LOPDays.toString())-parseFloat(r[0].LeavesTaken.toString())-parseFloat(r[0].UnpaidDays.toString());e=g.Tables[0].filter(E=>E.AdjMonth==m.J0.ParseDate(h[M])),null!=e&&e.length>0&&(S+=parseFloat(e[0].Days)),p=g.Tables[1].filter(E=>2==E.DType&&E.ArrAdjMonth==m.J0.ParseDate(h[M])),I.SetDaysAttended(0,"Days Attended",S);let v=0,O=-1,N=0;r=C.filter(E=>new Date(E.PayrollMonth).ToString("dd MMM yyyy")==new Date(h[M]).ToString("dd MMM yyyy")&&11==E.VoucherType);for(let E=0;E<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;E++)if(null==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateArrears||""==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateArrears||"No"!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateArrears)for(let G=0;G<I.arrLstCPFields[0][0].length;G++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].SNo==I.arrLstCPFields[0][0][G].SNo){N=0,P=0,O=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].SNo,m.J0.IsEmpty(r[0]["dcCalcNum"+O])||(N=parseFloat(r[0]["dcCalcNum"+O])),null!=p&&p.length>0&&(m.J0.IsEmpty(p[0]["Earning"+O])||(P=parseFloat(p[0]["Earning"+O]))),v=parseFloat(I.arrLstCPFields[0][0][G].dEarned)-N-P,this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData+=h[M]+","+v+",",this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].dArrear=(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].dArrear)+v).ToString(o.d.SessionManager.sPayrollDecimals),this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].isArrCalculated=!0,null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet&&("Net"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet||"NetAndTax"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet)&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarArrears+=v);break}r=C.filter(E=>new Date(E.PayrollMonth).ToString("dd MMM yyyy")==new Date(h[M]).ToString("dd MMM yyyy")&&12==E.VoucherType);for(let E=0;E<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;E++)if(null==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateArrears||""==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateArrears||"No"!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateArrears)for(let G=0;G<I.arrLstCPFields[0][2].length;G++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].SNo==I.arrLstCPFields[0][2][G].SNo){N=0,P=0,O=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].SNo,null!=r[0]["dcCalcNum"+O]&&null!=r[0]["dcCalcNum"+O]&&""!=r[0]["dcCalcNum"+O].toString()&&(N=parseFloat(r[0]["dcCalcNum"+O])),null!=p&&p.length>0&&null!=p[0]["Deduction"+O]&&null!=p[0]["Deduction"+O]&&""!=p[0]["Deduction"+O].toString()&&(P=parseFloat(p[0]["Deduction"+O])),v=parseFloat(I.arrLstCPFields[0][2][G].dEarned)-N-P,this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData+=h[M]+","+v+",",this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].dArrear=(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].dArrear)+v).ToString(o.d.SessionManager.sPayrollDecimals),this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].isArrCalculated=!0,null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet&&("Net"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet||"NetAndTax"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet)&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedArrears+=v);break}}I.IsArrearclick=!1}let x="",y="";x=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays,y=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths,this.oCMP.iEmpIndex=this.iEmpIndex,this.oCMP.othMPField=this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.ExecuteAllFormulas(),this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays=x,this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths=y,this.oCMP.CalculateNet(),this.FillProcessedData(this.lstSelectedEmps[this.iEmpIndex])}}Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting CalculateArrears()")}catch(l){Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION btnArrears_Click()\r\n"+l.Message+"\r\n"+l.stack)}}AdjustmentsClick(s){try{Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering AdjustmentsClick()"),this.dtAdjData=[];let d,C,l=[],t=o.d.empService.GetQueryData(s,"ADJ001","","",""),i=this.oCMP.arrLstOthMPFields[this.iEmpIndex].DateOfJoining,n=o.d.SessionManager.PayrollMonth.AddMonths(-1),r=new Date(i.getFullYear(),i.getMonth(),1),h=Array();for(;n>=r;){if(C=t.filter(c=>c.PayrollMonth&&m.J0.ParseDate(c.PayrollMonth).ToString("dd/MMM/yyyy")==n.ToString("dd/MMM/yyyy")),null!=C&&C.length>0){if(o.d.SessionManager.PayrollMonth.AddMonths(-1).ToString("dd MMM yyyy")==n.ToString("dd MMM yyyy")&&"True"==o.d.SessionManager.Preferences.DontConsiderEmpLeavesVacationDataBasedonPostedDate&&""!=o.d.SessionManager.Preferences.ConsiderLOPBasedOn.toString()){d={},d.PayrollMonth=n.ToString("dd/MMM/yyyy");let c,g,e,p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e};if(m.J0.SetPayrollDate_1(m.J0.ParseDate(o.d.SessionManager.PayrollMonth.AddMonths(-1)),p),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd,o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade){let x=0;x=m.J0.GetEmployeeGrade(s.toString(),c,g,e),x>0&&(p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e},m.J0.SetPayrollDate_1(m.J0.ParseDate(o.d.SessionManager.PayrollMonth.AddMonths(-1)),p,x),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd)}let u=[];u.push(s),u.push(c.ToString("dd/MMM/yyyy")),u.push(g.ToString("dd/MMM/yyyy")),u.push(e.ToString("dd/MMM/yyyy")),u.push(0),u.push(o.d.SessionManager.UserID),u.push(o.d.SessionManager.RoleID),u.push(o.d.SessionManager.LanguageID);let P=o.d.empService.ExecuteQuery_SP(u,"spPAY_GetEmpAdjDetailsMultiple");if(null!=P&&P.Tables.length>0&&P.Tables[0].length>0&&P.Columns[0].Contains("EmpSeqNo")){let x=[];x.push(e.ToString("dd MMM yyyy")),x.push(""),x.push(0),x.push(o.d.SessionManager.RoleID),x.push(o.d.SessionManager.UserID),x.push(o.d.SessionManager.LanguageID);let y=o.d.empService.ExecuteQuery_SP(x,"spPAY_GetEmpMasterCCDetails"),M=new Xe.mr,A=M.AggregateLeaves(s.toString(),P,g,e,y,this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.othMPField.GradeID);A>0&&(d.Days=-A),h=M.lstPrevAdj}l.push(d)}if(null!=h&&h.length>0&&o.d.SessionManager.PayrollMonth.AddMonths(-1).ToString("dd MMM yyyy")!=n.ToString("dd MMM yyyy")&&"True"==o.d.SessionManager.Preferences.DontConsiderEmpLeavesVacationDataBasedonPostedDate&&""!=o.d.SessionManager.Preferences.ConsiderLOPBasedOn.ToString())for(let c=0;c<h.length;c++)h[c].PrevMonth.ToString("dd MMM yyyy")==n.ToString("dd MMM yyyy")&&(d={},d.PayrollMonth=n.ToString("dd/MMM/yyyy"),d.Days=h[c].dDays,l.push(d))}else if(o.d.SessionManager.PayrollMonth.AddMonths(-1).ToString("dd MMM yyyy")==n.ToString("dd MMM yyyy")&&"True"==o.d.SessionManager.Preferences.DontConsiderEmpsForPayroll&&parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)>0&&i.getDate()>=parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)){d={},d.PayrollMonth=n.ToString("dd/MMM/yyyy");let c,g,e,p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e};m.J0.SetPayrollDate_1(i,p),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd;let u=o.d.SessionManager.PayrollMonth,P=0;o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade&&(P=m.J0.GetEmployeeGrade(s.toString(),c,g,e),P>0&&(p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e},m.J0.SetPayrollDate(i,p,P),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd),m.J0.SetPayrollMonth(c,o.d.SessionManager,P)),m.J0.SetPayrollMonth(c,o.d.SessionManager,P);let x=new fe.O;x.oParent=this,x.sSelectedEmpSeqNos=s.ToString(),x.PayrollMonth=o.d.SessionManager.PayrollMonth,x.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,x.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,x.ProcessPayroll(),x.IsCompleted&&(d.Days=x.arrLstOthMPFields[0].DaysAttended),m.J0.SetPayrollMonth(u),l.push(d)}n=n.AddMonths(-1)}if(null!=l&&l.length>0)for(let c=0;c<l.length;c++)null!=l[c].Days&&null!=l[c].Days&&""!=l[c].Days.toString().Trim()&&(d={},d.PayrollMonth=o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),d.AdjMonth=l[c].PayrollMonth.toString(),d.Days=l[c].Days.toString(),this.dtAdjData.push(d));if(null!=this.dtAdjData&&this.dtAdjData.length>0&&(this.SaveAdjustment(),this.sAdjCalcMonthPaydays="",this.sAdjsCalcMonths="",null!=this.dtAdjData&&this.dtAdjData.length>0)){for(let c=0;c<this.dtAdjData.length;c++)this.sAdjCalcMonthPaydays=this.sAdjCalcMonthPaydays+this.dtAdjData[c].Days.toString()+";",this.sAdjsCalcMonths=this.sAdjsCalcMonths+this.dtAdjData[c].AdjMonth.toString()+";";this.sAdjCalcMonthPaydays.length>0&&(this.sAdjCalcMonthPaydays=this.sAdjCalcMonthPaydays.substring(this.sAdjCalcMonthPaydays.length-1,0)),this.sAdjsCalcMonths.length>0&&(this.sAdjsCalcMonths=this.sAdjsCalcMonths.substring(this.sAdjsCalcMonths.length-1,0)),this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths=this.sAdjsCalcMonths,this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays=this.sAdjCalcMonthPaydays}Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting AdjustmentsClick()")}catch(l){Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION AdjustmentsClick()\r\n"+l.Message+"\r\n"+l.stack)}}SaveAdjustment(){let s=o.d.SessionManager.PayrollMonth;this.CalculateAdjustments(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo)),this.oCMP.CalculateNet(),this.FillProcessedData(this.lstSelectedEmps[this.iEmpIndex]),m.J0.SetPayrollMonth(s,o.d.SessionManager,this.oCMP.arrLstOthMPFields[this.iEmpIndex].GradeID)}CalculateAdjustments(s){if(null!=this.dtAdjData&&this.dtAdjData.length>0){let t,i,n,l="";for(let e=0;e<this.dtAdjData.length;e++)l.length>0&&(l+=","),l+="'"+new Date(this.dtAdjData[e].AdjMonth).ToString("dd MMM yyyy")+"'";let r=o.d.empService.GetQueryData(s,"MPL010",l,"","");for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;e++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dAdjusted="0";for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;e++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dAdjusted="0";this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments=0,this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments=0;let g,d=o.d.empService.GetQueryData(0,"MPL014","","",""),C=o.d.empService.GetQueryData(s,"MPL005","","",""),h=o.d.empService.GetQueryData(s,"MPL011",o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy"),"",""),c="";for(let e=0;e<this.dtAdjData.length;e++){let p=new Date(this.dtAdjData[e].AdjMonth),u=p;t=r.filter(A=>new Date(A.PayrollMonth).ToString("dd MMM yyyy")==p.ToString("dd MMM yyyy")&&11==A.VoucherType);let P=null;if(null!=t&&t.length>0){let A=d.filter(T=>T.GradeID==t[0].dcCCNID53&&T.CPayrollDate<=u.ToString("dd MMM yyyy")).Compute("max","CPayrollDate");P=d.filter(T=>T.GradeID==t[0].dcCCNID53&&T.CPayrollDate==m.J0.String(A))}if(c="'"+p.ToString("dd/MMM/yyyy")+"' >= ApplyFrom AND '"+p.ToString("dd/MMM/yyyy")+"' <=EffectFrom",g=C.filter(A=>p.ToString("dd/MMM/yyyy")>=A.ApplyFrom&&p.ToString("dd/MMM/yyyy")<=A.EffectFrom),g=g.sort((A,T)=>A.EffectFrom-T.EffectFrom),i=h.Tables[0].filter(A=>A.ArrearsCalcMonths==m.J0.ParseDate(p)),n=h.Tables[1].filter(A=>1==A.DType&&A.ArrAdjMonth==m.J0.ParseDate(p)),null!=g&&g.length>0){let A=!1;if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.length>0){let T=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.split(";");if(T.length>0)for(let I=0;I<T.length;I++)m.J0.ParseDate(T[I]).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&(A=!0)}null!=i&&i.length>0||A?(p=m.J0.ParseDate(g[0].EffectFrom),o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade?m.J0.SetPayrollMonth(p,o.d.SessionManager,null!=t&&t.length>0?parseInt(t[0].dcCCNID53):this.oCMP.arrLstOthMPFields[0].GradeID):m.J0.SetPayrollMonth(p)):o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade?m.J0.SetPayrollMonth(p,o.d.SessionManager,null!=t&&t.length>0?parseInt(t[0].dcCCNID53):this.oCMP.arrLstOthMPFields[0].GradeID):m.J0.SetPayrollMonth(p)}else o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade?m.J0.SetPayrollMonth(p,o.d.SessionManager,null!=t&&t.length>0?parseInt(t[0].dcCCNID53):this.oCMP.arrLstOthMPFields[0].GradeID):m.J0.SetPayrollMonth(p);let x=parseFloat(this.dtAdjData[e].Days),y=0;y="Actual Days"!=o.d.SessionManager.Preferences.PayDays?parseInt(o.d.SessionManager.Preferences.PayDays):p.DaysInMonth();let M=new fe.O;if(M.oParent=this,M.sSelectedEmpSeqNos=s.toString(),M.PayrollMonth=o.d.SessionManager.PayrollMonth,M.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,M.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,M.dAdjDays=x,null!=t&&t.length>0&&(M.IsAdjustments=!0,M.drcArrStructure=P,M.ArrGradeID=m.J0.Int(t[0].dcCCNID53)),M.ProcessPayroll(),M.IsCompleted){let A=0;null!=t&&t.length>0?(M.arrLstOthMPFields[0].TotalDays=parseFloat(t[0].TotalDays),M.arrLstOthMPFields[0].MonthDays=parseFloat(t[0].TotalDays),M.arrLstOthMPFields[0].PaidLeaves=parseFloat(t[0].dcAlpha24),M.arrLstOthMPFields[0].TotalLeaves=parseFloat(t[0].LeavesTaken),M.arrLstOthMPFields[0].WeeklyOffs=parseFloat(t[0].WOffs),M.arrLstOthMPFields[0].Holidays=parseFloat(t[0].Holidays),A=parseFloat(t[0].DaysWorked.toString())+x,M.SetDaysAttended(0,"Days Attended",A)):m.J0.ParseDate(this.dtAdjData[e].AdjMonth).iMonth()==this.oCMP.arrLstOthMPFields[this.iEmpIndex].DateOfJoining.iMonth()&&m.J0.ParseDate(this.dtAdjData[e].AdjMonth).getFullYear()==this.oCMP.arrLstOthMPFields[this.iEmpIndex].DateOfJoining.getFullYear()&&(M.arrLstOthMPFields[0].TotalDays=y,M.arrLstOthMPFields[0].TotalLeaves=0,M.SetDaysAttended(0,"Days Attended",Math.abs(x)));let N,T=0,I=-1,S=0,v=0,O=0;t=r.filter(E=>new Date(E.PayrollMonth).ToString("dd MMM yyyy")==p.ToString("dd MMM yyyy")&&11==E.VoucherType);for(let E=0;E<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;E++)if(m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateAdjustments)||"No"!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateAdjustments)for(let G=0;G<M.arrLstCPFields[0][0].length;G++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].SNo==M.arrLstCPFields[0][0][G].SNo){if(S=0,v=0,O=0,I=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].SNo,!m.J0.IsEmpty(t)&&t.length>0&&!m.J0.IsEmpty(t[0]["dcCalcNum"+I])&&(S=parseFloat(t[0]["dcCalcNum"+I])),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData&&this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData.length>0&&(N=[],this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData.TrimEnd(","),N=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData.split(";"),null!=N&&N.length>0))for(let J=0;J<N.length;J+=2)new Date(N[J]).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&(v=parseFloat(N[J+1]));null!=n&&n.length>0&&null!=n[0]["Earning"+I]&&null!=n[0]["Earning"+I]&&""!=n[0]["Earning"+I]&&(O=parseFloat(n[0]["Earning"+I])),T=o.d.SessionManager.Preferences.ContainsKey("DonotconsiderArrearwhilecalculatingAdjustmentofPF")&&(0,j.yG0)("True"==o.d.SessionManager.Preferences.DonotconsiderArrearwhilecalculatingAdjustmentofPF)&&"PFE"==M.arrLstCPFields[0][0][G].ComponentName?parseFloat(M.arrLstCPFields[0][0][G].dEarned)-S:parseFloat(M.arrLstCPFields[0][0][G].dEarned)-S-v-O,this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AdjData=m.J0.String(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AdjData),this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AdjData+=u.ToString("dd MMM yyyy")+","+T+",",this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].dAdjusted=(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].dAdjusted)+T).ToString(o.d.SessionManager.sPayrollDecimals),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet&&("Net"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet||"NetAndTax"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet)&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments+=T);break}t=r.filter(E=>new Date(E.PayrollMonth).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&12==E.VoucherType);for(let E=0;E<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;E++)if(null==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateAdjustments||""==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateAdjustments||"No"!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateAdjustments)for(let G=0;G<M.arrLstCPFields[0][2].length;G++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].SNo==M.arrLstCPFields[0][2][G].SNo){if(S=0,v=0,O=0,I=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].SNo,null!=t&&t.length>0&&null!=t[0]["dcCalcNum"+I]&&null!=t[0]["dcCalcNum"+I]&&""!=t[0]["dcCalcNum"+I].toString()&&(S=parseFloat(t[0]["dcCalcNum"+I])),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData&&this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData.length>0&&(N=[],this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData.TrimEnd(","),N=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData.split(";"),null!=N&&N.length>0))for(let J=0;J<N.length;J+=2)new Date(N[J]).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&(v=parseFloat(N[J+1]));null!=n&&n.length>0&&null!=n[0]["Deduction"+I]&&null!=n[0]["Deduction"+I]&&""!=n[0]["Deduction"+I]&&(O=parseFloat(n[0]["Deduction"+I])),T=o.d.SessionManager.Preferences.ContainsKey("DonotconsiderArrearwhilecalculatingAdjustmentofPF")&&(0,j.yG0)("True"==o.d.SessionManager.Preferences.DonotconsiderArrearwhilecalculatingAdjustmentofPF)&&"PF"==M.arrLstCPFields[0][2][G].ComponentName?parseFloat(M.arrLstCPFields[0][2][G].dEarned)-S:parseFloat(M.arrLstCPFields[0][2][G].dEarned)-S-v-O,this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AdjData=m.J0.String(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AdjData),this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AdjData+=u.ToString("dd MMM yyyy")+","+T+",",this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].dAdjusted=(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].dAdjusted)+T).ToString(o.d.SessionManager.sPayrollDecimals),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet&&("Net"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet||"NetAndTax"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet)&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments+=T);break}this.oCMP.iEmpIndex=this.iEmpIndex,this.oCMP.othMPField=this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.ExecuteAllFormulas(),this.oCMP.CalculateNet(),this.FillProcessedData(this.lstSelectedEmps[this.iEmpIndex])}}}}CalculateAccruals(s){let l=this.oCMP.arrLstOthMPFields[0].dsAllEmpsData.Tables[2];if(l=l.filter(t=>t.EmpSeqNo==s),l.length>0&&m.J0.ParseDate(l[0].cEffectFrom).getFullYear()==o.d.SessionManager.PayrollMonth.getFullYear()&&m.J0.ParseDate(l[0].cEffectFrom).iMonth()==o.d.SessionManager.PayrollMonth.iMonth()&&this.oCMP.lstAccrAccumulateSNos.length>0){let t="",i=0,n=0,r=0,d=0,C=0,h=0,c=0,g=0,e=0,p=-1;for(let x=0;x<this.oCMP.lstAccrAccumulateSNos.length;x++)t.length>0&&(t+=","),t+="ISNULL(dcCalcNum"+this.oCMP.lstAccrAccumulateSNos[x]+",0) as dcCalcNum"+this.oCMP.lstAccrAccumulateSNos[x]+",ISNULL(dcCalcNumFC"+this.oCMP.lstAccrAccumulateSNos[x]+",0) as dcCalcNumFC"+this.oCMP.lstAccrAccumulateSNos[x];let u=o.d.empService.GetQueryData(s,"CONS002",JSON.stringify(t),o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy"),""),P=o.d.empService.GetQueryData(0,"CONS003","","","");if(null!=u&&u.length>0){let x=!1;for(let y=0;y<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;y++)if(n=0,r=0,this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].IsAccrualType&&"Accruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].Behaviour){p=this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].SNo,i=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dActual);for(let M=0;M<u.length;M++)C=parseFloat(u[M].TotalDays),d=parseFloat(u[M].DaysAttended)+parseFloat(u[M].PaidLeaves)+parseFloat(u[M].LOPDays),h=parseFloat(u[M]["dcCalcNum"+p]),c=parseFloat(u[M]["dcCalcNumFC"+p]),g=parseFloat((d/C*i).ToString(o.d.SessionManager.sPayrollDecimals)),e=parseFloat((g-h).ToString(o.d.SessionManager.sPayrollDecimals)),n+=parseFloat(e.ToString(o.d.SessionManager.sPayrollDecimals)),r+=c;this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dAdjusted=(n-r).ToString(o.d.SessionManager.sPayrollDecimals)}else this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].Behaviour&&(x=!0);if(x){for(let y=0;y<u.length;y++){let M=P.filter(I=>I.GradeID==parseInt(u[y].GradeID)&&I.CPayrollDate==m.J0.ParseDate(u[y].PayrollDate)).Compute("max","CPayrollDate"),A=P.filter(I=>I.GradeID==parseInt(u[y].GradeID)&&I.CPayrollDate==M),T=new fe.O;if(T.oParent=this,T.sSelectedEmpSeqNos=s.toString(),T.PayrollMonth=o.d.SessionManager.PayrollMonth,T.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,T.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,T.drcArrStructure=A,T.IsCalculateAccruals=!0,T.ArrGradeID=parseInt(u[y].GradeID),T.ProcessPayroll(),T.IsCompleted){T.arrLstOthMPFields[0].TotalDays=parseFloat(u[y].TotalDays),T.arrLstOthMPFields[0].MonthDays=parseFloat(u[y].TotalDays),T.arrLstOthMPFields[0].PaidLeaves=parseFloat(u[y].PaidLeaves),T.arrLstOthMPFields[0].TotalLeaves=parseFloat(u[y].LeavesTaken),T.arrLstOthMPFields[0].WeeklyOffs=parseFloat(u[y].WOffs),T.arrLstOthMPFields[0].Holidays=parseFloat(u[y].Holidays),d=parseFloat(u[y].TotalDays.toString())-parseFloat(u[y].LOPDays.toString())-parseFloat(u[y].LeavesTaken.toString())-parseFloat(u[y].UnpaidDays.toString()),T.SetDaysAttended(0,"Days Attended",d);let I=0,S=-1,v=0,O=0;for(let N=0;N<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;N++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][N].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][N].Behaviour)for(let E=0;E<T.arrLstCPFields[0][0].length;E++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][N].SNo==T.arrLstCPFields[0][0][E].SNo){v=0,O=0,S=this.oCMP.arrLstCPFields[this.iEmpIndex][0][N].SNo,null!=u[y]["dcCalcNum"+S]&&null!=u[y]["dcCalcNum"+S]&&""!=u[y]["dcCalcNum"+S].toString()&&(v=parseFloat(u[y]["dcCalcNum"+S])),null!=u[y]["dcCalcNumFC"+S]&&null!=u[y]["dcCalcNumFC"+S]&&""!=u[y]["dcCalcNumFC"+S].toString()&&(O=parseFloat(u[y]["dcCalcNumFC"+S])),I=parseFloat(T.arrLstCPFields[0][0][E].dEarned)-v,this.oCMP.arrLstCPFields[this.iEmpIndex][0][N].dPrevAccEar+=parseFloat(I.ToString(o.d.SessionManager.sPayrollDecimals)),this.oCMP.arrLstCPFields[this.iEmpIndex][0][N].dPrevAccAdj+=O;break}for(let N=0;N<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;N++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][N].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][N].Behaviour)for(let E=0;E<T.arrLstCPFields[0][2].length;E++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][N].SNo==T.arrLstCPFields[0][2][E].SNo){v=0,O=0,S=this.oCMP.arrLstCPFields[this.iEmpIndex][2][N].SNo,null!=u[y]["dcCalcNum"+S]&&null!=u[y]["dcCalcNum"+S]&&""!=u[y]["dcCalcNum"+S].toString()&&(v=parseFloat(u[y]["dcCalcNum"+S])),null!=u[y]["dcCalcNumFC"+S]&&null!=u[y]["dcCalcNumFC"+S]&&""!=u[y]["dcCalcNumFC"+S].toString()&&(O=parseFloat(u[y]["dcCalcNumFC"+S])),I=parseFloat(T.arrLstCPFields[0][2][E].dEarned)-v,this.oCMP.arrLstCPFields[this.iEmpIndex][2][N].dPrevAccEar+=parseFloat(I.ToString(o.d.SessionManager.sPayrollDecimals)),this.oCMP.arrLstCPFields[this.iEmpIndex][2][N].dPrevAccAdj+=O;break}}}for(let y=0;y<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;y++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].Behaviour&&(this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dAdjusted=(this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dPrevAccEar-this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dPrevAccAdj).ToString(o.d.SessionManager.sPayrollDecimals));for(let y=0;y<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;y++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].Behaviour&&(this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].dAdjusted=(this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].dPrevAccEar-this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].dPrevAccAdj).ToString(o.d.SessionManager.sPayrollDecimals))}}}}FillProcessedData(s){if(Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering FillProcessedData()"),null!=this.oCMP&&this.oCMP.IsCompleted&&!(this.iEmpIndex>this.oCMP.arrLstOthMPFields.length-1)){if(this.oCMP.arrLstCPFields[this.iEmpIndex][0].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;l++)this.dgvEmployees.TableColumns.Contains("Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].SNo)&&(this.dgvEmployees.Table[s]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].dEarned).ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].SNo+"_Arr")&&(this.dgvEmployees.Table[s]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].SNo+"_Arr"]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].dArrear).ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].SNo+"_Adj")&&(this.dgvEmployees.Table[s]["Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].SNo+"_Adj"]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][l].dAdjusted).ToString(o.d.SessionManager.sPayrollDecimals));if(this.oCMP.arrLstCPFields[this.iEmpIndex][1].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][1].length;l++)this.dgvEmployees.TableColumns.Contains("EarningOTHrs"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][l].SNo)&&(this.dgvEmployees.Table[s]["EarningOTHrs"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][1][l].dActual).ToString(o.d.SessionManager.sPayrollDecimals2)),this.dgvEmployees.TableColumns.Contains("EarningOTAmt"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][l].SNo)&&(this.dgvEmployees.Table[s]["EarningOTAmt"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][1][l].dEarned).ToString(o.d.SessionManager.sPayrollDecimals));if(this.oCMP.arrLstCPFields[this.iEmpIndex][2].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;l++)this.dgvEmployees.TableColumns.Contains("Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].SNo)&&(this.dgvEmployees.Table[s]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].dEarned).ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].SNo+"_Arr")&&(this.dgvEmployees.Table[s]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].SNo+"_Arr"]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].dArrear).ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].SNo+"_Adj")&&(this.dgvEmployees.Table[s]["Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].SNo+"_Adj"]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][2][l].dAdjusted).ToString(o.d.SessionManager.sPayrollDecimals));if(this.oCMP.arrLstCPFields[this.iEmpIndex][3].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][3].length;l++)this.dgvEmployees.TableColumns.Contains("DeductionOTHrs"+this.oCMP.arrLstCPFields[this.iEmpIndex][3][l].SNo)&&(this.dgvEmployees.Table[s]["DeductionOTHrs"+this.oCMP.arrLstCPFields[this.iEmpIndex][3][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][3][l].dActual).ToString(o.d.SessionManager.sPayrollDecimals2)),this.dgvEmployees.TableColumns.Contains("DeductionOTAmt"+this.oCMP.arrLstCPFields[this.iEmpIndex][3][l].SNo)&&(this.dgvEmployees.Table[s]["DeductionOTAmt"+this.oCMP.arrLstCPFields[this.iEmpIndex][3][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][3][l].dEarned).ToString(o.d.SessionManager.sPayrollDecimals));if(this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][4].length;l++)this.dgvEmployees.TableColumns.Contains("Loan"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][l].SNo)&&null!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][l].LoanInstAmt&&(this.dgvEmployees.Table[s]["Loan"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][l].SNo]=m.J0.Double(this.oCMP.arrLstCPFields[this.iEmpIndex][4][l].LoanInstAmt).ToString(o.d.SessionManager.sPayrollDecimals));if(this.oCMP.arrLstCPFields[this.iEmpIndex][5].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][5].length;l++)this.dgvEmployees.TableColumns.Contains("Leave"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][l].SNo)&&(this.dgvEmployees.Table[s]["Leave"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][l].SNo]=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][5][l].LeaveTaken).ToString(o.d.SessionManager.sPayrollDecimals));if(this.oCMP.arrLstCPFields[this.iEmpIndex][6].length>0)for(let l=0;l<this.oCMP.arrLstCPFields[this.iEmpIndex][6].length;l++)if(this.dgvEmployees.TableColumns.Contains(this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName))if("LISTBOX"==this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldDataType){if("EMPTY"!=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue){let t=o.d.SessionManager.dtFeatures.filter(i=>i.FeatureID==parseInt(this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName.Replace("dcCCNID",""))+5e4);if(null!=t&&t.length>0){let i=o.d.empService.GetQueryData(this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue,"CONS001",t[0].TableName.toString(),"","");null!=i&&i.length>0&&(this.dgvEmployees.Table[s][this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName]=i[0].Name.toString(),this.dgvEmployees.Table[s][this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName+"_Key"]=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue)}}}else"DATE"==this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldUserColumnType?"EMPTY"!=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue&&(m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue)||(this.dgvEmployees.Table[s][this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName]=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue,m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue)||(this.dgvEmployees.Table[s][this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName+"_Key"]=m.J0.ParseDate(this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue)))):"EMPTY"!=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue&&(this.dgvEmployees.Table[s][this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldName]=this.oCMP.arrLstCPFields[this.iEmpIndex][6][l].ExtraFieldValue);this.dgvEmployees.TableColumns.Contains("MonthDays")&&(this.dgvEmployees.Table[s].MonthDays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalDays.ToString("N1")),this.dgvEmployees.TableColumns.Contains("DaysAttended")&&(this.dgvEmployees.Table[s].DaysAttended=this.oCMP.arrLstOthMPFields[this.iEmpIndex].DaysAttended.ToString("N1")),this.dgvEmployees.TableColumns.Contains("TotalLeaves")&&(this.dgvEmployees.Table[s].TotalLeaves=this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalLeaves.ToString("N1")),this.dgvEmployees.TableColumns.Contains("PaidLeaves")&&(this.dgvEmployees.Table[s].PaidLeaves=this.oCMP.arrLstOthMPFields[this.iEmpIndex].PaidLeaves.ToString("N1")),this.dgvEmployees.TableColumns.Contains("WeeklyOffs")&&(this.dgvEmployees.Table[s].WeeklyOffs=this.oCMP.arrLstOthMPFields[this.iEmpIndex].WeeklyOffs.ToString("N1")),this.dgvEmployees.TableColumns.Contains("Holidays")&&(this.dgvEmployees.Table[s].Holidays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].Holidays.ToString("N1")),this.dgvEmployees.TableColumns.Contains("LOPDays")&&(this.dgvEmployees.Table[s].LOPDays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays.ToString("N1")),this.dgvEmployees.TableColumns.Contains("UnpaidDays")&&(this.dgvEmployees.Table[s].UnpaidDays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].UnpaidDays.ToString("N1")),this.dgvEmployees.TableColumns.Contains("TotalDays")&&(this.dgvEmployees.Table[s].TotalDays=this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalDays.ToString("N1")),this.dgvEmployees.TableColumns.Contains("Basic")&&(this.dgvEmployees.Table[s].Basic=this.oCMP.arrLstOthMPFields[this.iEmpIndex].BasicMonthly.ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("TotalEarnings")&&(this.dgvEmployees.Table[s].TotalEarnings=(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarnings+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTAmount).ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("TotalDeductions")&&(this.dgvEmployees.Table[s].TotalDeductions=(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDeductions+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totLoans).ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.TableColumns.Contains("NetSalary")&&(this.dgvEmployees.Table[s].NetSalary=this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary.ToString(o.d.SessionManager.sPayrollDecimals)),this.dgvEmployees.updateRow(this.dgvEmployees.Table[s]),this.dgvEmployees.UpdateTotals(),Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting FillProcessedData()")}}CheckViewForUser(s){if(null!=this.dsDocDesig&&this.dsDocDesig.Tables.length>6&&this.dsDocDesig.Tables[6].length>0)for(let l=0;l<this.dgvEmployees.Columns.length;l++)this.SetView(this.dgvEmployees.Columns[l])}SetView(s){let l=this.dsDocDesig.Tables[6],t=this.dsDocDesig.Tables[0];l=l.filter(i=>1==i.Mode||2==i.Mode||3==i.Mode||4==i.Mode),s instanceof L.O7&&(l=s.CrRefColID>0?l.filter(i=>i.CostCenterColID==1e6+s.CrRefColID):null!=s.CrRefColName&&""!=s.CrRefColName&&s.CrRefColName.startsWith("dcAlpha")?l.filter(i=>i.SysColumnName==s.CrRefColName):[]),l.length>0?(s instanceof L.O7&&(s.IsVisible=(0,j.yG0)(l[0].IsVisible.toString())),m.J0.IsEmpty(l[0].IsMandatory)||s instanceof L.O7&&(s.Mandatory=(0,j.yG0)(l[0].IsMandatory)),s instanceof L.O7&&(s.ReadOnly=!(0,j.yG0)(l[0].IsEditable)),s instanceof L.O7&&(s.Expression=m.J0.String(l[0].Expression)),s instanceof L.O7&&(s.Message=m.J0.String(l[0].FailureMessage)),m.J0.IsEmpty(l[0].ActionOptionID)?s instanceof L.O7&&(s.Action=0):s instanceof L.O7&&(s.Action=parseInt(l[0].ActionOptionID)),m.J0.IsEmpty(l[0].NumFieldEditOptionID)?s instanceof L.O7&&(s.EditOption=0):s instanceof L.O7&&(s.EditOption=parseInt(l[0].NumFieldEditOptionID.toString()))):(s instanceof L.O7&&(t="combobox"==s.DataType.toLowerCase()?t.filter(i=>i.SysColumnName==s.ValueBinding):t.filter(3==s.CostCenterID||2==s.CostCenterID?i=>i.CostcenterColid==s.ID:i=>i.SysColumnName==s.DisplayMember)),t.length>0&&(s instanceof L.O7&&(o.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==o.d.SessionManager.Preferences.EnableDivisionWise.toString()&&50001==s.CostCenterID||o.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==o.d.SessionManager.Preferences.EnableLocationWise.toString()&&50002==s.CostCenterID||(s.ReadOnly=!(0,j.yG0)(t[0].IsEditable.toString()))),m.J0.IsEmpty(t[0].IsMandatory)||s instanceof L.O7&&(s.Mandatory=(0,j.yG0)(t[0].IsMandatory)),s instanceof L.O7&&(s.IsVisible=(0,j.yG0)(t[0].IsVisible.toString()))),s instanceof L.O7&&(s.EditOption=0),s instanceof L.O7&&(s.Expression=""),s instanceof L.O7&&(s.Message=""),s instanceof L.O7&&(s.Action=0))}UnPostPayrollData(){Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering UnPostPayrollData()"),this.InProgress="";let s=0,l=0;if(null!=this.dgvEmployees.Table&&this.dgvEmployees.Table.length>0){this.lstSelectedEmps=new Array;let t="";for(let i=0;i<this.dgvEmployees.Table.length;i++)(0,j.yG0)(this.dgvEmployees.Table[i].Select)&&(t+=this.dgvEmployees.Table[i].EmpSeqNo.toString()+",",this.lstSelectedEmps.push(i),l++);if(t.length>0&&l>0){t=t.substr(0,t.length-1);let n,i=t.split(",");s=l,this.FailedCount=0,this.Failed="",this.ProgressVisibility=!0,this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Unposting Payroll, please wait ...";let r=o.d.common.GetDataSet3("PAY061",t,o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")).Tables[0];for(let d=0;d<i.length;d++){if(this.strResult="",null!=i[d]&&""!=i[d]){if(n=r.filter(C=>C.EmpSeqNo==i[d]),null!=n&&n.length>0){let C=0,h=[];h.push(this.CostCenterID),h.push(parseInt(n[0].DocID)),h.push(1);let c=o.d.document.DeleteSelectedRows(h,C);this.strResult=c.Message,C=c.RetValue}else this.strResult="No Data exits to delete.",this.Failed+=this.dgvEmployees.Table[this.lstSelectedEmps[d]].EmpCode.toString()+",",this.FailedCount++;this.dgvEmployees.Table[this.lstSelectedEmps[d]].Result=this.strResult,this.dgvEmployees.updateRow(this.dgvEmployees.Table[this.lstSelectedEmps[d]])}this.ProgressValue=d+1,this.InProgress=d+1+" of "+s}this.FailedCount>0&&this.Failed.length>1?(this.Failed=this.Failed.substr(0,this.Failed.length-1),this.DisplayMessage="Failed count : "+this.FailedCount+", Emp.Codes : ( "+this.Failed+" )"):null!=this.dgvEmployees&&null!=this.dgvEmployees.Table&&this.dgvEmployees.Table.length>0&&this.dgvEmployees.Table.filter(C=>(0,j.yG0)(C.Select)).length>0&&(this.DisplayMessage="Unposted Successfully"),this.MessageVisibility=!0}else this.DisplayMessage="Select atleast one Employee."}else this.DisplayMessage="No Employees found to unpost payroll.";this.MessageVisibility=!0,Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting UnPostPayrollData()")}bgworker_RunWorkerCompleted(s,l){this.ProgressVisibility=!1,this.dgvEmployees.UpdateTotals(),this.dgvEmployees.RefreshGrid=!0,"PROCESS"==this.sBGWorkType?this.IsProcessed=!0:"POST"==this.sBGWorkType&&(this.IsProcessed=!1)}PostPayrollData(){Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering PostPayrollData()"),this.InProgress="";let s=0,l=0;if(null!=this.dgvEmployees.Table&&this.dgvEmployees.Table.length>0){for(let t=0;t<this.dgvEmployees.Table.length;t++)(0,j.yG0)(this.dgvEmployees.Table[t].Select)&&l++;if(l>0){s=l,this.FailedCount=0,this.Failed="",this.ProgressVisibility=!0,this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Posting data, please wait...";for(let t=0;t<this.dgvEmployees.Table.length;t++)if((0,j.yG0)(this.dgvEmployees.Table[t].Select)){let i=this.oCMP.arrLstOthMPFields.find(n=>n.EmpSeqNo==this.dgvEmployees.Table[t].EmpSeqNo.toString());if(this.iEmpIndex=this.oCMP.arrLstOthMPFields.indexOf(i),this.iEmpIndex>=0){if(o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)for(let n=0;n<this.oCMP.GradeMPFls.length;n++)this.oCMP.GradeMPFls[n].lstGradeEmps.Contains(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo))&&(o.d.SessionManager.PayrollMonth=this.oCMP.GradeMPFls[n].GradePayrollMonth,o.d.SessionManager.PayrollMonthStart=this.oCMP.GradeMPFls[n].GradePayrollMonthStart,o.d.SessionManager.PayrollMonthEnd=this.oCMP.GradeMPFls[n].GradePayrollMonthEnd);if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].IsAlreadyProcessed&&null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID&&null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID&&""!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID.toString()&&parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID)>0){let n=o.d.common.GetDataTable("PAY087",this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].INVDocDetailsID.toString()+",54,'"+o.d.SessionManager.UserName+"',40054,"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID.toString()+","+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowLevel.toString()+","+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].StatusID.toString()+","+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].CreatedDate.toString()+","+o.d.SessionManager.UserID+","+o.d.SessionManager.RoleID);null!=n&&n.length>0&&(!m.J0.IsEmpty(n[0].CanApprove)&&"TRUE"==n[0].CanApprove.toString().toUpperCase()||(369!=parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].StatusID)||o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Posted Docs")?441==parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].StatusID)&&!o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Approved Docs")&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage="Can't Edit Approved Document"):this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage="Can't Edit Posted Document"))}this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.length>0?(this.strResult=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage,this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++,this.dgvEmployees.Table[t].Result=this.strResult):(this.strResult="",this.SaveVoucher(),this.ProgressValue=this.iEmpIndex+1,this.InProgress=this.iEmpIndex+1+" of "+s)}this.IsProcessed=!1}this.MessageVisibility=!0,this.FailedCount>0&&this.Failed.length>1?(this.Failed=this.Failed.substr(0,this.Failed.length-1),this.DisplayMessage="Failed count : "+this.FailedCount+", Emp.Codes : ( "+this.Failed+" )"):null!=this.dgvEmployees&&null!=this.dgvEmployees.Table&&this.dgvEmployees.Table.length>0&&this.dgvEmployees.Table.filter(i=>(0,j.yG0)(i.Select)).length>0&&(this.DisplayMessage="Posted Successfully",o.d.SessionManager.Preferences.ContainsKey("DefaultPostbasedonAttendanceDimensionWise")&&"True"==o.d.SessionManager.Preferences.DefaultPostbasedonAttendanceDimensionWise?this.chkPostBasedOnAttDimWise.IsChecked=!0:"True"==o.d.SessionManager.Preferences.GetDailyAttendanceDataInMonthlyPayroll?(this.chkPostBasedOnDailyAttendance.IsChecked=!0,this.chkIncludeOTHours.IsChecked=!0):(this.chkIncludeOTHours.IsChecked=!1,this.chkPostBasedOnDailyAttendance.IsChecked=!1))}else this.DisplayMessage="Select atleast one Employee."}else this.DisplayMessage="No Employees found to post payroll.";this.MessageVisibility=!0,Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting PostPayrollData()")}ValidatePosting(){try{if(Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering IsValidated()"),null!=o.d.SessionManager.Preferences.PayrollProduct&&""!=o.d.SessionManager.Preferences.PayrollProduct&&(this.DefProdID=parseInt(o.d.SessionManager.Preferences.PayrollProduct)),0==this.DefProdID)return this.strResult+="Select any Default Payroll Product at Global Preferences",this.MessageVisibility=!0,!1;for(let s=0;s<this.dgvEmployees.Columns.length;s++)if(this.dgvEmployees.Columns[s].ID.startsWith("dcAlpha")&&!this.dgvEmployees.Columns[s].ID.endsWith("_Key")&&this.dgvEmployees.Columns[s].Mandatory&&"SELECTIONBOX"!=this.dgvEmployees.Columns[s].DataType&&""==m.J0.String(this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]][this.dgvEmployees.Columns[s].ID]))return this.strResult+="Enter "+this.dgvEmployees.Columns[s].Header.toString(),this.MessageVisibility=!0,!1;return this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays<0?(this.strResult+="Days mismatch : Month days and Total days.",this.MessageVisibility=!0,!1):this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP>0&&parseFloat(this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays.ToString("N1"))<parseFloat(this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP.ToString("N1"))?(this.strResult+="Employee Should have atleast "+this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP+" LOP Days",this.MessageVisibility=!0,!1):this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary<0&&("False"==o.d.SessionManager.Preferences.CreateLoanIfNetSalLessThanZero||0==parseInt(o.d.SessionManager.Preferences.CreateLoanType))?(this.strResult+="Net Amount should be greater than or equal to zero.",this.MessageVisibility=!0,!1):(Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting IsValidated()"),!0)}catch(s){return Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION IsValidated()",s),!1}}SaveVoucher(){try{if(Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering btnPost_Click()"),this.ValidatePosting()){let s=0,l=[];l.push(this.CostCenterID),l.push(this.oCMP.arrLstOthMPFields[this.iEmpIndex].DocID),l.push(o.d.SessionManager.PayrollMonth.ToString("MMM'/'yyyy")+"-"),l.push(this.oCMP.arrLstOthMPFields[this.iEmpIndex].DocNo),l.push(Date.Today().ToString("dd/MMM/yyyy")),l.push(o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")),l.push(""),l.push(this.GetDocumentXML()),l.push(""),l.push(""),l.push(""),l.push(this.GetActivityXML()),l.push("false"),o.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==o.d.SessionManager.Preferences.EnableLocationWise.toString()?l.push(o.d.SessionManager.LocationID>0?o.d.SessionManager.LocationID:1):l.push(0),o.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==o.d.SessionManager.Preferences.EnableDivisionWise.toString()?l.push(o.d.SessionManager.DivisionID>0?o.d.SessionManager.DivisionID:1):l.push(0),l.push(this.oCMP.arrLstOthMPFields[this.iEmpIndex].WID),l.push(o.d.SessionManager.RoleID),l.push(""),l.push(0),l.push(0),l.push(o.d.SessionManager.CompanyGUID),l.push(o.d.SessionManager.UserName),l.push(o.d.SessionManager.UserID),l.push(o.d.SessionManager.LanguageID),l.push(o.d.SessionManager.IsOffline);let t="",i="",n=o.d.document.SetTempInvDocumentPostPayroll(l);s=n.obj;let r=n;t=null!=r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Columns[r.Tables.length-1].Contains("ErrorMessage")?r.Tables[r.Tables.length-1][0].ErrorMessage.toString():"Problem in processing your request,Please contact administrator.",s=n.obj,s>0?null!=r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Columns[r.Tables.length-1].Contains("VoucherNo")&&(i=r.Tables[r.Tables.length-1][0].VoucherNo.toString()):null!=r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Columns[r.Tables.length-1].Contains("ServerMessage")&&(this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++,s="-407"==r.Tables[r.Tables.length-1][0].ServerMessage.toString()?-407:-12345),this.strResult+=t,this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]].Result=this.strResult,this.dgvEmployees.updateRow(this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]])}else this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++;Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting btnPost_Click()")}catch(s){this.strResult+=s.message,Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION btnPost_Click()"+s.stack)}this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]].Result=this.strResult}GetDocumentXML(){let s,l="",t="",i="",n="",r="",d="",C=new Array,h=" dcAlpha1='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].BasicMonthly+"',dcAlpha3='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary+"',dcAlpha4='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalDays+"',dcAlpha5='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].DaysAttended+"',dcAlpha6='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalLeaves+"',dcAlpha7='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].WeeklyOffs+"',dcAlpha8='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].Holidays+"',dcAlpha9='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays+"',dcAlpha10='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].UnpaidDays+"',\n                    dcAlpha11='"+(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarnings+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTAmount)+"',dcAlpha12='"+(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDeductions+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totLoans)+"',dcAlpha13='0'";o.d.SessionManager.Preferences.ContainsKey("ShowPaymentModeselectionWhilePayrollProcessing")&&"True"==o.d.SessionManager.Preferences.ShowPaymentModeselectionWhilePayrollProcessing&&"Default"!=this.objEmpFilter.PaymentModes.SelectedValue?(h+=",dcAlpha14='"+this.objEmpFilter.PaymentModes.SelectedValue.toString()+"'",h+="Bank Transfer"==this.objEmpFilter.PaymentModes.SelectedValue?",dcAlpha15='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank.toString()+"',dcAlpha16='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].BankAccNo.toString()+"'":",dcAlpha15='',dcAlpha16=''"):(h+=",dcAlpha14='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode.toString()+"'","Bank Transfer"==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode.toString()?h+=",dcAlpha15='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank.toString()+"',dcAlpha16='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].BankAccNo.toString()+"'":h+=",dcAlpha15='',dcAlpha16=''"),h+=",dcAlpha17='"+o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")+"',dcAlpha18='"+o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")+"',\n                                dcAlpha19='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTHours+"',dcAlpha20='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTAmount+"',\n                                dcAlpha21='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths+"',dcAlpha22='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays+"' ",h+=",dcAlpha23='' ",h+=",dcAlpha24='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].PaidLeaves+"' ",h+=",dcAlpha25='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totActEarnings+"' ",h+=",dcAlpha26='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarArrears+"' ",h+=",dcAlpha27='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments+"' ",h+=",dcAlpha28='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totActDeductions+"' ",h+=",dcAlpha29='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedArrears+"' ",h+=",dcAlpha30='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments+"' ",h+=",dcAlpha31='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totLoans+"' ",h+=",dcAlpha32='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths+"',dcAlpha33='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays+"' ",o.d.SessionManager.Preferences.ContainsKey("ShowPaymentModeselectionWhilePayrollProcessing")&&"True"==o.d.SessionManager.Preferences.ShowPaymentModeselectionWhilePayrollProcessing&&"Default"!=this.objEmpFilter.PaymentModes.SelectedValue?h+="Bank Transfer"==this.objEmpFilter.PaymentModes.SelectedValue?",dcAlpha34='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].IBANNo.toString()+"'":",dcAlpha34=''":"Bank Transfer"==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode.toString()?h+=",dcAlpha34='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].IBANNo.toString()+"'":h+=",dcAlpha34=''",h+=",dcAlpha35='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].ActDaysAttended.toString()+"'",i+='<Alpha Query="',i+=h;for(let e=0;e<this.dgvEmployees.TableColumns.length;e++)this.dgvEmployees.TableColumns[e].startsWith("dcAlpha")&&!this.dgvEmployees.TableColumns[e].endsWith("_Key")&&(r+=" "+this.dgvEmployees.TableColumns[e]+"='"+m.J0.EncodeXML(m.J0.StringValue(this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]][this.dgvEmployees.TableColumns[e]]))+"',");r+=" ",r.length>0&&(i+=","+r),i+='" ></Alpha>',r="",n+='<CostCenters Query="',r+=" dcCCNID51="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+",",r+=" dcCCNID53="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].GradeID+",",null==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank||"0"==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank.toString()||null==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank||"Cash"==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode.toString()?r+=" dcCCNID68=1,":r+=" dcCCNID68="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank.toString()+",",C.push("dcCCNID51"),C.push("dcCCNID53"),C.push("dcCCNID68");let c="",g="";if(null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim.length>0)for(let e=0;e<Object.keys(this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[24][0]).length;e++)c=Object.keys(this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[24][0])[e].toString(),g=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim[0][c].toString(),c.Contains("CCNID")&&"CCNID51"!=c&&"CCNID53"!=c&&"CCNID68"!=c&&(r+=" dc"+c+"="+g+",",C.Contains("dc"+c)||C.push("dc"+c));for(let e=0;e<this.dgvEmployees.TableColumns.length;e++)this.dgvEmployees.TableColumns[e].startsWith("dcCCNID")&&(C.Contains(this.dgvEmployees.TableColumns[e])||this.dgvEmployees.TableColumns[e].endsWith("_Key")||(r+=" "+this.dgvEmployees.TableColumns[e]+"="+m.J0.EncodeXML(this.dgvEmployees.Table[this.lstSelectedEmps[this.iEmpIndex]][this.dgvEmployees.TableColumns[e]+"_Key"].toString())+","));if(r.length>0&&(n+=r),n+='" ></CostCenters>',t+='" ProductID="'+this.DefProdID+'" Quantity="0" Unit="1" UOMConversion="1" UOMConvertedQty="0" Rate="0" Gross="0" IsQtyIgnored="1" AverageRate="0" StockValue="0" StockValueFC="0" RefNO="" BillDate="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+'" CurrencyID="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].CurrencyID+'" ExchangeRate="1" DebitAccount="'+this.sDrAccount+'" CreditAccount="'+this.sCrAccount+'" CommonNarration="'+m.J0.EncodeXML("POSTED FROM CONSOLIDATED MONTHLY PAYROLL"),this.oCMP.arrLstCPFields[this.iEmpIndex][0].length>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="1" VoucherType="11" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Earning',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&11==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][0].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;e++)null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo&&!m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo)&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dActual.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dEarned.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dArrear.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dAdjusted.Replace(",","")+",");if(this.oCMP.arrLstCPFields[this.iEmpIndex][1].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][1].length;e++)m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo)||(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].dActual.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].dEarned.Replace(",","")+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}if(this.oCMP.arrLstCPFields[this.iEmpIndex][2].length>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="2" VoucherType="12" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Deduction',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&12==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][2].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;e++)m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo)||(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dActual.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dEarned.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dArrear.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dAdjusted.Replace(",","")+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}if(this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].iExtLoansCnt>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="3" VoucherType="13" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Loan',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&13==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][4].length;e++)!m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo)&&1==this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].IsVisible&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanActInstAmt.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanInstAmt.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanBalAmt.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanPayStatus+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}if(this.oCMP.arrLstCPFields[this.iEmpIndex][5].length>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="4" VoucherType="14" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="Leaves',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&14==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][5].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][5].length;e++)m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo)||(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].LeaveTotOPBal.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].EncashLeavetaken.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].LeaveMonOPBal.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].LeaveNetBal.Replace(",","")+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}return l.toString()}GetActivityXML(){let i,s="",l="",t="";if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0)for(let r=0;r<this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length;r++)s+="~"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[r].InvDocDetailsID.toString();let n="";if(n+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].IsAlreadyProcessed?s.length>0?'<XML DetailIds="'+s+'" AppRejDate="'+(new Date).ToString("dd/MMM/yyyy")+'" >':'<XML AppRejDate="'+(new Date).ToString("dd/MMM/yyyy")+'" >':s.length>0?'<XML DetailIds="'+s+'" >':"<XML>",this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].iExtLoansCnt>0){let r,d,C,h,c,e,g="0";if(l=t="",null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay.length>0&&(g=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay[0].DocID.toString()),n+='<LoanRepaymentXML DocID="'+g+'" DocDetIDs="" WorkFlowID="0" >',n+="<DOCXML>",this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0){let p=0;null!=o.d.SessionManager.dtDocDefAccs&&(i=o.d.SessionManager.dtDocDefAccs.filter(u=>40057==u.CostCenterID&&"CreditAccount"==u.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(l=i[0].UserDefaultValue.toString()),i=o.d.SessionManager.dtDocDefAccs.filter(u=>40057==u.CostCenterID&&"DebitAccount"==u.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(t=i[0].UserDefaultValue.toString()));for(let u=0;u<this.oCMP.arrLstCPFields[this.iEmpIndex][4].length;u++)if(!m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].SNo)&&1==this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].IsVisible&&!m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanInstAmt)){r=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanDocNo,C=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanActInstNo,c=3==parseInt(this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanPayStatus)?this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanActInstAmt.Replace(",",""):this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanInstAmt.Replace(",","");let P=parseInt(C);this.oCMP.arrLstOthMPFields[this.iEmpIndex].IsAlreadyProcessed?(e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[11].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.RefNo==r&&A.dcAlpha5==o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")),null!=e&&e.length>0&&(P=parseInt(e[0].dcNum1))):(o.d.SessionManager.Preferences.ContainsKey("ShowLoanBalRespDedMonthWhilePayProc")&&"True"==o.d.SessionManager.Preferences.ShowLoanBalRespDedMonthWhilePayProc?(e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.DocNo==r&&A.InstallmentNo==P),e.SortBy(["InstallmentNo"])):(e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.DocNo==r&&A.InstBalance>0&&A.InstallmentNo<P),e.SortBy(["InstallmentNo"])),null!=e&&e.length>0&&(P=parseInt(e[0].InstallmentNo)));let x=parseFloat(c),y=0,M=0;do{if(p++,e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.DocNo==r&&A.InstallmentNo==P),d=e[0].InvDocDetailsID.toString(),h=e[0].InstallmentAmt.toString().Replace(",",""),y=x>parseFloat(e[0].InstBalance)?parseFloat(e[0].InstBalance):x,n+="<RowHead/>",n+="<Row>",n+="<AccountsXML></AccountsXML>",n+='<Transactions DocSeqNo="'+p+'"  DocDetailsID="0" LinkedInvDocDetailsID="'+d+'" LinkedFieldName="dcNum3" LineNarration="" ProductID="'+this.DefProdID+'" IsScheme="" Quantity="1" Unit="1" UOMConversion="1" UOMConvertedQty="1" Rate="0" Gross="0" RefNO="'+r+'" LinkedFieldValue="'+y+'" IsQtyIgnored="1" AverageRate="0" StockValue="0" StockValueFC="0" CurrencyID="1" ExchangeRate="1"  DebitAccount="'+t+'"  CreditAccount="'+l+'"  ></Transactions>',n+='<Numeric Query="dcNum1='+P+", dcCalcNum1="+P+", dcNum2="+h.Replace(",","")+", dcCalcNum2="+h.Replace(",","")+", dcNum3="+y.toString().Replace(",","")+", dcCalcNum3="+y.toString().Replace(",","")+', " ></Numeric>',n+="<Alpha Query=\"dcAlpha1=N'"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanApprovedAmt+"',dcAlpha2=N'"+(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanBalAmt)-M)+"', dcAlpha3=N'"+c+"', dcAlpha4=N'"+m.J0.ParseDate(e[0].DeductionMonth).ToString("dd/MMM/yyyy")+"', dcAlpha5=N'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"',dcAlpha6=N'1',dcAlpha7=N'"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanPayStatus+"', \" ></Alpha>",n+='<CostCenters Query="dcCCNID51='+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+", dcCCNID52="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].ComponentID+', " ></CostCenters>',n+="<EXTRAXML></EXTRAXML>",n+="</Row>",M+=y,x-=y,e[0].Flag=1,o.d.SessionManager.Preferences.ContainsKey("DeductExcessLoanAmountfromLastInstallment")&&"True"==o.d.SessionManager.Preferences.DeductExcessLoanAmountfromLastInstallment){let A=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(T=>T.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&T.DocNo==r&&0==T.Flag&&T.InstBalance>0).Compute("max","InstallmentNo");null!=A&&null!=A&&(P=parseInt(A))}else P++}while(x>0)}}n+="</DOCXML>",n+="<BillXML></BillXML></LoanRepaymentXML>"}if(this.chkPostBasedOnDailyAttendance.IsChecked&&o.d.SessionManager.Preferences.ContainsKey("CaputureDimensionData")&&"True"==o.d.SessionManager.Preferences.CaputureDimensionData.toString()){let c,r="",d="",C="",h="",g="";if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData.length>0){C=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData[0].DocID.toString();for(let p=0;p<this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData.length;p++)h+="~"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData[p].InvDocDetailsID.toString()}c=g="",null!=o.d.SessionManager.dtDocDefAccs&&(i=o.d.SessionManager.dtDocDefAccs.filter(p=>40079==p.CostCenterID&&"CreditAccount"==p.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(c=i[0].UserDefaultValue.toString()),i=o.d.SessionManager.dtDocDefAccs.filter(p=>40079==p.CostCenterID&&"DebitAccount"==p.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(g=i[0].UserDefaultValue.toString())),n+='<AttendanceDimensionwiseXML DocID="'+C+'" DocDetIDs="'+h+'" WorkFlowID="0" >',n+="<DOCXML>";let e=null;if(null!=this.dsDailyAttendanceData&&this.dsDailyAttendanceData.Tables.length>0&&(e=this.dsDailyAttendanceData.Tables[0].filter(p=>p.EMPNODE==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo)),null!=e&&e.length>0){let P,x,y,M,p=[],u=[];u.push("EMPNODE");for(let T=0;T<this.dsDailyAttendanceData.Tables[3].length;T++)u.push(this.dsDailyAttendanceData.Tables[3][T].Data.toString());u.push("OT1"),u.push("OT2"),u.push("OT3"),u.push("OT4"),u.push("OT5"),u.push("DAYSATTENDED"),u.push("ABSENTDAYS"),u.push("Leaves"),u.push("TOTALOTAMOUNT");for(let T=0;T<e.length;T++)if(x=this.ApplyFilter(p,e[T]),null!=x&&x.length>0)for(let I=0;I<u.length;I++)u[I].startsWith("OT")&&(x[0][u[I]]=m.J0.SUMHoursAndMinutes(x[0][u[I]].toString(),e[T][u[I]].toString()));else{P={},P.EMPNODE=e[T].EMPNODE;for(let I=1;I<u.length;I++)P[u[I]]=e[T][u[I]];if(y=this.ApplyFilter(this.dsDailyAttendanceData.Tables[1],e[T]),null!=y&&y.length>0){if(M=this.ApplyFilter(this.dsDailyAttendanceData.Tables[2],e[T]),P.ABSENTDAYS=null!=M&&M.length>0?M[0].ABSENTDAYS:"0",null==this.dsDailyAttendanceData.Tables[4]||this.dsDailyAttendanceData.Columns[4].Contains("NODATA"))P.Leaves="0";else{let I=this.ApplyFilter(this.dsDailyAttendanceData.Tables[4],e[T]),S=0;if(null!=I&&I.length>0){let v,O;S=0;for(let N=0;N<I.length;N++)v=m.J0.ParseDate(I[N].FromDate),O=m.J0.ParseDate(I[N].ToDate),v>=o.d.SessionManager.PayrollMonthStart?O<=o.d.SessionManager.PayrollMonthEnd?S+=parseFloat(I[N].Leaves):v<=o.d.SessionManager.PayrollMonthEnd&&(S+=this.oCMP.GetNoOfDays(v,o.d.SessionManager.PayrollMonthEnd,parseInt(I[N].ComponentID))):O<=o.d.SessionManager.PayrollMonthEnd?O>=o.d.SessionManager.PayrollMonthStart&&(S+=this.oCMP.GetNoOfDays(o.d.SessionManager.PayrollMonthStart,O,parseInt(I[N].ComponentID))):S+=this.oCMP.GetNoOfDays(o.d.SessionManager.PayrollMonthStart,o.d.SessionManager.PayrollMonthEnd,parseInt(I[N].ComponentID))}P.Leaves=S>0?S:"0"}P.DAYSATTENDED=parseFloat(y[0].DAYSATTENDED)-parseFloat(P.ABSENTDAYS),P.TOTALOTAMOUNT=y[0].TOTALOTAMOUNT}p.push(P)}let A="0";for(let T=0;T<p.length;T++){if(A="0",null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay.length>T&&(A=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay[T].InvDocDetailsID.toString()),r="",n+="<RowHead/>",n+="<Row>",n+="<AccountsXML></AccountsXML>",n+='<Transactions DocSeqNo="'+T+'"  DocDetailsID="'+A+'" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="',n+='" ProductID="'+this.DefProdID+'" IsScheme="" Quantity="1" Unit="1" UOMConversion="1" UOMConvertedQty="1',n+='" Rate="0" Gross="0" RefNO="0" LinkedFieldValue="0" IsQtyIgnored="1" AverageRate="0',n+='" StockValue="0" StockValueFC="0" CurrencyID="1" ExchangeRate="1"  DebitAccount="'+g+'"  CreditAccount="'+c+'"  ></Transactions>',n+='<Numeric Query="dcNum1='+m.J0.Double(p[T].TOTALOTAMOUNT)+", dcCalcNum1="+m.J0.Double(p[T].TOTALOTAMOUNT)+", ",n+="dcNum5="+m.J0.Double(p[T].OT1)+", dcCalcNum5="+m.J0.Double(p[T].OT1)+", ",n+="dcNum7="+m.J0.Double(p[T].OT2)+", dcCalcNum7="+m.J0.Double(p[T].OT2)+", ",n+="dcNum9="+m.J0.Double(p[T].OT3)+", dcCalcNum9="+m.J0.Double(p[T].OT3)+", ",n+="dcNum11="+m.J0.Double(p[T].OT4)+", dcCalcNum11="+m.J0.Double(p[T].OT4)+", ",n+="dcNum13="+m.J0.Double(p[T].OT5)+", dcCalcNum13="+m.J0.Double(p[T].OT5)+", ",n+='" ></Numeric>',n+="<Alpha Query=\"dcAlpha1=N'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"',dcAlpha2=N'"+m.J0.Double(p[T].DAYSATTENDED)+"', dcAlpha3=N'"+m.J0.Double(p[T].ABSENTDAYS)+"', dcAlpha4=N'"+m.J0.Double(p[T].Leaves)+"', \" ></Alpha>",n+='<CostCenters Query="',r+=" dcCCNID51="+m.J0.Int(p[T].EMPNODE)+",",this.dsDailyAttendanceData.Tables[3].length>0){d="";for(let I=0;I<this.dsDailyAttendanceData.Tables[3].length;I++)d=this.dsDailyAttendanceData.Tables[3][I].Data.toString(),r+=" "+d+"="+m.J0.Int(p[T][d])+","}r.length>0&&(n+=r),n+='" ></CostCenters>',n+="<EXTRAXML></EXTRAXML>",n+="</Row>"}}n+="</DOCXML>",n+="</AttendanceDimensionwiseXML>"}if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.length>0){let r=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.split(";"),d=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrCalcMonthPaydays.split(";");if(r.length>0){n+="<ArrearsXML>",n+="<Rows>";for(let C=0;C<r.length;C++)n+='<Row PayrollMonth="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),n+='" EmpSeqNo="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo,n+='" ArrearsCalcMonths="'+m.J0.ParseDate(r[C]).ToString("dd/MMM/yyyy"),n+='" ArrCalcMonthPayDays="'+d[C].toString(),n+='" ArrearsCalcDays="',n+='" />';n+="</Rows>",n+="</ArrearsXML>"}}if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays.length>0){let r=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths.split(";"),d=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays.split(";");if(r.length>0){n+="<AdjustmentsXML>",n+="<Rows>";for(let C=0;C<r.length;C++)n+='<Row PayrollMonth="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),n+='" EmpSeqNo="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo,n+='" AdjMonth="'+m.J0.ParseDate(r[C]).ToString("dd/MMM/yyyy"),n+='" Days="'+d[C].toString(),n+='" Remarks="',n+='" />';n+="</Rows>",n+="</AdjustmentsXML >"}}if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanCrNetSalLessZero.length>0&&(n+='<DelLoanXML DocID="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanCrNetSalLessZero[0].DocID.toString()+'" > </DelLoanXML>'),this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary<0&&"True"==o.d.SessionManager.Preferences.CreateLoanIfNetSalLessThanZero&&parseInt(o.d.SessionManager.Preferences.CreateLoanType)>0&&(l=t="",null!=o.d.SessionManager.dtDocDefAccs&&(i=o.d.SessionManager.dtDocDefAccs.filter(r=>40056==r.CostCenterID&&"CreditAccount"==r.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(l=i[0].UserDefaultValue.toString()),i=o.d.SessionManager.dtDocDefAccs.filter(r=>40056==r.CostCenterID&&"DebitAccount"==r.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(t=i[0].UserDefaultValue.toString())),n+='<CreateLoanXML DocID="" DocDetIDs="" WorkFlowID="0" >',n+="<DOCXML>",n+="<RowHead/>",n+="<Row>",n+="<AccountsXML></AccountsXML>",n+='<Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="" CommonNarration="LOAN CREATED FROM MONTHLY PAYROLL WHEN NET SALARY LESS THAN 0" ProductID="'+this.DefProdID+'" IsScheme="" Quantity="1" Unit="1" UOMConversion="1" UOMConvertedQty="1" Rate="0" Gross="0" RefNO="0" IsQtyIgnored="1" AverageRate="0" StockValue="0" StockValueFC="0" CurrencyID="1" ExchangeRate="1"  DebitAccount="'+t+'"  CreditAccount="'+l+'"  ></Transactions>',n+='<Numeric Query="dcNum1=1, dcCalcNum1=1, dcNum2='+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+", dcCalcNum2="+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+', " ></Numeric>',n+="<Alpha Query=\"dcAlpha6=N'"+o.d.SessionManager.PayrollMonth.AddMonths(1).ToString("dd/MMM/yyyy")+"',dcAlpha1=N'"+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+"', dcAlpha2=N'"+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+"', dcAlpha4=N'1', dcAlpha3=N'"+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+"',dcAlpha5=N'"+o.d.SessionManager.PayrollMonth.AddMonths(1).ToString("dd/MMM/yyyy")+"',dcAlpha7=N'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"', \" ></Alpha>",n+='<CostCenters Query="dcCCNID51='+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+", dcCCNID52="+o.d.SessionManager.Preferences.CreateLoanType+', " ></CostCenters>',n+="<EXTRAXML></EXTRAXML>",n+="</Row>",n+="</DOCXML>",n+="<BillXML></BillXML></CreateLoanXML>"),this.oCMP.arrLstCPFields[this.iEmpIndex][0].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.length>0){let r=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.split(";");if(r.length>0){let d="";d+="    DELETE FROM PAY_EmpMonthlyArrAdjDetails WHERE EmpSeqNo="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+" AND DType=1 AND PayrollMonth='"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"'";for(let C=0;C<r.length;C++){let h="",c="";d+="  INSERT INTO PAY_EmpMonthlyArrAdjDetails(EmpSeqNo,PayrollMonth,ArrAdjMonth,DType",h+="VALUES("+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+",'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"','"+r[C].toString()+"',1";for(let g=0;g<this.oCMP.arrLstCPFields[0][0].length;g++){let e="";if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].ArrData&&this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].ArrData.length>0){let p=[];if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].ArrData=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].ArrData.TrimEnd(","),p=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].ArrData.split(";"),null!=p&&p.length>0)for(let u=0;u<p.length;u+=2)m.J0.ParseDate(p[u]).ToString("dd MMM yyyy")==m.J0.ParseDate(r[C]).ToString("dd MMM yyyy")&&(e=p[u+1])}c+=",Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].SNo,h+=null!=e&&""!=e?","+e:",0"}for(let g=0;g<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;g++){let e="";if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].ArrData&&this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].ArrData.length>0){let p=[];if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].ArrData=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].ArrData.TrimEnd(","),p=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].ArrData.split(";"),null!=p&&p.length>0)for(let u=0;u<p.length;u+=2)m.J0.ParseDate(p[u]).ToString("dd MMM yyyy")==m.J0.ParseDate(r[C]).ToString("dd MMM yyyy")&&(e=p[u+1])}c+=",Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].SNo,h+=null!=e&&""!=e?","+e:",0"}d+=c+")",d+=h+")"}n+='<ArrearsDetailXML Query="'+d+'"></ArrearsDetailXML>'}}if(this.oCMP.arrLstCPFields[0].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths.length>0){let r=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths.split(";");if(r.length>0){let d="";d+="    DELETE FROM PAY_EmpMonthlyArrAdjDetails WHERE EmpSeqNo="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+" AND DType=2 AND PayrollMonth='"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"'";for(let C=0;C<r.length;C++){let h="",c="";d+="  INSERT INTO PAY_EmpMonthlyArrAdjDetails(EmpSeqNo,PayrollMonth,ArrAdjMonth,DType",h+="VALUES("+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+",'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"','"+r[C].toString()+"',2";for(let g=0;g<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;g++){let e="";if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData&&this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData.length>0){let p=[];if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData.TrimEnd(","),p=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData.split(","),null!=p&&p.length>0)for(let u=0;u<p.length;u+=2)m.J0.ParseDate(p[u]).ToString("dd MMM yyyy")==m.J0.ParseDate(r[C]).ToString("dd MMM yyyy")&&(e=p[u+1])}c+=",Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].SNo,h+=null!=e&&""!=e?","+e:",0"}for(let g=0;g<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;g++){let e="";if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData&&this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData.length>0){let p=[];if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData.TrimEnd(","),p=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData.split(","),null!=p&&p.length>0)for(let u=0;u<p.length;u+=2)m.J0.ParseDate(p[u]).ToString("dd MMM yyyy")==m.J0.ParseDate(r[C]).ToString("dd MMM yyyy")&&(e=p[u+1])}c+=",Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].SNo,h+=null!=e&&""!=e?","+e:",0"}d+=c+")",d+=h+")"}n+='<AdjustmentsDetailXML Query="'+d+'"></AdjustmentsDetailXML>'}}return n+="</XML>",n.toString()}GetRawExportHTML(){let s="",l="";s+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",l+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",l+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",l+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",l+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",l+=".null{background-color:#ECF9C;}",s+="<style>"+l.toString()+"</style>";let t=this.dgvEmployees.Table;s+="<table>",s+="<tr><td style='padding-top:10p;'><table border=1 style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",s+="<COLGROUP>";let i=null;for(let r=0;r<this.dgvEmployees.TableColumns.length;r++){var n=this.dgvEmployees.TableColumns[r];i=this.dgvEmployees.Columns.find(d=>d.DisplayMember.toUpperCase()==this.dgvEmployees.TableColumns[r][n].toUpperCase()),null!=i&&i.IsVisible&&(s+="<COL>")}s+="</COLGROUP>",s+="<tr style=''>";for(let r=0;r<this.dgvEmployees.Table.length;r++)n=this.dgvEmployees.Table[r],i=this.dgvEmployees.Columns.find(C=>C.DisplayMember.toUpperCase()==this.dgvEmployees.TableColumns[r][n].toUpperCase()),null!=i&&i.IsVisible&&(s+="<th class='hdr'>",s+=i.Header,s+="</th>");s+="</tr>";for(let r=0;r<t.length;r++){if(s+="<tr",r%2==1&&(s+=" class=alt"),s+=">",0==this.dgvEmployees.TableColumns.length)s+="<td colspan="+this.dgvEmployees.TableColumns.length+">DELETED ROW</td>";else for(let d=0;d<this.dgvEmployees.TableColumns.length;d++)n=this.dgvEmployees.TableColumns[r],i=this.dgvEmployees.Columns.find(h=>h.DisplayMember.toUpperCase()==this.dgvEmployees.TableColumns[d][n].toUpperCase()),null!=i&&i.IsVisible&&(null==t[r][d]?s+="<td class='null'>":(s+="<td>",s+=t[r][d].toString()),s+="</td>");s+="</tr>"}return s+="</table>",s+="</td></tr></table>",s+="</body><html>",s.toString()}ApplyFilter(s,l){let t=s.filter(i=>i.EMPNODE==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo);for(let i=0;i<this.dsDailyAttendanceData.Tables[3].length;i++){let n=this.dsDailyAttendanceData.Tables[3][i].Data.toString();t=t.filter(r=>r[n]==l[this.dsDailyAttendanceData.Tables[3][i].Data.toString()])}return t}ReportView(){this.ReportDimension=new qe.y$(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportsList=[],this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");let s=[];this.dsData=o.d.common.GetDataSetQuery(" declare @UserID int,@RoleID int        set @UserID="+o.d.SessionManager.UserID+" set @RoleID="+o.d.SessionManager.RoleID+"    \n                    SELECT R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel,Q.Width ,Q.Height,Q.mapxml,Q.MapType\n                    FROM ADM_RevenUReports R  with(nolock)\n                    inner join ADM_DocumentReports Q WITH(NOLOCK) on Q.DocumentReportID=R.ReportID\n                    left join ADM_CostCenterDef A WITH(NOLOCK) on A.CostCenterColID=Q.DocumentField \n                    left join [ADM_DocReportUserRoleMap] DR WITH(NOLOCK) on DR.DocumentViewID=Q.DocumentViewID and DR.CostCenterID=Q.CostCenterID\n                    where  Q.CostCenterID="+this.CostCenterID+" and (DR.UserID=@UserID OR DR.RoleID=@RoleID OR GroupID IN (SELECT GroupID FROM COM_Groups WITH(NOLOCK) WHERE UserID=@UserID OR RoleID=@RoleID))\n                    GROUP BY  Q.ReportID, R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel ,Q.Width,Q.Height,Q.mapxml,Q.MapType \n                    order by Q.ReportID "),null!=this.dsData&&this.dsData.Tables[0].length>0&&this.dsData.Tables[0].forEach(t=>{let i=new Ke.v;i.DBColumnID=parseInt(t.ReportID),i.Label=t.ReportName.toString(),this.dsData.Columns[0].Contains("Shortcut")&&(i.KeyTip=t.Shortcut.toString()),this.dsData.Columns[0].Contains("DisplayAsPopup")&&""!=t.DisplayAsPopup.toString()&&(i.Dependantinuse="1"==t.DisplayAsPopup.toString()),this.dsData.Columns[0].Contains("Width")&&""!=t.Width.toString()&&(i.Width=t.Width.toString()),this.dsData.Columns[0].Contains("Height")&&""!=t.Height.toString()&&(i.Length=t.Height.toString()),this.dsData.Columns[0].Contains("DocumentField")&&""!=t.DocumentField.toString()&&(i.Formula=t.DocumentField.toString()),this.dsData.Columns[0].Contains("mapxml")&&""!=t.mapxml.toString()&&(i.ToolTipDescription=t.mapxml.toString()),s.Contains(parseInt(t.ReportID))||(s.push(parseInt(t.ReportID)),this.ReportsList.push(i)),0==this.ReportsList.length&&(this.ButtonReport.Visible=!1)})}OnReportsLinkClick(s){var l=this;return(0,B.A)(function*(){const{ReportViewModel:t}=yield Promise.resolve().then(V.bind(V,35725)),{ReportViewComponent:i}=yield Promise.resolve().then(V.bind(V,73540));let d,n={strXML:""},r=new t;if(l.DisplayMessage=l.GetReportFilterXML(s,n),d=n.strXML,0==l.DisplayMessage.length){var C=l.ReportsList.find(h=>h.DBColumnID==parseInt(s));if(null!=C&&C.Dependantinuse)r.ReportViewModel_Document(l.CostCenterID,d,parseInt(s),!0,null,null),!m.J0.IsEmpty(C.Width)&&m.J0.Double(C.Width)>0&&(r.RptWidth=m.J0.Double(C.Width)),!m.J0.IsEmpty(C.length)&&m.J0.Double(C.length)>0&&(r.RptHeight=m.J0.Double(C.length)),r.DocumentObject=l,o.d.page.HideDialog(l.PopUpGUID),o.d.page.ShowDialog(r,i,{Title:"",HideClose:!0,ShowCenter:!0});else{let h=new t;h.ReportViewModel_Document(l.CostCenterID,d,parseInt(s),!1,null,null),h.DocumentObject=l,o.d.page.HideDialog(l.PopUpGUID),o.d.page.addNewTab({component:i,params:{obj:h}})}}})()}GetReportFilterXML(s,l){let t="";l.strXML="";let i=this.dsData.Tables[0];i=i.filter(d=>d.ReportID==s);let r,n=!1;i.forEach(d=>{(0,j.yG0)(d.GroupLevel)&&(n=!0)}),t+="<XML",n&&(t+=' GroupLevel="1"'),t+=" >";for(let d=0;d<i.length;d++){if(r=i[d].ReportField.toString(),t+="<Row ",t+='ColID ="'+r+'" ',!m.J0.IsEmpty(i[d].SysColumnName))if("dcccnid51"==i[d].SysColumnName.toString().toLowerCase()){let C="";for(let h=0;h<this.dgvEmployees.Table.length;h++)(0,j.yG0)(this.dgvEmployees.Table[h].Select)&&(C+=this.dgvEmployees.Table[h].EmpSeqNo.toString()+",");if(m.J0.IsEmpty(C)||!(C.length>0))return alert(this.ErrorMessage+"Employee '"),"Empty Value";C=C.substr(0,C.length-1),t+='Value ="'+C+'" '}else"duedate"==i[d].SysColumnName.toString().toLowerCase()?t+='Value ="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+'" ':"dcalpha17"==i[d].SysColumnName.toString().toLowerCase()?t+='Value ="'+o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")+'" ':"dcalpha18"==i[d].SysColumnName.toString().toLowerCase()&&(t+='Value ="'+o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")+'" ');t+=" />"}return t+="</XML>",l.strXML=t.toString(),""}}function Xt(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",5),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Post"))}),a.nrm(1,"i",19),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Post")))}function qt(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",5),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("UnPost"))}),a.nrm(1,"i",20),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"UnPost")))}function Kt(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",5),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Report"))}),a.nrm(1,"i",21),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Report")))}let Qt=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){this.obj=this.params.obj}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-post-payroll"]],decls:100,vars:27,consts:[[1,"maincontainer"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-filter"],[1,"main_div",2,"display","flex","flex-direction","column","padding","10px"],[1,"masterscreen",2,"height","120px"],[1,"row",2,"height","30px"],[1,"col-xl-3","col-md-4","col-sm-6","col-xs-12",2,"display","flex","flex-direction","row","margin-bottom","9px"],[1,"input_cntrl_label",2,"font-size","13px"],[1,"input_cntrl_label",2,"font-weight","bold","font-size","12px !important"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12",2,"display","flex","flex-direction","row"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12"],["FieldDirective","",3,"obj"],[1,"documentgrid",2,"flex","1","overflow","auto"],[2,"width","100%","height","100%",3,"obj"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-times"],[1,"fa-light","fa-file-chart-line"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n      "),a.j41(2,"div",1),a.EFF(3,"\n        "),a.j41(4,"span",2),a.EFF(5),a.k0s(),a.EFF(6,"\n        "),a.j41(7,"div",3),a.EFF(8,"\n          "),a.DNE(9,Xt,4,3,"span",4),a.EFF(10,"\n          "),a.j41(11,"span",5),a.bIt("click",function(){return i.obj.Button_Click("Clear")}),a.nrm(12,"i",6),a.EFF(13),a.nI1(14,"translate"),a.k0s(),a.EFF(15,"\n          "),a.DNE(16,qt,4,3,"span",4),a.EFF(17,"\n          "),a.j41(18,"span",5),a.bIt("click",function(){return i.obj.Button_Click("Filter")}),a.nrm(19,"i",7),a.EFF(20),a.nI1(21,"translate"),a.k0s(),a.EFF(22,"\n          "),a.DNE(23,Kt,4,3,"span",4),a.EFF(24,"           \n        "),a.k0s(),a.EFF(25,"\n      "),a.k0s(),a.EFF(26,"\n      "),a.j41(27,"div",8),a.EFF(28," \n        "),a.j41(29,"div",9),a.EFF(30,"\n          "),a.j41(31,"div",10),a.EFF(32," \n            "),a.j41(33,"div",11),a.EFF(34,"\n                  "),a.j41(35,"label",12),a.EFF(36),a.nI1(37,"translate"),a.k0s(),a.EFF(38,"\n                  "),a.j41(39,"label",13),a.EFF(40),a.k0s(),a.EFF(41,"\n              "),a.k0s(),a.EFF(42,"\n            "),a.k0s(),a.EFF(43,"\n          "),a.j41(44,"div",10),a.EFF(45,"\n                "),a.j41(46,"div",14),a.EFF(47,"\n                "),a.j41(48,"label",12),a.EFF(49),a.nI1(50,"translate"),a.k0s(),a.EFF(51,"\n                "),a.j41(52,"label",13),a.EFF(53),a.k0s(),a.EFF(54,"\n              "),a.k0s(),a.EFF(55,"\n              "),a.j41(56,"div",14),a.EFF(57,"\n                "),a.j41(58,"label",12),a.EFF(59),a.nI1(60,"translate"),a.k0s(),a.EFF(61,"\n                "),a.j41(62,"label",13),a.EFF(63),a.k0s(),a.EFF(64,"              \n            "),a.k0s(),a.EFF(65,"\n          "),a.k0s(),a.EFF(66,"\n          "),a.j41(67,"div",10),a.EFF(68,"\n            "),a.j41(69,"div",15),a.EFF(70,"\n              "),a.eu8(71,16),a.EFF(72,"\n          "),a.k0s(),a.EFF(73,"\n  \n          "),a.j41(74,"div",15),a.EFF(75,"\n            "),a.eu8(76,16),a.EFF(77,"\n        "),a.k0s(),a.EFF(78,"                  \n           "),a.k0s(),a.EFF(79,"\n           "),a.j41(80,"div",10),a.EFF(81,"\n        "),a.j41(82,"div",15),a.EFF(83,"\n          "),a.eu8(84,16),a.EFF(85,"\n      "),a.k0s(),a.EFF(86,"\n      "),a.j41(87,"div",15),a.EFF(88,"\n        "),a.eu8(89,16),a.EFF(90,"\n    "),a.k0s(),a.EFF(91,"\n          "),a.k0s(),a.EFF(92,"\n        "),a.k0s(),a.EFF(93,"\n        "),a.j41(94,"div",17),a.EFF(95,"\n          "),a.nrm(96,"app-PactGridView",18),a.EFF(97,"  \n        "),a.k0s(),a.EFF(98,"\n      "),a.k0s(),a.EFF(99,"\n "),a.k0s()),2&t&&(a.R7$(5),a.JRh(i.obj.Title),a.R7$(4),a.Y8G("ngIf",i.obj.PostVisiblility),a.R7$(4),a.JRh(a.bMT(14,17,"Clear")),a.R7$(3),a.Y8G("ngIf",i.obj.UnPostVisiblility),a.R7$(4),a.JRh(a.bMT(21,19,"Filter")),a.R7$(3),a.Y8G("ngIf",i.obj.ReportInfoVisibility),a.R7$(13),a.SpI("",a.bMT(37,21,"Payroll_PayMonth"),"        :"),a.R7$(4),a.JRh(i.obj.lblPayrollMonth),a.R7$(9),a.SpI("",a.bMT(50,23,"Payroll_StartDate"),"   :"),a.R7$(4),a.JRh(i.obj.lblPayrollMonthStart),a.R7$(6),a.SpI("",a.bMT(60,25,"Payroll_EndDate"),"   :"),a.R7$(4),a.JRh(i.obj.lblPayrollMonthEnd),a.R7$(8),a.Y8G("obj",i.obj.chkPostBasedOnDailyAttendance),a.R7$(5),a.Y8G("obj",i.obj.chkIncludeOTHours),a.R7$(8),a.Y8G("obj",i.obj.chkPostBasedOnAttDimWise),a.R7$(5),a.Y8G("obj",i.obj.IsProcessWithAdjustments),a.R7$(7),a.Y8G("obj",i.obj.EmployeesList))},dependencies:[ce.bT,ye._,Ne.X,De.D9],encapsulation:2})}return F})();var ot=V(81669),$t=V(73631);const zt=F=>({width:F});let ft=(()=>{class F extends $t.P{constructor(){super()}ngOnInit(){m.J0.IsEmpty(this.obj.ProgressMessage)||(this.ProgressMessage=this.obj.ProgressMessage),this.obj.progress||(this.obj.progress=0),0===this.obj.total?this.obj.total=this.obj.progress:this.obj.total||(this.obj.total=100),this.obj.progress>this.obj.total&&(this.obj.progress=100,this.obj.total=100),this.obj.progress=this.obj.progress/this.obj.total*100,this.color=this.obj.progress<55?"red":this.obj.progress<75?"yellow":"green",setTimeout(()=>{o.d.page.HideDialog(this.obj.PopUpGUID)},2e3)}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-progress-bar"]],inputs:{progress:"progress",total:"total"},features:[a.Vt3],decls:7,vars:7,consts:[[1,"progress-bar-container"],[3,"ngStyle"]],template:function(t,i){1&t&&(a.EFF(0,"\n  "),a.j41(1,"div",0),a.EFF(2,"\n     "),a.j41(3,"div",1),a.EFF(4),a.k0s(),a.EFF(5,"\n  "),a.k0s(),a.EFF(6,"\n  ")),2&t&&(a.R7$(3),a.ZvI("progress-bar ",i.color,""),a.Y8G("ngStyle",a.eq3(5,zt,i.progress+"%")),a.R7$(),a.SpI("\n      ",i.ProgressMessage,"\n     "))},dependencies:[ce.B3],encapsulation:2})}return F})();class Et extends Re.g{get SelectAll(){return this._SelectAll}set SelectAll(s){s!=this._SelectAll&&(this._SelectAll=s,this.SelectUnselectAll(s))}get ReportInfoVisibility(){return this._ReportInfoVisibility}set ReportInfoVisibility(s){s!=this._ReportInfoVisibility&&(this._ReportInfoVisibility=s)}constructor(s){super(),this.ButtonClick=new ot.Yk,this.ProgressVisibility=!1,this.chkPostBasedOnDailyAttendance=new Ce.c,this.chkPostBasedOnAttDimWise=new Ce.c,this.chkIncludeOTHours=new Ce.c,this.IsProcessWithAdjustments=new Ce.c,this.EmployeesList=new ue.vv,this.PostVisiblility=!0,this.UnPostVisiblility=!0,this.dsDailyAttendanceData=null,this.sPayrollMonthMouseDoubleClickCommand=new ot.Yk,this.btnCancelFlag=!1,this.ReportsList=[],this.dsData=null,this._ReportInfoVisibility=!0,this.ButtonReport=new Ke.v,this.sCrAccount="0",this.sDrAccount="0",this.SelectUnCheck=0,this.sFilter="",this.IsPosting=!1,this.iEmpIndex=0,this.strResult="",this.Failed="",this.FailedCount=0,this.dtAdjData=[],this.sAdjsCalcMonths="",this.sAdjCalcMonthPaydays="",this.DefProdID=0,this.ErrorMessage="Missing Report Parameter ' ";try{Logger.InfoLog("PostPayrollViewModel::Entering PostPayrollViewModel()"),this.ClassName="PostPayrollViewModel",this.CostCenterID=40054,this.DisplayName=o.d.GetResource(s),this.Title=o.d.GetResource(s),this.DisplayMessage="",this.sPayrollMonth=" / ["+o.d.SessionManager.PayrollMonth.ToString("MMM-yyyy")+"]",this.ButtonClick.Subscribe(this,"Button_Click"),this.sPayrollMonthMouseDoubleClickCommand.Subscribe(this,"sPayrollMonth_MouseDoubleClick"),this.lblPayrollMonth=o.d.SessionManager.PayrollMonth.ToString("MMM, yyyy"),this.lblPayrollMonthStart=o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy"),this.lblPayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy"),this.PostVisiblility=o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Create"),this.UnPostVisiblility=o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Delete"),this.btnCancelFlag=!1,this.chkPostBasedOnDailyAttendance.Label=o.d.GetResource("PostbasedonDailyAttendance"),this.chkIncludeOTHours.Label=o.d.GetResource("IncludeOverTimeHours"),this.chkPostBasedOnAttDimWise.Label=o.d.GetResource("PostbasedonAttendanceDimensionwise"),this.IsProcessWithAdjustments.Label=o.d.GetResource("IsProcessWithAdjustments"),this.LoadGrid(),this.btnFilter_Click(),o.d.SessionManager.Preferences.ContainsKey("DefaultPostbasedonAttendanceDimensionWise")&&"True"==o.d.SessionManager.Preferences.DefaultPostbasedonAttendanceDimensionWise?this.chkPostBasedOnAttDimWise.IsChecked=!0:"True"==o.d.SessionManager.Preferences.GetDailyAttendanceDataInMonthlyPayroll&&(this.chkPostBasedOnDailyAttendance.IsChecked=!0,this.chkIncludeOTHours.IsChecked=!0),this.ReportView(),Logger.InfoLog("PostPayrollViewModel::Exiting PostPayrollViewModel()")}catch(l){Logger.ErrorLog("PostPayrollViewModel::EXCEPTION PostPayrollViewModel()"+l.stack)}}sPayrollMonth_MouseDoubleClick(s){var l=this;return(0,B.A)(function*(){const{SetPayrollDateViewModel:t}=yield Promise.resolve().then(V.bind(V,15091)),{SetPayrollDateComponent:i}=yield Promise.resolve().then(V.bind(V,72974));let n=new t;o.d.page.ShowDialog(n,i,{ShowCenter:!0,Title:o.d.GetResource("Pay_SetPayrollDate")}),n.DialogResult&&l.btnClear_Click()})()}LoadGrid(){let t,l=(new yt.ControlGenerator).GetScreenInfo(this.CostCenterID);t=l.Tables[0].filter(n=>"CreditAccount"==n.SysColumnName),null!=t&&t.length>0&&!m.J0.IsEmpty(t[0].UserDefaultValue)&&(this.sCrAccount=t[0].UserDefaultValue.toString()),t=l.Tables[0].filter(n=>"DebitAccount"==n.SysColumnName),null!=t&&t.length>0&&null!=t[0].UserDefaultValue&&""!=t[0].UserDefaultValue.toString().Trim()&&(this.sDrAccount=t[0].UserDefaultValue.toString()),this.EmployeesList=new ue.vv,this.EmployeesList.CanUserDeleteRows=!0,this.EmployeesList.Height=0,this.EmployeesList.Table=[],this.EmployeesList.SelectAll.Visible=!0,this.EmployeesList.TableColumns.push("Select"),this.EmployeesList.DataTypes.Bool.push("Select"),this.EmployeesList.TableColumns.push("SNo"),this.EmployeesList.TableColumns.push("EmpSeqNo"),this.EmployeesList.TableColumns.push("EmpCode"),this.EmployeesList.TableColumns.push("EmpName"),this.EmployeesList.TableColumns.push("GradeID"),this.EmployeesList.TableColumns.push("Result");let i=new L.O7;this.EmployeesList.Columns=[],i=new L.O7,i.Header=o.d.GetResource("Pay_Select"),i.DisplayMember="Select",i.DataType="CheckBox",i.Width=50,i.CheckedChanged.Subscribe(this,"dgColSelect_CheckedChanged"),this.EmployeesList.Columns.push(i),i=new L.O7,i.Header=o.d.GetResource("Payroll_EmpSNo"),i.DisplayMember="SNo",i.DataType="TextBlock",i.Width=50,i.ReadOnly=!0,this.EmployeesList.Columns.push(i),i=new L.O7,i.Header=o.d.GetResource("EmployeeCode"),i.DisplayMember="EmpCode",i.DataType="TextBlock",i.Width=250,i.ReadOnly=!0,this.EmployeesList.Columns.push(i),i=new L.O7,i.Header=o.d.GetResource("EmployeeName"),i.DisplayMember="EmpName",i.DataType="TextBlock",i.Width=250,i.ReadOnly=!0,this.EmployeesList.Columns.push(i),i=new L.O7,i.Header=o.d.GetResource("Result"),i.DisplayMember="Result",i.DataType="TextBlock",i.Width=250,i.ReadOnly=!0,this.EmployeesList.Columns.push(i)}dgColSelect_CheckedChanged(s,l){l||1==this.SelectAll&&(this.SelectUnCheck=1,this.SelectAll=!1)}SelectUnselectAll(s){for(let l=0;l<this.EmployeesList.Table.length;l++)0==this.SelectUnCheck&&(this.EmployeesList.Table[l].Select=s);this.SelectUnCheck=0,this.EmployeesList.refreshDataView()}Button_Click(s){Logger.InfoLog("PostPayrollViewModel::Entering Button_Click()"),"Post"==s.toString()?this.btnPost_Click():"Clear"==s.toString()?this.btnClear_Click():"UnPost"==s.toString()?this.btnUnPost_Click():"Filter"==s.toString()?this.btnFilter_Click():"Report"==s.toString()&&(this.ReportInfoVisibility=!0,o.d.page.ShowDialog(this,St.L,{Title:"Reports"})),Logger.InfoLog("PostPayrollViewModel::Exiting Button_Click()")}btnUnPost_Click(){this.IsPosting=!1,this.bgworker_DoWork(null,null),this.bgworker_RunWorkerCompleted(null,null)}btnClear_Click(){this.EmployeesList.Clear(),this.sPayrollMonth=" / ["+o.d.SessionManager.PayrollMonth.ToString("MMM-yyyy")+"]",this.lblPayrollMonth=o.d.SessionManager.PayrollMonth.ToString("MMM, yyyy"),this.lblPayrollMonthStart=o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy"),this.lblPayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy"),this.SelectAll=!1,this.chkIncludeOTHours.IsChecked=!1,this.chkPostBasedOnDailyAttendance.IsChecked=!1,this.chkPostBasedOnAttDimWise.IsChecked=!1,this.FailedCount=0,this.Failed="",this.InProgress="",this.IsPosting=!1,this.lstSelectedEmps=[],o.d.SessionManager.Preferences.ContainsKey("DefaultPostbasedonAttendanceDimensionWise")&&"True"==o.d.SessionManager.Preferences.DefaultPostbasedonAttendanceDimensionWise?this.chkPostBasedOnAttDimWise.IsChecked=!0:"True"==o.d.SessionManager.Preferences.GetDailyAttendanceDataInMonthlyPayroll&&(this.chkPostBasedOnDailyAttendance.IsChecked=!0,this.chkIncludeOTHours.IsChecked=!0)}btnPost_Click(){this.IsPosting||(this.IsPosting=!0,this.bgworker_DoWork(null,null),this.bgworker_RunWorkerCompleted(null,null))}btnFilter_Click(){Logger.InfoLog("PostPayrollViewModel::Entering Filter_Click()"),o.d.SessionManager.Preferences.ContainsKey("PostPayrollFilter")&&parseInt(o.d.SessionManager.Preferences.PostPayrollFilter)>0?null==this.objEmpFilter?this.objEmpFilter=new Oe.t("",0,2):this.objEmpFilter.CostCenterFilters.length>0?this.objEmpFilter.CostCenters.SelectedValue=this.objEmpFilter.CostCenterFilters[0].CostCenterID.toString():(this.objEmpFilter.Filter=2,this.objEmpFilter.InitControls()):null==this.objEmpFilter?this.objEmpFilter=new Oe.t("",0,0):(this.objEmpFilter.Filter=0,this.objEmpFilter.InitControls()),this.objEmpFilter.Filter>0&&o.d.page.ShowDialog(this.objEmpFilter,Ye.m,{ShowCenter:!0,HideHeader:!0}).subscribe(()=>{if(this.DialogResult=this.objEmpFilter.IsCompleted,this.objEmpFilter.IsCompleted)if(this.objEmpFilter.CostCenterFilters.length>0){let l=1,t="",i="",n="";for(let c=0;c<this.objEmpFilter.CostCenterFilters.length;c++){let g=this.objEmpFilter.CostCenterFilters[c];if(g.CostCenterID>5e4&&(l=2,t="NodeID",i=50051==g.CostCenterID?"EmpSeqNo":"CCNID"+(g.CostCenterID-5e4)),g.SelectedNodes.length>0){if(1==g.SelectedNodes.length)n+=" AND ",n+=i+"="+g.SelectedNodes[0].Id;else if(!g.SelectedNodes.find(e=>e.Id==l&&e.IsGroup))if(n+=" AND ",Ue.IPrefetchFilter.IsGroupTree(g)){let e="";for(let p=0;p<g.SelectedNodes.length;p++)(null==g.SelectedNodes[p].Parent||!g.SelectedNodes[p].Parent.IsSelected)&&(e.length>0&&(e+=","),e+=g.SelectedNodes[p].Id);0==e.length&&(e+=-12912),n+=i+" IN ",n+=" (select T."+t+" GTID from "+xe.A.GetTagTableName(g.CostCenterID)+" T with(nolock),"+xe.A.GetTagTableName(g.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP."+t+" IN (",n+=e.toString()+")  group by T."+t+")"}else{n+=i+" IN (";for(let e=0;e<g.SelectedNodes.length;e++)e>0&&(n+=","),n+=g.SelectedNodes[e].Id;n+=")"}}else g.DeleteButtonVisibility||(n+=" AND ",n+=i+"=-12912")}this.sFilter=n.toString(),this.sFilter+=" AND ( CONVERT(DATETIME,EMP.DOJ) <='"+o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")+"' AND CONVERT(DATETIME,EMP.DORelieve)  >='"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"' ) ","True"==o.d.SessionManager.Preferences.NPDontAllowPayrollProcessing&&(this.sFilter+=" AND EmpSeqNo NOT IN ( Select NodeID From COM_CC50051 WITH(NOLOCK) \n                                                            Where ResignStatus='Posted' AND DateDiff(day,ISNULL(CONVERT(DATETIME,DORelieve),'01-Jan-9000'),'"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"')<=0\n                                                            AND DateDiff(day,CONVERT(DATETIME,CONVERT(DATETIME,('01-'+CONVERT(NVARCHAR(3),DATENAME(MONTH,ISNULL(CONVERT(DATETIME,DOResign),'01-Jan-9000')))+'-'+CONVERT(NVARCHAR,YEAR(ISNULL(CONVERT(DATETIME,DOResign),'01-Jan-9000'))))) ),'"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"')>=0 )"),"True"==o.d.SessionManager.Preferences.DontConsiderEmpsForPayroll&&parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)>0&&(this.sFilter+=" AND NOT ( MONTH(CONVERT(DATETIME,EMP.DOJ))="+o.d.SessionManager.PayrollMonth.iMonth()+" AND YEAR(CONVERT(DATETIME,EMP.DOJ))="+o.d.SessionManager.PayrollMonth.getFullYear()+" AND DAY(CONVERT(DATETIME,EMP.DOJ))>="+parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)+" ) "),o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(this.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(this.sFilter+="  AND EmpSeqNo IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),"Processed"==this.objEmpFilter.StatusModes.SelectedValue?this.sFilter+=" AND EmpSeqNo IN (SELECT DISTINCT C51.NODEID FROM INV_DocDetails I\n                                                                JOIN COM_DocCCData CC ON CC.InvDocDetailsID=I.InvDocDetailsID\n                                                                JOIN COM_CC50051 C51 ON C51.NODEID=CC.DCCCNID51\n                                                                WHERE I.CostCenterID=40054  AND  CONVERT(DATETIME,I.DueDate)=CONVERT(DATETIME,'"+o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")+"'))":"UnProcessed"==this.objEmpFilter.StatusModes.SelectedValue&&(this.sFilter+=" AND EmpSeqNo NOT IN (SELECT DISTINCT C51.NODEID FROM INV_DocDetails I\n                                                                JOIN COM_DocCCData CC ON CC.InvDocDetailsID=I.InvDocDetailsID\n                                                                JOIN COM_CC50051 C51 ON C51.NODEID=CC.DCCCNID51\n                                                                WHERE I.CostCenterID=40054  AND  CONVERT(DATETIME,I.DueDate)=CONVERT(DATETIME,'"+o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")+"'))");let r=o.d.SessionManager.Preferences.ConsolidateMonthlyPayrollSort;""!=r.Trim()&&"None"!=r&&(this.sFilter+="TreeView"==r?" ORDER BY EMP.lft ":" ORDER BY EMP."+r);let d=[];d.push(o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")),d.push(this.sFilter),d.push(0),d.push(o.d.SessionManager.RoleID),d.push(o.d.SessionManager.UserID),d.push(o.d.SessionManager.LanguageID);let h,C=o.d.empService.GetData(d,"spPAY_GetEmpMasterCCDetails");if(this.EmployeesList.Clear(),null!=C&&C.Tables.length>0&&C.Tables[0].length>0){if(h=C.Tables[0],o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade){let c=o.d.SessionManager.dtPayrollPreferences.Tables[0].filter(g=>"DontConsiderEmpsForPayroll"==g.Name&&g.GradeID==C.Tables[0][0].CCNID53);if(null!=c&&c.length>0&&null!=c[0].Value&&null!=c[0].Value&&""!=c[0].Value.toString()&&"True"==c[0].Value.toString()&&(c=o.d.SessionManager.dtPayrollPreferences.Tables[0].filter(g=>"DontConsiderEmpsForPayrollDays"==g.Name&&g.GradeID==C.Tables[0][0].CCNID53),null!=c&&c.length>0&&null!=c[0].Value&&null!=c[0].Value&&""!=c[0].Value.toString())){let g=0;if(g=parseInt(c[0].Value),g>0){let e=new Date(o.d.SessionManager.PayrollMonth.getFullYear(),o.d.SessionManager.PayrollMonth.getMonth(),g),p=C.Tables[0].filter(u=>u.DOJ<=e);null!=p&&p.length>0&&(C=[],C=p)}}C.Tables[0].DefaultView.Sort="CCNID53",h=C.Tables[0].DefaultView.ToTable()}for(let c=0;c<h.length;c++){let g=this.EmployeesList.NewRow();g.EmpSeqNo=h[c].EmpSeqNo,g.EmpCode=h[c].EmpCode,g.EmpName=h[c].EmpName,g.GradeID=h[c].CCNID53,g.SNo=(c+1).toString(),g.Select=!1,this.EmployeesList.addRow(g)}}}else this.objEmpFilter.Filter>0&&this.FilterEmployees()}),Logger.InfoLog("PostPayrollViewModel::Exiting Filter_Click()")}FilterEmployees(){try{Logger.InfoLog("PostPayrollViewModel::Entering FilterEmployees()"),this.sFilter=" AND ( CONVERT(DATETIME,EMP.DOJ) <='"+o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")+"' AND CONVERT(DATETIME,EMP.DORelieve) >='"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"' ) ","True"==o.d.SessionManager.Preferences.NPDontAllowPayrollProcessing&&(this.sFilter+=" AND EmpSeqNo NOT IN ( Select NodeID From COM_CC50051 WITH(NOLOCK) \n\t\t\t                                        Where ResignStatus='Posted' AND DateDiff(day,ISNULL(CONVERT(DATETIME,DORelieve),'01-Jan-9000'),'"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"')<=0\n\t\t\t                                        AND DateDiff(day,CONVERT(DATETIME,CONVERT(DATETIME,('01-'+CONVERT(NVARCHAR(3),DATENAME(MONTH,ISNULL(CONVERT(DATETIME,DOResign),'01-Jan-9000')))+'-'+CONVERT(NVARCHAR,YEAR(ISNULL(CONVERT(DATETIME,DOResign),'01-Jan-9000'))))) ),'"+o.d.SessionManager.PayrollMonthStart.ToString("dd MMM yyyy")+"')>=0 )"),"True"==o.d.SessionManager.Preferences.DontConsiderEmpsForPayroll&&parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)>0&&(this.sFilter+=" AND NOT ( MONTH(CONVERT(DATETIME,EMP.DOJ))="+o.d.SessionManager.PayrollMonth.iMonth()+" AND YEAR(CONVERT(DATETIME,EMP.DOJ))="+o.d.SessionManager.PayrollMonth.getFullYear()+" AND DAY(CONVERT(DATETIME,EMP.DOJ))>="+parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)+" ) "),o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(this.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(this.sFilter+="  AND EmpSeqNo IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),"Processed"==this.objEmpFilter.StatusModes.SelectedValue?this.sFilter+=" AND EmpSeqNo IN (SELECT DISTINCT C51.NODEID FROM INV_DocDetails I\n                                                    JOIN COM_DocCCData CC ON CC.InvDocDetailsID=I.InvDocDetailsID\n                                                    JOIN COM_CC50051 C51 ON C51.NODEID=CC.DCCCNID51\n                                                    WHERE I.CostCenterID=40054  AND  CONVERT(DATETIME,I.DueDate)=CONVERT(DATETIME,'"+o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")+"'))":"UnProcessed"==this.objEmpFilter.StatusModes.SelectedValue&&(this.sFilter+=" AND EmpSeqNo NOT IN (SELECT DISTINCT C51.NODEID FROM INV_DocDetails I\n                                                    JOIN COM_DocCCData CC ON CC.InvDocDetailsID=I.InvDocDetailsID\n                                                    JOIN COM_CC50051 C51 ON C51.NODEID=CC.DCCCNID51\n                                                    WHERE I.CostCenterID=40054  AND  CONVERT(DATETIME,I.DueDate)=CONVERT(DATETIME,'"+o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy")+"'))");let s=o.d.SessionManager.Preferences.ConsolidateMonthlyPayrollSort;""!=s.Trim()&&"None"!=s&&(this.sFilter+="TreeView"==s?" ORDER BY EMP.lft ":" ORDER BY EMP."+s);let l=[];l.push(o.d.SessionManager.PayrollMonthEnd.ToString("dd MMM yyyy")),l.push(this.sFilter),l.push(0),l.push(o.d.SessionManager.RoleID),l.push(o.d.SessionManager.UserID),l.push(o.d.SessionManager.LanguageID);let i,t=o.d.empService.GetData(l,"spPAY_GetEmpMasterCCDetails");if(this.EmployeesList.Clear(),null!=t&&t.Tables.length>0&&t.Tables[0].length>0){if(i=t.Tables[0],o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade){let n=o.d.SessionManager.dtPayrollPreferences.Tables[0].filter(r=>"DontConsiderEmpsForPayroll"==r.Name&&r.GradeID==t.Tables[0][0].CCNID53);if(null!=n&&n.length>0&&null!=n[0].Value&&null!=n[0].Value&&""!=n[0].Value.toString()&&"True"==n[0].Value.toString()&&(n=o.d.SessionManager.dtPayrollPreferences.Tables[0].filter(r=>"DontConsiderEmpsForPayrollDays"==r.Name&&r.GradeID==t.Tables[0][0].CCNID53),null!=n&&n.length>0&&null!=n[0].Value&&null!=n[0].Value&&""!=n[0].Value.toString())){let r=0;if(r=parseInt(n[0].Value),r>0){let d=new Date(o.d.SessionManager.PayrollMonth.getFullYear(),o.d.SessionManager.PayrollMonth.getMonth(),r),C=t.Tables[0].filter(h=>new Date(h.DOJ)<=d);null!=C&&C.length>0&&(t=[],t=C)}}t.sort((r,d)=>d.CCNID53-r.CCNID53),i=t}for(let n=0;n<i.length;n++){let r=this.EmployeesList.NewRow();r.EmpSeqNo=i[n].EmpSeqNo,r.EmpCode=i[n].EmpCode,r.EmpName=i[n].EmpName,r.GradeID=i[n].CCNID53,r.SNo=(n+1).toString(),r.Select=!1,this.EmployeesList.addRow(r)}}Logger.InfoLog("PostPayrollViewModel::Exiting FilterEmployees()")}catch(s){Logger.ErrorLog("PostPayrollViewModel::EXCEPTION FilterEmployees()"+s.stack)}}bgworker_DoWork(s,l){Logger.InfoLog("PostPayrollViewModel::Entering bgworker_DoWork()"),this.IsPosting?this.PostPayrollData():this.UnPostPayrollData(),Logger.InfoLog("PostPayrollViewModel::Exiting bgworker_DoWork()")}UnPostPayrollData(){Logger.InfoLog("PostPayrollViewModel::Entering UnPostPayrollData()"),this.InProgress="";let s=0,l=0;if(null!=this.EmployeesList.Table&&this.EmployeesList.Table.length>0){this.lstSelectedEmps=[];let t="";for(let i=0;i<this.EmployeesList.Table.length;i++)(0,j.yG0)(this.EmployeesList.Table[i].Select)&&(t+=this.EmployeesList.Table[i].EmpSeqNo.toString()+",",this.lstSelectedEmps.push(i),l++);if(t.length>0&&l>0){t=t.substr(0,t.length-1);let n,i=t.split(",");s=l,this.FailedCount=0,this.Failed="",this.ProgressVisibility=!0,this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Unposting Payroll, please wait ...",o.d.page.ShowDialog({progress:this.ProgressValue,total:this.ProgressMax,ProgressMessage:this.ProgressMessage},ft,{HideHeader:!0,ShowCenter:!0,Title:"ProgressMessage"});let r=o.d.report.GetDataTable("PPVM01",t,o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"));for(let d=0;d<i.length;d++){if(this.strResult="",null!=i[d]&&""!=i[d]){if(n=r.filter(C=>C.EmpSeqNo==i[d]),null!=n&&n.length>0){let C=0,h=[];h.push(this.CostCenterID),h.push(parseInt(n[0].DocID)),h.push(1);let c=o.d.document.DeleteSelectedRows(h,C);this.strResult=c.Message,C=c.RetValue}else this.strResult="No Data exits to delete.",this.Failed+=this.EmployeesList.Table[this.lstSelectedEmps[d]].EmpCode.toString()+",",this.FailedCount++;this.EmployeesList.Table[this.lstSelectedEmps[d]].Result=this.strResult,this.EmployeesList.updateRow(this.EmployeesList.Table[this.lstSelectedEmps[d]])}this.ProgressValue=d+1,this.InProgress=d+1+" of "+s}this.FailedCount>0&&this.Failed.length>1?(this.Failed=this.Failed.substr(0,this.Failed.length-1),this.DisplayMessage="Failed count : "+this.FailedCount+", Emp.Codes : ( "+this.Failed+" )"):null!=this.EmployeesList&&null!=this.EmployeesList.Table&&this.EmployeesList.Table.length>0&&this.EmployeesList.Table.filter(C=>1==C.Select).length>0&&(this.DisplayMessage="Unposted Successfully"),this.MessageVisibility=!0}else this.DisplayMessage="Select atleast one Employee."}else this.DisplayMessage="No Employees found to unpost payroll.";this.MessageVisibility=!0,Logger.InfoLog("PostPayrollViewModel::Exiting UnPostPayrollData()")}bgworker_RunWorkerCompleted(s,l){Logger.InfoLog("PostPayrollViewModel::Entering worker_RunWorkerCompleted()"),this.ProgressVisibility=!1,this.IsPosting=!1,Logger.InfoLog("PostPayrollViewModel::Exiting worker_RunWorkerCompleted()")}PostPayrollData(){Logger.InfoLog("PostPayrollViewModel::Entering PostPayrollData()"),this.InProgress="";let s=0,l=0;if(this.iEmpIndex=0,null!=this.EmployeesList.Table&&this.EmployeesList.Table.length>0){this.lstSelectedEmps=[];let r,t="",i="",n=new Array,d=!1,C=0;for(let h=0;h<this.EmployeesList.Table.length;h++)if((0,j.yG0)(this.EmployeesList.Table[h].Select)&&(t+=this.EmployeesList.Table[h].EmpSeqNo.toString()+",",this.lstSelectedEmps.push(h),l++,d=!1,C=0,o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)){for(let c=0;c<n.length;c++)if(n[c].GradeID==parseInt(this.EmployeesList.Table[h].GradeID)){C=c,d=!0;break}d?(i=n[C].sEmpIds,i+=","+this.EmployeesList.Table[h].EmpSeqNo.toString(),n[C].sEmpIds=i,n[C].lstGradeEmps.push(parseInt(this.EmployeesList.Table[h].EmpSeqNo))):(r=new Xe.ii,r.GradeID=parseInt(this.EmployeesList.Table[h].GradeID),r.sEmpIds=this.EmployeesList.Table[h].EmpSeqNo.toString(),r.lstGradeEmps=new Array,r.lstGradeEmps.push(parseInt(this.EmployeesList.Table[h].EmpSeqNo)),n.push(r))}if(t.length>0&&l>0){if(t=t.substr(0,t.length-1),s=l,this.FailedCount=0,this.Failed="",this.ProgressVisibility=!0,this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Payroll is processing, please wait ...",o.d.page.ShowDialog({progress:this.ProgressValue,total:this.ProgressMax,ProgressMessage:this.ProgressMessage},ft,{HideHeader:!0,ShowCenter:!0,Title:"ProgressMessage"}),this.chkPostBasedOnDailyAttendance.IsChecked&&o.d.SessionManager.Preferences.ContainsKey("CaputureDimensionData")&&"True"==o.d.SessionManager.Preferences.CaputureDimensionData.toString())if(o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)for(let h=0;h<n.length;h++){m.J0.SetPayrollMonth(o.d.SessionManager.PayrollMonth,o.d.SessionManager,n[h].GradeID);let g=[];g.push(t),g.push(o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")),g.push(o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")),g.push(this.chkIncludeOTHours.IsChecked?1:0),g.push(m.J0.IntTryParse(o.d.SessionManager.UserID)),g.push(o.d.SessionManager.LanguageID);let e=o.d.empService.GetData(g,"spPAY_PostDailyAttendancetoPayroll");n[h].dsDailyAttendanceDataCollection=e}else{let h=[];h.push(t),h.push(o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")),h.push(o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")),h.push(this.chkIncludeOTHours.IsChecked?1:0),h.push(m.J0.IntTryParse(o.d.SessionManager.UserID)),h.push(o.d.SessionManager.LanguageID),this.dsDailyAttendanceData=o.d.empService.GetData(h,"spPAY_PostDailyAttendancetoPayroll")}if(this.oCMP=new fe.O,this.oCMP.oParent=this,this.oCMP.sSelectedEmpSeqNos=t,this.oCMP.IsPostFullAttendance=!0,this.chkPostBasedOnDailyAttendance.IsChecked&&(this.oCMP.IsPostBasedOnDailyAttendance=!0),this.chkPostBasedOnAttDimWise.IsChecked&&(this.oCMP.IsPostBasedOnAttDimWise=!0),this.chkIncludeOTHours.IsChecked&&(this.oCMP.IncludeOTHours=!0),this.oCMP.PayrollMonth=o.d.SessionManager.PayrollMonth,this.oCMP.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,this.oCMP.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,this.oCMP.GradeMPFls=n,this.oCMP.ProcessPayroll(),this.oCMP.IsCompleted){for(this.ProgressValue=0,this.ProgressMax=s,this.ProgressMessage="Saving data, please wait ...",this.iEmpIndex=0;this.iEmpIndex<this.oCMP.arrLstOthMPFields.length;this.iEmpIndex++){if(o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade)for(let h=0;h<n.length;h++)n[h].lstGradeEmps.Contains(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo))&&(o.d.SessionManager.PayrollMonth=n[h].GradePayrollMonth,o.d.SessionManager.PayrollMonthStart=n[h].GradePayrollMonthStart,o.d.SessionManager.PayrollMonthEnd=n[h].GradePayrollMonthEnd,this.dsDailyAttendanceData=n[h].dsDailyAttendanceDataCollection);if(null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID&&null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID&&""!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID.toString()&&parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID)>0){let h=o.d.common.GetDataTable("PAY088",this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].INVDocDetailsID.toString()+",54,'"+o.d.SessionManager.UserName+"',40054,"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowID.toString()+","+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].WorkFlowLevel.toString()+","+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].StatusID.toString()+","+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].CreatedDate.toString()+","+o.d.SessionManager.UserID+","+o.d.SessionManager.RoleID);null!=h&&h.length>0&&(!m.J0.IsEmpty(h[0].CanApprove)&&"TRUE"==h[0].CanApprove.toString().toUpperCase()||(369!=parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].StatusID)||o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Posted Docs")?441==parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[0].StatusID)&&!o.d.SessionManager.IsActionAssigned(this.CostCenterID,"Edit Approved Docs")&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage="Can't Edit Approved Document"):this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage="Can't Edit Posted Document"))}if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.length>0){if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.endsWith("NumFields"))return this.DisplayMessage=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage.Replace("NumFields",""),void(this.MessageVisibility=!0);this.strResult=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sErrorMessage,this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++,this.EmployeesList.Table[this.lstSelectedEmps[this.iEmpIndex]].Result=this.strResult,this.EmployeesList.updateRow(this.EmployeesList.Table[this.lstSelectedEmps[this.iEmpIndex]])}else this.strResult="",this.CalculateAccruals(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo),this.IsProcessWithAdjustments.IsChecked&&this.AdjustmentsClick(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo)),this.SaveVoucher(),this.ProgressValue=this.iEmpIndex+1,this.InProgress=this.iEmpIndex+1+" of "+s}this.MessageVisibility=!0,this.FailedCount>0&&this.Failed.length>1?(this.Failed=this.Failed.substr(0,this.Failed.length-1),this.DisplayMessage="Failed count : "+this.FailedCount+", Emp.Codes : ( "+this.Failed+" )"):null!=this.EmployeesList&&null!=this.EmployeesList.Table&&this.EmployeesList.Table.length>0&&this.EmployeesList.Table.filter(c=>1==c.Select).length>0&&(this.DisplayMessage="Posted Successfully",this.SelectAll=!1,o.d.SessionManager.Preferences.ContainsKey("DefaultPostbasedonAttendanceDimensionWise")&&"True"==o.d.SessionManager.Preferences.DefaultPostbasedonAttendanceDimensionWise?this.chkPostBasedOnAttDimWise.IsChecked=!0:"True"==o.d.SessionManager.Preferences.GetDailyAttendanceDataInMonthlyPayroll?(this.chkPostBasedOnDailyAttendance.IsChecked=!0,this.chkIncludeOTHours.IsChecked=!0):(this.chkIncludeOTHours.IsChecked=!1,this.chkPostBasedOnDailyAttendance.IsChecked=!1))}}else this.DisplayMessage="Select atleast one Employee."}else this.DisplayMessage="No Employees found to post payroll.";this.MessageVisibility=!0,Logger.InfoLog("PostPayrollViewModel::Exiting PostPayrollData()")}AdjustmentsClick(s){try{Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Entering AdjustmentsClick()"),this.dtAdjData=[];let d,C,l=[],t=o.d.empService.GetQueryData(s,"ADJ001","","",""),i=this.oCMP.arrLstOthMPFields[this.iEmpIndex].DateOfJoining,n=o.d.SessionManager.PayrollMonth.AddMonths(-1),r=new Date(i.getFullYear(),i.getMonth(),1),h=Array();for(;n>=r;){if(C=t.filter(c=>c.PayrollMonth&&m.J0.ParseDate(c.PayrollMonth).ToString("dd/MMM/yyyy")==n.ToString("dd/MMM/yyyy")),null!=C&&C.length>0){if(o.d.SessionManager.PayrollMonth.AddMonths(-1).ToString("dd MMM yyyy")==n.ToString("dd MMM yyyy")&&"True"==o.d.SessionManager.Preferences.DontConsiderEmpLeavesVacationDataBasedonPostedDate&&""!=o.d.SessionManager.Preferences.ConsiderLOPBasedOn.toString()){d={},d.PayrollMonth=n.ToString("dd/MMM/yyyy");let c,g,e,p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e};if(m.J0.SetPayrollDate_1(m.J0.ParseDate(o.d.SessionManager.PayrollMonth.AddMonths(-1)),p),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd,o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade){let x=0;x=m.J0.GetEmployeeGrade(s.toString(),c,g,e),x>0&&(p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e},m.J0.SetPayrollDate_1(m.J0.ParseDate(o.d.SessionManager.PayrollMonth.AddMonths(-1)),p,x),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd)}let u=[];u.push(s),u.push(c.ToString("dd/MMM/yyyy")),u.push(g.ToString("dd/MMM/yyyy")),u.push(e.ToString("dd/MMM/yyyy")),u.push(0),u.push(o.d.SessionManager.UserID),u.push(o.d.SessionManager.RoleID),u.push(o.d.SessionManager.LanguageID);let P=o.d.empService.ExecuteQuery_SP(u,"spPAY_GetEmpAdjDetailsMultiple");if(null!=P&&P.Tables.length>0&&P.Tables[0].length>0&&P.Columns[0].Contains("EmpSeqNo")){let x=[];x.push(e.ToString("dd MMM yyyy")),x.push(""),x.push(0),x.push(o.d.SessionManager.RoleID),x.push(o.d.SessionManager.UserID),x.push(o.d.SessionManager.LanguageID);let y=o.d.empService.ExecuteQuery_SP(x,"spPAY_GetEmpMasterCCDetails"),A=(new Xe.mr).AggregateLeaves(s.toString(),P,g,e,y,this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.othMPField.GradeID);A>0&&(d.Days=-A)}l.push(d)}if(null!=h&&h.length>0&&o.d.SessionManager.PayrollMonth.AddMonths(-1).ToString("dd MMM yyyy")!=n.ToString("dd MMM yyyy")&&"True"==o.d.SessionManager.Preferences.DontConsiderEmpLeavesVacationDataBasedonPostedDate&&""!=o.d.SessionManager.Preferences.ConsiderLOPBasedOn.ToString())for(let c=0;c<h.length;c++)h[c].PrevMonth.ToString("dd MMM yyyy")==n.ToString("dd MMM yyyy")&&(d={},d.PayrollMonth=n.ToString("dd/MMM/yyyy"),d.Days=h[c].dDays,l.push(d))}else if(o.d.SessionManager.PayrollMonth.AddMonths(-1).ToString("dd MMM yyyy")==n.ToString("dd MMM yyyy")&&"True"==o.d.SessionManager.Preferences.DontConsiderEmpsForPayroll&&parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)>0&&i.getDate()>=parseInt(o.d.SessionManager.Preferences.DontConsiderEmpsForPayrollDays)){d={},d.PayrollMonth=n.ToString("dd/MMM/yyyy");let c,g,e,p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e};m.J0.SetPayrollDate_1(m.J0.ParseDate(o.d.SessionManager.PayrollMonth.AddMonths(-1)),p),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd;let u=o.d.SessionManager.PayrollMonth,P=0;o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade&&(P=m.J0.GetEmployeeGrade(s.toString(),c,g,e),P>0&&(p={PayrollMonth:c,PayrollMonthStart:g,PayrollMonthEnd:e},m.J0.SetPayrollDate_1(m.J0.ParseDate(o.d.SessionManager.PayrollMonth.AddMonths(-1)),p,P),c=p.PayrollMonth,g=p.PayrollMonthStart,e=p.PayrollMonthEnd)),m.J0.SetPayrollMonth(c);let x=new fe.O;x.oParent=this,x.sSelectedEmpSeqNos=s.ToString(),x.PayrollMonth=o.d.SessionManager.PayrollMonth,x.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,x.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,x.ProcessPayroll(),x.IsCompleted&&(d.Days=x.arrLstOthMPFields[0].DaysAttended),m.J0.SetPayrollMonth(u),l.push(d)}n=n.AddMonths(-1)}if(null!=l&&l.length>0)for(let c=0;c<l.length;c++)null!=l[c].Days&&null!=l[c].Days&&""!=l[c].Days.toString().Trim()&&(d={},d.PayrollMonth=o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),d.AdjMonth=l[c].PayrollMonth.toString(),d.Days=l[c].Days.toString(),this.dtAdjData.push(d));if(null!=this.dtAdjData&&this.dtAdjData.length>0&&(this.SaveAdjustment(),this.sAdjCalcMonthPaydays="",this.sAdjsCalcMonths="",null!=this.dtAdjData&&this.dtAdjData.length>0)){for(let c=0;c<this.dtAdjData.length;c++)this.sAdjCalcMonthPaydays=this.sAdjCalcMonthPaydays+this.dtAdjData[c].Days.toString()+";",this.sAdjsCalcMonths=this.sAdjsCalcMonths+this.dtAdjData[c].AdjMonth.toString()+";";this.sAdjCalcMonthPaydays.length>0&&(this.sAdjCalcMonthPaydays=this.sAdjCalcMonthPaydays.substring(this.sAdjCalcMonthPaydays.length-1,0)),this.sAdjsCalcMonths.length>0&&(this.sAdjsCalcMonths=this.sAdjsCalcMonths.substring(this.sAdjsCalcMonths.length-1,0)),this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths=this.sAdjsCalcMonths,this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays=this.sAdjCalcMonthPaydays}Logger.InfoLog("ConsolidatedMonthlyPayrollViewModel::Exiting AdjustmentsClick()")}catch(l){Logger.ErrorLog("ConsolidatedMonthlyPayrollViewModel::EXCEPTION AdjustmentsClick()\r\n"+l.Message+"\r\n"+l.stack)}}SaveAdjustment(){let s=o.d.SessionManager.PayrollMonth;this.CalculateAdjustments(parseInt(this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo)),this.oCMP.CalculateNet(),m.J0.SetPayrollMonth(s,o.d.SessionManager,this.oCMP.arrLstOthMPFields[this.iEmpIndex].GradeID)}CalculateAdjustments(s){if(null!=this.dtAdjData&&this.dtAdjData.length>0){let t,i,n,l="";for(let e=0;e<this.dtAdjData.length;e++)l.length>0&&(l+=","),l+="'"+new Date(this.dtAdjData[e].AdjMonth).ToString("dd MMM yyyy")+"'";let r=o.d.empService.GetQueryData(s,"MPL010",l,"","");for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;e++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dAdjusted="0";for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;e++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dAdjusted="0";this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments=0,this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments=0;let g,d=o.d.empService.GetQueryData(0,"MPL014","","",""),C=o.d.empService.GetQueryData(s,"MPL005","","",""),h=o.d.empService.GetQueryData(s,"MPL011",o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy"),"",""),c="";for(let e=0;e<this.dtAdjData.length;e++){let p=new Date(this.dtAdjData[e].AdjMonth),u=p;t=r.filter(A=>new Date(A.PayrollMonth).ToString("dd MMM yyyy")==p.ToString("dd MMM yyyy")&&11==A.VoucherType);let P=null;if(null!=t&&t.length>0){let A=d.filter(T=>T.GradeID==t[0].dcCCNID53&&T.CPayrollDate<=u.ToString("dd MMM yyyy")).Compute("max","CPayrollDate");P=d.filter(T=>T.GradeID==t[0].dcCCNID53&&T.CPayrollDate==m.J0.String(A))}if(c="'"+p.ToString("dd/MMM/yyyy")+"' >= ApplyFrom AND '"+p.ToString("dd/MMM/yyyy")+"' <=EffectFrom",g=C.filter(A=>p.ToString("dd/MMM/yyyy")>=A.ApplyFrom&&p.ToString("dd/MMM/yyyy")<=A.EffectFrom),g=g.sort((A,T)=>A.EffectFrom-T.EffectFrom),i=h.Tables[0].filter(A=>A.ArrearsCalcMonths==m.J0.ParseDate(p)),n=h.Tables[1].filter(A=>1==A.DType&&A.ArrAdjMonth==m.J0.ParseDate(p)),null!=g&&g.length>0){let A=!1;if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.length>0){let T=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sArrsCalcMonths.split(";");if(T.length>0)for(let I=0;I<T.length;I++)m.J0.ParseDate(T[I]).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&(A=!0)}null!=i&&i.length>0||A?(p=m.J0.ParseDate(g[0].EffectFrom),o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade?m.J0.SetPayrollMonth(p,o.d.SessionManager,null!=t&&t.length>0?parseInt(t[0].dcCCNID53):this.oCMP.arrLstOthMPFields[0].GradeID):m.J0.SetPayrollMonth(p)):o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade?m.J0.SetPayrollMonth(p,o.d.SessionManager,null!=t&&t.length>0?parseInt(t[0].dcCCNID53):this.oCMP.arrLstOthMPFields[0].GradeID):m.J0.SetPayrollMonth(p)}else o.d.SessionManager.Preferences.ContainsKey("ConsiderGlobalPreferencesBasedOnGrade")&&"True"==o.d.SessionManager.Preferences.ConsiderGlobalPreferencesBasedOnGrade?m.J0.SetPayrollMonth(p,o.d.SessionManager,null!=t&&t.length>0?parseInt(t[0].dcCCNID53):this.oCMP.arrLstOthMPFields[0].GradeID):m.J0.SetPayrollMonth(p);let x=parseFloat(this.dtAdjData[e].Days),y=0;y="Actual Days"!=o.d.SessionManager.Preferences.PayDays?parseInt(o.d.SessionManager.Preferences.PayDays):p.DaysInMonth();let M=new fe.O;if(M.oParent=this,M.sSelectedEmpSeqNos=s.toString(),M.PayrollMonth=o.d.SessionManager.PayrollMonth,M.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,M.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,M.dAdjDays=x,null!=t&&t.length>0&&(M.IsAdjustments=!0,M.drcArrStructure=P,M.ArrGradeID=m.J0.Int(t[0].dcCCNID53)),M.ProcessPayroll(),M.IsCompleted){let A=0;null!=t&&t.length>0?(M.arrLstOthMPFields[0].TotalDays=parseFloat(t[0].TotalDays),M.arrLstOthMPFields[0].MonthDays=parseFloat(t[0].TotalDays),M.arrLstOthMPFields[0].PaidLeaves=parseFloat(t[0].dcAlpha24),M.arrLstOthMPFields[0].TotalLeaves=parseFloat(t[0].LeavesTaken),M.arrLstOthMPFields[0].WeeklyOffs=parseFloat(t[0].WOffs),M.arrLstOthMPFields[0].Holidays=parseFloat(t[0].Holidays),A=parseFloat(t[0].DaysWorked.toString())+x,M.SetDaysAttended(0,"Days Attended",A)):m.J0.ParseDate(this.dtAdjData[e].AdjMonth).iMonth()==this.oCMP.arrLstOthMPFields[this.iEmpIndex].DateOfJoining.iMonth()&&m.J0.ParseDate(this.dtAdjData[e].AdjMonth).getFullYear()==this.oCMP.arrLstOthMPFields[this.iEmpIndex].DateOfJoining.getFullYear()&&(M.arrLstOthMPFields[0].TotalDays=y,M.arrLstOthMPFields[0].TotalLeaves=0,M.SetDaysAttended(0,"Days Attended",Math.abs(x)));let N,T=0,I=-1,S=0,v=0,O=0;t=r.filter(E=>new Date(E.PayrollMonth).ToString("dd MMM yyyy")==p.ToString("dd MMM yyyy")&&11==E.VoucherType);for(let E=0;E<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;E++)if(m.J0.IsEmpty(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateAdjustments)||"No"!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].CalculateAdjustments)for(let G=0;G<M.arrLstCPFields[0][0].length;G++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].SNo==M.arrLstCPFields[0][0][G].SNo){if(S=0,v=0,O=0,I=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].SNo,!m.J0.IsEmpty(t)&&t.length>0&&!m.J0.IsEmpty(t[0]["dcCalcNum"+I])&&(S=parseFloat(t[0]["dcCalcNum"+I])),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData&&this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData.length>0&&(N=[],this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData.TrimEnd(","),N=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].ArrData.split(";"),null!=N&&N.length>0))for(let J=0;J<N.length;J+=2)new Date(N[J]).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&(v=parseFloat(N[J+1]));null!=n&&n.length>0&&null!=n[0]["Earning"+I]&&null!=n[0]["Earning"+I]&&""!=n[0]["Earning"+I]&&(O=parseFloat(n[0]["Earning"+I])),T=o.d.SessionManager.Preferences.ContainsKey("DonotconsiderArrearwhilecalculatingAdjustmentofPF")&&(0,j.yG0)("True"==o.d.SessionManager.Preferences.DonotconsiderArrearwhilecalculatingAdjustmentofPF)&&"PFE"==M.arrLstCPFields[0][0][G].ComponentName?parseFloat(M.arrLstCPFields[0][0][G].dEarned)-S:parseFloat(M.arrLstCPFields[0][0][G].dEarned)-S-v-O,this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AdjData=m.J0.String(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AdjData),this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AdjData+=u.ToString("dd MMM yyyy")+","+T+",",this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].dAdjusted=(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].dAdjusted)+T).ToString(o.d.SessionManager.sPayrollDecimals),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet&&("Net"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet||"NetAndTax"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][E].AddToNet)&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments+=T);break}t=r.filter(E=>new Date(E.PayrollMonth).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&12==E.VoucherType);for(let E=0;E<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;E++)if(null==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateAdjustments||""==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateAdjustments||"No"!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].CalculateAdjustments)for(let G=0;G<M.arrLstCPFields[0][2].length;G++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].SNo==M.arrLstCPFields[0][2][G].SNo){if(S=0,v=0,O=0,I=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].SNo,null!=t&&t.length>0&&null!=t[0]["dcCalcNum"+I]&&null!=t[0]["dcCalcNum"+I]&&""!=t[0]["dcCalcNum"+I].toString()&&(S=parseFloat(t[0]["dcCalcNum"+I])),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData&&this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData.length>0&&(N=[],this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData.TrimEnd(","),N=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].ArrData.split(";"),null!=N&&N.length>0))for(let J=0;J<N.length;J+=2)new Date(N[J]).ToString("dd MMM yyyy")==u.ToString("dd MMM yyyy")&&(v=parseFloat(N[J+1]));null!=n&&n.length>0&&null!=n[0]["Deduction"+I]&&null!=n[0]["Deduction"+I]&&""!=n[0]["Deduction"+I]&&(O=parseFloat(n[0]["Deduction"+I])),T=o.d.SessionManager.Preferences.ContainsKey("DonotconsiderArrearwhilecalculatingAdjustmentofPF")&&(0,j.yG0)("True"==o.d.SessionManager.Preferences.DonotconsiderArrearwhilecalculatingAdjustmentofPF)&&"PF"==M.arrLstCPFields[0][2][G].ComponentName?parseFloat(M.arrLstCPFields[0][2][G].dEarned)-S:parseFloat(M.arrLstCPFields[0][2][G].dEarned)-S-v-O,this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AdjData=m.J0.String(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AdjData),this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AdjData+=u.ToString("dd MMM yyyy")+","+T+",",this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].dAdjusted=(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].dAdjusted)+T).ToString(o.d.SessionManager.sPayrollDecimals),null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet&&("Net"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet||"NetAndTax"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][E].AddToNet)&&(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments+=T);break}this.oCMP.iEmpIndex=this.iEmpIndex,this.oCMP.othMPField=this.oCMP.arrLstOthMPFields[this.iEmpIndex],this.oCMP.ExecuteAllFormulas(),this.oCMP.CalculateNet()}}}}CalculateAccruals(s){let l=this.oCMP.arrLstOthMPFields[0].dsAllEmpsData.Tables[2];if(l=l.filter(t=>t.EmpSeqNo==s),l.length>0&&m.J0.ParseDate(l[0].cEffectFrom).getFullYear()==o.d.SessionManager.PayrollMonth.getFullYear()&&m.J0.ParseDate(l[0].cEffectFrom).iMonth()==o.d.SessionManager.PayrollMonth.iMonth()&&this.oCMP.lstAccrAccumulateSNos.length>0){let t="",i=0,n=0,r=0,d=0,C=0,h=0,c=0,g=0,e=0,p=-1;for(let x=0;x<this.oCMP.lstAccrAccumulateSNos.length;x++)t.length>0&&(t+=","),t+="ISNULL(dcCalcNum"+this.oCMP.lstAccrAccumulateSNos[x]+",0) as dcCalcNum"+this.oCMP.lstAccrAccumulateSNos[x]+",ISNULL(dcCalcNumFC"+this.oCMP.lstAccrAccumulateSNos[x]+",0) as dcCalcNumFC"+this.oCMP.lstAccrAccumulateSNos[x];let u=o.d.empService.GetQueryData(s,"PostCalculateAccural",JSON.stringify(t),o.d.SessionManager.PayrollMonth.ToString("dd MMM yyyy"),""),P=o.d.report.GetDataTable("PPVM02","");if(null!=u&&u.length>0){let x=!1;for(let y=0;y<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;y++)if(n=0,r=0,this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].IsAccrualType&&"Accruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].Behaviour){p=this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].SNo,i=parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dActual);for(let M=0;M<u.length;M++)C=parseFloat(u[M].TotalDays),d=parseFloat(u[M].DaysAttended)+parseFloat(u[M].PaidLeaves)+parseFloat(u[M].LOPDays),h=parseFloat(u[M]["dcCalcNum"+p]),c=parseFloat(u[M]["dcCalcNumFC"+p]),g=parseFloat((d/C*i).ToString(o.d.SessionManager.sPayrollDecimals)),e=parseFloat((g-h).ToString(o.d.SessionManager.sPayrollDecimals)),n+=parseFloat(e.ToString(o.d.SessionManager.sPayrollDecimals)),r+=c;this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dAdjusted=(n-r).ToString(o.d.SessionManager.sPayrollDecimals)}else this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].Behaviour&&(x=!0);if(x){for(let y=0;y<u.length;y++){let M=P.filter(T=>T.GradeID==parseInt(u[y].GradeID)&&T.CPayrollDate==m.J0.ParseDate(u[y].PayrollDate)).Compute("max","MaxSchemeID"),A=new fe.O;if(A.oParent=this,A.sSelectedEmpSeqNos=s.toString(),A.PayrollMonth=o.d.SessionManager.PayrollMonth,A.PayrollMonthStart=o.d.SessionManager.PayrollMonthStart,A.PayrollMonthEnd=o.d.SessionManager.PayrollMonthEnd,A.drcArrStructure=M,A.IsCalculateAccruals=!0,A.ArrGradeID=parseInt(u[y].GradeID),A.ProcessPayroll(),A.IsCompleted){A.arrLstOthMPFields[0].TotalDays=parseFloat(u[y].TotalDays),A.arrLstOthMPFields[0].MonthDays=parseFloat(u[y].TotalDays),A.arrLstOthMPFields[0].PaidLeaves=parseFloat(u[y].PaidLeaves),A.arrLstOthMPFields[0].TotalLeaves=parseFloat(u[y].LeavesTaken),A.arrLstOthMPFields[0].WeeklyOffs=parseFloat(u[y].WOffs),A.arrLstOthMPFields[0].Holidays=parseFloat(u[y].Holidays),d=parseFloat(u[y].TotalDays.toString())-parseFloat(u[y].LOPDays.toString())-parseFloat(u[y].LeavesTaken.toString())-parseFloat(u[y].UnpaidDays.toString()),A.SetDaysAttended(0,"Days Attended",d);let T=0,I=-1,S=0,v=0;for(let O=0;O<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;O++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][O].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][O].Behaviour)for(let N=0;N<A.arrLstCPFields[0][0].length;N++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][O].SNo==A.arrLstCPFields[0][0][N].SNo){S=0,v=0,I=this.oCMP.arrLstCPFields[this.iEmpIndex][0][O].SNo,null!=u[y]["dcCalcNum"+I]&&null!=u[y]["dcCalcNum"+I]&&""!=u[y]["dcCalcNum"+I].toString()&&(S=parseFloat(u[y]["dcCalcNum"+I])),null!=u[y]["dcCalcNumFC"+I]&&null!=u[y]["dcCalcNumFC"+I]&&""!=u[y]["dcCalcNumFC"+I].toString()&&(v=parseFloat(u[y]["dcCalcNumFC"+I])),T=parseFloat(A.arrLstCPFields[0][0][N].dEarned)-S,this.oCMP.arrLstCPFields[this.iEmpIndex][0][O].dPrevAccEar+=parseFloat(T.ToString(o.d.SessionManager.sPayrollDecimals)),this.oCMP.arrLstCPFields[this.iEmpIndex][0][O].dPrevAccAdj+=v;break}for(let O=0;O<this.oCMP.arrLstCPFields[2].length;O++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][O].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][O].Behaviour)for(let N=0;N<A.arrLstCPFields[0][2].length;N++)if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][O].SNo==A.arrLstCPFields[0][2][N].SNo){S=0,v=0,I=this.oCMP.arrLstCPFields[this.iEmpIndex][2][O].SNo,null!=u[y]["dcCalcNum"+I]&&null!=u[y]["dcCalcNum"+I]&&""!=u[y]["dcCalcNum"+I].toString()&&(S=parseFloat(u[y]["dcCalcNum"+I])),null!=u[y]["dcCalcNumFC"+I]&&null!=u[y]["dcCalcNumFC"+I]&&""!=u[y]["dcCalcNumFC"+I].toString()&&(v=parseFloat(u[y]["dcCalcNumFC"+I])),T=parseFloat(A.arrLstCPFields[0][2][N].dEarned)-S,this.oCMP.arrLstCPFields[this.iEmpIndex][2][O].dPrevAccEar+=parseFloat(T.ToString(o.d.SessionManager.sPayrollDecimals)),this.oCMP.arrLstCPFields[this.iEmpIndex][2][O].dPrevAccAdj+=v;break}}}for(let y=0;y<this.oCMP.arrLstCPFields[0].length;y++)this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].Behaviour&&(this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dAdjusted=(this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dPrevAccEar-this.oCMP.arrLstCPFields[this.iEmpIndex][0][y].dPrevAccAdj).ToString(o.d.SessionManager.sPayrollDecimals));for(let y=0;y<this.oCMP.arrLstCPFields[2].length;y++)this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].IsAccrualType&&"ReEvaluateAccruals-AccumulateForPreviousYears"==this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].Behaviour&&(this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].dAdjusted=(this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].dPrevAccEar-this.oCMP.arrLstCPFields[this.iEmpIndex][2][y].dPrevAccAdj).ToString(o.d.SessionManager.sPayrollDecimals))}}}}ValidatePosting(){try{return Logger.InfoLog("PostPayrollViewModel::Entering IsValidated()"),null!=o.d.SessionManager.Preferences.PayrollProduct&&""!=o.d.SessionManager.Preferences.PayrollProduct&&(this.DefProdID=parseInt(o.d.SessionManager.Preferences.PayrollProduct)),0==this.DefProdID?(this.strResult+="Select any Default Payroll Product at Global Preferences",this.MessageVisibility=!0,!1):this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays<0?(this.strResult+="Days mismatch : Month days and Total days.",this.MessageVisibility=!0,!1):this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP>0&&parseFloat(this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays.ToString("N1"))<parseFloat(this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP.ToString("N1"))?(this.strResult+="Employee Should have atleast "+this.oCMP.arrLstOthMPFields[this.iEmpIndex].dblLeavesLOP+" LOP Days",this.MessageVisibility=!0,!1):this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary<0&&("False"==o.d.SessionManager.Preferences.CreateLoanIfNetSalLessThanZero||0==parseInt(o.d.SessionManager.Preferences.CreateLoanType))?(this.strResult+="Net Amount should be greater than or equal to zero.",this.MessageVisibility=!0,!1):(Logger.InfoLog("PostPayrollViewModel::Exiting IsValidated()"),!0)}catch(s){return Logger.ErrorLog("PostPayrollViewModel::EXCEPTION IsValidated()"+s.stack),!1}}SaveVoucher(){try{if(Logger.InfoLog("PostPayrollViewModel::Entering btnPost_Click()"),this.ValidatePosting()){let s=0,l=[];l.push(this.CostCenterID),l.push(this.oCMP.arrLstOthMPFields[this.iEmpIndex].DocID),l.push(o.d.SessionManager.PayrollMonth.ToString("MMM'/'yyyy")+"-"),l.push(this.oCMP.arrLstOthMPFields[this.iEmpIndex].DocNo),l.push(Date.Today().ToString("dd/MMM/yyyy")),l.push(o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")),l.push(""),l.push(this.GetDocumentXML()),l.push(""),l.push(""),l.push(""),l.push(this.GetActivityXML()),l.push("false"),o.d.SessionManager.Preferences.ContainsKey("EnableLocationWise")&&"True"==o.d.SessionManager.Preferences.EnableLocationWise.toString()?l.push(o.d.SessionManager.LocationID>0?o.d.SessionManager.LocationID:1):l.push(0),o.d.SessionManager.Preferences.ContainsKey("EnableDivisionWise")&&"True"==o.d.SessionManager.Preferences.EnableDivisionWise.toString()?l.push(o.d.SessionManager.DivisionID>0?o.d.SessionManager.DivisionID:1):l.push(0),l.push(this.oCMP.arrLstOthMPFields[this.iEmpIndex].WID),l.push(o.d.SessionManager.RoleID),l.push(""),l.push(0),l.push(0),l.push(o.d.SessionManager.CompanyGUID),l.push(o.d.SessionManager.UserName),l.push(o.d.SessionManager.UserID),l.push(o.d.SessionManager.LanguageID),l.push(o.d.SessionManager.IsOffline);let t="",i="",n=o.d.document.SetTempInvDocumentPostPayroll(l);s=n.obj;let r=n;t=null!=r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Tables[r.Tables.length-1].some(d=>d.hasOwnProperty("ErrorMessage"))?r.Tables[r.Tables.length-1][0].ErrorMessage.toString():"Problem in processing your request,Please contact administrator.",s>0?null!=r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Tables[r.Tables.length-1].some(d=>d.hasOwnProperty("VoucherNo"))&&(i=r.Tables[r.Tables.length-1][0].VoucherNo.toString()):null!=r&&r.Tables.length>0&&r.Tables[r.Tables.length-1].length>0&&r.Tables[r.Tables.length-1].some(d=>d.hasOwnProperty("ServerMessage"))&&(this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++,s="-407"==r.Tables[r.Tables.length-1][0].ServerMessage.toString()?-407:-12345),this.strResult+=t,this.EmployeesList.Table[this.lstSelectedEmps[this.iEmpIndex]].Result=this.strResult,this.EmployeesList.updateRow(this.EmployeesList.Table[this.lstSelectedEmps[this.iEmpIndex]])}else this.Failed+=this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpCode+",",this.FailedCount++;Logger.InfoLog("PostPayrollViewModel::Exiting btnPost_Click()")}catch(s){this.strResult+=s.message,Logger.ErrorLog("PostPayrollViewModel::EXCEPTION btnPost_Click()",s)}this.EmployeesList.Table[this.lstSelectedEmps[this.iEmpIndex]].Result=this.strResult,this.EmployeesList.updateRow(this.EmployeesList.Table[this.lstSelectedEmps[this.iEmpIndex]])}GetDocumentXML(){let s,l="",t="",i="",n="",r="",d="",C=[],h=" dcAlpha1='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].BasicMonthly+"',dcAlpha3='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary+"',dcAlpha4='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalDays+"',dcAlpha5='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].DaysAttended+"',dcAlpha6='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].TotalLeaves+"',dcAlpha7='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].WeeklyOffs+"',dcAlpha8='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].Holidays+"',dcAlpha9='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].LOPDays+"',dcAlpha10='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].UnpaidDays+"', dcAlpha11='"+(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarnings+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTAmount)+"',dcAlpha12='"+(this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDeductions+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totLoans)+"',dcAlpha13='0'";o.d.SessionManager.Preferences.ContainsKey("ShowPaymentModeselectionWhilePayrollProcessing")&&"True"==o.d.SessionManager.Preferences.ShowPaymentModeselectionWhilePayrollProcessing&&"Default"!=this.objEmpFilter.PaymentModes.SelectedValue?(h+=",dcAlpha14='"+this.objEmpFilter.PaymentModes.SelectedValue.toString()+"'",h+="Bank Transfer"==this.objEmpFilter.PaymentModes.SelectedValue?",dcAlpha15='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank.toString()+"',dcAlpha16='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].BankAccNo.toString()+"'":",dcAlpha15='',dcAlpha16=''"):(h+=",dcAlpha14='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode.toString()+"'","Bank Transfer"==m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode)?h+=",dcAlpha15='"+m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank)+"',dcAlpha16='"+m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].BankAccNo)+"'":h+=",dcAlpha15='',dcAlpha16=''"),h+=",dcAlpha17='"+o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")+"',dcAlpha18='"+o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")+"', dcAlpha19='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTHours+"',dcAlpha20='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totOTAmount+"', dcAlpha21='',dcAlpha22=''",h+=",dcAlpha23='' ",h+=",dcAlpha24='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].PaidLeaves+"' ",h+=",dcAlpha25='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totActEarnings+"' ",h+=",dcAlpha26='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarArrears+"' ",h+=",dcAlpha27='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totEarAdjustments+"' ",h+=",dcAlpha28='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totActDeductions+"' ",h+=",dcAlpha29='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedArrears+"' ",h+=",dcAlpha30='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totDedAdjustments+"' ",h+=",dcAlpha31='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].totLoans+"' ",h+=",dcAlpha32='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths+"',dcAlpha33='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays+"' ",o.d.SessionManager.Preferences.ContainsKey("ShowPaymentModeselectionWhilePayrollProcessing")&&"True"==o.d.SessionManager.Preferences.ShowPaymentModeselectionWhilePayrollProcessing&&"Default"!=this.objEmpFilter.PaymentModes.SelectedValue?h+="Bank Transfer"==this.objEmpFilter.PaymentModes.SelectedValue?",dcAlpha34='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].IBANNo.toString()+"'":",dcAlpha34=''":"Bank Transfer"==this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode.toString()?h+=",dcAlpha34='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].IBANNo.toString()+"'":h+=",dcAlpha34=''",h+=",dcAlpha35='"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].ActDaysAttended+"'",i+='<Alpha Query="',i+=h,r+=" ",r.length>0&&(i+=","+r),i+='" ></Alpha>',r="",n+='<CostCenters Query="',r+=" dcCCNID51="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+",",r+=" dcCCNID53="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].GradeID+",",""==m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank)||"0"==m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank)||"Cash"==m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].PaymentMode)?r+=" dcCCNID68=1,":r+=" dcCCNID68="+m.J0.String(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAllEmpsData[0].iBank)+",",C.push("dcCCNID51"),C.push("dcCCNID53"),C.push("dcCCNID68");let c="",g="";if(null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim.length>0)for(let e=0;e<Object.keys(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim[0]).length;e++)c=Object.keys(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim[0])[e],g=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcAsOnDim[0][c],c.Contains("CCNID")&&"CCNID51"!=c&&"CCNID53"!=c&&"CCNID68"!=c&&(r+=" dc"+c+"="+g+",",C.Contains("dc"+c)||C.push("dc"+c));if(r.length>0&&(n+=r),n+='" ></CostCenters>',t+='" ProductID="'+this.DefProdID+'" Quantity="0',t+='" Unit="1" UOMConversion="1" UOMConvertedQty="0',t+='" Rate="0" Gross="0" IsQtyIgnored="1" AverageRate="0',t+='" StockValue="0" StockValueFC="0" RefNO="',t+='" BillDate="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),t+='" CurrencyID="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].CurrencyID+'" ExchangeRate="1',t+='" DebitAccount="'+this.sDrAccount+'" CreditAccount="'+this.sCrAccount,t+='" CommonNarration="'+m.J0.EncodeXML("POSTED FROM POST PAYROLL"),this.oCMP.arrLstCPFields[this.iEmpIndex][0].length>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="1" VoucherType="11',l+='" LinkedInvDocDetailsID="0" LinkedFieldName="',l+='" LineNarration="Earning',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&11==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][0].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;e++)null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo.toString()&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dActual.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dEarned.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dArrear.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][0][e].dAdjusted.Replace(",","")+",");if(this.oCMP.arrLstCPFields[this.iEmpIndex][1].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][1].length;e++)null!=this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo.toString()&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].dActual.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][1][e].dEarned.Replace(",","")+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}if(this.oCMP.arrLstCPFields[this.iEmpIndex][2].length>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="2" VoucherType="12',l+='" LinkedInvDocDetailsID="0" LinkedFieldName="',l+='" LineNarration="Deduction',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&12==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][2].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;e++)null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo.toString()&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dActual.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dEarned.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dArrear.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][2][e].dAdjusted.Replace(",","")+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}if(this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].iExtLoansCnt>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="3" VoucherType="13',l+='" LinkedInvDocDetailsID="0" LinkedFieldName="',l+='" LineNarration="Loan',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&13==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][4].length;e++)null!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo.toString()&&1==this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].IsVisible&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanActInstAmt.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanInstAmt.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanBalAmt.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][e].LoanPayStatus+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}if(this.oCMP.arrLstCPFields[this.iEmpIndex][5].length>0){if(l+="\x11",l+="<Row>",l+="<AccountsXML></AccountsXML>",l+='<Transactions DocSeqNo="4" VoucherType="14',l+='" LinkedInvDocDetailsID="0" LinkedFieldName="',l+='" LineNarration="Leave',d="",null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0&&(s=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[6].filter(e=>e.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&14==e.VoucherType),null!=s&&s.length>0&&(d=s[0].InvDocDetailsID.toString())),l+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',l+=t.toString()+'" ></Transactions>',r="",l+='<Numeric Query="',this.oCMP.arrLstCPFields[this.iEmpIndex][5].length>0)for(let e=0;e<this.oCMP.arrLstCPFields[this.iEmpIndex][5].length;e++)null!=this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo.toString()&&(r+=" dcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].LeaveTotOPBal.Replace(",","")+",",r+=" dcCalcNum"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].EncashLeavetaken.Replace(",","")+",",r+=" dcExchRT"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].LeaveMonOPBal.Replace(",","")+",",r+=" dcCalcNumFC"+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].SNo+"="+this.oCMP.arrLstCPFields[this.iEmpIndex][5][e].LeaveNetBal.Replace(",","")+",");r.length>0&&(l+=r),l+='" ></Numeric>',l+=i.toString(),l+=n.toString(),l+="<EXTRAXML></EXTRAXML>",l+="</Row>"}return l.toString()}GetActivityXML(){let i,s="",l="",t="";if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0)for(let r=0;r<this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length;r++)s+="~"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed[r].InvDocDetailsID.toString();let n="";if(n+=null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcPayProcessed.length>0?s.length>0?'<XML SysInfo="'+o.d.SessionManager.GetSysInfo()+'" AP="'+o.d.SessionManager.GetAccessPoint()+'" DetailIds="'+s+'" AppRejDate="'+(new Date).ToString("dd/MMM/yyyy")+'" >':'<XML SysInfo="'+o.d.SessionManager.GetSysInfo()+'" AP="'+o.d.SessionManager.GetAccessPoint()+'" AppRejDate="'+(new Date).ToString("dd/MMM/yyyy")+'" >':s.length>0?'<XML SysInfo="'+o.d.SessionManager.GetSysInfo()+'" AP="'+o.d.SessionManager.GetAccessPoint()+'" DetailIds="'+s+'" >':'<XML SysInfo="'+o.d.SessionManager.GetSysInfo()+'" AP="'+o.d.SessionManager.GetAccessPoint()+'" >',this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].iExtLoansCnt>0){let r,d,C,h,c,e,g="0";if(l=t="",null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay.length>0&&(g=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay[0].DocID.toString()),n+='<LoanRepaymentXML DocID="'+g+'" DocDetIDs="" WorkFlowID="0" >',n+="<DOCXML>",this.oCMP.arrLstCPFields[this.iEmpIndex][4].length>0){let p=0;null!=o.d.SessionManager.dtDocDefAccs&&(i=o.d.SessionManager.dtDocDefAccs.filter(u=>40057==u.CostCenterID&&"CreditAccount"==u.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(l=i[0].UserDefaultValue.toString()),i=o.d.SessionManager.dtDocDefAccs.filter(u=>40057==u.CostCenterID&&"DebitAccount"==u.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(t=i[0].UserDefaultValue.toString()));for(let u=0;u<this.oCMP.arrLstCPFields[this.iEmpIndex][4].length;u++)if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].SNo&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].SNo.toString()&&1==this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].IsVisible&&null!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanInstAmt&&""!=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanInstAmt.toString()){r=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanDocNo,C=this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanActInstNo,c=3==parseInt(this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanPayStatus)?this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanActInstAmt.Replace(",",""):this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanInstAmt.Replace(",","");let P=parseInt(C);this.oCMP.arrLstOthMPFields[this.iEmpIndex].IsAlreadyProcessed?(e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[11].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.RefNo==r&&m.J0.ParseDate(A.dcAlpha5)==o.d.SessionManager.PayrollMonth),null!=e&&e.length>0&&(P=parseInt(e[0].dcNum1))):(o.d.SessionManager.Preferences.ContainsKey("ShowLoanBalRespDedMonthWhilePayProc")&&"True"==o.d.SessionManager.Preferences.ShowLoanBalRespDedMonthWhilePayProc?(e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.RefNo==r&&A.InstallmentNo==P),e.SortBy([{name:"InstallmentNo",parser:parseInt}])):(e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.DocNo==r&&A.InstBalance>0&&A.InstallmentNo<P),e.SortBy([{name:"InstallmentNo",parser:parseInt}])),null!=e&&e.length>0&&(P=parseInt(e[0].InstallmentNo)));let x=parseFloat(c),y=0,M=0;do{if(p++,e=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(A=>A.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&A.DocNo==r&&A.InstallmentNo==P),e.length>0)if(d=e[0].InvDocDetailsID.toString(),h=e[0].InstallmentAmt.toString().Replace(",",""),y=x>parseFloat(e[0].InstBalance)?parseFloat(e[0].InstBalance):x,n+="<RowHead/>",n+="<Row>",n+="<AccountsXML></AccountsXML>",n+='<Transactions DocSeqNo="'+p+'"  DocDetailsID="0" LinkedInvDocDetailsID="'+d+'" LinkedFieldName="dcNum3" LineNarration="',n+='" ProductID="'+this.DefProdID+'" IsScheme="" Quantity="1" Unit="1" UOMConversion="1" UOMConvertedQty="1',n+='" Rate="0" Gross="0" RefNO="'+r+'" LinkedFieldValue="'+y+'" IsQtyIgnored="1" AverageRate="0',n+='" StockValue="0" StockValueFC="0" CurrencyID="1" ExchangeRate="1"  DebitAccount="'+t+'"  CreditAccount="'+l+'"  ></Transactions>',n+='<Numeric Query="dcNum1='+P+", dcCalcNum1="+P+", dcNum2="+h.Replace(",","")+", dcCalcNum2="+h.Replace(",","")+", dcNum3="+y.toString().Replace(",","")+", dcCalcNum3="+y.toString().Replace(",","")+', " ></Numeric>',n+="<Alpha Query=\"dcAlpha1=N'"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanApprovedAmt+"',dcAlpha2=N'"+(parseFloat(this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanBalAmt)-M)+"', dcAlpha3=N'"+c+"', dcAlpha4=N'"+m.J0.ParseDate(e[0].DeductionMonth).ToString("dd/MMM/yyyy")+"', dcAlpha5=N'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"',dcAlpha6=N'1',dcAlpha7=N'"+this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].LoanPayStatus+"', \" ></Alpha>",n+='<CostCenters Query="dcCCNID51='+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+", dcCCNID52="+this.oCMP.arrLstCPFields[this.iEmpIndex][4][u].ComponentID+', " ></CostCenters>',n+="<EXTRAXML></EXTRAXML>",n+="</Row>",M+=y,x-=y,e[0].Flag=1,o.d.SessionManager.Preferences.ContainsKey("DeductExcessLoanAmountfromLastInstallment")&&"True"==o.d.SessionManager.Preferences.DeductExcessLoanAmountfromLastInstallment){let A=this.oCMP.arrLstOthMPFields[this.iEmpIndex].dsAllEmpsData.Tables[10].filter(T=>T.EmpSeqNo==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo&&T.DocNo==r&&0==T.Flag&&T.InstBalance>0).Compute("max","InstallmentNo");null!=A&&null!=A&&(P=parseInt(A))}else P++;else x=0}while(x>0)}}n+="</DOCXML>",n+="<BillXML></BillXML></LoanRepaymentXML>"}if(this.chkPostBasedOnDailyAttendance.IsChecked&&o.d.SessionManager.Preferences.ContainsKey("CaputureDimensionData")&&"True"==o.d.SessionManager.Preferences.CaputureDimensionData.toString()){let c,r="",d="",C="",h="",g="";if(null!=this.oCMP&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData.length>0){C=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData[0].DocID.toString();for(let p=0;p<this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData.length;p++)h+="~"+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcADWData[p].InvDocDetailsID.toString()}c=g="",null!=o.d.SessionManager.dtDocDefAccs&&(i=o.d.SessionManager.dtDocDefAccs.filter(p=>40079==p.CostCenterID&&"CreditAccount"==p.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(c=i[0].UserDefaultValue.toString()),i=o.d.SessionManager.dtDocDefAccs.filter(p=>40079==p.CostCenterID&&"DebitAccount"==p.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(g=i[0].UserDefaultValue.toString())),n+='<AttendanceDimensionwiseXML DocID="'+C+'" DocDetIDs="'+h+'" WorkFlowID="0" >',n+="<DOCXML>";let e=null;if(null!=this.dsDailyAttendanceData&&this.dsDailyAttendanceData.Tables.length>0&&(e=this.dsDailyAttendanceData.Tables[0].filter(p=>p.EMPNODE==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo)),null!=e&&e.length>0){let P,x,y,M,p=[],u=[];u.push("EMPNODE");for(let T=0;T<this.dsDailyAttendanceData.Tables[3].length;T++)u.push(this.dsDailyAttendanceData.Tables[3][T].Data.toString());u.push("OT1"),u.push("OT2"),u.push("OT3"),u.push("OT4"),u.push("OT5"),u.push("DAYSATTENDED"),u.push("ABSENTDAYS"),u.push("Leaves"),u.push("TOTALOTAMOUNT");for(let T=0;T<e.length;T++)if(x=this.ApplyFilter(p,e[T]),null!=x&&x.length>0)for(let I=0;I<u.length;I++)u[I].startsWith("OT")&&(x[0][u[I]]=m.J0.SUMHoursAndMinutes(x[0][u[I]].toString(),e[T][u[I]].toString()));else{P={},P.EMPNODE=e[T].EMPNODE;for(let I=1;I<u.length;I++)P[u[I]]=e[T][u[I]];if(y=this.ApplyFilter(this.dsDailyAttendanceData.Tables[1],e[T]),null!=y&&y.length>0){if(M=this.ApplyFilter(this.dsDailyAttendanceData.Tables[2],e[T]),P.ABSENTDAYS=null!=M&&M.length>0?M[0].ABSENTDAYS:"0",null==this.dsDailyAttendanceData.Tables[4]||this.dsDailyAttendanceData.Columns[4].Contains("NODATA"))P.Leaves="0";else{let I=this.ApplyFilter(this.dsDailyAttendanceData.Tables[4],e[T]),S=0;if(null!=I&&I.length>0){let v,O;S=0;for(let N=0;N<I.length;N++)v=m.J0.ParseDate(I[N].FromDate),O=m.J0.ParseDate(I[N].ToDate),v>=o.d.SessionManager.PayrollMonthStart?O<=o.d.SessionManager.PayrollMonthEnd?S+=parseFloat(I[N].Leaves):v<=o.d.SessionManager.PayrollMonthEnd&&(S+=this.oCMP.GetNoOfDays(v,o.d.SessionManager.PayrollMonthEnd,parseInt(I[N].ComponentID))):O<=o.d.SessionManager.PayrollMonthEnd?O>=o.d.SessionManager.PayrollMonthStart&&(S+=this.oCMP.GetNoOfDays(o.d.SessionManager.PayrollMonthStart,O,parseInt(I[N].ComponentID))):S+=this.oCMP.GetNoOfDays(o.d.SessionManager.PayrollMonthStart,o.d.SessionManager.PayrollMonthEnd,parseInt(I[N].ComponentID))}P.Leaves=S>0?S:"0"}P.DAYSATTENDED=parseFloat(y[0].DAYSATTENDED)-parseFloat(P.ABSENTDAYS),P.TOTALOTAMOUNT=y[0].TOTALOTAMOUNT}p.push(P)}let A="0";for(let T=0;T<p.length;T++){if(A="0",null!=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay.length>T&&(A=this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanRepay[T].InvDocDetailsID.toString()),r="",n+="<RowHead/>",n+="<Row>",n+="<AccountsXML></AccountsXML>",n+='<Transactions DocSeqNo="'+T+'"  DocDetailsID="'+A+'" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="',n+='" ProductID="'+this.DefProdID+'" IsScheme="" Quantity="1" Unit="1" UOMConversion="1" UOMConvertedQty="1',n+='" Rate="0" Gross="0" RefNO="0" LinkedFieldValue="0" IsQtyIgnored="1" AverageRate="0',n+='" StockValue="0" StockValueFC="0" CurrencyID="1" ExchangeRate="1"  DebitAccount="'+g+'"  CreditAccount="'+c+'"  ></Transactions>',n+='<Numeric Query="dcNum1='+m.J0.Double(p[T].TOTALOTAMOUNT)+", dcCalcNum1="+m.J0.Double(p[T].TOTALOTAMOUNT)+", ",n+="dcNum5="+m.J0.Double(p[T].OT1)+", dcCalcNum5="+m.J0.Double(p[T].OT1)+", ",n+="dcNum7="+m.J0.Double(p[T].OT2)+", dcCalcNum7="+m.J0.Double(p[T].OT2)+", ",n+="dcNum9="+m.J0.Double(p[T].OT3)+", dcCalcNum9="+m.J0.Double(p[T].OT3)+", ",n+="dcNum11="+m.J0.Double(p[T].OT4)+", dcCalcNum11="+m.J0.Double(p[T].OT4)+", ",n+="dcNum13="+m.J0.Double(p[T].OT5)+", dcCalcNum13="+m.J0.Double(p[T].OT5)+", ",n+='" ></Numeric>',n+="<Alpha Query=\"dcAlpha1=N'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"',dcAlpha2=N'"+m.J0.Double(p[T].DAYSATTENDED)+"', dcAlpha3=N'"+m.J0.Double(p[T].ABSENTDAYS)+"', dcAlpha4=N'"+m.J0.Double(p[T].Leaves)+"', \" ></Alpha>",n+='<CostCenters Query="',r+=" dcCCNID51="+m.J0.Int(p[T].EMPNODE)+",",this.dsDailyAttendanceData.Tables[3].length>0){d="";for(let I=0;I<this.dsDailyAttendanceData.Tables[3].length;I++)d=this.dsDailyAttendanceData.Tables[3][I].Data.toString(),r+=" "+d+"="+m.J0.Int(p[T][d])+","}r.length>0&&(n+=r),n+='" ></CostCenters>',n+="<EXTRAXML></EXTRAXML>",n+="</Row>"}}n+="</DOCXML>",n+="</AttendanceDimensionwiseXML>"}if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays.length>0){let r=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths.split(";"),d=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjCalcMonthPaydays.split(";");if(r.length>0){n+="<AdjustmentsXML>",n+="<Rows>";for(let C=0;C<r.length;C++)n+='<Row PayrollMonth="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy"),n+='" EmpSeqNo="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo,n+='" AdjMonth="'+m.J0.ParseDate(r[C]).ToString("dd/MMM/yyyy"),n+='" Days="'+d[C].toString(),n+='" Remarks="',n+='" />';n+="</Rows>",n+="</AdjustmentsXML >"}}if(this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanCrNetSalLessZero.length>0&&(n+='<DelLoanXML DocID="'+this.oCMP.arrLstOthMPFields[this.iEmpIndex].drcLoanCrNetSalLessZero[0].DocID.toString()+'" > </DelLoanXML>'),l=t="",this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary<0&&"True"==o.d.SessionManager.Preferences.CreateLoanIfNetSalLessThanZero&&parseInt(o.d.SessionManager.Preferences.CreateLoanType)>0&&(null!=o.d.SessionManager.dtDocDefAccs&&(i=o.d.SessionManager.dtDocDefAccs.filter(r=>40056==r.CostCenterID&&"CreditAccount"==r.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(l=i[0].UserDefaultValue.toString()),i=o.d.SessionManager.dtDocDefAccs.filter(r=>40056==r.CostCenterID&&"DebitAccount"==r.SysColumnName),null!=i&&i.length>0&&null!=i[0].UserDefaultValue&&""!=i[0].UserDefaultValue.toString().Trim()&&(t=i[0].UserDefaultValue.toString())),n+='<CreateLoanXML DocID="" DocDetIDs="" WorkFlowID="0" >',n+="<DOCXML>",n+="<RowHead/>",n+="<Row>",n+="<AccountsXML></AccountsXML>",n+='<Transactions DocSeqNo="1"  DocDetailsID="0" LinkedInvDocDetailsID="0" LinkedFieldName="" LineNarration="" CommonNarration="LOAN CREATED FROM MONTHLY PAYROLL WHEN NET SALARY LESS THAN 0',n+='" ProductID="'+this.DefProdID+'" IsScheme="" Quantity="1" Unit="1" UOMConversion="1" UOMConvertedQty="1',n+='" Rate="0" Gross="0" RefNO="0" IsQtyIgnored="1" AverageRate="0',n+='" StockValue="0" StockValueFC="0" CurrencyID="1" ExchangeRate="1"  DebitAccount="'+t+'"  CreditAccount="'+l+'"  ></Transactions>',n+='<Numeric Query="dcNum1=1, dcCalcNum1=1, dcNum2='+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+", dcCalcNum2="+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+', " ></Numeric>',n+="<Alpha Query=\"dcAlpha6=N'"+o.d.SessionManager.PayrollMonth.AddMonths(1).ToString("dd/MMM/yyyy")+"',dcAlpha1=N'"+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+"', dcAlpha2=N'"+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+"', dcAlpha4=N'1', dcAlpha3=N'"+Math.abs(this.oCMP.arrLstOthMPFields[this.iEmpIndex].NetSalary)+"',dcAlpha5=N'"+o.d.SessionManager.PayrollMonth.AddMonths(1).ToString("dd/MMM/yyyy")+"',dcAlpha7=N'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"', \" ></Alpha>",n+='<CostCenters Query="dcCCNID51='+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+", dcCCNID52="+o.d.SessionManager.Preferences.CreateLoanType+', " ></CostCenters>',n+="<EXTRAXML></EXTRAXML>",n+="</Row>",n+="</DOCXML>",n+="<BillXML></BillXML></CreateLoanXML>"),this.oCMP.arrLstCPFields[0].length>0&&this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths.length>0){let r=this.oCMP.arrLstOthMPFields[this.iEmpIndex].sAdjsCalcMonths.split(";");if(r.length>0){let d="";d+="    DELETE FROM PAY_EmpMonthlyArrAdjDetails WHERE EmpSeqNo="+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+" AND DType=2 AND PayrollMonth='"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"'";for(let C=0;C<r.length;C++){let h="",c="";d+="  INSERT INTO PAY_EmpMonthlyArrAdjDetails(EmpSeqNo,PayrollMonth,ArrAdjMonth,DType",h+="VALUES("+this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo+",'"+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+"','"+r[C].toString()+"',2";for(let g=0;g<this.oCMP.arrLstCPFields[this.iEmpIndex][0].length;g++){let e="";if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData&&this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData.length>0){let p=[];if(this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData.TrimEnd(","),p=this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].AdjData.split(","),null!=p&&p.length>0)for(let u=0;u<p.length;u+=2)m.J0.ParseDate(p[u]).ToString("dd MMM yyyy")==m.J0.ParseDate(r[C]).ToString("dd MMM yyyy")&&(e=p[u+1])}c+=",Earning"+this.oCMP.arrLstCPFields[this.iEmpIndex][0][g].SNo,h+=null!=e&&""!=e?","+e:",0"}for(let g=0;g<this.oCMP.arrLstCPFields[this.iEmpIndex][2].length;g++){let e="";if(null!=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData&&this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData.length>0){let p=[];if(this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData.TrimEnd(","),p=this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].AdjData.split(","),null!=p&&p.length>0)for(let u=0;u<p.length;u+=2)m.J0.ParseDate(p[u]).ToString("dd MMM yyyy")==m.J0.ParseDate(r[C]).ToString("dd MMM yyyy")&&(e=p[u+1])}c+=",Deduction"+this.oCMP.arrLstCPFields[this.iEmpIndex][2][g].SNo,h+=null!=e&&""!=e?","+e:",0"}d+=c+")",d+=h+")"}n+='<AdjustmentsDetailXML Query="'+d+'"></AdjustmentsDetailXML>'}}return n+="</XML>",n.toString()}ApplyFilter(s,l){let t=s.filter(i=>i.EMPNODE==this.oCMP.arrLstOthMPFields[this.iEmpIndex].EmpSeqNo);for(let i=0;i<this.dsDailyAttendanceData.Tables[3].length;i++){let n=this.dsDailyAttendanceData.Tables[3][i].Data.toString();t=t.filter(r=>r[n]==l[this.dsDailyAttendanceData.Tables[3][i].Data.toString()])}return t}ReportView(){this.ReportDimension=new qe.y$(0),this.ReportDimension.CCID=this.CostCenterID,this.ReportDimension.TypeID=1,this.ReportsList=[],this.ReportDimension.OnPactListBoxValueChanged.Subscribe(this,"OnReportsLinkClick");let s=[];this.dsData=o.d.common.GetDataSetQuery(" declare @UserID int,@RoleID int        set @UserID="+o.d.SessionManager.UserID+" set @RoleID="+o.d.SessionManager.RoleID+"    \n                     SELECT R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel,Q.Width ,Q.Height,Q.mapxml,Q.MapType\n                     FROM ADM_RevenUReports R  with(nolock)\n                     inner join ADM_DocumentReports Q WITH(NOLOCK) on Q.DocumentReportID=R.ReportID\n                     left join ADM_CostCenterDef A WITH(NOLOCK) on A.CostCenterColID=Q.DocumentField \n                     left join [ADM_DocReportUserRoleMap] DR WITH(NOLOCK) on DR.DocumentViewID=Q.DocumentViewID and DR.CostCenterID=Q.CostCenterID\n                     where  Q.CostCenterID="+this.CostCenterID+" and (DR.UserID=@UserID OR DR.RoleID=@RoleID OR GroupID IN (SELECT GroupID FROM COM_Groups WITH(NOLOCK) WHERE UserID=@UserID OR RoleID=@RoleID))\n                     GROUP BY  Q.ReportID, R.ReportID,Q.ReportName,Q.ReportField,Q.ReportFieldName,Q.DocumentField,Q.DocumentFieldName,A.SysColumnName,Q.Shortcut,Q.DisplayAsPopup,Q.GroupLevel ,Q.Width,Q.Height,Q.mapxml,Q.MapType \n                     order by Q.ReportID "),null!=this.dsData&&this.dsData.Tables[0].length>0&&this.dsData.Tables[0].forEach(t=>{let i=new Ke.v;i.DBColumnID=parseInt(t.ReportID),i.Label=t.ReportName.toString(),this.dsData.Columns[0].Contains("Shortcut")&&(i.KeyTip=t.Shortcut.toString()),this.dsData.Columns[0].Contains("DisplayAsPopup")&&""!=t.DisplayAsPopup.toString()&&(i.Dependantinuse="1"==t.DisplayAsPopup.toString()),this.dsData.Columns[0].Contains("Width")&&""!=t.Width.toString()&&(i.Width=t.Width.toString()),this.dsData.Columns[0].Contains("Height")&&""!=t.Height.toString()&&(i.Length=t.Height.toString()),this.dsData.Columns[0].Contains("DocumentField")&&""!=t.DocumentField.toString()&&(i.Formula=t.DocumentField.toString()),this.dsData.Columns[0].Contains("mapxml")&&""!=t.mapxml.toString()&&(i.ToolTipDescription=t.mapxml.toString()),s.Contains(parseInt(t.ReportID))||(s.push(parseInt(t.ReportID)),this.ReportsList.push(i)),0==this.ReportsList.length&&(this.ButtonReport.Visible=!1)})}OnReportsLinkClick(s){var l=this;return(0,B.A)(function*(){const{ReportViewModel:t}=yield Promise.resolve().then(V.bind(V,35725)),{ReportViewComponent:i}=yield Promise.resolve().then(V.bind(V,73540));let d,n={strXML:""},r=new t;if(l.DisplayMessage=l.GetReportFilterXML(s,n),d=n.strXML,0==l.DisplayMessage.length){var C=l.ReportsList.find(h=>h.DBColumnID==parseInt(s));if(null!=C&&C.Dependantinuse)r.ReportViewModel_Document(l.CostCenterID,d,parseInt(s),!0,null,null),!m.J0.IsEmpty(C.Width)&&m.J0.Double(C.Width)>0&&(r.RptWidth=m.J0.Double(C.Width)),!m.J0.IsEmpty(C.length)&&m.J0.Double(C.length)>0&&(r.RptHeight=m.J0.Double(C.length)),r.DocumentObject=l,o.d.page.HideDialog(l.PopUpGUID),o.d.page.ShowDialog(r,i,{Title:"",HideClose:!0,ShowCenter:!0});else{let h=new t;h.ReportViewModel_Document(l.CostCenterID,d,parseInt(s),!1,null,null),h.DocumentObject=l,o.d.page.HideDialog(l.PopUpGUID),o.d.page.addNewTab({component:i,params:{obj:h}})}}})()}GetReportFilterXML(s,l){let t="";l.strXML="";let i=this.dsData.Tables[0];i=i.filter(d=>d.ReportID==s);let r,n=!1;i.forEach(d=>{(0,j.yG0)(d.GroupLevel)&&(n=!0)}),t+="<XML",n&&(t+=' GroupLevel="1"'),t+=" >";for(let d=0;d<i.length;d++)if(r=i[d].ReportField.toString(),t+="<Row ",t+='ColID ="'+r+'" ',!m.J0.IsEmpty(i[d].SysColumnName)){if("dcccnid51"==i[d].SysColumnName.toString().toLowerCase()){let C="";for(let h=0;h<this.EmployeesList.Table.length;h++)(0,j.yG0)(this.EmployeesList.Table[h].Select)&&(C+=this.EmployeesList.Table[h].EmpSeqNo.toString()+",");if(m.J0.IsEmpty(C)||!(C.length>0))return alert(this.ErrorMessage+"Employee '"),"Empty Value";C=C.substr(0,C.length-1),t+='Value ="'+C+'" '}else"duedate"==i[d].SysColumnName.toString().toLowerCase()?t+='Value ="'+o.d.SessionManager.PayrollMonth.ToString("dd/MMM/yyyy")+'" ':"dcalpha17"==i[d].SysColumnName.toString().toLowerCase()?t+='Value ="'+o.d.SessionManager.PayrollMonthStart.ToString("dd/MMM/yyyy")+'" ':"dcalpha18"==i[d].SysColumnName.toString().toLowerCase()&&(t+='Value ="'+o.d.SessionManager.PayrollMonthEnd.ToString("dd/MMM/yyyy")+'" ');t+=" />"}return t+="</XML>",l.strXML=t.toString(),""}}function Zt(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",6),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.Button_Click("Post"))}),a.nrm(1,"i",12),a.EFF(2,"Post"),a.k0s()}}let es=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){this.obj=this.params.obj}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-post-att-time-sheet-to-daily-att"]],decls:36,vars:12,consts:[[2,"display","flex","position","relative","height","100%"],[2,"width","100%"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],["class","secondary-btn-wicon",3,"click",4,"ngIf"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-broom"],[1,"fa-light","fa-filter"],[1,"fa-light","fa-file-export"],[1,"documentgrid","row","form-row",2,"padding","4px 12px","height","calc(100% - 50px)","width","100%"],[2,"width","100%","height","100%",3,"obj"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n    "),a.j41(2,"div",1),a.EFF(3,"\n        "),a.j41(4,"div",2),a.EFF(5,"\n            "),a.j41(6,"label",3),a.EFF(7),a.k0s(),a.EFF(8,"\n            "),a.j41(9,"div",4),a.EFF(10,"\n            "),a.DNE(11,Zt,3,0,"span",5),a.EFF(12,"\n            "),a.j41(13,"span",6),a.bIt("click",function(){return i.obj.Button_Click("Clear")}),a.nrm(14,"i",7),a.EFF(15),a.nI1(16,"translate"),a.k0s(),a.EFF(17,"\n            "),a.j41(18,"span",6),a.bIt("click",function(){return i.obj.Button_Click("Filter")}),a.nrm(19,"i",8),a.EFF(20),a.nI1(21,"translate"),a.k0s(),a.EFF(22,"\n            "),a.j41(23,"span",6),a.bIt("click",function(){return i.obj.Button_Click("Export")}),a.nrm(24,"i",9),a.EFF(25),a.nI1(26,"translate"),a.k0s(),a.EFF(27,"\n            "),a.k0s(),a.EFF(28,"\n        "),a.k0s(),a.EFF(29,"\n        "),a.j41(30,"div",10),a.EFF(31,"\n            "),a.nrm(32,"app-PactGridView",11),a.EFF(33,"  \n        "),a.k0s(),a.EFF(34,"\n   "),a.k0s(),a.EFF(35,"\n "),a.k0s()),2&t&&(a.R7$(7),a.JRh(i.obj.Title),a.R7$(4),a.Y8G("ngIf",i.obj.PostVisiblility),a.R7$(4),a.JRh(a.bMT(16,6,"Clear")),a.R7$(5),a.JRh(a.bMT(21,8,"Filter")),a.R7$(5),a.JRh(a.bMT(26,10,"lbl_Export")),a.R7$(7),a.Y8G("obj",i.obj.dgv))},dependencies:[ce.bT,Ne.X,De.D9],encapsulation:2})}return F})();var Qe=V(48875),ve=V(95050),xt=V(33012);class At extends Re.g{get SelectAll(){return this._SelectAll}set SelectAll(s){s!=this._SelectAll&&(this._SelectAll=s,this.SelectUnselectAll(s))}set RefreshGrid(s){}constructor(s){super(),this.ProgressVisibility=!1,this.ProgressValue=0,this.ProgressMax=0,this.DialogResult=!1,this.PostVisiblility=!0,this._SelectAll=!1,this.ChkBtnPostOnlyFirstAndLastTrans=new Ce.c,this.PostOnlyFirstInLastOut=!1,this.PostOnlyFirstInLastOutVisibility=!0,this.btnCancelFlag=!1,this.SelectUnCheck=0,this.dsEmps=null,this.sEmpSeqNosOnGrid="",this.sFilter="",this.iPostDocType=0,this.iEmpIndex=0,this.strResult="",this.Failed="",this.FailedCount=0,this.DefProdID=0;try{this.DisplayName=s,this.Title=s,this.DisplayMessage="",this.btnCancelFlag=!1,this.LoadGrid(),this.btnFilter_Click()}catch(l){Logger.ErrorLog("PostAttTimeSheetToDailyAttViewModel::EXCEPTION PostAttTimeSheetToDailyAttViewModel()",l)}}LoadGrid(){this.dgv=new ue.vv,this.dgv.Height=0,this.dgv.SelectAll.Visible=!0,this.dgv.CanUserDeleteRows=!0,this.dgv.Table=[],this.dgv.TableColumns.push("Select"),this.dgv.TableColumns.push("SNo"),this.dgv.TableColumns.push("EmpSeqNo"),this.dgv.TableColumns.push("EmpCode"),this.dgv.TableColumns.push("EmpName"),this.dgv.TableColumns.push("VoucherNo"),this.dgv.TableColumns.push("CheckInDate"),this.dgv.TableColumns.push("CheckInTime"),this.dgv.TableColumns.push("CheckOutDate"),this.dgv.TableColumns.push("CheckOutTime"),this.dgv.TableColumns.push("TotalTime"),this.dgv.TableColumns.push("Result"),this.dgv.TableColumns.push("Row_Background"),this.dgv.TableColumns.push("InvDocDetailsID");let l,s=new L.O7;if(this.dgv.Columns=new Array,s=new L.O7,s.Header="Select",s.DisplayMember="Select",s.DataType="CheckBox",s.Width=50,s.CheckedChanged.Subscribe(this,"dgColSelect_CheckedChanged"),this.dgv.Columns.push(s),s=new L.O7,s.Header="#",s.DisplayMember="SNo",s.DataType="TextBlock",s.Width=40,s.ReadOnly=!0,this.dgv.Columns.push(s),s=new L.O7,s.Header="Employee Code",s.DisplayMember="EmpCode",s.DataType="TextBlock",s.Width=100,s.ReadOnly=!0,this.dgv.Columns.push(s),s=new L.O7,s.Header="Employee Name",s.DisplayMember="EmpName",s.DataType="TextBlock",s.Width=220,s.ReadOnly=!0,this.dgv.Columns.push(s),s=new L.O7,s.Header="Voucher No.",s.DisplayMember="VoucherNo",s.DataType="LINK_VOUCHER",s.Width=180,s.ReadOnly=!0,this.dgv.Columns.push(s),s=new L.O7,s.Header="Check-in Date",s.DisplayMember="CheckInDate",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,s.TextAlign="Center",this.dgv.Columns.push(s),s=new L.O7,s.Header="Check-in Time",s.DisplayMember="CheckInTime",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,s.TextAlign="Center",this.dgv.Columns.push(s),s=new L.O7,s.Header="Check-out Date",s.DisplayMember="CheckOutDate",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,s.TextAlign="Center",this.dgv.Columns.push(s),s=new L.O7,s.Header="Check-out Time",s.DisplayMember="CheckOutTime",s.DataType="TextBlock",s.Width=120,s.ReadOnly=!0,s.TextAlign="Center",this.dgv.Columns.push(s),s=new L.O7,s.Header="Total Time",s.DisplayMember="TotalTime",s.DataType="TextBlock",s.Width=100,s.ReadOnly=!0,s.TextAlign="Center",this.dgv.Columns.push(s),s=new L.O7,s.Header="Result",s.DisplayMember="Result",s.DataType="TextBlock",s.Width=200,s.ReadOnly=!0,this.dgv.Columns.push(s),this.dsCols=o.d.common.GetDataSet("PAY062",""),null!=this.dsCols&&this.dsCols.Tables.length>0&&(l=this.dsCols.Tables[0].filter(t=>1==t.IsColumnInUse),null!=l&&l.length>0))for(let t=0;t<l.length;t++)s=new L.O7,s.Header=l[t].USERCOLUMNNAME.toString(),s.DisplayMember=l[t].SysColumnName.toString(),s.ID=l[t].SysColumnName.toString(),s.DataType="LISTBOX",s.CostCenterID=parseInt(l[t].ColumnCostCenterID),s.TypeID=parseInt(l[t].ColumnCCListViewTypeID),s.ReadOnly=!0,s.Width=120,this.dgv.Columns.push(s),this.dgv.TableColumns.push(s.DisplayMember),s=new L.O7,s.DisplayMember=l[t].SysColumnName.toString()+"_Key",s.IsVisible=!1,this.dgv.Columns.push(s),this.dgv.TableColumns.push(s.DisplayMember)}dgColSelect_CheckedChanged(s,l){l||1==this.SelectAll&&(this.SelectUnCheck=1,this.SelectAll=!1)}SelectUnselectAll(s){for(let l=0;l<this.dgv.Table.length;l++)0==this.SelectUnCheck&&(this.dgv.Table[l].Select=s);this.SelectUnCheck=0}Button_Click(s){"Post"==s.toString()?this.btnPost_Click():"Clear"==s.toString()?this.btnClear_Click():"Filter"==s.toString()?this.btnFilter_Click():"Export"==s.toString()&&this.Export_Click()}Export_Click(){this.dgv.Excelexportdelegate.Call()}btnClear_Click(){this.dgv.Clear(),this.SelectAll=!1,this.FailedCount=0,this.Failed="",this.InProgress="",this.lstSelectedEmps=new Array}btnPost_Click(){if(this.ValidatePosting()){let l,t,s="",i=null;for(let n=0;n<this.objEmpFilter.DocumentsToLoad.Items.length;n++)if(i=null,1==this.objEmpFilter.DocumentsToLoad.Items[n].IsChecked)if("89"==this.objEmpFilter.DocumentsToLoad.Items[n].Value?o.d.SessionManager.Preferences.ContainsKey("PostAttendanceDataGroupBy")&&""!=o.d.SessionManager.Preferences.PostAttendanceDataGroupBy&&(i=o.d.SessionManager.Preferences.PostAttendanceDataGroupBy.toString().split(",")):"90"==this.objEmpFilter.DocumentsToLoad.Items[n].Value?o.d.SessionManager.Preferences.ContainsKey("PostTimeSheetDataGroupBy")&&""!=o.d.SessionManager.Preferences.PostTimeSheetDataGroupBy&&(i=o.d.SessionManager.Preferences.PostTimeSheetDataGroupBy.toString().split(",")):"103"==this.objEmpFilter.DocumentsToLoad.Items[n].Value&&o.d.SessionManager.Preferences.ContainsKey("PostAttendanceDataGroupBy")&&""!=o.d.SessionManager.Preferences.PostAttendanceDataGroupBy&&(i=o.d.SessionManager.Preferences.PostAttendanceDataGroupBy.toString().split(",")),null!=i){let r="";if(null!=this.dtData&&this.dtData.length>0){let C=this.dtData.filter(h=>h.DocumentType==this.objEmpFilter.DocumentsToLoad.Items[n].Value);if(null!=C&&C.length>0)for(let h=0;h<C.length;h++)r.length>0&&(r+=","),r+=C[h].EmpSeqNo.toString()}let d=this.GetGroupByFilterEmployees(r);if(null!=d&&d.length>0){let C="";if(null!=i&&i.length>0){for(let h=0;h<i.length;h++)m.J0.IsEmptySpace(i[h])||(C.length>0&&(C+=","),C+="-1"==i[h]?"RptManager":"-2"==i[h]?"EmpSeqNo":"CCNID"+(parseInt(i[h])-5e4));if(C.length>0){let h=d.ToTable(!0,C.split(","));if(null!=h&&h.length>0){this.dgv.TableColumns.Contains("Flag")&&this.dgv.TableColumns.Remove("Flag"),this.dgv.TableColumns.push("Flag");for(let c=0;c<this.dgv.Table.length;c++)this.dgv.TableColumns.Contains("Flag")&&(this.dgv.Table[c].Flag="0");for(let c=0;c<h.length;c++){let g=d;for(let e=0;e<Object.keys(h[0]).length;e++){let p=Object.keys(h[0])[e],u=h[0][p];g=g.filter(P=>P[p]==m.J0.String(u))}Object.keys(h[0]).length>0&&g.length>0&&ve.RibbonExtViewModel.GetDocumentObject(40067,"",!1,"PostAttTimeSheet").then(e=>{e.ScreenObject.GridData.Clear();let p=-1;for(let P=0;P<this.dgv.Table.length;P++)if((0,j.yG0)(this.dgv.Table[P].Select)&&(t=this.dtData.filter(x=>x.InvDocDetailsID==this.dgv.Table[0].InvDocDetailsID&&x.DocumentType==this.objEmpFilter.DocumentsToLoad.Items[n].Value),null!=t&&t.length>0&&"1"!=m.J0.String(this.dgv.Table[P].Flag)&&g.filter(x=>x.EmpCode==t[0].EmpCode.toString()).length>0)){if(this.dgv.Table[P].Flag="1",p++,l=e.ScreenObject.GridDataObj.NewRow(),e.ScreenObject.GridDataObj.addRow(l),e.ScreenObject.GridDataColumns.Contains("dcCCNID51Code")&&(e.ScreenObject.GridData[p].dcCCNID51Code=t[0].EmpCode),e.ScreenObject.GridData[p].dcCCNID51_Key=t[0].EmpSeqNo,e.ScreenObject.GridData[p].dcCCNID51=t[0].EmpName,e.FillDefaultProd(e.ScreenObject.GridData[p],"dcCCNID51"),e.ScreenObject.GridDataColumns.Contains("RefNo")&&(e.ScreenObject.GridData[p].RefNo=t[0].InvDocDetailsID),e.ScreenObject.GridData[p].dcAlpha1=m.J0.ParseDate(t[0].CheckInDate).ToString(o.d.SessionManager.Preferences["Date Format"]),e.ScreenObject.GridData[p].dcAlpha1_Key=m.J0.ParseDate(t[0].CheckInDate),e.Celleditend(e.ScreenObject.GridData[p],"dcCCNID51",0),e.ScreenObject.GridData[p].dcAlpha2=m.J0.ParseDate(t[0].CheckInTime).ToString("HH:mm"),e.ScreenObject.GridData[p].dcAlpha2_Key=m.J0.ParseDate(t[0].CheckInTime),e.ScreenObject.GridData[p].dcAlpha3=m.J0.ParseDate(t[0].CheckOutTime).ToString("HH:mm"),e.ScreenObject.GridData[p].dcAlpha3_Key=m.J0.ParseDate(t[0].CheckOutTime),e.Celleditend(e.ScreenObject.GridData[p],"dcAlpha3",40067),e.ScreenObject._CCFields.length>0)for(let x=0;x<e.ScreenObject._CCFields.length;x++)"DCCCNID51"!=e.ScreenObject._CCFields[x].DBColumnName.toUpperCase()&&(e.ScreenObject.GridDataColumns.Contains(e.ScreenObject._CCFields[x].DBColumnName+"_Key")?e.ScreenObject.GridData[p][e.ScreenObject._CCFields[x].DBColumnName+"_Key"]=t[0][e.ScreenObject._CCFields[x].DBColumnName].toString():(e.ScreenObject._CCFields[x]instanceof qe.y$||e.ScreenObject._CCFields[x]instanceof Qe.G)&&(e.ScreenObject._CCFields[x].SelectedValue=parseInt(t[0][e.ScreenObject._CCFields[x].DBColumnName])));for(let x=0;x<e.ScreenObject.GridDataColumns.length;x++)e.ScreenObject.GridDataColumns[x].startsWith("dcCCNID")&&!e.ScreenObject.GridDataColumns[x].endsWith("_Key")&&!e.ScreenObject.GridDataColumns[x].endsWith("Code")&&"DCCCNID51"!=e.ScreenObject.GridDataColumns[x].toUpperCase()&&"DCCCNID73"!=e.ScreenObject.GridDataColumns[x].toUpperCase()&&(e.ScreenObject.GridData[p][e.ScreenObject.GridDataColumns[x]]="",e.ScreenObject.GridData[p][e.ScreenObject.GridDataColumns[x]+"_Key"]=t[0][e.ScreenObject.GridDataColumns[x]]);e.CalculateTotals(e.ScreenObject.GridData[p],!1),e.ScreenObject.GridDataObj.updateRow(e.ScreenObject.GridData[p]),e.ScreenObject.GridDataObj.RefreshGrid=!0}m.J0.IsEmptySpace(s)||(e.DisplayMessage=s,e.MessageVisibility=!0),e.UpdateFooter=!0,e.RefreshGrid=!0,o.d.page.addNewTab({title:e.DisplayName,component:xt.AddEditDocumentComponent,params:{obj:e}});var u=e.ScreenObject._StaticFields.find(P=>"CommonNarration"==P.DBColumnName);null!=u&&(u.SetFocus=!0)})}}}}}}else{let r=this.dtData.filter(d=>d.DocumentType==this.objEmpFilter.DocumentsToLoad.Items[n].Value);null!=r&&r.length>0&&ve.RibbonExtViewModel.GetDocumentObject(40067,"",!1,"PostAttTimeSheet").then(d=>{d.ScreenObject.GridData.Clear();let C=-1;for(let c=0;c<this.dgv.Table.length;c++)if((0,j.yG0)(this.dgv.Table[c].Select)&&(t=this.dtData.filter(g=>g.InvDocDetailsID==this.dgv.Table[c].InvDocDetailsID.toString()&&g.DocumentType==this.objEmpFilter.DocumentsToLoad.Items[n].Value),null!=t&&t.length>0)){if(C++,l=d.ScreenObject.GridDataObj.NewRow(),d.ScreenObject.GridDataObj.addRow(l),d.ScreenObject.GridDataColumns.Contains("dcCCNID51Code")&&(d.ScreenObject.GridData[C].dcCCNID51Code=t[0].EmpCode),d.ScreenObject.GridData[C].dcCCNID51_Key=t[0].EmpSeqNo,d.ScreenObject.GridData[C].dcCCNID51=t[0].EmpName,d.FillDefaultProd(d.ScreenObject.GridData[C],"dcCCNID51"),d.ScreenObject.GridDataColumns.Contains("RefNo")&&(d.ScreenObject.GridData[C].RefNo=t[0].InvDocDetailsID),d.ScreenObject.GridData[C].dcAlpha1=m.J0.ParseDate(t[0].CheckInDate).ToString(o.d.SessionManager.Preferences["Date Format"]),d.ScreenObject.GridData[C].dcAlpha1_Key=m.J0.ParseDate(t[0].CheckInDate),d.Celleditend(d.ScreenObject.GridData[C],"dcCCNID51",0),d.ScreenObject.GridData[C].dcAlpha2=m.J0.ParseDate(t[0].CheckInTime).ToString("HH:mm"),d.ScreenObject.GridData[C].dcAlpha2_Key=m.J0.ParseDate(t[0].CheckInTime),d.ScreenObject.GridData[C].dcAlpha3=m.J0.ParseDate(t[0].CheckOutTime).ToString("HH:mm"),d.ScreenObject.GridData[C].dcAlpha3_Key=m.J0.ParseDate(t[0].CheckOutTime),d.Celleditend(d.ScreenObject.GridData[C],"dcAlpha3",40067),d.ScreenObject._CCFields.length>0)for(let g=0;g<d.ScreenObject._CCFields.length;g++)"DCCCNID51"!=d.ScreenObject._CCFields[g].DBColumnName.toUpperCase()&&(d.ScreenObject.GridDataColumns.Contains(d.ScreenObject._CCFields[g].DBColumnName+"_Key")?d.ScreenObject.GridData[C][d.ScreenObject._CCFields[g].DBColumnName+"_Key"]=t[0][d.ScreenObject._CCFields[g].DBColumnName].toString():(d.ScreenObject._CCFields[g]instanceof qe.y$||d.ScreenObject._CCFields[g]instanceof Qe.G)&&(d.ScreenObject._CCFields[g].SelectedValue=parseInt(t[0][d.ScreenObject._CCFields[g].DBColumnName])));for(let g=0;g<d.ScreenObject.GridDataColumns.length;g++)d.ScreenObject.GridDataColumns[g].startsWith("dcCCNID")&&!d.ScreenObject.GridDataColumns[g].endsWith("_Key")&&"DCCCNID51"!=d.ScreenObject.GridDataColumns[g].toUpperCase()&&"DCCCNID73"!=d.ScreenObject.GridDataColumns[g].toUpperCase()&&(d.ScreenObject.GridData[C][d.ScreenObject.GridDataColumns[g]+"_Key"]=t[0][d.ScreenObject.GridDataColumns[g]]);d.CalculateTotals(d.ScreenObject.GridData[C],!1),d.ScreenObject.GridDataObj.updateRow(d.ScreenObject.GridData[C]),d.ScreenObject.GridDataObj.RefreshGrid=!0}m.J0.IsEmptySpace(s)||(d.DisplayMessage=s,d.MessageVisibility=!0),d.UpdateFooter=!0,d.RefreshGrid=!0,o.d.page.addNewTab({title:d.DisplayName,component:xt.AddEditDocumentComponent,params:{obj:d}});var h=d.ScreenObject._StaticFields.find(c=>"CommonNarration"==c.DBColumnName);h&&(h.SetFocus=!0)})}}}GetGroupByFilterEmployees(s){let l="  AND EmpSeqNo IN ("+s+")",t=[];return t.push(Date.Today().ToString("dd MMM yyyy")),t.push(l),t.push(0),t.push(o.d.SessionManager.RoleID),t.push(o.d.SessionManager.UserID),t.push(o.d.SessionManager.LanguageID),o.d.empService.GetData(t,"spPAY_GetEmpMasterCCDetails").Tables[0]}ValidatePosting(){try{Logger.InfoLog("PostAttTimeSheetToDailyAttViewModel::Entering IsValidated()");{let s=0;for(let l=0;l<this.dgv.Table.length;l++)(0,j.yG0)(this.dgv.Table[l].Select)&&s++;if(0==s)return this.DisplayMessage="Select atleast one Document to post",!1;for(let l=0;l<this.dgv.Table.length;l++)if((0,j.yG0)(this.dgv.Table[l].Select)&&(null==this.dgv.Table[l].CheckInTime||null==this.dgv.Table[l].CheckInTime||""==this.dgv.Table[l].CheckInTime.toString()||null==this.dgv.Table[l].CheckOutTime||null==this.dgv.Table[l].CheckOutTime||""==this.dgv.Table[l].CheckOutTime.toString()))return this.DisplayMessage="CheckInTime/CheckOutTime is empty at Row No. : "+(l+1).toString(),!1}return Logger.InfoLog("PostAttTimeSheetToDailyAttViewModel::Exiting IsValidated()"),!0}catch(s){return Logger.ErrorLog("PostAttTimeSheetToDailyAttViewModel::EXCEPTION IsValidated()"+s.stack),!1}}btnFilter_Click(){Logger.InfoLog("PostAttTimeSheetToDailyAttViewModel::Entering Filter_Click()"),null==this.objEmpFilter?this.objEmpFilter=new Oe.t("",0,10):(this.objEmpFilter.Filter=10,this.objEmpFilter.InitControls()),this.objEmpFilter.Filter>0?o.d.page.ShowDialog(this.objEmpFilter,Ye.m,{ShowCenter:!0,HideHeader:!0}).subscribe(()=>{this.btnFilter_Click_CallBack()}):this.btnFilter_Click_CallBack()}btnFilter_Click_CallBack(){if(this.DialogResult=this.objEmpFilter.IsCompleted,this.objEmpFilter.IsCompleted){if(this.sEmpSeqNosOnGrid="",this.objEmpFilter.CostCenterFilters.length>0){let l=1,t="",i="",n="";for(let r=0;r<this.objEmpFilter.CostCenterFilters.length;r++){let d=this.objEmpFilter.CostCenterFilters[r];if(d.CostCenterID>5e4&&(l=2,t="NodeID",i=50051==d.CostCenterID?"EmpSeqNo":"CCNID"+(d.CostCenterID-5e4)),d.SelectedNodes.length>0){if(1==d.SelectedNodes.length)n+=" AND ",n+=i+"="+d.SelectedNodes[0].Id;else if(!d.SelectedNodes.find(C=>C.Id==l&&C.IsGroup))if(n+=" AND ",Ue.IPrefetchFilter.IsGroupTree(d)){let C="";for(let h=0;h<d.SelectedNodes.length;h++)(null==d.SelectedNodes[h].Parent||!d.SelectedNodes[h].Parent.IsSelected)&&(C.length>0&&(C+=","),C+=d.SelectedNodes[h].Id);0==C.length&&(C+=-12912),n+=i+" IN ",n+=" (select T."+t+" GTID from "+xe.A.GetTagTableName(d.CostCenterID)+" T with(nolock),"+xe.A.GetTagTableName(d.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP."+t+" IN (",n+=C.toString()+")  group by T."+t+")"}else{n+=i+" IN (";for(let C=0;C<d.SelectedNodes.length;C++)C>0&&(n+=","),n+=d.SelectedNodes[C].Id;n+=")"}}else d.DeleteButtonVisibility||(n+=" AND ",n+=i+"=-12912")}this.sFilter=n.toString()}this.FilterEmployees()}}FilterEmployees(){this.sEmpSeqNosOnGrid="",this.objEmpFilter.rBtnPostAttDocs?this.iPostDocType=89:this.objEmpFilter.rBtnPostTimeSheetDocs?this.iPostDocType=90:this.objEmpFilter.rBtnPostOnDutyDocs&&(this.iPostDocType=103),this.iPostDocType=this.objEmpFilter.rBtnPostAttDocs?89:90,this.ChkBtnPostOnlyFirstAndLastTrans.Visible=90==this.iPostDocType,this.ChkBtnPostOnlyFirstAndLastTrans.Visible=!1;try{o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(this.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(this.sFilter+="  AND EmpSeqNo IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),Logger.InfoLog("PostAttTimeSheetToDailyAttViewModel::Entering FilterEmployees()");let l=[];l.push(Date.Today().ToString("dd MMM yyyy")),l.push(this.sFilter),l.push(0),l.push(o.d.SessionManager.RoleID),l.push(o.d.SessionManager.UserID),l.push(o.d.SessionManager.LanguageID);let t=o.d.empService.GetData(l,"spPAY_GetEmpMasterCCDetails"),i="";if(this.dgv.Clear(),null!=t&&t.Tables.length>0&&t.Tables[0].length>0){for(let r=0;r<t.Tables[0].length;r++)i.Trim().length>0&&(i+=","),i+=t.Tables[0][r].EmpSeqNo.toString();var s;let n="";for(let r=0;r<this.objEmpFilter.DocumentsToLoad.Items.length;r++)1==this.objEmpFilter.DocumentsToLoad.Items[r].IsChecked&&(n.Trim().length>0&&(n+=","),n+=this.objEmpFilter.DocumentsToLoad.Items[r].Value);if(s=o.d.common.GetDataSet3("PAY117",n,i,this.objEmpFilter.FromDatePicker.Date.ToString("dd/MMM/yyyy")+"~"+this.objEmpFilter.ToDatePicker.Date.ToString("dd/MMM/yyyy")),this.dtData=s.Tables[0],!(null!=s&&s.Tables.length>0&&s.Tables[0].length>0))return void(this.DisplayMessage="No documents found for the selected Employees.");{let r;for(let d=0;d<s.Tables[0].length;d++){r=this.dgv.NewRow(),r.Select=!1,r.SNo=(d+1).toString(),this.sEmpSeqNosOnGrid.length>0&&(this.sEmpSeqNosOnGrid+=","),this.sEmpSeqNosOnGrid+=s.Tables[0][d].EmpSeqNo.toString(),r.EmpSeqNo=s.Tables[0][d].EmpSeqNo,r.EmpCode=s.Tables[0][d].EmpCode,r.EmpName=s.Tables[0][d].EmpName,r.InvDocDetailsID=s.Tables[0][d].InvDocDetailsID,r.VoucherNo=s.Tables[0][d].VoucherNo,r.CheckInDate=s.Tables[0][d].CheckInDate,m.J0.IsEmptySpace(s.Tables[0][d].CheckInTime)||(r.CheckInTime=m.J0.ParseDate(s.Tables[0][d].CheckInTime).ToString("HH:mm")),m.J0.IsEmptySpace(s.Tables[0][d].CheckOutDate)?r.Row_Background="#F77B7E":r.CheckOutDate=s.Tables[0][d].CheckOutDate,m.J0.IsEmptySpace(s.Tables[0][d].CheckOutTime)||(r.CheckOutTime=m.J0.ParseDate(s.Tables[0][d].CheckOutTime).ToString("HH:mm")),r.TotalTime=m.J0.IsEmptySpace(s.Tables[0][d].TotalTime)?"0.00":s.Tables[0][d].TotalTime,0==parseFloat(r.TotalTime.toString().Replace(":","."))&&(r.Row_Background="#F77B7E");for(let C=0;C<this.dgv.TableColumns.length;C++)this.dgv.TableColumns[C].startsWith("dcCCNID")&&!this.dgv.TableColumns[C].endsWith("_Key")&&(r[this.dgv.TableColumns[C]+"_Key"]=s.Tables[0][d][this.dgv.TableColumns[C]]);this.dgv.addRow(r)}this.dgv.refreshDataView(),this.dgv.RefreshGrid=!0,this.dgv.Update()}}Logger.InfoLog("PostAttTimeSheetToDailyAttViewModel::Exiting FilterEmployees()")}catch(l){Logger.ErrorLog("PostAttTimeSheetToDailyAttViewModel::EXCEPTION FilterEmployees()"+l.stack)}}}var bt=V(5661);const ts=()=>({standalone:!0});let ss=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){this.obj=this.params.obj}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-payslip"]],decls:71,vars:28,consts:[[1,"maincontainer"],[1,"page-header"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group",2,"margin-right","6px"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-eye"],[1,"fa-light","fa-print"],[1,"fa-light","fa-file-export"],[1,"fa-light","fa-envelope"],[1,"fa-light","fa-filter"],[1,"main_div"],[2,"padding","11px"],[1,"row","form-row"],[1,"form-group","col-md-3","col-sm-6","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"form-group","col-xl-3","col-md-4","col-sm-6","col-xs-12","divChk",2,"align-content","center"],["type","checkbox",3,"ngModelChange","ngModel","ngModelOptions"],[3,"click"],[1,"documentgrid","row","form-row",2,"padding","4px 12px","height","calc(100% - 50px)","width","100%"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n        "),a.j41(2,"div",1),a.EFF(3,"\n            "),a.j41(4,"span",2),a.EFF(5),a.k0s(),a.EFF(6,"\n            "),a.j41(7,"div",3),a.EFF(8,"\n                "),a.j41(9,"span",4),a.bIt("click",function(){return i.obj.Button_Click("Preview")}),a.nrm(10,"i",5),a.EFF(11),a.nI1(12,"translate"),a.k0s(),a.EFF(13," \n                "),a.j41(14,"span",4),a.bIt("click",function(){return i.obj.Button_Click("Print")}),a.nrm(15,"i",6),a.EFF(16),a.nI1(17,"translate"),a.k0s(),a.EFF(18," \n                "),a.j41(19,"span",4),a.bIt("click",function(){return i.obj.Button_Click("Export")}),a.nrm(20,"i",7),a.EFF(21),a.nI1(22,"translate"),a.k0s(),a.EFF(23,"\n                "),a.j41(24,"span",4),a.bIt("click",function(){return i.obj.Button_Click("EMail")}),a.nrm(25,"i",8),a.EFF(26),a.nI1(27,"translate"),a.k0s(),a.EFF(28,"\n                "),a.j41(29,"span",4),a.bIt("click",function(){return i.obj.Button_Click("Filter")}),a.nrm(30,"i",9),a.EFF(31),a.nI1(32,"translate"),a.k0s(),a.EFF(33,"\n            "),a.k0s(),a.EFF(34,"\n        "),a.k0s(),a.EFF(35,"\n"),a.j41(36,"div",10),a.EFF(37,"\n    "),a.j41(38,"div",11),a.EFF(39,"          \n        "),a.j41(40,"div",12),a.EFF(41,"\n            "),a.j41(42,"div",13),a.EFF(43,"\n                "),a.eu8(44,14),a.EFF(45,"\n            "),a.k0s(),a.EFF(46,"\n            "),a.j41(47,"div",13),a.EFF(48,"\n                "),a.eu8(49,14),a.EFF(50,"\n            "),a.k0s(),a.EFF(51,"\n            "),a.j41(52,"div",13),a.EFF(53,"\n                "),a.eu8(54,14),a.EFF(55,"\n            "),a.k0s(),a.EFF(56,"\n                "),a.j41(57,"div",15),a.EFF(58,"\n                  "),a.j41(59,"input",16),a.mxI("ngModelChange",function(r){return a.DH7(i.obj.ExportSeperate,r)||(i.obj.ExportSeperate=r),r}),a.k0s(),a.EFF(60,"\n                  "),a.j41(61,"label",17),a.bIt("click",function(){return i.obj.ExportSeperate=!i.obj.ExportSeperate}),a.EFF(62),a.nI1(63,"translate"),a.k0s(),a.EFF(64,"\n              "),a.k0s(),a.EFF(65,"              \n    "),a.k0s(),a.EFF(66,"\n\n    "),a.j41(67,"div",18),a.EFF(68,"\n        \n    "),a.k0s(),a.EFF(69,"\n"),a.k0s(),a.EFF(70,"\n "),a.k0s()()),2&t&&(a.R7$(5),a.JRh(i.obj.Title),a.R7$(6),a.JRh(a.bMT(12,15,"Preview")),a.R7$(5),a.JRh(a.bMT(17,17,"Print")),a.R7$(5),a.JRh(a.bMT(22,19,"Export")),a.R7$(5),a.JRh(a.bMT(27,21,"EMail")),a.R7$(5),a.JRh(a.bMT(32,23,"Filter")),a.R7$(13),a.Y8G("obj",i.obj.dtpPayrollMonth)("group",i.form),a.R7$(5),a.Y8G("obj",i.obj.cmbPayslipLayout)("group",i.form),a.R7$(5),a.Y8G("obj",i.obj.cmbSortOn)("group",i.form),a.R7$(5),a.R50("ngModel",i.obj.ExportSeperate),a.Y8G("ngModelOptions",a.lJ4(27,ts)),a.R7$(3),a.JRh(a.bMT(63,25,"Export Each Employee Seperately")))},dependencies:[ye._,ae.Zm,ae.BC,ae.vS,De.D9],encapsulation:2})}return F})();var as=V(54004),rt=V(70234),Ft=V(54683),dt=V(9309),Nt=V(39559),ee=V(31820),Ge=V(95005),ls=V(3436),is=V(93426),Rt=V(78906);class Lt extends Re.g{get CCID(){return this.CostCenterID}set CCID(s){this.CostCenterID=s}get dtPayrollTaxCmpts(){return this.dtPayrollTaxCmptsObj.Table}get PayrollColumnSourceTaxComponents(){return this.dtPayrollTaxCmptsObj.Columns}get lFinancialDate(){return this._lFinancialDate}set lFinancialDate(s){s!=this._lFinancialDate&&(this._lFinancialDate=s)}get ScreenObject(){return this._ScreenObject}set ScreenObject(s){this._ScreenObject=s}constructor(){super(),this.CostCenterID=0,this.TypeID=0,this.AttachmentVisibility=!1,this.Employee=new Qe.G(0),this.AttachVisiblility=!1,this.PayrollTaxFields=new Array,this.dtPayrollTaxCmptsObj=new ue.vv,this.Savereturnvalue=-1,this.oRadio1=null,this.dsTaxComponents=null,this.CostCenterID=262,this.objEmp=new Nt.h,this.ScreenObject=new Rt.a(0,0),this.ScreenObject.Data=[],this.ViewAttachments=new dt.ViewAttachmentViewModel(this),this.OnAddAttachment(),this.AttachVisiblility=o.d.SessionManager.IsActionAssigned(262,"Attach"),this.EmpYear=new X.y$(0),this.EmpYear.LblWidth="60",this.EmpYear.Label=o.d.GetResource("Doc_Year"),this.EmpYear.SelectionChangedCommand.Subscribe(this,"OnYearSelected");for(let s=2e3;s<2100;s++){let l=X._p.ComboBoxItems_2(s.toString(),s.toString());this.EmpYear.Items.push(l)}this.EmpYear.SelectedValue=m.J0.ParseDate(o.d.SessionManager.PayrollMonth).ToString("yyyy"),this.EmpRegime=new X.y$(0),this.EmpRegime.Items.push(X._p.ComboBoxItems_2("Old","Old")),this.EmpRegime.Items.push(X._p.ComboBoxItems_2("New","New")),this.EmpRegime.Label="Regime Opted For",this.lFinancialDate=this.GetFinancialYear(),this.Employee.Visible=!0,this.Employee.Code.TypeID=4,this.Employee.Name.TypeID=1,this.Employee.Code.Visible=this.Employee.Name.Visible=!1,this.Employee.Code.Column=0,this.Employee.Name.Column=1,this.Employee.Code.Visible=!0,this.Employee.Name.Visible=!0,this.Employee.Code.CCID=this.Employee.Name.CCID=50051,this.Employee.LblWidth="80",this.EmpRegime.LblWidth="80",this.Employee.Label=o.d.GetResource("Pay_Employee"),this.Employee.Code.Visible&&(this.Employee.Code.CCID=50051,this.Employee.Code.TypeID=4),this.Employee.Name.Visible&&(this.Employee.Name.CCID=50051,this.Employee.Name.TypeID=1),this.FilterEmployees(),this.Employee.SelectionCallBack.Subscribe(this,"Employee_SelectedValueChanged"),this.dtPayrollTaxCmptsObj.Table=[],this.dtPayrollTaxCmptsObj.Columns=new Array,this.dtPayrollTaxCmptsObj.Height=110,this.GenerateTaxComponentFields(0,0,this.PayrollTaxFields),this.BindHRAGridColumns()}BindHRAGridColumns(){this.PayrollColumnSourceTaxComponents.Clear(),this.dtPayrollTaxCmptsObj.Clear();let s=new L.O7;s.Header="FromDate",s.DisplayMember="ITFromDate",s.ValueMember="ITFromDate_Key",s.DataType="DATE",s.ReadOnly=!1,s.Width=85,this.PayrollColumnSourceTaxComponents.push(s),s=new L.O7,s.Header="ToDate",s.DisplayMember="ITToDate",s.ValueMember="ITToDate_Key",s.DataType="DATE",s.ReadOnly=!1,s.Width=85,this.PayrollColumnSourceTaxComponents.push(s),s=new L.O7,s.Header="Amount",s.DisplayMember="Amount",s.DataType="TextBlock",s.ReadOnly=!1,s.Width=75,this.PayrollColumnSourceTaxComponents.push(s),s=new L.O7,s.Header="Metro",s.ValueBinding="Metro",s.DataType="ComboBox",s.DisplayMember="Name",s.ValueMember="Value",s.Width=60;let l=[];l.push(X._p.ComboBoxItems_2("Yes","Yes")),l.push(X._p.ComboBoxItems_2("No","No")),s.ComboData=l,this.PayrollColumnSourceTaxComponents.push(s),s=new L.O7,s.Header="HRAAddress",s.DisplayMember="HRAAddress",s.DataType="TextArea",s.ReadOnly=!1,s.Width=200,this.PayrollColumnSourceTaxComponents.push(s),s=new L.O7,s.Header="Name of Landlord",s.DisplayMember="NameofLandlord",s.DataType="TextBlock",s.ReadOnly=!1,s.Width=153,this.PayrollColumnSourceTaxComponents.push(s),s=new L.O7,s.Header="Pan of Landlord",s.DisplayMember="PanofLandlord",s.DataType="TextBlock",s.ReadOnly=!1,s.Width=150,this.PayrollColumnSourceTaxComponents.push(s),this.dtPayrollTaxCmptsObj.RefreshGridView()}Employee_SelectedValueChanged(s){""!=this.EmpYear.SelectedValue.toString()?(this.EmpRegime.SelectedValue="",this.PayrollTaxFields.Clear(),this.dtPayrollTaxCmptsObj.Clear(),null!=this.ViewAttachments&&this.ViewAttachments.AttachmentsListObj.Clear(),this.ViewAttachments=new dt.ViewAttachmentViewModel(this),this.OnAddAttachment(),this.GenerateTaxComponentFields(parseInt(this.EmpYear.SelectedValue),this.Employee.SelectedValue,this.PayrollTaxFields)):this.DisplayMessage="Please select the Year"}OnYearSelected(s){this.Employee.SelectedValue=0,this.EmpRegime.SelectedValue="",this.lFinancialDate=this.GetFinancialYear(),this.FilterEmployees(),this.dtPayrollTaxCmptsObj.Columns.Clear(),this.PayrollTaxFields.Clear(),this.dtPayrollTaxCmptsObj.Clear(),this.Employee.SelectedValue>0?this.GenerateTaxComponentFields(parseInt(this.EmpYear.SelectedValue),this.Employee.SelectedValue,this.PayrollTaxFields):this.GenerateTaxComponentFields(0,0,this.PayrollTaxFields)}GetFinancialYear(){let s="",l=new Date(parseInt(this.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth,1),t=l.AddYears(1).AddMonths(-1);return s=this.ScreenObject.GetMonthName(l.getMonth(),!1)+" "+l.getFullYear()+" - "+this.ScreenObject.GetMonthName(t.getMonth(),!1)+" "+t.getFullYear(),s}OnComponentSelection(s){let l="",t="";this.PayrollTaxFields.forEach(i=>{if(i instanceof Ge.mn){let n=i;if(t=n.Currency.SelectedValue,null!=t){let r=this.dsTaxComponents.Tables[0].filter(d=>"ComboTextValue"==d.ControlType&&d.NodeID==parseInt(t));for(let d=0;d<r.length;d++){let C=r[d];"COMBOTEXTVALUE"===(l=m.J0.String(C.ControlType),l)&&(n.Label=m.J0.String(C.AmountLimit))}}}})}GenerateTaxComponentFields(s,l,t){try{Logger.InfoLog("VoucherGenerator:: Inside GenerateCustomFields");let n,r,i=0,d=null,C=null;if(null===l&&(l=0),0!=s&&0!=l&&(d=o.d.common.GetDataSet3("PAY071",s.toString(),l.toString())),null!=d&&d.Tables.length>0&&d.Tables[0].length>0&&!m.J0.IsEmpty(d.Tables[0][0].SEQNO)&&(C=o.d.common.GetDataSet("PAY072",d.Tables[0][0].SEQNO.toString())),this.dsTaxComponents=o.d.empService.GetIncomeTaxComponents(0,s,l),this.dsTaxComponents.Tables[0].length>0&&this.dsTaxComponents.Columns[0].Contains("ITComponentsValidationMessage")&&!m.J0.IsEmpty(this.dsTaxComponents.Tables[0][0].ITComponentsValidationMessage))return void(this.DisplayMessage=this.dsTaxComponents.Tables[0][0].ITComponentsValidationMessage.toString());let h=this.dsTaxComponents.Tables[0];if(h.forEach(c=>{switch(n=m.J0.String(c.CONTROLTYPE).toUpperCase(),n){case"LABEL":r=new ls.D,r.Label=m.J0.String(c.NAME),t.push(r),r.tabname="LABEL";break;case"TEXTBOX":this.LabelLimitAmount=m.J0.String(c.AMOUNTLIMIT),this.oText=new ee.Dw(parseInt(c.NODEID)),this.oText.Label=m.J0.String(c.NAME),this.oText.KeyTip=this.LabelLimitAmount,this.oText.Text=c.AMOUNT.toString(),this.oText.LblWidth="400",this.oText.tabname="TEXTBOX",t.push(this.oText);break;case"COMBOTEXTVALUE":let e=h.filter(p=>"ComboTextValue"==p.CONTROLTYPE&&p.GROUPID==parseInt(c.GROUPID));var g=t.find(p=>p instanceof Ge.mn&&p.DBColumnID==parseInt(c.GROUPID));null==g?(this.oRadio1=new Ge.mn,this.oRadio1.DBColumnID=parseInt(c.GROUPID)):this.oRadio1=g,this.oRadio1.tabname="COMBOTEXTVALUE",this.oRadio1.LblWidth="1",(0==i||i!=parseInt(c.GROUPID))&&e.length>0&&(e.forEach(p=>{this.oRadio1.Currency.Items.push(X._p.ComboBoxItems_2(m.J0.String(p.NAME).TrimStart(" "),m.J0.String(p.NODEID)))}),this.oRadio1.Currency.SelectedValue=this.oRadio1.Currency.Items[0].Value,this.oRadio1.Currency.SelectionChangedCommand.Subscribe(this,"OnComponentSelection"),t.push(this.oRadio1)),parseInt(c.SELECTEDNODE)>0?(this.oRadio1.Currency.SelectedValue=m.J0.String(c.SELECTEDNODE),this.oRadio1.ExchangeRate.Text=c.AMOUNT.toString(),this.oRadio1.Label=c.SELECTEDAMTLIMIT.toString()):""==this.oRadio1.ExchangeRate.Text&&(this.oRadio1.ExchangeRate.Text=c.AMOUNT.toString()),null==this.oRadio1.Label&&(this.LabelLimitAmount=m.J0.String(c.AMOUNTLIMIT),this.oRadio1.Label=this.LabelLimitAmount),(0==i||i!=parseInt(c.GROUPID))&&(i=parseInt(c.GROUPID))}}),null!=this.dsTaxComponents&&this.dsTaxComponents.Tables.length>2&&this.dsTaxComponents.Tables[2].length>0&&this.dsTaxComponents.Columns[2].Contains("RegimeType")&&null!=this.dsTaxComponents.Tables[2][0].RegimeType&&null!=this.dsTaxComponents.Tables[2][0].RegimeType&&""!=this.dsTaxComponents.Tables[2][0].RegimeType.toString()&&(this.EmpRegime.SelectedValue=this.dsTaxComponents.Tables[2][0].RegimeType.toString()),null!=this.dsTaxComponents&&this.dsTaxComponents.Tables.length>1&&this.dsTaxComponents.Tables[1].length>0){let g;for(let e=0;e<this.dsTaxComponents.Tables[1].length;e++)g=this.dtPayrollTaxCmptsObj.NewRow(),g.ITFromDate=m.J0.ParseDate(this.dsTaxComponents.Tables[1][e].FromDate).ToString("MMM/yyyy"),g.ITFromDate_Key=m.J0.ParseDate(this.dsTaxComponents.Tables[1][e].FromDate).ToString("dd-MMM-yyyy"),g.ITToDate=m.J0.ParseDate(this.dsTaxComponents.Tables[1][e].ToDate).ToString("MMM/yyyy"),g.ITToDate_Key=m.J0.ParseDate(this.dsTaxComponents.Tables[1][e].ToDate).ToString("dd-MMM-yyyy"),g.Amount=this.dsTaxComponents.Tables[1][e].Amount.toString(),g.Metro=this.dsTaxComponents.Tables[1][e].Metro.toString().TrimEnd(),g.HRAAddress=this.dsTaxComponents.Tables[1][e].Address.toString(),g.NameofLandlord=this.dsTaxComponents.Tables[1][e].Landlord.toString(),g.PanofLandlord=this.dsTaxComponents.Tables[1][e].LandlordPAN.toString(),this.dtPayrollTaxCmptsObj.addRow(g)}if(null!=C&&C.Tables.length>0&&C.Tables[0].length>0){let c=C.Tables[0];if(null!=c&&c.length>0)for(let g=0;g<c.length;g++){let e=new Ft.AddAttachmentViewModel;e.AddAttachmentViewModel_2(this),e.AttachmentID=parseInt(c[g].FileID),e.ActualFileName=c[g].ActualFileName.toString(),e.FileExtension=c[g].FileExtension.toString(),e.FileDescription=c[g].FileDescription.toString(),e.FilePath=m.J0.GetPath(c[g].GUID+"."+c[g].FileExtension),e.RelativeFileName=c[g].RelativeFileName.toString(),e.IsProductImage=!1,this.ViewAttachments.AttachmentsList.push(e)}}else this.BindEmptyRows(2)}catch(i){Logger.ErrorLog("Error : "+i),this.DisplayMessage=i.message}}OnSaveITDeclarations(s){try{Logger.InfoLog("ITDeclarationsViewModel::Entering OnSaveITDeclarations()");let l="";if(l=this.DataValid(),""!=l.toString())return void(this.DisplayMessage=l);this.SaveEmpIncomeTax(),this.OnClear(s)}catch(l){Logger.ErrorLog("ITDeclarationsViewModel::EXCEPTION OnSaveITDeclarations()"+l)}}DataValid(){let l,t,s="",i=0,n=0;0==this.Employee.SelectedValue&&(s+="Please select the Employee \r\n"),""==this.EmpYear.SelectedValue.toString()&&(s+="Please select the Year \r\n");let r=o.d.common.GetDataTable("PAY111",this.EmpYear.SelectedValue.ToString());null!=r&&r.length>0&&(m.J0.IsEmpty(r[0].dcAlpha9)||m.J0.ParseDate(r[0].dcAlpha9)<Date.Today()&&(s+="Cannot save the record,CutOffDate Exceeded \r\n")),this.PayrollTaxFields.forEach(d=>{if(d instanceof ee.Dw){let C=d;i=m.J0.Double(C.KeyTip),n=m.J0.Double(C.Text),i>0&&n>i&&(s=s+"Amount should be less than Limit Amount for '"+C.Label.toString().Trim()+"'\r\n")}if(d instanceof Ge.mn){let C=d;i=m.J0.Double(C.Label),n=m.J0.Double(C.ExchangeRate.Text),i>0&&n>i&&(s=s+"Amount should be less than Limit Amount for '"+C.Currency.Text.toString().Trim()+"'\r\n")}});for(let d=0;d<this.dtPayrollTaxCmpts.length;d++)m.J0.IsEmpty(this.dtPayrollTaxCmpts[d].ITFromDate_Key)||(m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITFromDate_Key).ToString("MMM/yyyy"))>m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITToDate_Key).ToString("MMM/yyyy"))?s=s+"Fromdate should be less than todate at row no ('"+d.toString()+"')\r\n":m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITToDate_Key).ToString("MMM/yyyy"))<m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITFromDate_Key).ToString("MMM/yyyy"))&&(s=s+"Todate should be greater than fromdate at row no ('"+d.toString()+"')\r\n"));for(let d=0;d<this.dtPayrollTaxCmpts.length&&""!=m.J0.String(this.dtPayrollTaxCmpts[d].ITFromDate_Key);d++){l=m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITFromDate_Key).ToString("MMM/yyyy")),t=m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITToDate_Key).ToString("MMM/yyyy"));for(let C=0;C<this.dtPayrollTaxCmpts.length;C++)if(d!=C){if(""==m.J0.String(this.dtPayrollTaxCmpts[C].ITFromDate_Key))break;if(+l.Date>=+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITFromDate_Key).OnlyDate()&&+l.Date<=+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITToDate_Key).OnlyDate()||+t.Date>=+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITFromDate_Key).OnlyDate()&&+t.Date<=+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITToDate_Key).OnlyDate()||+l.Date>=+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITFromDate_Key).OnlyDate()&&+t.Date<=+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITToDate_Key).OnlyDate()||+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITFromDate_Key).OnlyDate()>=+l.Date&&+m.J0.ParseDate(this.dtPayrollTaxCmpts[C].ITToDate_Key).OnlyDate()<=+t.Date){s=s+"Invalid dates entered at row no ('"+C.toString()+"')\r\n";break}}}for(let d=0;d<this.dtPayrollTaxCmpts.length&&""!=m.J0.String(this.dtPayrollTaxCmpts[d].ITFromDate_Key)&&""!=m.J0.String(this.dtPayrollTaxCmpts[d].ITToDate_Key);d++)if(l=m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITFromDate_Key).ToString("MMM/yyyy")),t=m.J0.ParseDate(m.J0.ParseDate(this.dtPayrollTaxCmpts[d].ITToDate_Key).ToString("MMM/yyyy")),""!=this.dtPayrollTaxCmpts[d].Amount.toString()){n=parseFloat(this.dtPayrollTaxCmpts[d].Amount);let C=12*(t.getFullYear()-l.getFullYear())+t.getMonth()-l.getMonth()+1;if(n/C>8e3){if(""==this.dtPayrollTaxCmpts[d].NameofLandlord.toString()){s=s+"Mandatory NameofLandlord row no ('"+(d+1).toString()+"')\r\n";break}if(""==this.dtPayrollTaxCmpts[d].PanofLandlord.toString()){s=s+"Mandatory PanofLandlord row no ('"+(d+1).toString()+"')\r\n";break}}}return s}SaveEmpIncomeTax(){Logger.InfoLog("ITDeclarationsViewModel::Entering SaveEmpIncomeTax");try{let l="";this.objEmp.EmpYear=this.EmpYear.SelectedValue,this.objEmp.EmpCode=this.Employee.SelectedValue.toString(),this.objEmp.Regime=this.EmpRegime.SelectedValue,l+="<Rows>",this.PayrollTaxFields.forEach(n=>{n instanceof ee.Dw?(l+='<row ComponentID="'+n.DBColumnID,l+='" AmountLimit="'+n.KeyTip,l+=null!=n.Text?'" Amount="'+parseFloat(n.Text):'" Amount="0',l+='"/>'):n instanceof Ge.mn&&(l+='<row ComponentID="'+n.Currency.SelectedValue,l+='" AmountLimit="'+n.Label,l+=null!=n.ExchangeRate.Text?'" Amount="'+parseFloat(n.ExchangeRate.Text):'" Amount="0',l+='"/>')}),l+="</Rows>";let t="";t+="<HRAINFO>";for(let n=0;n<this.dtPayrollTaxCmpts.length;n++)(""!=m.J0.String(this.dtPayrollTaxCmpts[n].ITFromDate_Key)||""!=m.J0.String(this.dtPayrollTaxCmpts[n].ITToDate_Key))&&(t+='<row FromDt="'+m.J0.ParseDate(this.dtPayrollTaxCmpts[n].ITFromDate_Key).ToString("dd-MMM-yyyy"),t+='" ToDt="'+m.J0.ParseDate(this.dtPayrollTaxCmpts[n].ITToDate_Key).ToString("dd-MMM-yyyy"),""!=this.dtPayrollTaxCmpts[n].Amount.toString()?t+='" Amt="'+parseFloat(this.dtPayrollTaxCmpts[n].Amount):t+='" Amt="0',t+='" Metro="'+this.dtPayrollTaxCmpts[n].Metro,t+='" Address="'+this.dtPayrollTaxCmpts[n].HRAAddress,t+='" Landlord="'+this.dtPayrollTaxCmpts[n].NameofLandlord,t+='" LandlordPAN="'+this.dtPayrollTaxCmpts[n].PanofLandlord,t+='"/>');t+="</HRAINFO>";let i=this.ViewAttachments.GetXML();o.d.empService.SaveEmpTaxDeclarations(l.toString(),t.toString(),i.toString(),this.objEmp.EmpYear,this.objEmp.EmpCode,this.objEmp.Regime).subscribe(n=>{this.DisplayMessage=n.Message,this.Savereturnvalue=n.RetValue})}catch(s){Logger.ErrorLog("ITDeclarationsViewModel:: SaveEmpIncomeTax"+s.stack)}}OnClear(s){try{this.Employee.SelectedValue=0,this.EmpRegime.SelectedValue="",this.PayrollColumnSourceTaxComponents.Clear(),this.PayrollTaxFields.Clear(),this.BindHRAGridColumns(),this.GenerateTaxComponentFields(0,0,this.PayrollTaxFields),null!=this.ViewAttachments&&this.ViewAttachments.AttachmentsList.Clear(),this.ViewAttachments=new dt.ViewAttachmentViewModel(this),this.OnAddAttachment()}catch(l){Logger.ErrorLog("Error : "+l),this.DisplayMessage=l.message}}BindEmptyRows(s){this.dtPayrollTaxCmptsObj.addEmptyRows(s)}FilterEmployees(){try{Logger.InfoLog("ITDeclarationsViewModel::Entering FilterEmployees()");let l,t,s="";l=new Date(parseInt(this.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth-1,1),t=new Date(o.d.SessionManager.AccountingFromMonth>1?parseInt(this.EmpYear.SelectedValue)+1:parseInt(this.EmpYear.SelectedValue),o.d.SessionManager.AccountingToMonth-1,1),t=t.AddMonths(1).AddDays(-1),s=" ( a.StatusID=250 AND (ISNULL(CONVERT(DATETIME,a.DORelieve),'01-Jan-9000')='01-Jan-9000') ",s=s+" or (Year(CONVERT(DATETIME,'"+t.ToString("dd/MMM/yyyy")+"'))<=Year(CONVERT(DATETIME,a.DORelieve)) and CONVERT(DATETIME,'"+l.ToString("dd/MMM/yyyy")+"')<=CONVERT(DATETIME,a.DORelieve)) ",s=s+" or ( CONVERT(DATETIME,'"+l.ToString("dd/MMM/yyyy")+"')<=CONVERT(DATETIME,a.DORelieve))) ",o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(s=s+" AND a.NodeID IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(s+="  AND a.NodeID IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),o.d.SessionManager.IsRptManagerUser&&o.d.SessionManager.IsActionAssigned(262,"Do not show sub ordinates Data")&&(s+="  AND a.NodeID IN ("+o.d.SessionManager.iEmployee+")"),this.Employee.Code.CustomWhere=this.Employee.Name.CustomWhere=s,Logger.InfoLog("ITDeclarationsViewModel::Exiting FilterEmployees()")}catch(s){Logger.ErrorLog("ITDeclarationsViewModel::EXCEPTION FilterEmployees()"+s.stack)}}OnAddAttachment(){Logger.InfoLog("AddProductViewModel::Entering AddAttachment");let s="";null!=this.Attachment&&(s=this.Attachment.ColID);let l=null;null!=this.Attachment&&(l=this.Attachment.RowID),this.Attachment=new Ft.AddAttachmentViewModel,this.Attachment.AddAttachmentViewModel_2(this),""==s?(this.Attachment.ColID="",this.Attachment.RowID=null):(this.Attachment.ColID=s,this.Attachment.RowID=l),Logger.InfoLog("AddProductViewModel::Entering AddAttachment")}OnClickAttachment(s){this.AttachmentVisibility=!0,o.d.page.ShowDialog(this,is.l,{Title:"Attachment"})}}function ns(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",6),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.obj.OnClickAttachment())}),a.EFF(1,"\n        "),a.nrm(2,"i",22),a.EFF(3),a.nI1(4,"translate"),a.k0s()}2&F&&(a.R7$(3),a.JRh(a.bMT(4,1,"Attachments")))}function os(F,s){if(1&F&&(a.j41(0,"div",26),a.EFF(1),a.k0s()),2&F){const l=a.XpG().$implicit;a.R7$(),a.JRh(l.Label)}}function rs(F,s){if(1&F&&a.nrm(0,"input",31),2&F){const l=a.XpG(2).$implicit,t=a.XpG();a.Y8G("placeholder",t.lblwatermark)("ngModel",l.Text)}}function ds(F,s){if(1&F){const l=a.RV6();a.j41(0,"input",32),a.mxI("ngModelChange",function(i){a.eBV(l);const n=a.XpG(2).$implicit;return a.DH7(n.Text,i)||(n.Text=i),a.Njj(i)}),a.k0s()}if(2&F){const l=a.XpG(2).$implicit;a.Y8G("tabindex",l.IsTabStop?null:-1)("disabled",!l.Enable||l.IsReadOnly),a.R50("ngModel",l.Text)}}function hs(F,s){if(1&F&&(a.qex(0),a.EFF(1,"\n                "),a.j41(2,"div"),a.EFF(3,"\n                  "),a.j41(4,"label",27),a.EFF(5),a.k0s(),a.EFF(6," \n                  "),a.j41(7,"label",28),a.EFF(8),a.k0s(),a.EFF(9," \n                  "),a.DNE(10,rs,1,2,"input",29),a.EFF(11,"\n                  "),a.DNE(12,ds,1,3,"input",30),a.EFF(13,"\n                     "),a.EFF(14,"\n                "),a.k0s(),a.EFF(15,"\n              "),a.EFF(16,"\n            "),a.bVm()),2&F){const l=a.XpG().$implicit;a.R7$(2),a.AVh("c-flex",l.LblWidth),a.R7$(2),a.BMQ("for",l.DBColumnName),a.R7$(),a.SpI("  ",l.Label," "),a.R7$(2),a.BMQ("for",l.DBColumnName),a.R7$(),a.SpI("    ",l.KeyTip," "),a.R7$(2),a.Y8G("ngIf",!l.ShowControl),a.R7$(2),a.Y8G("ngIf",l.ShowControl)}}function ms(F,s){if(1&F&&(a.qex(0),a.EFF(1,"\n              "),a.eu8(2,13),a.EFF(3,"\n            "),a.bVm()),2&F){const l=a.XpG().$implicit,t=a.XpG();a.R7$(2),a.Y8G("obj",l)("group",t.form)}}function Cs(F,s){if(1&F&&(a.qex(0),a.EFF(1,"\n          "),a.j41(2,"div",23),a.EFF(3,"\n            "),a.DNE(4,os,2,1,"div",24),a.EFF(5,"\n            "),a.DNE(6,hs,17,8,"ng-container",25),a.EFF(7,"\n            "),a.DNE(8,ms,4,2,"ng-container",25),a.EFF(9,"\n          "),a.k0s(),a.EFF(10,"\n        "),a.bVm()),2&F){const l=s.$implicit;a.R7$(2),a.Y8G("ngSwitch",!0),a.R7$(2),a.Y8G("ngSwitchCase","LABEL"==l.tabname),a.R7$(2),a.Y8G("ngSwitchCase","TEXTBOX"==l.tabname),a.R7$(2),a.Y8G("ngSwitchCase","COMBOTEXTVALUE"==l.tabname)}}let gs=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){this.obj=this.params.obj,console.log(this.obj)}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-income-tax-declaration"]],decls:77,vars:18,consts:[["id","maincontainer",1,"maincontainer",2,"display","flex"],[2,"flex-direction","column","justify-content","flex-end","width","100%"],[1,"page-header"],[1,"page-title_div"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-save"],[1,"fa-light","fa-broom"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"main_div","detailed",2,"padding","10px"],[1,"row"],[1,"form-group","col-xl-3","col-md-4","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"input_cntrl_label"],[1,"form-group","col-xl-6","col-md-4","col-sm-12","col-xs-12","PACTControl"],[2,"height","calc(100% - 190px)","overflow","auto"],[1,"PACTHeaderFields","row","form-row"],[4,"ngFor","ngForOf"],[1,"documentgrid",2,"height","140px"],[1,"page-subtitle",2,"padding","0","display","block","height","30px","font-size","16px"],[2,"height","90px"],[1,"fa-light","fa-paperclip"],[1,"form-group","row","PACTControl",3,"ngSwitch"],["class","input_cntrl_label panel-heading","style","font-weight: bold; background-color:var(--gridheaderbg-color); padding: 4px;",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"input_cntrl_label","panel-heading",2,"font-weight","bold","background-color","var(--gridheaderbg-color)","padding","4px"],[1,"input_cntrl_label",2,"width","70%"],[1,"input_cntrl_label",2,"width","10%","font-weight","bold"],["disabled","","class","input_cntrl disablecntrl","style","text-align: right;width: 20%;",3,"placeholder","ngModel",4,"ngIf"],["class","input_cntrl","style","width: 20%;text-align: right;",3,"tabindex","disabled","ngModel","ngModelChange",4,"ngIf"],["disabled","",1,"input_cntrl","disablecntrl",2,"text-align","right","width","20%",3,"placeholder","ngModel"],[1,"input_cntrl",2,"width","20%","text-align","right",3,"ngModelChange","tabindex","disabled","ngModel"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n  "),a.j41(2,"div",1),a.EFF(3,"\n  "),a.j41(4,"div",2),a.EFF(5,"\n     "),a.j41(6,"div",3),a.EFF(7,"\n      "),a.j41(8,"span",4),a.EFF(9),a.k0s(),a.EFF(10,"\n    "),a.k0s(),a.EFF(11,"\n    "),a.j41(12,"div",5),a.EFF(13,"\n      "),a.EFF(14,"\n      "),a.j41(15,"span",6),a.bIt("click",function(){return i.obj.OnSaveITDeclarations()}),a.EFF(16,"\n        "),a.nrm(17,"i",7),a.EFF(18),a.nI1(19,"translate"),a.k0s(),a.EFF(20,"\n      "),a.j41(21,"span",6),a.bIt("click",function(){return i.obj.OnClear("Clear")}),a.EFF(22,"\n        "),a.nrm(23,"i",8),a.EFF(24),a.nI1(25,"translate"),a.k0s(),a.EFF(26,"\n      "),a.DNE(27,ns,5,3,"span",9),a.EFF(28,"\n  "),a.k0s(),a.EFF(29,"\n  "),a.k0s(),a.EFF(30,"\n  "),a.j41(31,"div",10),a.EFF(32,"\n    "),a.j41(33,"div",11),a.EFF(34,"\n      "),a.j41(35,"div",12),a.EFF(36,"\n        "),a.eu8(37,13),a.EFF(38,"\n        "),a.j41(39,"label",14),a.EFF(40),a.k0s(),a.EFF(41,"\n      "),a.k0s(),a.EFF(42,"\n      "),a.j41(43,"div",15),a.EFF(44,"\n        "),a.eu8(45,13),a.EFF(46,"\n      "),a.k0s(),a.EFF(47,"\n      "),a.j41(48,"div",12),a.EFF(49,"\n        "),a.eu8(50,13),a.EFF(51,"\n      "),a.k0s(),a.EFF(52,"\n    "),a.k0s(),a.EFF(53,"\n    "),a.j41(54,"div",16),a.EFF(55,"\n      "),a.j41(56,"div",17),a.EFF(57,"\n        "),a.DNE(58,Cs,11,4,"ng-container",18),a.EFF(59,"\n      "),a.k0s(),a.EFF(60,"\n    "),a.k0s(),a.EFF(61,"\n    "),a.j41(62,"div",19),a.EFF(63,"\n      "),a.j41(64,"span",20),a.EFF(65,"HRA Information"),a.k0s(),a.EFF(66,"\n      "),a.j41(67,"div",21),a.EFF(68,"\n        "),a.eu8(69,13),a.EFF(70,"\n      "),a.k0s(),a.EFF(71,"\n    "),a.k0s(),a.EFF(72,"\n  "),a.k0s(),a.EFF(73,"\n  "),a.k0s(),a.EFF(74,"\n"),a.k0s(),a.EFF(75,"\n\n"),a.EFF(76,"\n")),2&t&&(a.R7$(9),a.SpI("\n        ",i.obj.Title,"\n      "),a.R7$(9),a.JRh(a.bMT(19,14,"Save")),a.R7$(6),a.JRh(a.bMT(25,16,"Clear")),a.R7$(3),a.Y8G("ngIf",i.obj.AttachVisiblility),a.R7$(10),a.Y8G("obj",i.obj.EmpYear)("group",i.form),a.R7$(3),a.JRh(i.obj.lFinancialDate),a.R7$(5),a.Y8G("obj",i.obj.Employee)("group",i.form),a.R7$(5),a.Y8G("obj",i.obj.EmpRegime)("group",i.form),a.R7$(8),a.Y8G("ngForOf",i.obj.PayrollTaxFields),a.R7$(11),a.Y8G("obj",i.obj.dtPayrollTaxCmptsObj)("group",i.form))},dependencies:[ce.Sq,ce.bT,ce.ux,ce.e1,ye._,ae.me,ae.BC,ae.vS,De.D9],encapsulation:2})}return F})();var we=V(24028);class ps extends Re.g{constructor(s){super(),this.dtpFromDate=new we.P6(0),this.dtpToDate=new we.P6(0),this.lTotalTaxAmount="",this.lTDSPaidAmount="",this.lTDSAmount="",this.ButtonClick=new ot.Yk,this.iComponentID=0,Logger.InfoLog("TDSPostingViewModel::Entering TDSPostingViewModel()"),this.DisplayMessage="",this.Parent=s[0],this.lTotalTaxAmount=s[1].toString(),this.lTDSPaidAmount=s[2].toString(),this.lTDSAmount=s[3].toString(),this.iComponentID=parseInt(s[4]),this.ButtonClick.Subscribe(this,"Button_Click"),this.LoadGrid(),this.dtpFromDate.Label="From Date",this.dtpFromDate.LblWidth="80",this.dtpFromDate.Date=new Date(parseInt(this.Parent.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth-1,1),this.dtpToDate.Label="To Date",this.dtpToDate.LblWidth="80",this.dtpToDate.Date=this.dtpFromDate.Date.AddYears(1).AddMonths(-1),this.Generate_Click(0),Logger.InfoLog("TDSPostingViewModel::Exiting TDSPostingViewModel()")}LoadGrid(){this.dgv=new ue.vv,this.dgv.Width="550",this.dgv.CanUserDeleteRows=!1,this.dgv.CanUserAddRows=!1,this.dgv.OnCellEditEnding.Subscribe(this,"dgv_EndEdit"),this.dgv.TableColumns.push("SNo"),this.dgv.TableColumns.push("Month"),this.dgv.TableColumns.push("Amount");let s=new L.O7;this.dgv.Columns=[],s=new L.O7,s.Header="#",s.DisplayMember="SNo",s.DataType="TextBlock",s.Width=40,s.ReadOnly=!0,this.dgv.Columns.push(s),s=new L.O7,s.Header="Month",s.DisplayMember="Month",s.DataType="TextBlock",s.Width=180,s.ReadOnly=!0,s.TextAlign="Center",this.dgv.Columns.push(s),s=new L.O7,s.Header="Amount",s.DisplayMember="Amount",s.DataType="TextBlock",s.Width=180,s.ReadOnly=!1,s.TextAlign="FLOAT",this.dgv.Columns.push(s),this.dgv.Columns[2].footer="0.00",this.dgv.UpdateFooter()}Button_Click(s){Logger.InfoLog("TDSPostingViewModel::Entering Button_Click"),"Post"==s.toString()?this.Post_Click():"Cancel"==s.toString()?o.d.page.HideDialog(this.PopUpGUID):"Generate"==s.toString()&&this.Generate_Click(1),Logger.InfoLog("TDSPostingViewModel::Exiting Button_Click")}Generate_Click(s){this.dgv.Clear();let l=new Date(parseInt(this.Parent.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth-1,1),t=l.AddYears(1).AddMonths(-1);if(this.dtpFromDate.Date<l||this.dtpFromDate.Date>t)return this.DisplayMessage="From Date should be in Between Finacial Year",void(this.MessageVisibility=!0);if(this.dtpToDate.Date<l||this.dtpToDate.Date>t)return this.DisplayMessage="To Date should be in Between Finacial Year",void(this.MessageVisibility=!0);let i=o.d.common.GetDataSet3("PAY122",this.Parent.Employee.SelectedValue,this.dtpFromDate.Date.ToString("dd MMM yyyy"),this.dtpToDate.Date.ToString("dd MMM yyyy"));if(0==s){if(null!=i&&i.length>0){let c=i.Compute("max","PayrollDate");m.J0.IsEmpty(c)||(this.dtpFromDate.Date=new Date(c))}}else if(1==s&&null!=i&&i.length>0)return this.DisplayMessage="Payroll Already Processed For the Month - "+new Date(i.Rows[0].PayrollDate).ToString("dd MMM yyyy"),void(this.MessageVisibility=!0);let n=null,r=0,d=0,C=0,h=this.dtpFromDate.Date;for(;h<=this.dtpToDate.Date;)r+=1,h=h.AddMonths(1);for(d=parseFloat(this.lTDSAmount)/r,d=parseFloat(d.ToString("0.00")),h=this.dtpFromDate.Date;h<=this.dtpToDate.Date;)n=this.dgv.NewRow(),n.SNo=this.dgv.Table.length+1,n.Month=h.ToString("dd MMM yyyy"),n.Amount=h.ToString("dd MMM yyyy")==this.dtpToDate.Date.ToString("dd MMM yyyy")?parseFloat(this.lTDSAmount)-C:d,this.dgv.addRow(n),C+=parseFloat(n.Amount),h=h.AddMonths(1);this.dgv.Columns[2].footer=C.ToString("0.00"),this.dgv.UpdateFooter()}Post_Click(){try{if(Logger.InfoLog("TDSPostingViewModel::Entering Post_Click()"),0==this.dgv.Table.length)return this.DisplayMessage="No Data to Post",void(this.MessageVisibility=!0);if(this.ValidatePosting()){let r,s="",l=0,t="0",i="0",n=o.d.common.GetScreenInfo(40068);r=n.Tables[0].filter(g=>"CreditAccount"==g.SysColumnName),null!=r&&r.length>0&&null!=r[0].UserDefaultValue&&""!=r[0].UserDefaultValue.toString().Trim()&&(t=r[0].UserDefaultValue.toString()),r=n.Tables[0].filter(g=>"DebitAccount"==g.SysColumnName),null!=r&&r.length>0&&null!=r[0].UserDefaultValue&&""!=r[0].UserDefaultValue.toString().Trim()&&(i=r[0].UserDefaultValue.toString()),r=n.Tables[0].filter(g=>"ProductID"==g.SysColumnName),null!=r&&r.length>0&&null!=r[0].UserDefaultValue&&""!=r[0].UserDefaultValue.toString().Trim()&&(l=parseInt(r[0].UserDefaultValue));let d=o.d.common.GetDataSet3("PAY123",this.Parent.Employee.SelectedValue,this.iComponentID.ToString(),this.iComponentID.ToString()),C="",h="",c=0;for(let g=0;g<this.dgv.Table.length;g++)if(C="",c=0,null!=this.dgv.Table[g].Amount&&null!=this.dgv.Table[g].Amount&&""!=this.dgv.Table[g].Amount.toString()&&null!=this.dgv.Table[g].Month&&null!=this.dgv.Table[g].Month&&""!=this.dgv.Table[g].Month.toString()){if(null!=d&&d.Tables.length>0){let e=d.Tables[0].filter(p=>new Date(p.dcAlpha2).ToString("dd MMM yyyy")==new Date(this.dgv.Table[g].Month).ToString("dd MMM yyyy")||new Date(p.dcAlpha4).ToString("dd MMM yyyy")==new Date(this.dgv.Table[g].Month).ToString("dd MMM yyyy"));null!=e&&e.length>0&&(h=e[0].InvDocDetailsID.toString(),c=parseInt(e[0].DocID))}C=h.length>0?'<XML SysInfo="'+o.d.SessionManager.GetSysInfo()+'" AP="Desktop" DetailIds="'+h+'"> </XML>':'<XML SysInfo="'+o.d.SessionManager.GetSysInfo()+'" AP="Desktop" > </XML>',s+="<ROWS>",s+="<DocumentXML>",s+=this.GetRecXML(new Date(this.dgv.Table[g].Month),new Date(this.dgv.Table[g].Month),parseFloat(this.dgv.Table[g].Amount),l,t,i,h),s+="</DocumentXML>",s+="<ActivityXML>",s+=C,s+="</ActivityXML>",s+="<DOCIDXML>",s+='<XML DOCID="'+c+'"></XML>',s+="</DOCIDXML>",s+="</ROWS>"}if(s.length>0&&s.length>0){s="<REC>"+s,s+="</REC>";let g=[];g.push(s.toString()),g.push(o.d.SessionManager.GetSysInfo()),g.push("Desktop"),g.push(o.d.SessionManager.UserID),g.push(o.d.SessionManager.LanguageID);let e=o.d.empService.ExecuteQuery_SP(g,"spPAY_PostTDSDoc");return null!=e&&e.Tables.length>0&&e.Tables[e.Tables.length-1].length>0&&e.Columns[e.Tables.length-1].Contains("ErrorMessage")?(this.DisplayMessage=e.Tables[e.Tables.length-1][0].ErrorMessage.toString(),void(this.MessageVisibility=!0)):(this.DisplayMessage="Problem in processing your request,Please contact administrator.",void(this.MessageVisibility=!0))}}Logger.InfoLog("TDSPostingViewModel::Exiting Post_Click()")}catch(s){Logger.ErrorLog("TDSPostingViewModel::EXCEPTION btnPost_Click()\r\n"+s.stack)}}ValidatePosting(){try{return Logger.InfoLog("TDSPostingViewModel::Entering ValidatePosting()"),parseFloat(this.dgv.Columns[2].footer)!=parseFloat(this.lTDSAmount)?(this.DisplayMessage="TDS Amount not Equal",this.MessageVisibility=!0,!1):this.iComponentID<=0?(this.DisplayMessage="TDS Component Should be Monthly Type",this.MessageVisibility=!0,!1):(Logger.InfoLog("TDSPostingViewModel::Exiting ValidatePosting()"),!0)}catch(s){return Logger.ErrorLog("TDSPostingViewModel::EXCEPTION ValidatePosting()\r\n"+s.stack),!1}}dgv_EndEdit(s,l,t){try{Logger.InfoLog("TDSPostingViewModel::Entering dgv_EndEdit()");let i=0;if(this.dgv.Table.length>0){for(let n=0;n<this.dgv.Table.length;n++)null!=this.dgv.Table[n].Amount&&null!=this.dgv.Table[n].Amount&&""!=this.dgv.Table[n].Amount.toString()&&(i+=parseFloat(this.dgv.Table[n].Amount));this.dgv.Columns[2].footer=i.ToString("0.00"),this.dgv.UpdateFooter()}Logger.InfoLog("TDSPostingViewModel::Exiting dgv_EndEdit()")}catch(i){Logger.ErrorLog("TDSPostingViewModel::EXCEPTION dgv_EndEdit()\r\n"+i.stack)}}GetRecXML(s,l,t,i,n,r,d){let C="",h="",c="",g="",e="",p="";return c+='<Alpha Query="',c+=" dcAlpha1=3,dcAlpha2='"+s.ToString("dd MMM yyyy")+"',dcAlpha3="+this.iComponentID+",dcAlpha4='"+l.ToString("dd MMM yyyy")+"', ",c+='" ></Alpha>',p="",e+='<CostCenters Query="',p+=" dcCCNID51="+this.Parent.Employee.SelectedValue+",",p.length>0&&(e+=p),e+='" ></CostCenters>',h+=d.length>0?'" DocDetailsID="'+d:'" DocDetailsID="',h+='" ProductID="'+i+'" Quantity="0',h+='" Unit="1" UOMConversion="1" UOMConvertedQty="0',h+='" Rate="0" Gross="0" IsQtyIgnored="1" AverageRate="0',h+='" StockValue="0" StockValueFC="0" RefNO="',h+='" BillDate="'+(new Date).ToString("dd/MMM/yyyy"),h+='" CurrencyID="1" ExchangeRate="1',h+='" DebitAccount="'+n+'" CreditAccount="'+r,h+='" CommonNarration="'+m.J0.EncodeXML(""),g+='<Numeric Query="',g+="dcNum1="+t+", dcCalcNum1="+t,g+='" ></Numeric>',C+="<Row>",C+="<AccountsXML></AccountsXML>",C+='<Transactions DocSeqNo="1',C+='" LinkedInvDocDetailsID="0" LinkedFieldName="',C+='" LineNarration="'+m.J0.EncodeXML(""),C+=h.toString()+'" ></Transactions>',C+=c.toString(),C+=g.toString(),C+=e.toString(),C+="<EXTRAXML></EXTRAXML>",C+="</Row>",C.toString()}}let cs=(()=>{class F{constructor(){this.form=new ae.gE({}),this.lblTotalTaxAmount="TOTAL INCOME TAX PAYABLE : ",this.lblTDSPaidAmount="TDS Paid : ",this.lblTDSAmount="Payable TDS Amount : "}ngOnInit(){}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-tds-posting"]],inputs:{obj:"obj"},decls:72,vars:21,consts:[[1,"master-screen",2,"padding-bottom","4px","width","700px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"row"],["FieldDirective","",3,"obj","group"],[2,"margin-left","12px"],[1,"form-group",2,"margin-left","12px"],[1,"primary-btn-wicon",3,"click"],[2,"padding-top","5px"],[2,"font-weight","bold","margin-left","10px"],[2,"padding-top","5px","margin-left","25px"],[1,"documentgrid","row","form-row",2,"width","100%","margin-top","5px"],[2,"width","100%",3,"obj","group"],[1,"Pactdailogfooter"],[1,"secondary-btn-wicon",3,"click"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n    "),a.j41(2,"div",1),a.EFF(3,"\n        "),a.j41(4,"div",2),a.EFF(5,"\n            "),a.j41(6,"div"),a.EFF(7,"\n            "),a.eu8(8,3),a.EFF(9,"\n        "),a.k0s(),a.EFF(10,"\n        "),a.j41(11,"div",4),a.EFF(12,"\n            "),a.eu8(13,3),a.EFF(14,"\n        "),a.k0s(),a.EFF(15,"\n        "),a.j41(16,"div",5),a.EFF(17,"\n            "),a.j41(18,"button",6),a.bIt("click",function(){return i.obj.Button_Click("Generate")}),a.EFF(19),a.nI1(20,"translate"),a.k0s(),a.EFF(21,"\n          "),a.k0s(),a.EFF(22,"\n        "),a.k0s(),a.EFF(23,"\n        "),a.j41(24,"div",2),a.EFF(25,"\n            "),a.j41(26,"div",7),a.EFF(27,"\n                "),a.j41(28,"label"),a.EFF(29),a.k0s(),a.j41(30,"label",8),a.EFF(31),a.k0s(),a.EFF(32,"\n            "),a.k0s(),a.EFF(33,"\n            "),a.j41(34,"div",9),a.EFF(35,"\n                "),a.j41(36,"label"),a.EFF(37),a.k0s(),a.j41(38,"label",8),a.EFF(39),a.k0s(),a.EFF(40,"\n            "),a.k0s(),a.EFF(41,"\n            "),a.j41(42,"div",9),a.EFF(43,"\n                "),a.j41(44,"label"),a.EFF(45),a.k0s(),a.j41(46,"label",8),a.EFF(47),a.k0s(),a.EFF(48,"\n            "),a.k0s(),a.EFF(49,"\n        "),a.k0s(),a.EFF(50,"\n        "),a.j41(51,"div",10),a.EFF(52,"\n            "),a.nrm(53,"app-PactGridView",11),a.EFF(54,"\n        "),a.k0s(),a.EFF(55,"\n\n\n        "),a.j41(56,"div",12),a.EFF(57,"\n            "),a.j41(58,"div"),a.EFF(59,"\n                "),a.j41(60,"button",6),a.bIt("click",function(){return i.obj.Button_Click("Post")}),a.EFF(61),a.nI1(62,"translate"),a.k0s(),a.EFF(63,"\n                "),a.j41(64,"button",13),a.bIt("click",function(){return i.obj.Button_Click("Cancel")}),a.EFF(65),a.nI1(66,"translate"),a.k0s(),a.EFF(67,"\n            "),a.k0s(),a.EFF(68,"\n        "),a.k0s(),a.EFF(69,"\n    "),a.k0s(),a.EFF(70,"\n"),a.k0s(),a.EFF(71,"\n")),2&t&&(a.R7$(8),a.Y8G("obj",i.obj.dtpFromDate)("group",i.form),a.R7$(5),a.Y8G("obj",i.obj.dtpToDate)("group",i.form),a.R7$(6),a.JRh(a.bMT(20,15,"Generate")),a.R7$(10),a.JRh(i.lblTotalTaxAmount),a.R7$(2),a.JRh(i.obj.lTotalTaxAmount),a.R7$(6),a.JRh(i.lblTDSPaidAmount),a.R7$(2),a.JRh(i.obj.lTDSPaidAmount),a.R7$(6),a.JRh(i.lblTDSAmount),a.R7$(2),a.JRh(i.obj.lTDSAmount),a.R7$(6),a.Y8G("obj",i.obj.dgv)("group",i.form),a.R7$(8),a.JRh(a.bMT(62,17,"Post")),a.R7$(4),a.JRh(a.bMT(66,19,"Close")))},dependencies:[ye._,Ne.X,De.D9]})}return F})();class Vt extends Re.g{constructor(){super(...arguments),this.CostCenterID=0,this.MessageDisplay="",this.TypeID=0,this.Employee=new Qe.G(0),this.TDSPostVisiblility=!1,this.PrintVisiblility=!1,this.ExportVisiblility=!1,this.WorksheetVisiblility=!1,this.txtDesignation="",this.dtPayrollTaxCmptsObj=new ue.vv,this.Savereturnvalue=0,this.dsITComputation=null,this.sbComputationData="",this.sbValidation="",this.dPayableTDSAmount=0,this.dTotalTaxAmount=0,this.dTDSPaidAmount=0,this.iCompnentID=0,this.objTDSVM=null}get CCID(){return this.CostCenterID}set CCID(s){this.CostCenterID=s}get lFinancialDate(){return this._lFinancialDate}set lFinancialDate(s){s!=this._lFinancialDate&&(this._lFinancialDate=s)}get ScreenObject(){return this._ScreenObject}set ScreenObject(s){this._ScreenObject=s}get dtPayrollTaxCmpts(){return this.dtPayrollTaxCmptsObj.Table}get PayrollColumnSourceTaxComponents(){return this.dtPayrollTaxCmptsObj.Columns}IncomeTaxComputationViewModel(){Logger.InfoLog("ITComputationViewModel::Entering ITComputationViewModel"),this.objEmp=new Nt.h,this.ScreenObject=new Rt.a(0,0),this.ScreenObject.Data=[],this.TDSPostVisiblility=o.d.SessionManager.IsActionAssigned(264,"TDS Posting"),this.PrintVisiblility=o.d.SessionManager.IsActionAssigned(264,"Print"),this.ExportVisiblility=o.d.SessionManager.IsActionAssigned(264,"Export"),this.WorksheetVisiblility=o.d.SessionManager.IsActionAssigned(264,"WorkSheet"),this.EmpYear=new X.y$(0);for(let s=2e3;s<2100;s++){let l=X._p.ComboBoxItems_2(s.toString(),s.toString());this.EmpYear.Items.push(l)}this.EmpYear.SelectedValue=m.J0.ParseDate(o.d.SessionManager.PayrollMonth).ToString("yyyy"),this.lFinancialDate=this.GetFinancialYear(),this.EmpRegime=new X.y$(0),this.EmpRegime.Items.push(X._p.ComboBoxItems_2("Old","Old")),this.EmpRegime.Items.push(X._p.ComboBoxItems_2("New","New")),this.Employee.Visible=!0,this.Employee.Code.TypeID=4,this.Employee.Name.TypeID=1,this.Employee.Code.Visible=this.Employee.Name.Visible=!1,this.Employee.Code.Column=0,this.Employee.Name.Column=1,this.Employee.Code.Visible=!0,this.Employee.Name.Visible=!0,this.Employee.Code.CCID=this.Employee.Name.CCID=50051,this.Employee.Code.Visible&&(this.Employee.Code.CCID=50051,this.Employee.Code.TypeID=4),this.Employee.Name.Visible&&(this.Employee.Name.CCID=50051,this.Employee.Name.TypeID=1),this.FilterEmployees(),this.dtPayrollTaxCmptsObj.Table=[],this.dtPayrollTaxCmptsObj.Columns=[],Logger.InfoLog("ITComputationViewModel::Exiting ITComputationViewModel")}GetFinancialYear(){let s="",l=new Date(parseInt(this.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth,1),t=l.AddYears(1).AddMonths(-1);return s=this.ScreenObject.GetMonthName(l.getMonth(),!1)+" "+l.getFullYear()+" - "+this.ScreenObject.GetMonthName(t.getMonth(),!1)+" "+t.getFullYear(),s}Employee_SelectedValueChanged(s){this.dsITComputation=o.d.empService.GetIncomeTaxCalcDetails(parseInt(this.EmpYear.SelectedValue),this.Employee.SelectedValue,o.d.SessionManager.AccountingFromMonth),this.GetResPerson()}GetResPerson(){this.lstResponsiblePerson=new us,this.txtDesignation="";let t,i,s=" 1=1 ",l="";if(o.d.SessionManager.Preferences.ContainsKey("IncomeTaxResponsibleBasedOn")&&""!=o.d.SessionManager.Preferences.ContainsKey("IncomeTaxResponsibleBasedOn").toString()&&o.d.SessionManager.Preferences.ContainsKey("IncomeTaxResponsibleBasedOnXML")&&""!=o.d.SessionManager.Preferences.IncomeTaxResponsibleBasedOnXML&&o.d.SessionManager.Preferences.IncomeTaxResponsibleBasedOnXML.length>0){t=new m.VB,t.ReadXml(o.d.SessionManager.Preferences.IncomeTaxResponsibleBasedOnXML),i=t.Tables[0];let r=o.d.SessionManager.Preferences.IncomeTaxResponsibleBasedOn.split(",");if(null!=r&&r.length>0)for(let d=0;d<r.length;d++)if(null!=r[d]&&""!=r[d]&&(l="CCNID"+(parseInt(r[d])-5e4),null!=this.dsITComputation&&this.dsITComputation.Tables.length>27&&this.dsITComputation.Tables[27].length>0)){let C=this.dsITComputation.Tables[27].filter(h=>h.NodeID=this.Employee.SelectedValue);null!=C&&C.length>0&&(s+=" AND ( dc"+l+"="+C[0][l]+" )",i=i.filter(h=>h["dc"+l]==C[0][l]))}}let n="";if(" 1=1 "!=s&&(n=i),null!=n&&n.length>0){this.lstResponsiblePerson.SelectedValue=n[0].ResponsiblePerson.toString();let r=o.d.common.GetDataSet("PAY070",this.lstResponsiblePerson.SelectedValue.toString());null!=r&&r.Tables[0].length>0&&(this.lstResponsiblePerson.Text=r.Tables[0][0].Name.toString(),this.lstResponsiblePerson.Tag=r.Tables[0][0].FHName.toString(),this.txtDesignation=r.Tables[0][0].Designation.toString())}}OnYearSelected(s){this.FilterEmployees(),this.dsITComputation=o.d.empService.GetIncomeTaxCalcDetails(parseInt(this.EmpYear.SelectedValue),this.Employee.SelectedValue,o.d.SessionManager.AccountingFromMonth),this.GetResPerson()}OnSaveITComputation(s){try{Logger.InfoLog("ITComputationViewModel::Entering OnSaveITComputation()"),this.sbValidation?this.DisplayMessage=this.sbValidation.toString():o.d.empService.SaveEmpTaxComputation(parseInt(this.EmpYear.SelectedValue),this.Employee.SelectedValue,this.sbComputationData.toString()).subscribe(l=>{this.DisplayMessage=l.Message,this.Savereturnvalue=l.RetValue})}catch(l){Logger.ErrorLog("ITComputationViewModel::EXCEPTION OnSaveITComputation()"+l.stack)}}OnDeleteITComputation(s){try{this.sbValidation?this.DisplayMessage=this.sbValidation.toString():o.d.empService.DeleteEmpTaxComputation(parseInt(this.EmpYear.SelectedValue),this.Employee.SelectedValue).subscribe(l=>{this.DisplayMessage=l.Message,this.Savereturnvalue=l.RetValue})}catch(l){Logger.ErrorLog("ITComputationViewModel::EXCEPTION OnDeleteITComputation()"+l.stack)}}OnSaveRegimeITComputation(s){try{Logger.InfoLog("ITComputationViewModel::Entering OnSaveRegimeITComputation()"),this.sbValidation?(this.DisplayMessage=this.sbValidation.toString(),this.MessageVisibility=!0):null!=this.EmpRegime.SelectedValue?(o.d.common.GetDataSet3("PAY121",this.EmpRegime.SelectedValue,this.Employee.SelectedValue.toString(),this.EmpYear.SelectedValue),this.DisplayMessage="Updated Succesfully",this.MessageVisibility=!0):(this.DisplayMessage="Please select RegimeType",this.MessageVisibility=!0)}catch(l){Logger.ErrorLog("ITComputationViewModel::EXCEPTION OnSaveRegimeITComputation()"+l.stack)}}OnTDSPostITComputation(s){try{if(Logger.InfoLog("ITComputationViewModel::Entering OnTDSPostITComputation()"),!this.DisplayMessage){let l=[];l.push(this),l.push(this.dTotalTaxAmount),l.push(this.dTDSPaidAmount),l.push(this.dPayableTDSAmount),l.push(this.iCompnentID),this.objTDSVM=new ps(l),o.d.page.ShowDialog(this.objTDSVM,cs,{ShowCenter:!0,Title:"TDS Posting"}).subscribe(()=>{})}Logger.InfoLog("ITComputationViewModel::Exiting OnTDSPostITComputation()")}catch(l){Logger.ErrorLog("ITComputationViewModel::EXCEPTION OnTDSPostITComputation()"+l.stack)}}FilterEmployees(){try{Logger.InfoLog("ITComputationViewModel::Entering FilterEmployees()");let l,t,s="";l=new Date(parseInt(this.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth-1,1),t=new Date(o.d.SessionManager.AccountingFromMonth>1?parseInt(this.EmpYear.SelectedValue)+1:parseInt(this.EmpYear.SelectedValue),o.d.SessionManager.AccountingToMonth-1,1),t=t.AddMonths(1).AddDays(-1),s=" ( a.StatusID=250 AND (ISNULL(CONVERT(DATETIME,a.DORelieve),'01-Jan-9000')='01-Jan-9000') ",s=s+" or (Year(CONVERT(DATETIME,'"+t.ToString("dd/MMM/yyyy")+"'))<=Year(CONVERT(DATETIME,a.DORelieve)) and CONVERT(DATETIME,'"+l.ToString("dd/MMM/yyyy")+"')<=CONVERT(DATETIME,a.DORelieve)) ",s=s+" or ( CONVERT(DATETIME,'"+l.ToString("dd/MMM/yyyy")+"')<=CONVERT(DATETIME,a.DORelieve))) ",o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(s=s+" AND a.NodeID IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(s+="  AND a.NodeID IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")"),o.d.SessionManager.IsRptManagerUser&&o.d.SessionManager.IsActionAssigned(264,"Do not show sub ordinates Data")&&(s+="  AND a.NodeID IN ("+o.d.SessionManager.iEmployee+")"),this.Employee.Code.CustomWhere=this.Employee.Name.CustomWhere=s,Logger.InfoLog("ITComputationViewModel::Exiting FilterEmployees()")}catch(s){Logger.ErrorLog("ITComputationViewModel::EXCEPTION FilterEmployees()"+s.stack)}}}class us{}var Te=V(71336),ht=V(78324),Ie=V(9524),Pe=V(38859),Ds=V(35620);function Ts(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",27),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.PrintForm16_Click("PrintForm16"))}),a.nrm(1,"i",28),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Print")))}function Is(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",6),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.btnSave_Click("Export"))}),a.nrm(1,"i",29),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"Export")))}function Ps(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",6),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.btnSave_Click("Worksheet"))}),a.nrm(1,"i",29),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"WorkSheet")))}function ys(F,s){if(1&F){const l=a.RV6();a.j41(0,"span",6),a.bIt("click",function(){a.eBV(l);const i=a.XpG();return a.Njj(i.btnSave_Click("TDSPost"))}),a.nrm(1,"i",7),a.EFF(2),a.nI1(3,"translate"),a.k0s()}2&F&&(a.R7$(2),a.JRh(a.bMT(3,1,"TDSPost")))}let Ms=(()=>{class F{constructor(){this.form=new ae.gE({}),this.prevSelectedEmp=0,this.iSelectedEmpSeqNo=0,this.prevSelectReperson=0,this.BasicIndex=-1,this.TotalSalaryIndex=0,this.Form12Section1Index=0,this.Form12Section2Index=0,this.Exemptionsunder10Index=0,this.HRA10BasicIndex=0,this.HRAAcutalIndex=0,this.HRAMetroNonMetroIndex=0,this.HRAExemptionIndex=0,this.TDSPaidIndex=0,this.NetTaxPayableIndex=0,this.InhandAmountIndex=0,this.MonthlyDeducIndex=0,this.intTotalIncometaxPayableindex=0,this.TotAmtOthExemptUs10Index=0,this.ConveyanceIndex=0,this.ChildrenEduIndex=0,this.StandardDedIndex=0,this.MedicalIndex=0,this.LTAIndex=0,this.LeaveEncashIndex=0,this.FoodIndex=0,this.GratuityIndex=0,this.BalanceSalInc12BAIndex=0,this.ProfessionalTaxIndex=0,this.NetTaxableSalIndex=0,this.GrossTotalIncomeIndex=0,this.IncomefromHousePropertyIndex=0,this.intDeducunder8oCto80CCCIndex=0,this.intTotalDeducunder8oCto80CCCIndex=0,this.intOtherDeducunder8oCto80CCCIndex=0,this.dblTotalIncomeIndex=0,this.dblTotalIncomeRoundoffIndex=0,this.intOtherDeducunder8oCto80CCCIndex1=0,this.dblTaxOnTotalIncomeIndex=0,this.dblRebateIndex=0,this.dblTaxPayableAfterRebateIndex=0,this.dblSurchargeIndex=0,this.dblTaxPayableIndex=0,this.dblEducationCessIndex=0,this.dblSecHighEduCessIndex=0,this.NewStandardDedIndex=0,this.NewRegimeStartIndex=0,this.intNewDeducunder8oCto80CCCIndex=0,this.intNewTotalDeducunder8oCto80CCCIndex=0,this.intNewOtherDeducunder8oCto80CCCIndex1=0,this.dblNewTotalIncomeIndex=0,this.dblNewTotalIncomeRoundoffIndex=0,this.dblNewTaxOnTotalIncomeIndex=0,this.dblNewRebateIndex=0,this.dblNewTaxPayableAfterRebateIndex=0,this.dblNewSurchargeIndex=0,this.dblNewTaxPayableIndex=0,this.dblNewEducationCessIndex=0,this.dblNewSecHighEduCessIndex=0,this.intNewTotalIncometaxPayableindex=0,this.NewTDSPaidIndex=0,this.NewNetTaxPayableIndex=0,this.NewNetTaxableSalIndex=0,this.NewGrossTotalIncomeIndex=0,this.intNewOtherDeducunder8oCto80CCCIndex=0,this.dblbalanceSalaryInc12BA=0,this.dblTotalCellSalary=0,this.dPerq1=0,this.dPerq2=0,this.HraMinValue=0,this.dblMedicalAmount=0,this.dblLTAAmount=0,this.dblLeaveEncashAmount=0,this.dblFoodAmount=0,this.dblGratuityAmount=0,this.dblTotaldeduction80ccc80c=0,this.dblNetTaxableSal=0,this.dblGrossTotalIncome=0,this.dblTDS=0,this.dblNetTaxPayable=0,this.dblInhandAmount=0,this.dblSelfletoutamount=0,this.dblTotalIncome=0,this.dblTotalIncomeRoundoff=0,this.dblServiceDays=0,this.dblStandardDeduction=0,this.dblNewStandardDeduction=0,this.dblNewTotaldeduction80ccc80c=0,this.dblNewTotalIncome=0,this.dblNewTotalIncomeRoundoff=0,this.dblNewSelfletoutamount=0,this.dblNewGrossTotalIncome=0,this.dblNewNetTaxableSal=0,this.lstTaxSalbs=new Array,this.lstNewTaxSalbs=new Array,this.bIsNewRegime=!1,this.txtPlace=new ee.Dw,this.dvTaxSlabsData=[],this.dvLimitData=[],this.dtpDate=new we.Lc}ngOnInit(){this.obj=this.params.obj,this.grdIncomeTax=new ht.j,this.grdIncomeTax.ItComput=!0,this.ITComputationViewModel=this.obj,this.BindGridColumns(),this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.ITComputationViewModel.EmpYear.SelectionChangedCommand.Subscribe(this,"cmbYear_SelectionChanged"),this.lstEmployee.SelectionChangedCommand.Subscribe(this,"lstEmployee_SelectionChanged"),this.dtpDate=new we.Lc,o.d.page.MaximizeTab(this.obj),this.MessageDisplay=""}set MessageDisplay(l){this.ITComputationViewModel.DisplayMessage=l}BindGridColumns(){try{let l=new Pe.bA;l.Alignment="Center",l.FontFamilyName="Arial",l.FontSize=12,l.IsBold=!0,l.BackColor="White",l.ForeColor="Black",l.IsVisible=!0;let i,t=new Pe.bA;t.Alignment="Left",t.FontFamilyName="Arial",t.FontSize=11,t.IsBold=!1,t.BackColor="White",t.ForeColor="#FF333333",i=new Ie.D_,i.HeaderText="SNo",i.width=10,i.HeaderAppearance=new Pe.bA,i.HeaderAppearance.IsVisible=!1,i.HeaderAppearance.Alignment="Center",i.HeaderAppearance.FontFamilyName="Arial",i.HeaderAppearance.FontSize=12,i.HeaderAppearance.IsBold=!0,i.HeaderAppearance.BackColor="White",i.HeaderAppearance.ForeColor="Black",i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),i=new Ie.D_,i.HeaderText="Header",i.width=20,i.HeaderAppearance=new Pe.bA,i.HeaderAppearance.IsVisible=!1,i.HeaderAppearance.Alignment="Center",i.HeaderAppearance.FontFamilyName="Arial",i.HeaderAppearance.FontSize=12,i.HeaderAppearance.IsBold=!0,i.HeaderAppearance.BackColor="White",i.HeaderAppearance.ForeColor="Black",i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),i=new Ie.D_,i.HeaderText="ComponentID",i.width=25,i.HeaderAppearance=new Pe.bA,i.HeaderAppearance.IsVisible=!1,i.HeaderAppearance.Alignment="Center",i.HeaderAppearance.FontFamilyName="Arial",i.HeaderAppearance.FontSize=12,i.HeaderAppearance.IsBold=!0,i.HeaderAppearance.BackColor="White",i.HeaderAppearance.ForeColor="Black",i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),i=new Ie.D_,i.HeaderText="Salary Breakup",i.width=220,i.HeaderAppearance=l,i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),i=new Ie.D_,i.HeaderText="Investment & Bill Details",i.width=100,i.HeaderAppearance=l,i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i);let e,n=0,r=0,d=0,C=0,h=0,c=0,g=0;h=o.d.SessionManager.FinancialYearStartDate.getFullYear(),e=h.toString(),h=parseInt(e.substr(2,2)),c=h+1,n=o.d.SessionManager.AccountingFromMonth,C=n,g=1==C?12:15;for(let p=C;p<=g;p++)if(12==r){d=r-p;for(let u=1;u<=d;u++)i=new Ie.D_,i.HeaderText=this.GetMonthName(u,!1),i.width=65,i.HeaderAppearance=l,i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),p+=1}else i=new Ie.D_,r=n,i.HeaderText=this.GetMonthName(p,!1),i.width=65,i.HeaderAppearance=l,i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i);i=new Ie.D_,i.HeaderText="RegimeType",i.width=25,i.HeaderAppearance=new Pe.bA,i.HeaderAppearance.IsVisible=!1,i.HeaderAppearance.Alignment="Center",i.HeaderAppearance.FontFamilyName="Arial",i.HeaderAppearance.FontSize=12,i.HeaderAppearance.IsBold=!0,i.HeaderAppearance.BackColor="White",i.HeaderAppearance.ForeColor="Black",i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),i=new Ie.D_,i.HeaderText="Amount",i.width=100,i.HeaderAppearance=l,i.DataAppearance=t,this.grdIncomeTax.ReportColumns.push(i),this.grdIncomeTax.ReportColumns.forEach(p=>p.ID=m.J0.NewGuid())}catch(l){Logger.ErrorLog("Error : "+l),this.MessageDisplay=l.message}}get lstEmployee(){return this.ITComputationViewModel.Employee.Code}get lstEmployeeName(){return this.ITComputationViewModel.Employee.Name}get cmbYear(){return this.ITComputationViewModel.EmpYear}get cmbRegime(){return this.ITComputationViewModel.EmpRegime}clear(l){this.MessageDisplay="",this.prevSelectedEmp=0,this.prevSelectReperson=0,this.dblbalanceSalaryInc12BA=this.dblTotalCellSalary=this.dPerq1=this.dPerq2=this.HraMinValue=this.dblMedicalAmount=this.dblLTAAmount=this.dblLeaveEncashAmount=this.dblFoodAmount=this.dblGratuityAmount=0,this.dblTotaldeduction80ccc80c=this.dblNetTaxableSal=this.dblGrossTotalIncome=this.dblTotalIncome=this.dblTotalIncomeRoundoff=this.dblServiceDays=this.dblTDS=this.dblNetTaxPayable=this.dblInhandAmount=0,this.dblStandardDeduction=0,this.cmbRegime.SelectedValue="",this.grdIncomeTax.Clear(),this.ITComputationViewModel.txtDesignation="",1==l&&(this.lstEmployee.SelectedValue=this.lstEmployeeName.SelectedValue=this.ITComputationViewModel.lstResponsiblePerson.SelectedValue=null,this.lstEmployee.SelectedValue=this.lstEmployeeName.SelectedValue=this.ITComputationViewModel.lstResponsiblePerson.SelectedValue=null)}btnSave_Click(l){if(null!=l)try{if("Clear"==l)this.clear(1);else if("Save"==l)try{let t=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let i=0,n=0,r=0,d="";if(0==t.length){d+="<Rows>";for(let C=0;C<this.grdIncomeTax.Data.length;C++)null!=this.grdIncomeTax.Data[C].Cells[1].Value&&(d+='<row HeaderID="'+this.grdIncomeTax.Data[C].Cells[1].Value,parseFloat(this.grdIncomeTax.Data[C].Cells[2].Value)<0?d+='" HeaderName="'+this.grdIncomeTax.Data[C].Cells[3].Value:d+='" HeaderName="',d+='" ComponentID="'+this.grdIncomeTax.Data[C].Cells[2].Value,i=m.J0.Double(this.grdIncomeTax.Data[C].Cells[4].Value),d+=i>=0?'" ComponentAmount="'+i:'" ComponentAmount="-1',null!=this.grdIncomeTax.Data[C].Cells[17].Value?(r=m.J0.Int(this.grdIncomeTax.Data[C].Cells[17].Value),d+=r>=0?'" RegimeType="'+r:'" RegimeType="0'):d+='" RegimeType="0',n=m.J0.Double(this.grdIncomeTax.Data[C].Cells[17].Value),d+='" TotalAmount="'+n,d+='"/>');d+="</Rows>",this.ITComputationViewModel.sbComputationData=d,this.clear(1)}else d+=t,this.ITComputationViewModel.sbValidation=d;this.ITComputationViewModel.OnSaveITComputation(l)}catch(t){Logger.ErrorLog("Error : "+t)}else if("Delete"==l)try{let t=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let i="";0==t.length?(this.ITComputationViewModel.sbComputationData=i,this.clear(1)):(i+=t,this.ITComputationViewModel.sbValidation=i),this.ITComputationViewModel.OnDeleteITComputation(l)}catch(t){Logger.ErrorLog("Error : "+t)}else if("Export"==l){let t=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let i="";0==t.length?(this.ITComputationViewModel.sbComputationData=i,this.ExportToExcel()):(i+=t,this.ITComputationViewModel.sbValidation=i)}else if("Worksheet"==l){if(null==this.dtpDate.Date&&(this.dtpDate.Date=new Date),!(this.lstEmployee.SelectedValue>0))return this.ITComputationViewModel.DisplayMessage="Select any Employee",void(this.ITComputationViewModel.MessageVisibility=!0);this.txtPlace.Text.Trim(),this.dtpDate.Date.ToString("dd/MMM/yyyy"),this.WorkSheetPrintGrid(),this.Form16export()}else if("SaveRegime"==l)try{let t=this.ValidateData();this.ITComputationViewModel.sbValidation=null,this.ITComputationViewModel.sbComputationData=null;let i="";0==t.length?this.ITComputationViewModel.sbComputationData=i:(i+=t,this.ITComputationViewModel.sbValidation=i),this.ITComputationViewModel.OnSaveRegimeITComputation(l)}catch(t){Logger.ErrorLog("Error : "+t)}else if("TDSPost"==l)try{if(!(this.iSelectedEmpSeqNo>0))return this.ITComputationViewModel.DisplayMessage="Select any Employee",void(this.ITComputationViewModel.MessageVisibility=!0);if(this.dvEmpTaxComputation=this.dsTaxData.Tables[21],!(null!=this.dvEmpTaxComputation&&this.dvEmpTaxComputation.length>0))return this.ITComputationViewModel.DisplayMessage="Please Save Income Tax Computation",void(this.ITComputationViewModel.MessageVisibility=!0);if(this.dvEmpTaxComputation.RowFilter="",null==this.cmbRegime.SelectedValue)return this.ITComputationViewModel.DisplayMessage="Please Save Regime Opted For",void(this.ITComputationViewModel.MessageVisibility=!0);if(this.dvEmpTaxComputation="New"==this.cmbRegime.SelectedValue.toString()?this.dsTaxData.Tables[21].filter(t=>-122==t.ComponentID&&1==t.RegimeType):this.dsTaxData.Tables[21].filter(t=>-122==t.ComponentID&&0==t.RegimeType),this.dvEmpTaxComputation.length>0&&(this.ITComputationViewModel.dTotalTaxAmount=parseFloat(this.dvEmpTaxComputation[0].TotalAmount)),this.dvEmpTaxComputation="New"==this.cmbRegime.SelectedValue.toString()?this.dsTaxData.Tables[21].filter(t=>-123==t.ComponentID&&1==t.RegimeType):this.dsTaxData.Tables[21].filter(t=>-123==t.ComponentID&&0==t.RegimeType),this.dvEmpTaxComputation.length>0&&(this.ITComputationViewModel.dTDSPaidAmount=parseFloat(this.dvEmpTaxComputation[0].TotalAmount)),this.dvEmpTaxComputation="New"==this.cmbRegime.SelectedValue.toString()?this.dsTaxData.Tables[21].filter(t=>-124==t.ComponentID&&1==t.RegimeType):this.dsTaxData.Tables[21].filter(t=>-124==t.ComponentID&&0==t.RegimeType),this.dvEmpTaxComputation.length>0&&(this.ITComputationViewModel.dPayableTDSAmount=parseFloat(this.dvEmpTaxComputation[0].TotalAmount)),null!=this.dsTaxData&&this.dsTaxData.Tables.length>19&&this.dsTaxData.Tables[19].length>0){let t=this.dsTaxData.Tables[19].filter(i=>"TDS"==i.TaxmapName&&"Monthly"==i.FieldType);null!=t&&t.length>0&&(this.ITComputationViewModel.iCompnentID=parseInt(t[0].componentID))}this.ITComputationViewModel.OnTDSPostITComputation(l)}catch{}}catch(t){Logger.ErrorLog("Error : "+t),this.MessageDisplay=t.message}}WorkSheetPrintGrid(){this.grdPrint=new ht.j,this.grdPrint.Data.Clear(),this.grdPrint.ReportColumns.Clear();let l=new Pe.bA;l.Alignment="Center",l.FontFamilyName="Arial",l.FontSize=12,l.IsBold=!0,l.BackColor="White",l.ForeColor="Black",l.IsVisible=!0;let i,t=new Pe.bA;t.Alignment="Left",t.FontFamilyName="Arial",t.FontSize=12,t.IsBold=!0,t.BackColor="White",t.ForeColor="#FF333333";for(let r=1;r<=10;r++)i=new Ie.D_,i.FieldName="Col"+r.toString(),i.width=70,i.HeaderText="Col"+r.toString(),i.HeaderAppearance=l,i.DataAppearance=t,this.grdPrint.ReportColumns.push(i);this.grdPrint.ReportColumns[0].width=60,this.grdPrint.ReportColumns[3].width=90,this.grdPrint.ReportColumns[4].width=90,this.grdPrint.ReportColumns[5].width=90,this.grdPrint.ReportColumns[6].width=80,this.grdPrint.ReportColumns[7].width=80,this.grdPrint.ReportColumns[8].width=80,this.grdPrint.ReportColumns[9].width=80;let n=0;this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[n].Cells[0].Value="WorkSheet\nEmployee Code : "+this.ITComputationViewModel.Employee.Code.Text+", Employee Name : "+this.ITComputationViewModel.Employee.Name.Text+"\nFinancial Year : "+this.dtFromMonth.getFullYear()+" - "+this.dtToMonth.getFullYear()+", Assessment Year : "+this.dtFromMonth.AddYears(1).getFullYear()+" - "+this.dtToMonth.AddYears(1).getFullYear(),this.grdPrint.Data[n].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[0].ColSpan=10,n++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[n].Cells[0].Value="Salary Breakup",this.grdPrint.Data[n].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[0].ColSpan=5,this.grdPrint.Data[n].Cells[5].Value="Investment & Bill Details",this.grdPrint.Data[n].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[5].ColSpan=1,this.grdPrint.Data[n].Cells[6].Value="Post Past",this.grdPrint.Data[n].Cells[6].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[6].ColSpan=1,this.grdPrint.Data[n].Cells[7].Value="Actual",this.grdPrint.Data[n].Cells[7].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[7].ColSpan=1,this.grdPrint.Data[n].Cells[8].Value="Projection",this.grdPrint.Data[n].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[8].ColSpan=1,this.grdPrint.Data[n].Cells[9].Value="Amount",this.grdPrint.Data[n].Cells[9].CellAppearance.Alignment="Center",this.grdPrint.Data[n].Cells[9].ColSpan=1;for(let r=0;r<this.grdIncomeTax.Data.length;r++){let d;n++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[n].Cells[0].Value=null!=this.grdIncomeTax.Data[r].Cells[3].Value&&""!=this.grdIncomeTax.Data[r].Cells[3].Value.toString()?this.grdIncomeTax.Data[r].Cells[3].Value:"",this.grdPrint.Data[n].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[n].Cells[0].ColSpan=5,this.grdPrint.Data[n].Cells[5].Value=null!=this.grdIncomeTax.Data[r].Cells[4].Value&&""!=this.grdIncomeTax.Data[r].Cells[4].Value.toString()&&m.J0.DoubleTryParse(this.grdIncomeTax.Data[r].Cells[4].Value.toString())?parseFloat(this.grdIncomeTax.Data[r].Cells[4].Value).toString():"",this.grdPrint.Data[n].Cells[5].CellAppearance.Alignment="Right",this.grdPrint.Data[n].Cells[5].ColSpan=1;let C=0,h=0,c=0;for(let g=5;g<this.grdIncomeTax.ReportColumns.length;g++)null!=this.grdIncomeTax.ReportColumns[g].Tag&&null!=this.grdIncomeTax.ReportColumns[g].Tag&&""!=this.grdIncomeTax.ReportColumns[g].Tag.toString()&&("Past"==this.grdIncomeTax.ReportColumns[g].Tag?(d=m.J0.DoubleTryParse(this.grdIncomeTax.Data[r].Cells[g].Value.toString()),C+=null!=this.grdIncomeTax.Data[r].Cells[g].Value&&""!=this.grdIncomeTax.Data[r].Cells[g].Value.toString()&&m.J0.DoubleTryParse(this.grdIncomeTax.Data[r].Cells[g].Value.toString())?parseFloat(this.grdIncomeTax.Data[r].Cells[g].Value):0):"Processed"==this.grdIncomeTax.ReportColumns[g].Tag?h+=null!=this.grdIncomeTax.Data[r].Cells[g].Value&&""!=this.grdIncomeTax.Data[r].Cells[g].Value.toString()&&m.J0.DoubleTryParse(this.grdIncomeTax.Data[r].Cells[g].Value.toString())?parseFloat(this.grdIncomeTax.Data[r].Cells[g].Value):0:"Future"==this.grdIncomeTax.ReportColumns[g].Tag&&(c+=null!=this.grdIncomeTax.Data[r].Cells[g].Value&&""!=this.grdIncomeTax.Data[r].Cells[g].Value.toString()&&m.J0.DoubleTryParse(this.grdIncomeTax.Data[r].Cells[g].Value.toString())?parseFloat(this.grdIncomeTax.Data[r].Cells[g].Value):0));this.grdPrint.Data[n].Cells[6].Value=r<=this.TotalSalaryIndex||r>this.MonthlyDeducIndex?C.toString():"",this.grdPrint.Data[n].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[n].Cells[6].ColSpan=1,this.grdPrint.Data[n].Cells[7].Value=r<=this.TotalSalaryIndex||r>this.MonthlyDeducIndex?h.toString():"",this.grdPrint.Data[n].Cells[7].CellAppearance.Alignment="Right",this.grdPrint.Data[n].Cells[7].ColSpan=1,this.grdPrint.Data[n].Cells[8].Value=r<=this.TotalSalaryIndex||r>this.MonthlyDeducIndex?c.toString():"",this.grdPrint.Data[n].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[n].Cells[8].ColSpan=1,15!=r&&41!=r&&(this.grdPrint.Data[n].Cells[9].Value=null!=this.grdIncomeTax.Data[r].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[r].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[r].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00"),this.grdPrint.Data[n].Cells[9].CellAppearance.Alignment="Right",this.grdPrint.Data[n].Cells[9].ColSpan=1}}ExportToExcel(){this.export()}export(){var l=this;return(0,B.A)(function*(){let t="Income Tax Computation\nEmployee Code : "+l.ITComputationViewModel.Employee.Code.Text+", Employee Name : "+l.ITComputationViewModel.Employee.Name.Text+"\nFinancial Year : "+l.dtFromMonth.getFullYear()+" - "+l.dtToMonth.getFullYear()+", Assessment Year : "+(l.dtFromMonth.getFullYear()+1)+" - "+(l.dtToMonth.getFullYear()+1),i=l.generatePrintContent(l.grdIncomeTax,t,!0);const n=new Blob([i],{type:"text/plain;charser=utf-8"});(0,nt.saveAs)(n,"ITFile.xls")})()}Form16export(){var l=this;return(0,B.A)(function*(){let t=l.generatePrintContent(l.grdPrint,"",!1,!0);const i=new Blob([t],{type:"text/plain;charser=utf-8"});(0,nt.saveAs)(i,"TAX_PLACE_DATE_Form.xls")})()}getExcelColumnName(l){let n,t=l+1,i="";for(;t>0;)n=(t-1)%26,i=String.fromCharCode(65+n)+i,t=Math.floor((t-n)/26);return i}GetExportHTML(l){Logger.InfoLog("PostedDocumentViewModel:: inside GetExportHTML ");let t="",i="";t+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",i+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",i+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",i+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",i+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",t+="<style>"+i.toString()+"</style>";let d,r=0;for(let C=0;C<this.grdIncomeTax.ReportColumns.length;C++)r+=this.grdIncomeTax.ReportColumns[C].width;t+="<table>",t+="\r\n<tr><td align='center'><h2>",t+=o.d.SessionManager.CompanyName,t+="</h2></td></tr>",t+="\r\n<tr><td align='center'><h3 style='vertical-align:middl;'>",t+=l,t+="</h3></td></tr>",t+="\r\n<tr><td align='center'>",t+=" From :  "+this.dtFromMonth.ToString(o.d.SessionManager.Preferences["Date Format"]),t+=" &nbs;&nbsp;&nbsp;To :  "+this.dtToMonth.ToString(o.d.SessionManager.Preferences["Date Format"]),t+="</td></tr>",t+="<tr><td style='padding-top:10p;'><table border=1 width='"+r+"' style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",t+="<COLGROUP>";for(let C=0;C<this.grdIncomeTax.ReportColumns.length;C++)m.J0.IsEmpty(this.grdIncomeTax.ReportColumns[C].ColumnType)||"FLOAT"!=this.grdIncomeTax.ReportColumns[C].ColumnType?t+="<COL style=''>":t+="<COL style='text-align:righ;'>";t+="</COLGROUP>",t+="<tr style=''>";for(let C=0;C<this.grdIncomeTax.ReportColumns.length;C++)t+="<th class='hdr' width='"+this.grdIncomeTax.ReportColumns[C].width,t+="' >",t+=this.grdIncomeTax.ReportColumns[C].HeaderText,t+="</th>";t+="</tr>";for(let C=0;C<this.grdIncomeTax.Data.length;C++){t+="<tr",C%2==1&&(t+=" class=alt"),t+=">";for(let h=0;h<this.grdIncomeTax.ReportColumns.length;h++)t+="<td",m.J0.IsEmpty(this.grdIncomeTax.ReportColumns[h].ColumnType)||"FLOAT"!=this.grdIncomeTax.ReportColumns[h].ColumnType?t+=" align='left'":t+=" align='right'",t+=">",m.J0.IsEmpty(this.grdIncomeTax.ReportColumns[h].ColumnType),d=this.grdIncomeTax.ReportColumns.indexOf(this.grdIncomeTax.ReportColumns[h]),this.grdIncomeTax.ReportColumns.Contains(d)&&(t+=m.J0.String(this.grdIncomeTax.Data[C].Cells[d].Text)),t+="</td>";t+="</tr>"}return t+="</table>",t+="</td></tr></table>",t+="</body><html>",Logger.InfoLog("PostedDocumentViewModel:: exiting GetExportHTML "),t}ValidateData(){let l="";return null==this.lstEmployee.SelectedValue&&(l="Please select the Employee."),l}GetMonthName(l,t){l>12&&(l-=12);let i="";switch(l){case 1:i=t?"January":"Jan";break;case 2:i=t?"February":"Feb";break;case 3:i=t?"March":"Mar";break;case 4:i=t?"April":"Apr";break;case 5:i="May";break;case 6:i=t?"June":"Jun";break;case 7:i=t?"July":"Jul";break;case 8:i=t?"August":"Aug";break;case 9:i=t?"September":"Sep";break;case 10:i=t?"October":"Oct";break;case 11:i=t?"November":"Nov";break;case 12:i=t?"December":"Dec"}return i}lstEmployee_SelectionChanged(l){this.lstEmployee.SelectedValue!=this.prevSelectedEmp&&(this.lstEmployeeName.SelectedValue=this.lstEmployee.SelectedValue,this.clear(0),this.prevSelectedEmp=this.lstEmployee.SelectedValue,this.iSelectedEmpSeqNo=this.lstEmployee.SelectedValue,this.ITComputationViewModel.Employee_SelectedValueChanged(l),this.FillDetails())}grdIncomeTax_CellEndEdit(l){if(4==l.ColumnIndex){let t=0;try{t=parseFloat(this.grdIncomeTax.Data[l.RowIndex][l.ColumnIndex]),t<0&&(t=0)}catch{}if(l.RowIndex==this.IncomefromHousePropertyIndex||l.RowIndex==this.IncomefromHousePropertyIndex+1||l.RowIndex==this.IncomefromHousePropertyIndex+2||l.RowIndex==this.IncomefromHousePropertyIndex+3||l.RowIndex==this.IncomefromHousePropertyIndex+4)return;l.RowIndex>=this.intDeducunder8oCto80CCCIndex&&l.RowIndex<this.intTotalDeducunder8oCto80CCCIndex||(this.grdIncomeTax.Data[l.RowIndex][this.grdIncomeTax.ReportColumns.length-1]=m.J0.GetAmount(t)),this.dblbalanceSalaryInc12BA=this.dblTotalCellSalary+this.dPerq1+this.dPerq2-(this.HraMinValue+parseFloat(this.grdIncomeTax.Data[this.ConveyanceIndex][this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.ChildrenEduIndex][this.grdIncomeTax.ReportColumns.length-1].Value)+parseFloat(this.grdIncomeTax.Data[this.MedicalIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.LTAIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.LeaveEncashIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.FoodIndex][4].Value)+parseFloat(this.grdIncomeTax.Data[this.GratuityIndex][4].Value)+this.dblStandardDeduction),this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex][this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblbalanceSalaryInc12BA),t=parseFloat(this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex][this.grdIncomeTax.ReportColumns.length-1].Value)-parseFloat(this.grdIncomeTax.Data[this.ProfessionalTaxIndex][this.grdIncomeTax.ReportColumns.length-1].Value),this.grdIncomeTax.Data[this.NetTaxableSalIndex][this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(t),this.dblGrossTotalIncome=0,this.dblGrossTotalIncome=t+this.dblSelfletoutamount-parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4][this.grdIncomeTax.ReportColumns.length-1].Value),this.grdIncomeTax.Data[this.GrossTotalIncomeIndex][this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblGrossTotalIncome);let i=0,n=0;if(this.dvLimit=this.dvLimitData.filter(C=>995==C.ComponentID),null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(n=parseFloat(this.dvLimit[0].AmountLimit)),l.RowIndex>=this.intDeducunder8oCto80CCCIndex&&l.RowIndex<=this.intTotalDeducunder8oCto80CCCIndex){let C=0;for(let h=this.intDeducunder8oCto80CCCIndex+1;h<this.intTotalDeducunder8oCto80CCCIndex;h++)this.dvLimit=this.dvLimitData.filter(c=>c.ComponentID==parseInt(this.grdIncomeTax.Data[h].Cells[2].Value)),this.dvLimit.length>0&&(i=m.J0.Double(this.dvLimit[0].AmountLimit),i>0&&parseInt(this.grdIncomeTax.Data[h].Cells[2].Value)==parseInt(this.dvLimit[0].ComponentID)&&parseFloat(this.grdIncomeTax.Data[h].Cells[l.ColumnIndex].Value)>i&&(this.grdIncomeTax.Data[h].Cells[l.ColumnIndex].Value=m.J0.GetAmount(i),this.grdIncomeTax.Data[h].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(i))),C+=parseFloat(this.grdIncomeTax.Data[h].Cells[l.ColumnIndex].Value);this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex][4].Value=m.J0.GetAmount(C),C>n&&(C=n),this.dblTotaldeduction80ccc80c=C,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex][this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTotaldeduction80ccc80c)}let d=0;for(let C=this.intOtherDeducunder8oCto80CCCIndex;C<=this.intOtherDeducunder8oCto80CCCIndex1;C++)this.dvLimit=this.dvLimitData.filter(h=>h.ComponentID==parseInt(this.grdIncomeTax.Data[C].Cells[2].Value)),this.dvLimit.length>0&&(i=m.J0.Double(this.dvLimit[0].AmountLimit),i>0&&parseInt(this.grdIncomeTax.Data[C].Cells[2].Value)==parseInt(this.dvLimit[0].ComponentID)&&parseFloat(this.grdIncomeTax.Data[C].Cells[l.ColumnIndex].Value)>i&&(this.grdIncomeTax.Data[C].Cells[l.ColumnIndex].Value=m.J0.GetAmount(i),this.grdIncomeTax.Data[C].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(i))),d+=parseFloat(this.grdIncomeTax.Data[C].Cells[l.ColumnIndex].Value);this.grdIncomeTax.Data[this.dblTotalIncomeIndex][this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblGrossTotalIncome-this.dblTotaldeduction80ccc80c-d),this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex][this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(Math.round(this.dblGrossTotalIncome-this.dblTotaldeduction80ccc80c-d)),this.UpdateTotals(parseFloat(this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex][this.grdIncomeTax.ReportColumns.length-1].Value))}}UpdateTotals(l){let t=0;for(let g=0;g<this.lstTaxSalbs.length&&l>0;g++)if(0==g){if(l<this.lstTaxSalbs[g].ToSlab){t+=l*this.lstTaxSalbs[g].Percentage;break}t+=this.lstTaxSalbs[g].ToSlab*this.lstTaxSalbs[g].Percentage}else{if(l<this.lstTaxSalbs[g].ToSlab){t+=(l-this.lstTaxSalbs[g-1].ToSlab)*this.lstTaxSalbs[g].Percentage;break}t+=(this.lstTaxSalbs[g].ToSlab-this.lstTaxSalbs[g-1].ToSlab)*this.lstTaxSalbs[g].Percentage}this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(Math.round(t));let i=0,n=0;n=m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value),n>0&&(parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)<2016?l<=5e5&&(i=2e3):2016==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)?l<=5e5&&(i=5e3):2017==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)||2018==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)?l<=35e4&&(i=2500):parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)>=2019&&l<=5e5&&(i=12500)),this.grdIncomeTax.Data[this.dblRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(n<i?Math.round(n):Math.round(i)),n-i<0?(this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=0,t=0):(this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(n-i),t=n-i);let C,r=0,d=null,h=new ie.bT;if(this.dsTaxData.Tables[7].length>0){let g;C=new Te.Nl("Basic",""),h.push("Basic",C),h.Basic.setFieldValue(parseFloat(this.dsTaxData.Tables[3][0].BasicMonthly).toString()),C=new Te.Nl("TotalIncome",""),h.push("TotalIncome",C),h.TotalIncome.setFieldValue(this.dblTotalIncomeRoundoff),d=this.dsTaxData.Tables[8];let p=this.dsTaxData.Tables[3];if(d=this.dsTaxData.Tables[8].filter(u=>1==u.Type&&"OverTime"!=u.FieldType),d.length>0)for(let u=0;u<d.length;u++)g=this.dsTaxData.Tables[8].filter(P=>P.ComponentID==d[u].ComponentID),null!=g&&g.length>0&&(C=new Te.Nl(d[u].ComponentName.toString(),""),h.push(d[u].ComponentName.toString(),C),h[d[u].ComponentName.toString()].setFieldValue(p[0]["Earning"+g[0].SNo.toString()].toString()));if(d=this.dsTaxData.Tables[8].filter(u=>2==u.Type&&"OverTime"!=u.FieldType),d.length>0)for(let u=0;u<d.length;u++)g=this.dsTaxData.Tables[8].filter(P=>P.ComponentID==d[u].ComponentID),null!=g&&g.length>0&&(C=new Te.Nl(d[u].ComponentName.toString(),""),h.push(d[u].ComponentName.toString(),C),h[d[u].ComponentName.toString()].setFieldValue(p[0]["Deduction"+g[0].SNo.toString()].toString()))}let c=h;this.dvTaxSlabs.length>0&&null!=this.dvTaxSlabs[0].Surcharge&&null!=this.dvTaxSlabs[0].Surcharge&&""!=this.dvTaxSlabs[0].Surcharge.toString().Trim()&&(r=parseFloat(o.d.eval.EvaluateExpression(this.dvTaxSlabs[0].Surcharge.toString(),c))),this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[3].Value="Surcharge @ "+r+"%",this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=(l=t*r/100)>0?m.J0.GetAmount(Math.round(l)):0,t+=Math.round(l),this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=t>0?m.J0.GetAmount(t):0,r=0,this.dvTaxSlabs.length>0&&null!=this.dvTaxSlabs[0].EducationCess&&null!=this.dvTaxSlabs[0].EducationCess&&""!=this.dvTaxSlabs[0].EducationCess.toString().Trim()&&(r=parseFloat(o.d.eval.EvaluateExpression(this.dvTaxSlabs[0].EducationCess.toString(),c))),this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[3].Value="Education Cess @ "+r+"%",l=t*r/100,t+=Math.round(l),this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l>0?m.J0.GetAmount(Math.round(l)):0,r=0,this.dvTaxSlabs.length>0&&null!=this.dvTaxSlabs[0].SecondaryandHighEduc&&null!=this.dvTaxSlabs[0].SecondaryandHighEduc&&""!=this.dvTaxSlabs[0].SecondaryandHighEduc.toString().Trim()&&(r=parseFloat(o.d.eval.EvaluateExpression(this.dvTaxSlabs[0].SecondaryandHighEduc.toString(),c))),this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[3].Value="Secondary and Higher Education Cess @ "+r+"%",l=t*r/100,t+=Math.round(l),this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l>0?m.J0.GetAmount(Math.round(l)):0,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=t>0?m.J0.GetAmount(Math.round(t)):0,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTDS),this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(parseFloat(this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)-parseFloat(this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value))}UpdateTotalsNewRegime(l){let t=0;for(let g=0;g<this.lstNewTaxSalbs.length&&l>0;g++)if(0==g){if(l<this.lstNewTaxSalbs[g].ToSlab){t+=l*this.lstNewTaxSalbs[g].Percentage;break}t+=this.lstNewTaxSalbs[g].ToSlab*this.lstNewTaxSalbs[g].Percentage}else{if(l<this.lstNewTaxSalbs[g].ToSlab){t+=(l-this.lstNewTaxSalbs[g-1].ToSlab)*this.lstNewTaxSalbs[g].Percentage;break}t+=(this.lstNewTaxSalbs[g].ToSlab-this.lstNewTaxSalbs[g-1].ToSlab)*this.lstNewTaxSalbs[g].Percentage}this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(Math.round(t));let i=0,n=0;n=parseFloat(this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value),n>0&&parseInt(this.cmbYear.SelectedValue)>=2023&&l<=7e5&&(i=25e3),this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(n<i?Math.round(n):Math.round(i)),n-i<0?(this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=0,t=0):(this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(n-i),t=n-i);let C,r=0,d=null,h=new ie.bT;if(this.dsTaxData.Tables[7].length>0){let g;C=new Te.Nl("Basic",""),h.push("Basic",C),h.Basic.setFieldValue(parseFloat(this.dsTaxData.Tables[3][0].BasicMonthly).toString()),C=new Te.Nl("TotalIncome",""),h.push("TotalIncome",C),h.TotalIncome.setFieldValue(this.dblNewTotalIncomeRoundoff),d=this.dsTaxData.Tables[8];let e=this.dsTaxData.Tables[3];if(d=this.dsTaxData.Tables[8].filter(p=>1==p.Type&&"OverTime"!=p.FieldType),d.length>0)for(let p=0;p<d.length;p++)g=this.dsTaxData.Tables[8].filter(u=>u.ComponentID==d[p].ComponentID),null!=g&&g.length>0&&(C=new Te.Nl(d[p].ComponentName.toString(),""),h.push(d[p].ComponentName.toString(),C),h[d[p].ComponentName.toString()].setFieldValue(e[0]["Earning"+g[0].SNo.toString()].toString()));if(d=this.dsTaxData.Tables[8].filter(p=>2==p.Type&&"OverTime"!=p.FieldType),d.length>0)for(let p=0;p<d.length;p++)g=this.dsTaxData.Tables[8].filter(u=>u.ComponentID==d[p].ComponentID),null!=g&&g.length>0&&(C=new Te.Nl(d[p].ComponentName.toString(),""),h.push(d[p].ComponentName.toString(),C),h[d[p].ComponentName.toString()].setFieldValue(e[0]["Deduction"+g[0].SNo.toString()].toString()))}let c=h;this.dvNewTaxSlabs.length>0&&null!=this.dvNewTaxSlabs[0].Surcharge&&""!=this.dvNewTaxSlabs[0].Surcharge.toString().Trim()&&(r=parseFloat(o.d.eval.EvaluateExpression(this.dvNewTaxSlabs[0].Surcharge.toString(),c))),this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[3].Value="Surcharge @ "+r+"%",this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=(l=t*r/100)>0?m.J0.GetAmount(Math.round(l)):0,t+=Math.round(l),this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=t>0?m.J0.GetAmount(t):0,r=0,this.dvNewTaxSlabs.length>0&&null!=this.dvNewTaxSlabs[0].EducationCess&&""!=this.dvNewTaxSlabs[0].EducationCess.toString().Trim()&&(r=parseFloat(o.d.eval.EvaluateExpression(this.dvNewTaxSlabs[0].EducationCess.toString(),c))),this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[3].Value="Education Cess @ "+r+"%",l=t*r/100,t+=Math.round(l),this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l>0?m.J0.GetAmount(Math.round(l)):0,r=0,this.dvNewTaxSlabs.length>0&&null!=this.dvNewTaxSlabs[0].SecondaryandHighEduc&&""!=this.dvNewTaxSlabs[0].SecondaryandHighEduc.toString().Trim()&&(r=parseFloat(o.d.eval.EvaluateExpression(this.dvNewTaxSlabs[0].SecondaryandHighEduc.toString(),c))),this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[3].Value="Secondary and Higher Education Cess @ "+r+"%",l=t*r/100,t+=Math.round(l),this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=l>0?m.J0.GetAmount(Math.round(l)):0,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=t>0?m.J0.GetAmount(Math.round(t)):0,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTDS),this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(parseFloat(this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)-parseFloat(this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value))}FillDetails(){try{let l=0,t=0,i=0,n=(new Date).OnlyDate(),r="";this.dsTaxData=this.ITComputationViewModel.dsITComputation;let d=this.dsTaxData.Tables[0],C=this.dsTaxData.Tables[22],h=this.dsTaxData.Tables[1],c=this.dsTaxData.Tables[2],g=this.dsTaxData.Tables[2];g=this.dsTaxData.Tables[2].filter(D=>"1"==D.ComponentType);let e=this.dsTaxData.Tables[3],p=this.dsTaxData.Tables[18];this.dvTaxSlabsData=this.dsTaxData.Tables[7],this.dvTaxSlabs=this.dsTaxData.Tables[7];let u=this.dsTaxData.Tables[15].filter(D=>"Old"==D.Regime);null!=u&&u.length>0&&(this.dvLimit=u,this.dvLimitData=this.dvLimit);let P=this.dsTaxData.Tables[15].filter(D=>"New"==D.Regime);null!=P&&P.length>0&&(this.dvNewLimit=P);let x=this.dsTaxData.Tables[7].filter(D=>"New"==D.RegimeType);if(null!=x&&x.length>0&&parseInt(this.cmbYear.SelectedValue)>=2020&&(!m.J0.IsEmpty(this.dvNewLimit)&&this.dvNewLimit.length>0?this.bIsNewRegime=!0:r+="Income tax amount limit data not avalilable for the selected year in New Regime"),this.dvEmpTaxComputation=this.dsTaxData.Tables[21],d.length>0&&(d=this.dsTaxData.Tables[0].filter(D=>"IT_BASIC"==D.MapFieldName),0==d.length&&(r+="Basic component is not available,Please map component in the payroll strucuture\r\n")),0==e.length&&(r+="Employee Payroll information not available\r\n"),!m.J0.IsEmpty(this.dvLimit)&&0==this.dvLimit.length&&(r+="Income tax amount limit data not avalilable for the selected year"),""!=r.toString())return this.MessageDisplay=r,this.ITComputationViewModel.MessageDisplay=r,void(this.ITComputationViewModel.MessageVisibility=!0);this.dsTaxData.Tables.length>26&&this.dsTaxData.Tables[26].length>0&&this.dsTaxData.Columns[26].Contains("RegimeType")&&null!=this.dsTaxData.Tables[26][0].RegimeType&&null!=this.dsTaxData.Tables[26][0].RegimeType&&""!=this.dsTaxData.Tables[26][0].RegimeType.toString()&&(this.cmbRegime.SelectedValue=this.dsTaxData.Tables[26][0].RegimeType.toString()),this.dblServiceDays=0,this.dtDateofJoining=m.J0.ParseDate(p[0].CDOJ),this.dtFromMonth=new Date(parseInt(this.ITComputationViewModel.EmpYear.SelectedValue),o.d.SessionManager.AccountingFromMonth-1,1),this.dtToMonth=this.dtFromMonth.AddYears(1).AddDays(-1),this.dblServiceDays=n.Subtract(this.dtDateofJoining).Days+1;let y=0,M=0,A=0,T={iY:y,iM:M,iD:A};m.J0.GetYearsMonthsDays(m.J0.ParseDate(p[0].CDOB),this.dtToMonth.OnlyDate(),T),y=T.iY,M=T.iM,A=T.iD,this.dvTaxSlabs=this.dvTaxSlabsData.filter(y>=80?D=>"SuperSeniorCitizen"==D.Gender&&"Old"==D.RegimeType:y>=60?D=>"SeniorCitizen"==D.Gender&&"Old"==D.RegimeType:D=>D.Gender==m.J0.String(p[0].GenderName)&&"Old"==D.RegimeType),this.lstTaxSalbs.Clear();for(let D=0;D<this.dvTaxSlabs.length;D++)this.lstTaxSalbs.push(new Ot),this.lstTaxSalbs[D].FromSlab=parseFloat(this.dvTaxSlabs[D].Fromslab),this.lstTaxSalbs[D].ToSlab=parseFloat(this.dvTaxSlabs[D].Toslab),this.lstTaxSalbs[D].Percentage=parseFloat(this.dvTaxSlabs[D].Percentage)/100;i=17,t=5;for(let D=5;D<this.grdIncomeTax.ReportColumns.length;D++)this.grdIncomeTax.ReportColumns[D].HeaderText.toString()==m.J0.StringValue(C[0].Month)&&(t=this.grdIncomeTax.ReportColumns.indexOf(this.grdIncomeTax.ReportColumns[D])),!m.J0.IsEmpty(C[0].RelieveMonth)&&this.grdIncomeTax.ReportColumns[D].HeaderText.toString()==m.J0.StringValue(C[0].RelieveMonth)&&(i=this.grdIncomeTax.ReportColumns.indexOf(this.grdIncomeTax.ReportColumns[D]));let I=0,S=0;this.dsTaxData.Tables[0].length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(this.dsTaxData.Tables[0].length);let N,v=0,O=0;for(let D=0;D<this.dsTaxData.Tables[0].length;D++){if(N=new Array,I=5,v=0,O=0,this.grdIncomeTax.Data[D].Cells[17].Value=0,this.grdIncomeTax.Data[D].Cells[0].Value=this.dsTaxData.Tables[0][D].SNo,this.grdIncomeTax.Data[D].Cells[2].Value=this.dsTaxData.Tables[0][D].componentID,this.grdIncomeTax.Data[D].Cells[3].Value=this.dsTaxData.Tables[0][D].SalaryBreakup,this.grdIncomeTax.Data[D].Cells[3].CellAppearance=new Pe.bA,this.grdIncomeTax.Data[D].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[D].Cells[3].ColSpan=2,null!=this.dsTaxData.Tables[0][D].MapFieldName&&null!=this.dsTaxData.Tables[0][D].MapFieldName&&"IT_BASIC"==this.dsTaxData.Tables[0][D].MapFieldName.toString().Trim()&&(this.BasicIndex=D),parseInt(this.dsTaxData.Tables[0][D].SNo)>0){for(let R=0;R<h.length;R++)for(let b=5;b<this.grdIncomeTax.ReportColumns.length;b++)if(!N.Contains(this.grdIncomeTax.ReportColumns[b].HeaderText)&&h[R].month.toString()==this.grdIncomeTax.ReportColumns[b].HeaderText.toString()){this.grdIncomeTax.ReportColumns[b].Tag="Processed",N.push(this.grdIncomeTax.ReportColumns[b].HeaderText),l=0,m.J0.IsEmpty(h[R]["dcCalcNum"+this.dsTaxData.Tables[0][D].SNo.toString()])||(l=parseFloat(h[R]["dcCalcNum"+this.dsTaxData.Tables[0][D].SNo.toString()])),this.grdIncomeTax.Data[D].Cells[b].Value=l>0?m.J0.GetAmount(l):0,this.grdIncomeTax.Data[D].Cells[b].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[D].Cells[b].IsNormal=!1,O=m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].Value)+l,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].Value=m.J0.GetAmount(O),this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].IsNormal=!1,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.IsBold=!0,v+=l;break}for(let R=0;R<g.length;R++)for(let b=5;b<this.grdIncomeTax.ReportColumns.length;b++)if(parseInt(this.dsTaxData.Tables[0][D].componentID)==parseInt(g[R].componentid)&&g[R].FieldName.toString()==this.grdIncomeTax.ReportColumns[b].HeaderText.toString()&&!m.J0.IsEmpty(g[R].Amount)&&parseFloat(g[R].Amount)>0&&!N.Contains(this.grdIncomeTax.ReportColumns[b].HeaderText)){N.push(this.grdIncomeTax.ReportColumns[b].HeaderText),l=0,m.J0.IsEmpty(g[R].Amount)||(l=parseFloat(g[R].Amount)),this.grdIncomeTax.Data[D].Cells[b].Value=l>0?m.J0.GetAmount(l):0,this.grdIncomeTax.Data[D].Cells[b].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[D].Cells[b].IsNormal=!1,O=m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].Value)+l,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].Value=m.J0.GetAmount(O),this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].IsNormal=!1,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[b].CellAppearance.IsBold=!0,v+=l;break}if(0==e.length)return;for(let R=0;R<e.length;R++)for(I=t;I<i;I++)!N.Contains(this.grdIncomeTax.ReportColumns[I].HeaderText)&&m.J0.IntegerValue(this.grdIncomeTax.Data[D].Cells[I].Value)<=0&&(this.grdIncomeTax.ReportColumns[I].Tag="Future",N.push(this.grdIncomeTax.ReportColumns[I].HeaderText),l=parseFloat(e[R]["Earning"+this.dsTaxData.Tables[0][D].SNo.toString()]),this.grdIncomeTax.Data[D].Cells[I].Value=l>0?m.J0.GetAmount(l):0,this.grdIncomeTax.Data[D].Cells[I].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[D].Cells[I].IsNormal=!1,O=m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].Value)+l,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].Value=m.J0.GetAmount(O),this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].IsNormal=!1,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[I].CellAppearance.IsBold=!0,v+=l)}I=this.grdIncomeTax.ReportColumns.length-1,this.dblTotalCellSalary=this.dblTotalCellSalary+v,parseInt(this.dsTaxData.Tables[0][D].SNo)>0?(this.grdIncomeTax.Data[D].Cells[I].Value=m.J0.GetAmount(v),this.grdIncomeTax.Data[D].Cells[I].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[D].Cells[I].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[D].Cells[I].CellAppearance.FontSize=12,this.grdIncomeTax.Data[D].Cells[I].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[D].Cells[I].IsNormal=!1,this.grdIncomeTax.Data[D].Cells[I].CellAppearance.ForeColor="#0bd10b"):(this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTotalCellSalary),this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[3].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[3].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.dsTaxData.Tables[0].length-1].Cells[3].IsNormal=!1,this.TotalSalaryIndex=this.dsTaxData.Tables[0].length-1,this.grdIncomeTax.Data[D].Cells[1].Value=this.TotalSalaryIndex,S=this.TotalSalaryIndex)}if(S++,this.Form12Section1Index=this.TotalSalaryIndex+1,this.Form12Section2Index=this.TotalSalaryIndex+2,this.grdIncomeTax.addEmptyRowsWithCellApperance(2),this.dsTaxData.Tables[4].length>0){let D=0;for(let R=0;R<this.dsTaxData.Tables[4].length;R++)D=S+R,this.grdIncomeTax.Data[D].Cells[17].Value=0,this.grdIncomeTax.Data[D].Cells[0].Value=0,this.grdIncomeTax.Data[D].Cells[1].Value=D+1,this.grdIncomeTax.Data[D].Cells[2].Value=this.dsTaxData.Tables[4][R].componentid,this.grdIncomeTax.Data[D].Cells[3].Value=this.dsTaxData.Tables[4][R].SalaryBreakup,this.grdIncomeTax.Data[D].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[D].Cells[3].ColSpan=14,this.grdIncomeTax.Data[D].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[D].Cells[3].CellAppearance.FontSize=12,this.grdIncomeTax.Data[D].Cells[3].CellAppearance.IsBold=!0,-1==parseInt(this.dsTaxData.Tables[4][R].FieldType)&&(this.dPerq1=parseFloat(this.dsTaxData.Tables[4][R].Amount)),-2==parseInt(this.dsTaxData.Tables[4][R].FieldType)&&(this.dPerq2=parseFloat(this.dsTaxData.Tables[4][R].Amount)),this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(parseFloat(this.dsTaxData.Tables[4][R].AMOUNT)),this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b"}let E=0,G=0,J=0;this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.Exemptionsunder10Index=this.Form12Section2Index+1,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[17].Value=0,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[0].Value=0,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[1].Value=this.Exemptionsunder10Index,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[2].Value=-101,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].Value="Less : Exemptions Under 10 ",this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].ColSpan=15,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.Exemptionsunder10Index].Cells[3].CellAppearance.IsBold=!0,this.dsTaxData.Tables[5].length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(1),S=this.HRA10BasicIndex=this.Exemptionsunder10Index+1,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[1].Value=this.HRA10BasicIndex,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[2].Value=0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[3].Value="Actual Rent Paid - 10% of Basic ",this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[3].ColSpan=2;let U=0,se=0,f=this.dsTaxData.Tables[13];if(f.length>0){for(let D=0;D<f.length;D++)for(let R=5;R<this.grdIncomeTax.ReportColumns.length;R++)if(f[D].MONTHTEXT.toString()==this.grdIncomeTax.ReportColumns[R].HeaderText.toString()){l=0,m.J0.IsEmpty(f[D].AMOUNT)||(l=parseFloat(f[D].AMOUNT)),l>0?(se=m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.BasicIndex].Cells[R].Value),l-=10*se/100,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[R].Value=m.J0.GetAmount(l)):this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[R].Value=0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[R].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[R].IsNormal=!1,U+=l;break}}else for(let D=5;D<this.grdIncomeTax.ReportColumns.length;D++)this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[D].Value=m.J0.GetAmount(0),this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[D].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[D].IsNormal=!1;if(E=U,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(U),this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[this.HRA10BasicIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.HRAAcutalIndex=this.HRA10BasicIndex+1,U=0,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[1].Value=this.HRAAcutalIndex,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[2].Value=this.dsTaxData.Tables[6][0].componentid.toString(),this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[3].Value="Actual Received ",this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[3].ColSpan=2,this.dsTaxData.Tables[6].length>0){for(I=5;I<17;I++)this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[I].Value=m.J0.GetAmount(0),this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[I].IsNormal=!1,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[I].CellAppearance.Alignment="Right";I=5;for(let D=0;D<this.TotalSalaryIndex;D++)if(parseInt(this.grdIncomeTax.Data[D].Cells[2].Value)==parseInt(this.dsTaxData.Tables[6][0].componentid))for(I=5;I<i;I++)this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[I].Value=m.J0.GetAmount(m.J0.DoubleTryParse(this.grdIncomeTax.Data[D].Cells[I].Value)),this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[I].CellAppearance.Alignment="Right",U+=m.J0.DoubleTryParse(this.grdIncomeTax.Data[D].Cells[I].Value)}G=U,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(U),this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.Data[this.HRAAcutalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1;let oe=0,z=0;if(this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dsTaxData.Tables[7].length>0){U=0;let R,te,D=null,b=new ie.bT;R=new Te.Nl("Basic",""),b.push("Basic",R),b.Basic.setFieldValue(m.J0.DoubleTryParse(this.dsTaxData.Tables[3][0].BasicMonthly).toString()),D=this.dsTaxData.Tables[8].filter(q=>1==q.Type&&"OverTime"!=q.FieldType);let w=this.dsTaxData.Tables[3];if(D.length>0)for(let q=0;q<D.length;q++)te=this.dsTaxData.Tables[8].filter(de=>de.ComponentID==D[q].ComponentID),null!=te&&te.length>0&&(R=new Te.Nl(D[q].ComponentName.toString(),""),b.push(D[q].ComponentName.toString(),R),b[D[q].ComponentName.toString()].setFieldValue(w[0]["Earning"+te[0].SNo.toString()].toString()));if(D=this.dsTaxData.Tables[8].filter(q=>2==q.Type&&"OverTime"!=q.FieldType),D.length>0)for(let q=0;q<D.length;q++)te=this.dsTaxData.Tables[8].filter(de=>de.ComponentID==D[q].ComponentID),null!=te&&te.length>0&&(R=new Te.Nl(D[q].ComponentName.toString(),""),b.push(D[q].ComponentName.toString(),R),b[D[q].ComponentName.toString()].setFieldValue(w[0]["Deduction"+te[0].SNo.toString()].toString()));if(D=this.dsTaxData.Tables[7],D.length>0){let q=b;oe=parseFloat(o.d.eval.EvaluateExpression(D[0].MetroFormula.toString(),q)),z=parseFloat(o.d.eval.EvaluateExpression(D[0].NonmetroFormula.toString(),q))}}this.HRAMetroNonMetroIndex=this.HRAAcutalIndex+1,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[1].Value=this.HRAMetroNonMetroIndex,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[2].Value=-102,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[3].Value="Metro/Non-Metro ",this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[3].ColSpan=2;let W="";if(f.length>0){for(let D=0;D<f.length;D++)for(let R=5;R<this.grdIncomeTax.ReportColumns.length;R++)if(f[D].MONTHTEXT.toString()==this.grdIncomeTax.ReportColumns[R].HeaderText.toString()){W=f[D].METRO.toString(),"Yes"==W?(l=oe,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[R].Value=m.J0.GetAmount(l)):"No"==W.TrimEnd(" ")?(l=z,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[R].Value=m.J0.GetAmount(l)):this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[R].Value=0,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[R].CellAppearance.Alignment="Right",U+=l;break}}else for(let D=5;D<this.grdIncomeTax.ReportColumns.length;D++)this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[D].Value=m.J0.GetAmount(0),this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[D].IsNormal=!1,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[D].CellAppearance.Alignment="Right";J=U,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(U),this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[this.HRAMetroNonMetroIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.HRAExemptionIndex=this.HRAMetroNonMetroIndex+1,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[1].Value=this.HRAExemptionIndex,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[2].Value=-103,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].Value="HRA Exemption ",this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[3].CellAppearance.IsBold=!0,this.HraMinValue=Math.min(E,G,J),this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.HraMinValue),this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.TotAmtOthExemptUs10Index=this.HRAExemptionIndex+1,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[17].Value=0,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[0].Value=0,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[1].Value=this.TotAmtOthExemptUs10Index,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[2].Value=10001,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[3].Value="Total amount of any other exemption under section 10",this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[3].ColSpan=14;let ne=0,_=this.dsTaxData.Tables[25].filter(D=>"U/S 10 : 1) Total amount of any other exemption under section 10"==D.Name);null!=_&&_.length>0&&null!=_[0].Amount&&null!=_[0].Amount&&""!=_[0].Amount.toString()&&(ne=parseFloat(_[0].Amount)),this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(ne),this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(2);let re=0,$e=0,mt=0;if(this.dvLimit=this.dvLimitData.filter(D=>998==D.ComponentID),null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(re=parseFloat(this.dvLimit[0].AmountLimit)),this.ConveyanceIndex=this.TotAmtOthExemptUs10Index+1,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[1].Value=this.ConveyanceIndex,this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[2].Value=parseInt(this.dsTaxData.Tables[9][0].ComponentID),this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[3].Value="Conveyance",this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[3].ColSpan=14,parseInt(this.dsTaxData.Tables[9][0].ComponentID)>0){if(this.dsTaxData.Tables[9].length>0){I=5;for(let D=0;D<this.TotalSalaryIndex;D++)if(parseInt(this.grdIncomeTax.Data[D].Cells[2].Value)==parseInt(this.dsTaxData.Tables[9][0].ComponentID))for(I=5;I<i;I++)m.J0.IsEmpty(this.grdIncomeTax.Data[D].Cells[I].Value)||($e+=m.J0.DoubleTryParse(this.grdIncomeTax.Data[D].Cells[I].Value))}mt=$e/12,0==mt||mt>re?re*=12:re=$e}parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)>=2018&&(re=0,2018==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)?this.dblStandardDeduction=4e4:parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)>=2019&&(this.dvLimit=this.dvLimitData.filter(D=>1e3==D.ComponentID),this.dblStandardDeduction=null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()?parseFloat(this.dvLimit[0].AmountLimit):5e4)),this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(re),this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.ChildrenEduIndex=this.ConveyanceIndex+1,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[1].Value=this.ChildrenEduIndex,this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[2].Value=parseInt(this.dsTaxData.Tables[9][1].ComponentID),this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[3].Value="Children Education Allowances";let kt=0;if(parseInt(this.dsTaxData.Tables[9][0].ComponentID)>0){let D=0,R=0,b=0,te=0;if(this.dvLimit=this.dvLimitData,this.dvLimit=this.dvLimitData.filter(w=>996==w.ComponentID),null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(b=parseFloat(this.dvLimit[0].AmountLimit)),this.dvLimit=this.dvLimitData,this.dvLimit=this.dvLimitData.filter(w=>996==w.ComponentID),null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(R=parseInt(this.dvLimit[0].AmountLimit)),this.dsTaxData.Tables[10].length>0){D=parseInt(this.dsTaxData.Tables[10][0][0]),D>R&&(D=R),te=12*D*b,I=5;for(let w=0;w<this.TotalSalaryIndex;w++)if(parseInt(this.grdIncomeTax.Data[w].Cells[2].Value)==parseInt(this.dsTaxData.Tables[9][1].ComponentID))for(I=5;I<i;I++)null!=this.grdIncomeTax.Data[w].Cells[I].Value&&""!=this.grdIncomeTax.Data[w].Cells[I].Value.toString()&&0!=m.J0.DoubleTryParse(this.grdIncomeTax.Data[w].Cells[I].Value)&&(kt+=D*b)}}this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(kt),this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.dsTaxData.Tables[11].length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(this.dsTaxData.Tables[11].length);let Ct=0,jt=0;Ct=this.ChildrenEduIndex+1,S=Ct;for(let D=0;D<this.dsTaxData.Tables[11].length;D++)this.grdIncomeTax.Data[S].Cells[17].Value=0,this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=Ct+D,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(this.dsTaxData.Tables[11][D].NodeID),this.grdIncomeTax.Data[S].Cells[3].Value=this.dsTaxData.Tables[11][D].NAME.toString(),this.grdIncomeTax.Data[S].Cells[4].CellAppearance.Alignment="Right",this.dvEmpTaxComputation=this.dsTaxData.Tables[21],this.dvEmpTaxComputation=this.dsTaxData.Tables[21].filter(R=>R.ComponentID==parseInt(this.dsTaxData.Tables[11][D].NODEID)&&0==R.RegimeType),this.dvEmpTaxComputation.length>0?(this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount)),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount))):(this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(0),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(0)),jt+=m.J0.DoubleTryParse(this.grdIncomeTax.Data[S].Cells[4].Value),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",S+=1;this.MedicalIndex=this.ChildrenEduIndex+1,this.LTAIndex=this.MedicalIndex+1,this.FoodIndex=this.LTAIndex+1,this.LeaveEncashIndex=this.FoodIndex+1,this.GratuityIndex=this.LeaveEncashIndex+1,this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.StandardDedIndex=this.GratuityIndex+1,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[1].Value=this.StandardDedIndex,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[2].Value=1e3,this.grdIncomeTax.Data[this.StandardDedIndex].Cells[3].Value="STANDARD DEDUCTION",this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblStandardDeduction),this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",S+=1,this.dblbalanceSalaryInc12BA=this.dblTotalCellSalary+this.dPerq1+this.dPerq2-(this.HraMinValue+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.ConveyanceIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.ChildrenEduIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.MedicalIndex].Cells[4].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.LTAIndex].Cells[4].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.LeaveEncashIndex].Cells[4].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.FoodIndex].Cells[4].Value)+m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.GratuityIndex].Cells[4].Value)+this.dblStandardDeduction),this.grdIncomeTax.addEmptyRowsWithCellApperance(3),this.BalanceSalInc12BAIndex=this.StandardDedIndex+1,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[1].Value=this.BalanceSalInc12BAIndex,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[2].Value=-104,this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[3].Value="Balance Salary including Perquisites",this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblbalanceSalaryInc12BA),this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.BalanceSalInc12BAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545";let ke=0,bs=this.dsTaxData.Tables[12];this.ProfessionalTaxIndex=this.BalanceSalInc12BAIndex+1,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[0].Value=-105,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[1].Value=this.ProfessionalTaxIndex,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[2].Value=0,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[3].Value="Professional Tax",h=this.dsTaxData.Tables[20];let Y=!1;if(bs.length>0){Y=!1;for(let D=0;D<this.dsTaxData.Tables[19].length;D++)if("PROFESSIONAL TAX"==m.J0.StringValue(this.dsTaxData.Tables[19][D].TaxmapName)&&parseInt(this.dsTaxData.Tables[19][D].SNo)>0)for(let R=5;R<this.grdIncomeTax.ReportColumns.length-2;R++){Y=!1;for(let b=0;b<h.length;b++)if(h[b].month.toString()==this.grdIncomeTax.ReportColumns[R].HeaderText.toString()){m.J0.IsEmpty(h[b]["dcCalcNum"+this.dsTaxData.Tables[19][D].SNo.toString()])||(ke+=parseFloat(h[b]["dcCalcNum"+this.dsTaxData.Tables[19][D].SNo.toString()])),Y=!0;break}if(!Y)for(let b=0;b<g.length;b++)if(parseInt(this.dsTaxData.Tables[19][D].componentID)==parseInt(g[b].componentid)&&g[b].FieldName.toString()==this.grdIncomeTax.ReportColumns[R].HeaderText.toString()&&parseFloat(g[b].Amount)>0){m.J0.IsEmpty(g[b].Amount)||(ke+=parseFloat(g[b].Amount)),Y=!0;break}if(!Y)for(let b=0;b<e.length;b++)m.J0.IsEmpty(e[b]["Deduction"+this.dsTaxData.Tables[19][D].SNo.toString()])||(ke+=parseFloat(e[b]["Deduction"+this.dsTaxData.Tables[19][D].SNo.toString()]))}}this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[4].Value=m.J0.GetAmount(ke),this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[5].ColSpan=12,this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(ke),this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.NetTaxableSalIndex=this.ProfessionalTaxIndex+1,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[1].Value=this.NetTaxableSalIndex,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[2].Value=-106,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[3].Value="Net Taxable Salary",this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[3].ColSpan=14,this.dblNetTaxableSal=0,this.dblNetTaxableSal=this.dblbalanceSalaryInc12BA-ke,this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNetTaxableSal),this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.addEmptyRowsWithCellApperance(this.dsTaxData.Tables[14].length+3);let Gt=0;this.IncomefromHousePropertyIndex=this.NetTaxableSalIndex+1;for(let D=0;D<this.dsTaxData.Tables[14].length;D++){this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[1].Value=this.IncomefromHousePropertyIndex,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[2].Value=parseInt(this.dsTaxData.Tables[14][D].NODEID),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[3].Value=this.dsTaxData.Tables[14][D].NAME,Gt=parseFloat(this.dsTaxData.Tables[14][D].AMOUNT),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dsTaxData.Tables[14][D].AMOUNT)),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[5].ColSpan=12,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right";break}let Bt=0;this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[17].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[1].Value=this.IncomefromHousePropertyIndex+1,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[2].Value=-107,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[3].Value="Less : Standard deduction 30%",Bt=30*Gt/100,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[4].Value=m.J0.GetAmount(Bt),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[5].ColSpan=12,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right";let ze=0;this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[17].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[1].Value=this.IncomefromHousePropertyIndex+2,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[2].Value=-108,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[3].Value="",ze=parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex].Cells[4].Value)-parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+1].Cells[4].Value),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[4].Value=m.J0.GetAmount(ze),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+2].Cells[5].ColSpan=12;let Ze=0;for(let D=1;D<this.dsTaxData.Tables[14].length;D++){this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[17].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[1].Value=this.IncomefromHousePropertyIndex+3,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[2].Value=parseInt(this.dsTaxData.Tables[14][D].NODEID),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[3].Value=this.dsTaxData.Tables[14][D].NAME,Ze=parseFloat(this.dsTaxData.Tables[14][D].AMOUNT),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[4].Value=m.J0.GetAmount(Ze),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[5].ColSpan=12,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+3].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right";break}this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[17].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[0].Value=0,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[1].Value=this.IncomefromHousePropertyIndex+4,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[2].Value=-109,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[3].Value="Loss from House Property",this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[3].ColSpan=2,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[5].ColSpan=12,this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(Ze-ze),this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right";let et=0;this.dblSelfletoutamount=0,S=et=this.IncomefromHousePropertyIndex+5;for(let D=2;D<this.dsTaxData.Tables[14].length;D++)this.grdIncomeTax.Data[S].Cells[17].Value=0,this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=et,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(this.dsTaxData.Tables[14][D].NODEID),this.grdIncomeTax.Data[S].Cells[3].Value=this.dsTaxData.Tables[14][D].NAME,this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dsTaxData.Tables[14][D].AMOUNT)),this.grdIncomeTax.Data[S].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S].Cells[5].ColSpan=12,this.dblSelfletoutamount=this.dblSelfletoutamount+parseFloat(this.dsTaxData.Tables[14][D].AMOUNT),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(m.J0.DoubleTryParse(this.dsTaxData.Tables[14][D].AMOUNT)),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",S+=1,et+=1;this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.GrossTotalIncomeIndex=et,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[1].Value=this.GrossTotalIncomeIndex,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[2].Value=-110,this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[3].Value="Gross Total Income",this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[3].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[3].ColSpan=14,this.dblGrossTotalIncome=this.dblNetTaxableSal+this.dblSelfletoutamount-(Ze-ze),this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblGrossTotalIncome),this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.GrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.intDeducunder8oCto80CCCIndex=this.GrossTotalIncomeIndex+1,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[1].Value=this.intDeducunder8oCto80CCCIndex,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[2].Value=-111,this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[3].Value="Deductions under 80C to 80CCC",this.grdIncomeTax.Data[this.intDeducunder8oCto80CCCIndex].Cells[3].ColSpan=15,this.grdIncomeTax.addEmptyRowsWithCellApperance(this.dsTaxData.Tables[16].length);let _t=0,gt=0,Ae=0;S=Ae=this.intDeducunder8oCto80CCCIndex+1;for(let D=0;D<this.dsTaxData.Tables[16].length;D++){if(this.grdIncomeTax.Data[S].Cells[17].Value=0,this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=Ae,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(this.dsTaxData.Tables[16][D].NODEID),this.grdIncomeTax.Data[S].Cells[3].Value=this.dsTaxData.Tables[16][D].NAME,this.dvEmpTaxComputation.RowFilter="",this.dvEmpTaxComputation.filter(R=>R.ComponentID==parseInt(this.dsTaxData.Tables[16][D].NODEID)),this.dvEmpTaxComputation.length>0)this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount));else if("PF(Deduction from Salary)"==m.J0.String(this.dsTaxData.Tables[16][D].NAME)){let R=0;Y=!1;for(let b=0;b<this.dsTaxData.Tables[19].length;b++)if("PF(Deduction from Salary)"==m.J0.String(this.dsTaxData.Tables[19][b].TaxmapName)&&parseInt(this.dsTaxData.Tables[19][b].SNo)>0)for(let te=5;te<this.grdIncomeTax.ReportColumns.length-2;te++){Y=!1;for(let w=0;w<h.length;w++)if(m.J0.String(h[w].month)==this.grdIncomeTax.ReportColumns[te].HeaderText.toString()){m.J0.IsEmpty(h[w]["dcCalcNum"+m.J0.String(this.dsTaxData.Tables[19][b].SNo)])||(R+=parseFloat(h[w]["dcCalcNum"+m.J0.String(this.dsTaxData.Tables[19][b].SNo)])),Y=!0;break}if(!Y)for(let w=0;w<g.length;w++)if(parseInt(this.dsTaxData.Tables[19][b].componentID)==parseInt(g[w].componentid)&&g[w].FieldName.toString()==this.grdIncomeTax.ReportColumns[te].HeaderText.toString()&&parseFloat(g[w].Amount)>0){m.J0.IsEmpty(g[w].Amount)||(R+=parseFloat(g[w].Amount)),Y=!0;break}if(!Y&&te>=t)for(let w=0;w<e.length;w++)m.J0.IsEmpty(e[w]["Deduction"+m.J0.String(this.dsTaxData.Tables[19][b].SNo)])||(R+=parseFloat(e[w]["Deduction"+m.J0.String(this.dsTaxData.Tables[19][b].SNo)]))}this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(R)}else this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dsTaxData.Tables[16][D].AMOUNT));this.grdIncomeTax.Data[S].Cells[4].CellAppearance.Alignment="Right",0==D&&(_t=m.J0.DoubleTryParse(this.grdIncomeTax.Data[S].Cells[4].Value)),D>0&&(gt+=m.J0.DoubleTryParse(this.grdIncomeTax.Data[S].Cells[4].Value)),this.grdIncomeTax.Data[S].Cells[5].ColSpan=12,S+=1,Ae+=1}this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.intTotalDeducunder8oCto80CCCIndex=Ae,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[1].Value=this.intTotalDeducunder8oCto80CCCIndex,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[2].Value=-112,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[3].Value="Total Deductions under 80C to 80CCC",this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[5].ColSpan=12,this.dblTotaldeduction80ccc80c=gt+_t,this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[4].Value=m.J0.GetAmount(this.dblTotaldeduction80ccc80c);let pt=0;this.dvLimit=this.dvLimitData.filter(D=>995==D.ComponentID),null!=this.dvLimit[0].AmountLimit&&null!=this.dvLimit[0].AmountLimit&&""!=this.dvLimit[0].AmountLimit.toString()&&(pt=parseFloat(this.dvLimit[0].AmountLimit)),this.dblTotaldeduction80ccc80c>pt&&(this.dblTotaldeduction80ccc80c=pt),this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTotaldeduction80ccc80c),this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b";let Be=0;this.grdIncomeTax.addEmptyRowsWithCellApperance(this.dsTaxData.Tables[17].length),this.intOtherDeducunder8oCto80CCCIndex=this.intTotalDeducunder8oCto80CCCIndex+1,S=Ae=this.intTotalDeducunder8oCto80CCCIndex+1;for(let D=0;D<this.dsTaxData.Tables[17].length;D++){let R=0;if(this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=Ae,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(this.dsTaxData.Tables[17][D].NODEID),this.grdIncomeTax.Data[S].Cells[3].Value=this.dsTaxData.Tables[17][D].NAME,this.dvEmpTaxComputation=this.dsTaxData.Tables[21].filter(b=>b.ComponentID==parseInt(this.dsTaxData.Tables[17][D].NODEID)&&0==b.RegimeType),this.dvEmpTaxComputation.length>0)Be+=parseFloat(this.dvEmpTaxComputation[0].ComponentAmount),this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount));else{if(R=0,R=parseFloat(this.dsTaxData.Tables[17][D].AMOUNT),"80D-Self/Spouse/Dependant Children"==m.J0.String(this.dsTaxData.Tables[17][D].NAME)||"80D-Self/Dependant/Parent (not Sr Citizen)"==this.dsTaxData.Tables[17][D].NAME.toString()||"80D-Self/Dependant/Parent (Sr Citizen)"==this.dsTaxData.Tables[17][D].NAME.toString()){Y=!1;for(let b=0;b<this.dsTaxData.Tables[19].length;b++)if(!m.J0.IsEmpty(this.dsTaxData.Tables[19][b].TaxmapName)&&this.dsTaxData.Tables[19][b].TaxmapName.toString()==this.dsTaxData.Tables[17][D].NAME.toString()&&parseInt(this.dsTaxData.Tables[19][b].SNo)>0)for(let te=5;te<this.grdIncomeTax.ReportColumns.length-2;te++){Y=!1;for(let w=0;w<h.length;w++)if(h[w].month.toString()==this.grdIncomeTax.ReportColumns[te].HeaderText.toString()){null!=h[w]["dcCalcNum"+this.dsTaxData.Tables[19][b].SNo.toString()]&&null!=h[w]["dcCalcNum"+this.dsTaxData.Tables[19][b].SNo.toString()]&&""!=h[w]["dcCalcNum"+this.dsTaxData.Tables[19][b].SNo.toString()].toString()&&(R+=parseFloat(h[w]["dcCalcNum"+this.dsTaxData.Tables[19][b].SNo.toString()])),Y=!0;break}if(!Y)for(let w=0;w<g.length;w++)if(parseInt(this.dsTaxData.Tables[19][b].componentID)==parseInt(g[w].componentid)&&g[w].FieldName.toString()==this.grdIncomeTax.ReportColumns[te].HeaderText.toString()&&parseFloat(g[w].Amount)>0){null!=g[w].Amount&&null!=g[w].Amount&&""!=g[w].Amount.toString()&&(R+=parseFloat(g[w].Amount)),Y=!0;break}if(!Y)for(let w=0;w<e.length;w++)null!=e[w]["Deduction"+this.dsTaxData.Tables[19][b].SNo.toString()]&&null!=e[w]["Deduction"+this.dsTaxData.Tables[19][b].SNo.toString()]&&""!=e[w]["Deduction"+this.dsTaxData.Tables[19][b].SNo.toString()].toString()&&(R+=parseFloat(e[w]["Deduction"+this.dsTaxData.Tables[19][b].SNo.toString()]))}}Be+=R,this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(R)}this.grdIncomeTax.Data[S].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S].Cells[5].ColSpan=12,this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dvEmpTaxComputation.length>0?parseFloat(this.dvEmpTaxComputation[0].ComponentAmount):R),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",S+=1,Ae+=1}this.intOtherDeducunder8oCto80CCCIndex1=Ae-1,this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblTotalIncomeIndex=this.intOtherDeducunder8oCto80CCCIndex1+1,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[1].Value=this.dblTotalIncomeIndex,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[2].Value=-113,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].Value="Total Income",this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.dblTotalIncome=this.dblGrossTotalIncome-this.dblTotaldeduction80ccc80c-Be,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTotalIncome),this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.dblTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblTotalIncomeRoundoffIndex=this.dblTotalIncomeIndex+1,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[2].Value=-114,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].Value="Total Income rounded off",this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[3].CellAppearance.IsBold=!0,this.dblTotalIncomeRoundoff=Math.round(this.dblTotalIncome),this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTotalIncomeRoundoff),this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.Data[this.dblTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblTaxOnTotalIncomeIndex=this.dblTotalIncomeRoundoffIndex+1,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+1,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[2].Value=-115,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[3].Value="Tax on Total Income",this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblRebateIndex=this.dblTaxOnTotalIncomeIndex+1,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+2,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[2].Value=-116,parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)<2016?this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.2,000 for Taxable Income below Rs.5,00,000/-)":2016==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)?this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.5,000 for Taxable Income below Rs.5,00,000/-)":2017==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)||2018==parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)?this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.2,500 for Taxable Income below Rs.3,50,000/-)":parseInt(this.ITComputationViewModel.EmpYear.SelectedValue)>=2019&&(this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.12,500 for Taxable Income below Rs.5,00,000/-)"),this.grdIncomeTax.Data[this.dblRebateIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblTaxPayableAfterRebateIndex=this.dblRebateIndex+1,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+3,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[2].Value=-117,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[3].Value="Tax Payable after rebate U/S 87A",this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblSurchargeIndex=this.dblTaxPayableAfterRebateIndex+1,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+4,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[2].Value=-118,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblTaxPayableIndex=this.dblSurchargeIndex+1,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+5,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[2].Value=-119,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[3].Value="Tax Payable",this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[3].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblEducationCessIndex=this.dblTaxPayableIndex+1,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+6,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[2].Value=-120,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblSecHighEduCessIndex=this.dblEducationCessIndex+1,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[1].Value=this.dblTotalIncomeRoundoffIndex+7,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[2].Value=-121,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblSecHighEduCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.intTotalIncometaxPayableindex=this.dblSecHighEduCessIndex+1,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[17].Value=0,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[1].Value=this.intTotalIncometaxPayableindex,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[2].Value=-122,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[3].Value="Total Income Tax Payable",this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[3].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.intTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.TDSPaidIndex=this.intTotalIncometaxPayableindex+1,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[1].Value=this.TDSPaidIndex,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[2].Value=-123,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[3].Value="TDS Paid",this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTDS),this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.TDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#0bd10b",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NetTaxPayableIndex=this.TDSPaidIndex+1,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[1].Value=this.NetTaxPayableIndex,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[2].Value=-124,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[3].Value="Net Tax Payable",this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[3].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545";let Wt,ct=0,_e=0,Ht=0,Fs=0,tt=0,Ns=0;tt=o.d.SessionManager.FinancialYearStartDate.getFullYear(),Wt=tt.toString(),tt=parseInt(Wt.substr(2,2)),Ns=tt+1,ct=o.d.SessionManager.AccountingFromMonth,Fs=ct;let st=1;_e=ct,this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.MonthlyDeducIndex=this.NetTaxPayableIndex+1,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[1].Value=this.MonthlyDeducIndex,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[2].Value=-125,this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[3].Value="Monthly Deductions from salary",this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[3].ColSpan=2;for(let D=5;D<this.grdIncomeTax.ReportColumns.length;D++)if(13==_e){Ht=_e-st;for(let R=1;R<=Ht;R++)this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[D].Value=this.GetMonthName(R,!1),this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[D].CellAppearance.Alignment="Center",st+=1,D++}else this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[D].Value=this.GetMonthName(_e,!1),this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[D].CellAppearance.Alignment="Center",_e+=1,st+=1;this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.MonthlyDeducIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].IsNormal=!1,this.dsTaxData.Tables[19].length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(this.dsTaxData.Tables[19].length+1);let at=0,He=0,be=0;S=at=this.MonthlyDeducIndex+1,h=this.dsTaxData.Tables[20];for(let D=0;D<this.dsTaxData.Tables[19].length;D++){if(N=new Array,I=5,be=He=0,this.grdIncomeTax.Data[S+D].Cells[17].Value=0,this.grdIncomeTax.Data[S+D].Cells[0].Value=this.dsTaxData.Tables[19][D].SNo,this.grdIncomeTax.Data[S+D].Cells[1].Value=at+D,this.grdIncomeTax.Data[S+D].Cells[2].Value=this.dsTaxData.Tables[19][D].componentID,this.grdIncomeTax.Data[S+D].Cells[3].Value=this.dsTaxData.Tables[19][D].SalaryBreakup,this.grdIncomeTax.Data[S+D].Cells[3].ColSpan=2,parseInt(this.dsTaxData.Tables[19][D].SNo)>0){for(let R=0;R<h.length;R++)for(let b=5;b<this.grdIncomeTax.ReportColumns.length;b++)if(h[R].month.toString()==this.grdIncomeTax.ReportColumns[b].HeaderText.toString()&&!N.Contains(this.grdIncomeTax.ReportColumns[b].HeaderText)){N.push(this.grdIncomeTax.ReportColumns[b].HeaderText),l=0,m.J0.IsEmpty(h[R]["dcCalcNum"+this.dsTaxData.Tables[19][D].SNo.toString()])||(l=parseFloat(h[R]["dcCalcNum"+this.dsTaxData.Tables[19][D].SNo.toString()])),this.grdIncomeTax.Data[S+D].Cells[b].Value=l>=0?m.J0.GetAmount(l):0,this.grdIncomeTax.Data[S+D].Cells[b].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S+D].Cells[b].IsNormal=!1,be+=l;break}g=c,g=this.dsTaxData.Tables[2].filter(R=>"2"==R.ComponentType);for(let R=0;R<g.length;R++)for(let b=5;b<this.grdIncomeTax.ReportColumns.length;b++)if(parseInt(this.dsTaxData.Tables[19][D].componentID)==parseInt(g[R].componentid)&&g[R].FieldName.toString()==this.grdIncomeTax.ReportColumns[b].HeaderText.toString()&&parseFloat(g[R].Amount)>0&&!N.Contains(this.grdIncomeTax.ReportColumns[b].HeaderText)){this.grdIncomeTax.ReportColumns[b].Tag="Past",N.push(this.grdIncomeTax.ReportColumns[b].HeaderText),l=0,m.J0.IsEmpty(g[R].Amount)||(l=parseFloat(g[R].Amount)),this.grdIncomeTax.Data[S+D].Cells[b].Value=l>=0?m.J0.GetAmount(l):0,this.grdIncomeTax.Data[S+D].Cells[b].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S+D].Cells[b].IsNormal=!1,be+=l;break}if(0==e.length)return;for(let R=0;R<e.length;R++)for(I=t;I<i;I++)!N.Contains(this.grdIncomeTax.ReportColumns[I].HeaderText)&&m.J0.DoubleTryParse(this.grdIncomeTax.Data[S+D].Cells[I].Value)<=0&&(N.push(this.grdIncomeTax.ReportColumns[I].HeaderText),l=parseFloat(e[R]["Deduction"+this.dsTaxData.Tables[19][D].SNo.toString()]),this.grdIncomeTax.Data[S+D].Cells[I].Value=l>=0?m.J0.GetAmount(l):0,this.grdIncomeTax.Data[S+D].Cells[I].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S+D].Cells[I].IsNormal=!1,be+=l)}this.grdIncomeTax.Data[S+D].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(be),this.grdIncomeTax.Data[S+D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S+D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[S+D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.FontSize=12,this.grdIncomeTax.Data[S+D].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.IsBold=!0}this.InhandAmountIndex=at+this.dsTaxData.Tables[19].length;let ut=0;this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[17].Value=0,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[1].Value=this.InhandAmountIndex,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[2].Value=-126,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[3].Value="In Hand",this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[3].CellAppearance.ForeColor="#dc3545",this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[3].ColSpan=2,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[3].IsNormal=!1,I=5;let Dt=0;for(I=5;I<17;I++)this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[I].Value=m.J0.GetAmount(0),this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[I].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[I].CellAppearance.ForeColor="#dc3545";for(I=5;I<i;I++){He=0;for(let D=at;D<this.InhandAmountIndex;D++)He+=m.J0.DoubleTryParse(this.grdIncomeTax.Data[D].Cells[I].Value);Dt=m.J0.DoubleTryParse(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[I].Value)-He,this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[I].Value=m.J0.GetAmount(Dt),this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[I].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[I].CellAppearance.ForeColor="#dc3545",ut+=Dt}this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(ut),this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.InhandAmountIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="#dc3545",Y=!1;for(let D=0;D<this.dsTaxData.Tables[19].length;D++)if("TDS"==m.J0.StringValue(this.dsTaxData.Tables[19][D].TaxmapName)&&parseInt(this.dsTaxData.Tables[19][D].SNo)>0)for(let R=5;R<this.grdIncomeTax.ReportColumns.length-2;R++){Y=!1;for(let b=0;b<h.length;b++)if(h[b].month.toString()==this.grdIncomeTax.ReportColumns[R].HeaderText.toString()){m.J0.IsEmpty(h[b]["dcCalcNum"+this.dsTaxData.Tables[19][D].SNo.toString()])||(this.dblTDS+=parseFloat(h[b]["dcCalcNum"+this.dsTaxData.Tables[19][D].SNo.toString()])),Y=!0;break}if(!Y)for(let b=0;b<g.length;b++)if(parseInt(this.dsTaxData.Tables[19][D].componentID)==parseInt(g[b].componentid)&&g[b].FieldName.toString()==this.grdIncomeTax.ReportColumns[R].HeaderText.toString()&&parseFloat(g[b].Amount)>0){m.J0.IsEmpty(g[b].Amount)||(this.dblTDS+=parseFloat(g[b].Amount)),Y=!0;break}if(!Y)for(let b=0;b<e.length;b++)m.J0.IsEmpty(e[b]["Deduction"+this.dsTaxData.Tables[19][D].SNo.toString()])||(this.dblTDS+=parseFloat(e[b]["Deduction"+this.dsTaxData.Tables[19][D].SNo.toString()]))}if(this.UpdateTotals(this.dblTotalIncomeRoundoff),this.bIsNewRegime){let D=0,R=0,b=0;this.dvNewTaxSlabs=this.dsTaxData.Tables[7];let te={iY:D,iM:R,iD:b};m.J0.GetYearsMonthsDays(new Date(p[0].CDOB),this.dtToMonth.OnlyDate(),te),D=te.iY,R=te.iM,b=te.iD,this.dvNewTaxSlabs=this.dsTaxData.Tables[7].filter(D>=80?k=>"SuperSeniorCitizen"==k.Gender&&"New"==k.RegimeType:D>=60?k=>"SeniorCitizen"==k.Gender&&"New"==k.RegimeType:k=>k.Gender==m.J0.String(p[0].GenderName)&&"New"==k.RegimeType),this.lstNewTaxSalbs.Clear();for(let k=0;k<this.dvNewTaxSlabs.length;k++)this.lstNewTaxSalbs.push(new Ot),this.lstNewTaxSalbs[k].FromSlab=parseFloat(this.dvNewTaxSlabs[k].Fromslab),this.lstNewTaxSalbs[k].ToSlab=parseFloat(this.dvNewTaxSlabs[k].Toslab),this.lstNewTaxSalbs[k].Percentage=parseFloat(this.dvNewTaxSlabs[k].Percentage)/100;this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NewRegimeStartIndex=this.InhandAmountIndex+1,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[1].Value=this.NewRegimeStartIndex,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[2].Value=-130,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].Value="Computation Based on New Regime",this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].CellAppearance.Alignment="Center",this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].CellAppearance.FontFamilyName="Tahoma",this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].CellAppearance.IsBold=!0,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].CellAppearance.ForeColor="Black",this.grdIncomeTax.Data[this.NewRegimeStartIndex].Cells[3].CellAppearance.FontSize=18,this.grdIncomeTax.Data[this.NewRegimeStartIndex].Height=32,this.dvNewLimit=this.dsTaxData.Tables[15].filter(k=>1e3==k.ComponentID&&"New"==k.Regime),this.dblNewStandardDeduction=null!=this.dvNewLimit[0].AmountLimit&&""!=this.dvNewLimit[0].AmountLimit.toString()?parseFloat(this.dvNewLimit[0].AmountLimit):5e4,this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NewStandardDedIndex=this.NewRegimeStartIndex+1,this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[1].Value=this.NewStandardDedIndex,this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[2].Value=1e3,this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[3].Value="STANDARD DEDUCTION",this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNewStandardDeduction),this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NewStandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NewNetTaxableSalIndex=this.NewStandardDedIndex+1,this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[1].Value=this.NewNetTaxableSalIndex,this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[2].Value=-106,this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[3].Value="Net Taxable Salary",this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[3].CellAppearance.ForeColor="Red",this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[3].ColSpan=14,this.dblNewNetTaxableSal=0,this.dblNewNetTaxableSal=this.dblTotalCellSalary-this.dblNewStandardDeduction,this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNewNetTaxableSal),this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NewNetTaxableSalIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Red";let w=0;this.dblNewSelfletoutamount=0;let q=this.dsTaxData.Tables[14].filter(k=>"New"==k.RegimeType||"Both"==k.RegimeType);if(null!=q&&q.length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(q.length),S=w=this.NewNetTaxableSalIndex+1,null!=q&&q.length>0)for(let k=0;k<q.length;k++)this.grdIncomeTax.Data[S].Cells[17].Value=1,this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=w,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(q[k].NODEID),this.grdIncomeTax.Data[S].Cells[3].Value=q[k].NAME,this.grdIncomeTax.Data[S].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(q[k].AMOUNT)),this.grdIncomeTax.Data[S].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S].Cells[5].ColSpan=12,this.dblNewSelfletoutamount=this.dblNewSelfletoutamount+parseFloat(q[k].AMOUNT),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(parseFloat(q[k].AMOUNT)),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",S+=1,w+=1;this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NewGrossTotalIncomeIndex=w,this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[1].Value=this.NewGrossTotalIncomeIndex,this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[2].Value=-110,this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[3].Value="Gross Total Income",this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[3].CellAppearance.ForeColor="Red",this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[3].ColSpan=14,this.dblNewGrossTotalIncome=this.dblNewNetTaxableSal+this.dblNewSelfletoutamount,this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNewGrossTotalIncome),this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NewGrossTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Red",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.intNewDeducunder8oCto80CCCIndex=this.NewGrossTotalIncomeIndex+1,this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[1].Value=this.intNewDeducunder8oCto80CCCIndex,this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[2].Value=-111,this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[3].Value="Deductions under 80C to 80CCC",this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.intNewDeducunder8oCto80CCCIndex].Cells[3].ColSpan=14;let de=this.dsTaxData.Tables[16].filter(k=>"New"==k.RegimeType||"Both"==k.RegimeType);null!=de&&de.length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(de.length);let Jt=0,Tt=0,Fe=0;if(S=Fe=this.intNewDeducunder8oCto80CCCIndex+1,null!=de&&de.length>0)for(let k=0;k<de.length;k++){if(this.grdIncomeTax.Data[S].Cells[17].Value=1,this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=Fe,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(de[k].NODEID),this.grdIncomeTax.Data[S].Cells[3].Value=this.dsTaxData.Tables[16][k].NAME,this.grdIncomeTax.Data[S].Cells[3].CellAppearance.Alignment="Left",this.dvEmpTaxComputation=this.dsTaxData.Tables[21].filter(he=>he.ComponentID==parseInt(de[k].NODEID)&&0==he.RegimeType),this.dvEmpTaxComputation.length>0)this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount));else if("PF(Deduction from Salary)"==de[k].NAME.toString()){let he=0;Y=!1;for(let Z=0;Z<this.dsTaxData.Tables[19].length;Z++)if("PF(Deduction from Salary)"==m.J0.String(this.dsTaxData.Tables[19][Z].TaxmapName)&&parseInt(this.dsTaxData.Tables[19][Z].SNo)>0)for(let Ee=5;Ee<this.grdIncomeTax.ReportColumns.length-2;Ee++){Y=!1;for(let H=0;H<h.length;H++)if(m.J0.String(h[H].month)==this.grdIncomeTax.ReportColumns[Ee].HeaderText.toString()){null!=h[H]["dcCalcNum"+m.J0.String(this.dsTaxData.Tables[19][Z].SNo)]&&""!=h[H]["dcCalcNum"+m.J0.String(this.dsTaxData.Tables[19][Z].SNo)].toString()&&(he+=parseFloat(h[H]["dcCalcNum"+this.dsTaxData.Tables[19][Z].SNo.toString()])),Y=!0;break}if(!Y)for(let H=0;H<g.length;H++)if(parseInt(this.dsTaxData.Tables[19][Z].componentID)==parseInt(g[H].componentid)&&g[H].FieldName.toString()==this.grdIncomeTax.ReportColumns[Ee].HeaderText.toString()&&parseFloat(g[H].Amount)>0){null!=g[H].Amount&&""!=g[H].Amount.toString()&&(he+=parseFloat(g[H].Amount)),Y=!0;break}if(!Y)for(let H=0;H<e.length;H++)null!=e[H]["Deduction"+m.J0.String(this.dsTaxData.Tables[19][Z].SNo)]&&""!=e[H]["Deduction"+m.J0.String(this.dsTaxData.Tables[19][Z].SNo)].toString()&&(he+=parseFloat(e[H]["Deduction"+this.dsTaxData.Tables[19][Z].SNo.toString()]))}this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(he)}else this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(de[k].Amount));0==k&&(Jt=parseFloat(this.grdIncomeTax.Data[S].Cells[4].Value)),k>0&&(Tt+=parseFloat(this.grdIncomeTax.Data[S].Cells[4].Value)),this.grdIncomeTax.Data[S].Cells[5].ColSpan=12,this.grdIncomeTax.Data[S].Cells[5].rowSpan=de.length,this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].rowSpan=de.length,S+=1,Fe+=1}this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.intNewTotalDeducunder8oCto80CCCIndex=Fe,this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[1].Value=this.intNewTotalDeducunder8oCto80CCCIndex,this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[2].Value=-112,this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[3].Value="Total Deductions under 80C to 80CCC",this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[5].ColSpan=12,this.dblNewTotaldeduction80ccc80c=Tt+Jt,this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[4].Value=m.J0.GetAmount(this.dblNewTotaldeduction80ccc80c);let It=0;this.dvNewLimit=this.dsTaxData.Tables[15].filter(k=>995==k.ComponentID),null!=this.dvNewLimit[0].AmountLimit&&""!=this.dvNewLimit[0].AmountLimit.toString()&&(It=parseFloat(this.dvNewLimit[0].AmountLimit)),this.dblNewTotaldeduction80ccc80c>It&&(this.dblNewTotaldeduction80ccc80c=It),this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNewTotaldeduction80ccc80c),this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.intNewTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green";let We=0,ge=this.dsTaxData.Tables[17].filter(k=>"New"==k.RegimeType||"Both"==k.RegimeType);if(null!=ge&&ge.length>0&&this.grdIncomeTax.addEmptyRowsWithCellApperance(ge.length),this.intNewOtherDeducunder8oCto80CCCIndex=this.intNewTotalDeducunder8oCto80CCCIndex+1,S=Fe=this.intNewTotalDeducunder8oCto80CCCIndex+1,null!=ge&&ge.length>0)for(let k=0;k<ge.length;k++){let he=0;if(this.grdIncomeTax.Data[S].Cells[17].Value=1,this.grdIncomeTax.Data[S].Cells[0].Value=0,this.grdIncomeTax.Data[S].Cells[1].Value=Fe,this.grdIncomeTax.Data[S].Cells[2].Value=parseInt(ge[k].NODEID),this.grdIncomeTax.Data[S].Cells[3].Value=ge[k].NAME,this.grdIncomeTax.Data[S].Cells[3].CellAppearance.Alignment="Left",this.dvEmpTaxComputation=this.dsTaxData.Tables[21].filter(Z=>Z.ComponentID==parseInt(ge[k].NODEID)&&0==Z.RegimeType),this.dvEmpTaxComputation.length>0)We+=parseFloat(this.dvEmpTaxComputation[0].ComponentAmount),this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(parseFloat(this.dvEmpTaxComputation[0].ComponentAmount));else{if(he=0,he=parseFloat(ge[k].AMOUNT),"80D-Self/Spouse/Dependant Children"==ge[k].NAME.toString()||"80D-Self/Dependant/Parent (not Sr Citizen)"==ge[k].NAME.toString()||"80D-Self/Dependant/Parent (Sr Citizen)"==ge[k].NAME.toString()){Y=!1;for(let Z=0;Z<this.dsTaxData.Tables[19].length;Z++)if(this.dsTaxData.Tables[19][Z].TaxmapName.toString()==ge[k].NAME.toString()&&parseInt(this.dsTaxData.Tables[19][Z].SNo)>0)for(let Ee=5;Ee<this.grdIncomeTax.ReportColumns.length-2;Ee++){Y=!1;for(let H=0;H<h.length;H++)if(h[H].month.toString()==this.grdIncomeTax.ReportColumns[Ee].HeaderText.toString()){null!=h[H]["dcCalcNum"+m.J0.String(this.dsTaxData.Tables[19][Z].SNo)]&&""!=h[H]["dcCalcNum"+m.J0.String(this.dsTaxData.Tables[19][Z].SNo)].toString()&&(he+=parseFloat(h[H]["dcCalcNum"+this.dsTaxData.Tables[19][Z].SNo.toString()])),Y=!0;break}if(!Y)for(let H=0;H<g.length;H++)if(parseInt(this.dsTaxData.Tables[19][Z].componentID)==parseInt(g[H].componentid)&&g[H].FieldName.toString()==this.grdIncomeTax.ReportColumns[Ee].HeaderText.toString()&&parseFloat(g[H].Amount)>0){null!=g[H].Amount&&""!=g[H].Amount.toString()&&(he+=parseFloat(g[H].Amount)),Y=!0;break}if(!Y)for(let H=0;H<e.length;H++)null!=e[H]["Deduction"+this.dsTaxData.Tables[19][Z].SNo.toString()]&&null!=e[H]["Deduction"+this.dsTaxData.Tables[19][Z].SNo.toString()]&&""!=e[H]["Deduction"+this.dsTaxData.Tables[19][Z].SNo.toString()].toString()&&(he+=parseFloat(e[H]["Deduction"+this.dsTaxData.Tables[19][Z].SNo.toString()]))}}We+=he,this.grdIncomeTax.Data[S].Cells[4].Value=m.J0.GetAmount(he)}this.grdIncomeTax.Data[S].Cells[4].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[S].Cells[5].ColSpan=12,this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dvEmpTaxComputation.length>0?parseFloat(this.dvEmpTaxComputation[0].ComponentAmount):he),this.grdIncomeTax.Data[S].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",S+=1,Fe+=1}this.intNewOtherDeducunder8oCto80CCCIndex1=Fe-1,this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewTotalIncomeIndex=this.intNewOtherDeducunder8oCto80CCCIndex1+1,this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[1].Value=this.dblNewTotalIncomeIndex,this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[2].Value=-113,this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[3].Value="Total Income",this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[3].CellAppearance.ForeColor="Red",this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[3].ColSpan=14,this.dblNewTotalIncome=this.dblNewGrossTotalIncome-this.dblNewTotaldeduction80ccc80c-We,this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNewTotalIncome),this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Red",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewTotalIncomeRoundoffIndex=this.dblNewTotalIncomeIndex+1,this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex,this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[2].Value=-114,this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[3].Value="Total Income rounded off",this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[3].ColSpan=14,this.dblNewTotalIncomeRoundoff=Math.round(this.dblNewTotalIncome),this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblNewTotalIncomeRoundoff),this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewTotalIncomeRoundoffIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewTaxOnTotalIncomeIndex=this.dblNewTotalIncomeRoundoffIndex+1,this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+1,this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[2].Value=-115,this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[3].Value="Tax on Total Income",this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewRebateIndex=this.dblNewTaxOnTotalIncomeIndex+1,this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+2,this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[2].Value=-116,parseInt(this.cmbYear.SelectedValue)>=2023&&(this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[3].Value="Rebate U/S 87A (Rs.25,000 for Taxable Income below Rs.7,00,000/-)"),this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewTaxPayableAfterRebateIndex=this.dblNewRebateIndex+1,this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+3,this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[2].Value=-117,this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[3].Value="Tax Payable after rebate U/S 87A",this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewTaxPayableAfterRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewSurchargeIndex=this.dblNewTaxPayableAfterRebateIndex+1,this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+4,this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[2].Value=-118,this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewTaxPayableIndex=this.dblNewSurchargeIndex+1,this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+5,this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[2].Value=-119,this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[3].Value="Tax Payable",this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[3].CellAppearance.ForeColor="Red",this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Red",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewEducationCessIndex=this.dblNewTaxPayableIndex+1,this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+6,this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[2].Value=-120,this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.dblNewSecHighEduCessIndex=this.dblNewEducationCessIndex+1,this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[1].Value=this.dblNewTotalIncomeRoundoffIndex+7,this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[2].Value=-121,this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.dblNewSecHighEduCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.intNewTotalIncometaxPayableindex=this.dblNewSecHighEduCessIndex+1,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[17].Value=1,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[0].Value=0,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[1].Value=this.intNewTotalIncometaxPayableindex,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[2].Value=-122,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[3].Value="Total Income Tax Payable",this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[3].CellAppearance.ForeColor="Red",this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.intNewTotalIncometaxPayableindex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Red",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NewTDSPaidIndex=this.intNewTotalIncometaxPayableindex+1,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[1].Value=this.NewTDSPaidIndex,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[2].Value=-123,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[3].Value="TDS Paid",this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value=m.J0.GetAmount(this.dblTDS),this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NewTDSPaidIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Green",this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.NewNetTaxPayableIndex=this.NewTDSPaidIndex+1,this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[17].Value=1,this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[0].Value=0,this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[1].Value=this.NewNetTaxPayableIndex,this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[2].Value=-124,this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[3].Value="Net Tax Payable",this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[3].CellAppearance.Alignment="Left",this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[3].ColSpan=14,this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[3].CellAppearance.ForeColor="Red",this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.Alignment="Right",this.grdIncomeTax.Data[this.NewNetTaxPayableIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].CellAppearance.ForeColor="Red",this.UpdateTotalsNewRegime(this.dblNewTotalIncomeRoundoff)}}catch(l){Logger.ErrorLog("Error : "+l)}}cmbYear_SelectionChanged(l){this.clear(0),this.ITComputationViewModel.FilterEmployees(),this.ITComputationViewModel.lFinancialDate=this.ITComputationViewModel.GetFinancialYear(),null!=this.lstEmployee.SelectedValue&&0!=this.lstEmployee.SelectedValue&&(this.grdIncomeTax.addEmptyRowsWithCellApperance(1),this.ITComputationViewModel.OnYearSelected("Year"),this.FillDetails())}PrintForm16_Click(l){var t=this;return(0,B.A)(function*(){if(null==t.dtpDate.Date&&(t.dtpDate.Date=new Date),!(t.lstEmployee.SelectedValue>0))return t.obj.DisplayMessage="Select any Employee",void(t.obj.MessageVisibility=!0);t.txtPlace.Text.Trim(),t.dtpDate.Date.ToString("dd/MMM/yyyy"),t.LoadForm16PrintGrid(),t.Form16export()})()}LoadForm16PrintGrid(){let l,i="",n=-1,r=-1,d=-1,C=-1;this.grdPrint=new ht.j,this.grdPrint.ItComput=!0,this.grdPrint.Data.Clear(),this.grdPrint.ReportColumns.Clear();let h=new Pe.bA;h.Alignment="Center",h.FontFamilyName="Arial",h.FontSize=12,h.IsBold=!0,h.BackColor="White",h.ForeColor="Black",h.IsVisible=!0;let g,c=new Pe.bA;c.Alignment="Left",c.FontFamilyName="Arial",c.FontSize=12,c.IsBold=!0,c.BackColor="White",c.ForeColor="#FF333333";for(let f=1;f<=10;f++)g=new Ie.D_,g.FieldName="Col"+f.toString(),g.width=70,g.HeaderText="Col"+f.toString(),g.HeaderAppearance=h,g.DataAppearance=c,this.grdPrint.ReportColumns.push(g);this.grdPrint.ReportColumns[0].width=60,this.grdPrint.ReportColumns[3].width=75,this.grdPrint.ReportColumns[4].width=90,this.grdPrint.ReportColumns[5].width=75,this.grdPrint.ReportColumns[6].width=40,this.grdPrint.ReportColumns[7].width=90,this.grdPrint.ReportColumns[8].width=90,this.grdPrint.ReportColumns[9].width=90;let e=0;this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="FORM NO. 16",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="[See rule 31(1)(a)]",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="PART A",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Certificate under Section 203 of the Income-tax Act, 1961 for tax deducted at source on salary",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Name and address of the Employer",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value="Name and address of the Employee",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=5,l=this.dsTaxData.Tables[23].filter(f=>f.DBIndex==o.d.SessionManager.CompanyIndex),i="",null!=l&&l.length>0&&(i+="\t"+(null!=l[0].Name&&null!=l[0].Name&&""!=l[0].Name.toString().Trim()?l[0].Name.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Address1&&null!=l[0].Address1&&""!=l[0].Address1.toString().Trim()?l[0].Address1.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Address2&&null!=l[0].Address2&&""!=l[0].Address2.toString().Trim()?l[0].Address2.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Address3&&null!=l[0].Address3&&""!=l[0].Address3.toString().Trim()?l[0].Address3.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].City&&null!=l[0].City&&""!=l[0].City.toString().Trim()?l[0].City.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].State&&null!=l[0].State&&""!=l[0].State.toString().Trim()?l[0].State.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Zip&&null!=l[0].Zip&&""!=l[0].Zip.toString().Trim()?l[0].Zip.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Country&&null!=l[0].Country&&""!=l[0].Country.toString().Trim()?l[0].Country.toString().Trim()+"\r\n":"")),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value=i,this.grdPrint.Data[e].Cells[0].ColSpan=5,l=this.dsTaxData.Tables[24].filter(f=>4==f.AddressTypeID),i="",i+="\t"+this.dsTaxData.Tables[18][0].Name.toString().Trim()+"\r\n",null!=l&&l.length>0&&(i+="\t"+(null!=l[0].Address1&&null!=l[0].Address1&&""!=l[0].Address1.toString().Trim()?l[0].Address1.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Address2&&null!=l[0].Address2&&""!=l[0].Address2.toString().Trim()?l[0].Address2.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Address3&&null!=l[0].Address3&&""!=l[0].Address3.toString().Trim()?l[0].Address3.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].City&&null!=l[0].City&&""!=l[0].City.toString().Trim()?l[0].City.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].State&&null!=l[0].State&&""!=l[0].State.toString().Trim()?l[0].State.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Zip&&null!=l[0].Zip&&""!=l[0].Zip.toString().Trim()?l[0].Zip.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Country&&null!=l[0].Country&&""!=l[0].Country.toString().Trim()?l[0].Country.toString().Trim()+"\r\n\t":"")),this.grdPrint.Data[e].Cells[5].Value=i,this.grdPrint.Data[e].Cells[5].ColSpan=5,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="PAN of the Deductor",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=3,this.grdPrint.Data[e].Cells[3].Value="TAN of the Deductor",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=3,this.grdPrint.Data[e].Cells[6].Value="PAN of the Employee",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value="Employee Reference No. provided by the Employer (If available)",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2,l=this.dsTaxData.Tables[23].filter(f=>f.DBIndex==o.d.SessionManager.CompanyIndex),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value=null!=l&&l.length>0&&null!=l[0].PANNo&&null!=l[0].PANNo&&""!=l[0].PANNo.toString().Trim()?l[0].PANNo.toString().Trim():"",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=3,this.grdPrint.Data[e].Cells[3].Value=null!=l&&l.length>0&&null!=l[0].TANNo&&null!=l[0].TANNo&&""!=l[0].TANNo.toString().Trim()?l[0].TANNo.toString().Trim():"",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=3,this.grdPrint.Data[e].Cells[6].Value=this.dsTaxData.Tables[18].length>0&&null!=this.dsTaxData.Tables[18][0].PANNo&&null!=this.dsTaxData.Tables[18][0].PANNo&&""!=this.dsTaxData.Tables[18][0].PANNo.toString().Trim()?this.dsTaxData.Tables[18][0].PANNo.toString().Trim():"",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=this.dsTaxData.Tables[18].length>0&&null!=this.dsTaxData.Tables[18][0].Code&&null!=this.dsTaxData.Tables[18][0].Code?this.dsTaxData.Tables[18][0].Code.toString():"",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="CIT (TDS)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value="Assessment Year",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=3,this.grdPrint.Data[e].Cells[8].Value="Period with the Employer\r\nFrom                  To",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Acknowledgement Nos. of all quarterly statements of TDS under sub sec. (3) of Sec.200 as provided by the TIN Facilitation Centre or NSDL website.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value=(this.dtToMonth.getFullYear()+"-"+(this.dtToMonth.getFullYear()+1).toString().substr(2)).toString(),this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=3,this.grdPrint.Data[e].Cells[8].Value=this.dtFromMonth.ToString("dd'-'MMM'-'yyyy"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[9].Value=this.dtToMonth.ToString("dd'-'MMM'-'yyyy"),this.grdPrint.Data[e].Cells[9].CellAppearance.Alignment="Center",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Summary of amount paid/credited and tax deducted at source thereon in respect of the employee",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Quarter(s)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=2,this.grdPrint.Data[e].Cells[2].Value="Receipt Numbers of original quarterly statements of TDS under sub-section (3) of Section 200",this.grdPrint.Data[e].Cells[2].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[2].ColSpan=2,this.grdPrint.Data[e].Cells[4].Value="Amount paid/credited",this.grdPrint.Data[e].Cells[4].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[4].ColSpan=2,this.grdPrint.Data[e].Cells[6].Value="Amount of tax deducted (Rs.)",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value="Amount of tax deposited/remitted in respect",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Q1",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=2,this.grdPrint.Data[e].Cells[2].ColSpan=2,this.grdPrint.Data[e].Cells[4].ColSpan=2,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,n=e,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Q2",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=2,this.grdPrint.Data[e].Cells[2].ColSpan=2,this.grdPrint.Data[e].Cells[4].ColSpan=2,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Q3",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=2,this.grdPrint.Data[e].Cells[2].ColSpan=2,this.grdPrint.Data[e].Cells[4].ColSpan=2,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Q4",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=2,this.grdPrint.Data[e].Cells[2].ColSpan=2,this.grdPrint.Data[e].Cells[4].ColSpan=2,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,r=e,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Total (Rs.)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=2,this.grdPrint.Data[e].Cells[2].Value="",this.grdPrint.Data[e].Cells[2].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[2].ColSpan=2,this.grdPrint.Data[e].Cells[4].Value="",this.grdPrint.Data[e].Cells[4].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[4].ColSpan=2,this.grdPrint.Data[e].Cells[6].Value="",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value="",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="I. DETAILS OF TAX DEDUCTED AND DEPOSITED IN THE CENTRAL GOVERNMENT ACCOUNT THROUGH BOOK ADJUSTMENT\r\n(The deductor to provide payment wise details of tax deducted and deposited with respect to the deductee)",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",e++,d=e,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Sl. No.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Tax Deposited in respect of the deductee (Rs.)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value="Book Identification Number (BIN)",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[3].Value="Receipt Numbers of Form No. 24G",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=2,this.grdPrint.Data[e].Cells[5].Value="DDO serial number in Form no. 24G",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=2,this.grdPrint.Data[e].Cells[7].Value="Date of transfer voucher \r\n (dd/mm/yyyy)",this.grdPrint.Data[e].Cells[7].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[7].ColSpan=2,this.grdPrint.Data[e].Cells[9].Value="Status of matching with Form no. 24G",this.grdPrint.Data[e].Cells[9].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[9].ColSpan=1,this.grdPrint.Data[d].Cells[0].rowSpan=2,this.grdPrint.Data[d].Cells[1].rowSpan=2,this.grdPrint.Data[d].Cells[2].rowSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Total (Rs.)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].ColSpan=2,this.grdPrint.Data[e].Cells[5].ColSpan=2,this.grdPrint.Data[e].Cells[7].ColSpan=2,this.grdPrint.Data[e].Cells[9].ColSpan=1,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="II. DETAILS OF TAX DEDUCTED AND DEPOSITED IN THE CENTRAL GOVERNMENT ACCOUNT THROUGH CHALLAN\r\n(The deductor to provide payment wise details of tax deducted and deposited with respect to the deductee)",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",e++,C=e,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Sl. No.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Tax Deposited in respect of the deductee (Rs.)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value="Challan Identification Number (CIN)",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[3].Value="BSR Code of the Bank Branch",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=2,this.grdPrint.Data[e].Cells[5].Value="Date on which Tax deposited (dd/mm/yyyy)",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=2,this.grdPrint.Data[e].Cells[7].Value="Challan Serial Number",this.grdPrint.Data[e].Cells[7].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[7].ColSpan=2,this.grdPrint.Data[e].Cells[9].Value="Status of matching with OLTAS*",this.grdPrint.Data[e].Cells[9].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[9].ColSpan=1,this.grdPrint.Data[C].Cells[0].rowSpan=2,this.grdPrint.Data[C].Cells[1].rowSpan=2,this.grdPrint.Data[C].Cells[2].rowSpan=2;let p=0,u=0,P=0,x=0,y=0,M=0,A=o.d.common.GetDataTable("INC001",this.iSelectedEmpSeqNo.toString()+"~"+this.obj.EmpYear.SelectedValue);if(null!=A&&A.length>0){if(l=A.filter(f=>"Monthly"==f.dcAlpha2),null!=l&&l.length>0){p=0;for(let f=0;f<l.length;f++)e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value=f+1,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,M=0,M=m.J0.Double(l[f].dcNum5.toString()),this.grdPrint.Data[e].Cells[1].Value=M.ToString("0.00"),this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[1].ColSpan=2,p+=M,this.grdPrint.Data[e].Cells[3].Value=null!=l[f].dcAlpha5&&null!=l[f].dcAlpha5?l[f].dcAlpha5.toString():"",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=2,this.grdPrint.Data[e].Cells[5].Value=null!=l[f].dcAlpha6&&null!=l[f].dcAlpha6?m.J0.ParseDate(l[f].dcAlpha6).ToString("dd'-'MMM'-'yyyy"):"",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=2,this.grdPrint.Data[e].Cells[7].Value=null!=l[f].dcAlpha7&&null!=l[f].dcAlpha7?l[f].dcAlpha7.toString():"",this.grdPrint.Data[e].Cells[7].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[7].ColSpan=2,this.grdPrint.Data[e].Cells[9].Value="F",this.grdPrint.Data[e].Cells[9].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[9].ColSpan=1}if(e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Total (Rs.)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value=p.ToString("0.00"),this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].ColSpan=7,l=A.filter(f=>"Quarterly"==f.dcAlpha2),null!=l&&l.length>0){p=u=P=x=y=0;let f=0;for(let oe=0;oe<l.length;oe++)f=parseInt(l[oe].dcAlpha3.toString().Replace("Quarter",""))-1,this.grdPrint.Data[n+f].Cells[2].Value=null!=l[oe].dcAlpha8&&null!=l[oe].dcAlpha8?l[oe].dcAlpha8.toString():"",this.grdPrint.Data[n+f].Cells[2].CellAppearance.Alignment="Center",this.grdPrint.Data[n+f].Cells[2].ColSpan=2,M=0,0==f?(M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[5].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[5].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[5].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[6].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[6].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[6].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[7].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[7].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[7].Value):0):1==f?(M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[8].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[8].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[8].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[9].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[9].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[9].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[10].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[10].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[10].Value):0):2==f?(M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[11].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[11].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[11].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[12].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[12].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[12].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[13].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[13].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[13].Value):0):3==f&&(M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[14].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[14].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[14].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[15].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[15].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[15].Value):0,M+=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[16].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[16].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[16].Value):0),this.grdPrint.Data[n+f].Cells[4].Value=M.ToString("0.00"),this.grdPrint.Data[n+f].Cells[4].CellAppearance.Alignment="Right",this.grdPrint.Data[n+f].Cells[4].ColSpan=2,p+=M,M=0,M=m.J0.Double(l[oe].dcNum6.toString()),this.grdPrint.Data[n+f].Cells[6].Value=M.ToString("0.00"),this.grdPrint.Data[n+f].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[n+f].Cells[6].ColSpan=2,u+=M,M=0,M=m.J0.Double(l[oe].dcNum7.toString()),this.grdPrint.Data[n+f].Cells[8].Value=M.ToString("0.00"),this.grdPrint.Data[n+f].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[n+f].Cells[8].ColSpan=2,P+=M}this.grdPrint.Data[r+1].Cells[4].Value=p.ToString("0.00"),this.grdPrint.Data[r+1].Cells[4].CellAppearance.Alignment="Right",this.grdPrint.Data[r+1].Cells[4].ColSpan=2,this.grdPrint.Data[r+1].Cells[6].Value=u.ToString("0.00"),this.grdPrint.Data[r+1].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[r+1].Cells[6].ColSpan=2,this.grdPrint.Data[r+1].Cells[8].Value=P.ToString("0.00"),this.grdPrint.Data[r+1].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[r+1].Cells[8].ColSpan=2}e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Verification",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),i="",i="I, "+m.J0.StringValue(this.ITComputationViewModel.lstResponsiblePerson.Text).toUpperCase()+", son / daughter of "+(null==this.ITComputationViewModel.lstResponsiblePerson.Tag?"":this.ITComputationViewModel.lstResponsiblePerson.Tag.toString().toUpperCase())+" working in the capacity of "+this.ITComputationViewModel.txtDesignation.toUpperCase()+" (designation) do hereby certify that a sum of Rs. "+this.grdPrint.Data[r+1].Cells[6].Value+" ["+m.J0.ConvertNumberToText(parseFloat(null!=this.grdPrint.Data[r+1].Cells[6].Value&&null!=this.grdPrint.Data[r+1].Cells[6].Value&&""!=this.grdPrint.Data[r+1].Cells[6].Value.toString()?this.grdPrint.Data[r+1].Cells[6].Value:"0").ToString("N2"),"2","Rs.","Paisa","English")+" (in words)] has been deducted and a sum of Rs. "+this.grdPrint.Data[r+1].Cells[8].Value+" ["+m.J0.ConvertNumberToText(parseFloat(null!=this.grdPrint.Data[r+1].Cells[6].Value&&null!=this.grdPrint.Data[r+1].Cells[6].Value&&""!=this.grdPrint.Data[r+1].Cells[6].Value.toString()?this.grdPrint.Data[r+1].Cells[8].Value:"0").ToString("N2"),"2","Rs.","Paisa","English")+" ] has been deposited to the credit of the Central Government. I further certify that the information given above is true, complete and correct and is based on the books of account, documents, TDS statements, TDS deposited and other available records.",this.grdPrint.Data[e].Cells[0].Value=i,this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value="(Signature of person responsible for deduction of Tax)",this.grdPrint.Data[e].Cells[5].ColSpan=5,this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Place : "+this.txtPlace.Text.Trim(),this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[5].Value="Full Name : "+m.J0.StringValue(this.ITComputationViewModel.lstResponsiblePerson.Text).toString(),this.grdPrint.Data[e].Cells[5].ColSpan=5,this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Date  : "+this.dtpDate.Date.ToString("dd'-'MMM'-'yyyy"),this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[5].Value="Designation : "+this.ITComputationViewModel.txtDesignation,this.grdPrint.Data[e].Cells[5].ColSpan=5,this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Notes :",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),i="",i="1. Part B (Annexure) of the certificate in Form No.16 shall be issued by the employer.\n\n2. If an assessee is employed under one employer during the year, Part 'A' of the certificate in Form No.16 issued for the quarter ending on 31st March of the financial year shall contain the details of tax deducted and deposited for all the quarters of the financial year.\n\n3. If an assessee is employed under more than one employer during the year, each of the employers shall issue Part A of the certificate in Form No.16 pertaining to the period for which such assessee was employed with each of the employers. Part B (Annexure) of the certificate in Form No. 16 may be issued by each of the employers or the last employer at the option of the assessee.\n\n4. To update PAN details in Income Tax Department database, apply for 'PAN change request' through NSDL or UTITSL.\n\n",this.grdPrint.Data[e].Cells[0].Value=i,this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Legend used in Form 16",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   * Status of matching with OLTAS",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Legend",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Description",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value="Definition",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="U",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Unmatched",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value="Deductors have not deposited taxes or have furnished incorrect particulars of tax payment. Final credit will be reflected only when payment details in bank match with details of deposit in TDS / TCS statement",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="P",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Provisional",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value='Provisional tax credit is effected only for TDS / TCS Statements filed by Government deductors."P" status will be changed to Final (F) on verification of payment details submitted by Pay and Accounts Officer (PAO)',this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="F",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Final",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value="In case of non-government deductors, payment details of TDS / TCS deposited in bank by deductor have matched with the payment details mentioned in the TDS / TCS statement filed by the deductors. In case of government deductors, details of TDS / TCS booked in Government account have been verified by Pay & Accounts Officer (PAO)",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="O",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=1,this.grdPrint.Data[e].Cells[1].Value="Overbooked",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=2,this.grdPrint.Data[e].Cells[3].Value="Payment details of TDS / TCS deposited in bank by deductor have matched with details mentioned in the TDS / TCS statement but the amount is over claimed in the statement. Final (F) credit will be reflected only when deductor reduces claimed amount in the statement or makes new payment for excess amount claimed in the statement",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[3].ColSpan=7,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Tag="Break",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="FORM NO. 16",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="PART B",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Certificate under Section 203 of the Income-tax Act, 1961 for tax deducted at source on salary",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Name and address of the Employer",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value="Name and address of the Employee",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=5,l=this.dsTaxData.Tables[23].filter(f=>f.DBIndex==o.d.SessionManager.CompanyIndex),i="",null!=l&&l.length>0&&(i+="\t"+(null!=l[0].Name&&null!=l[0].Name&&""!=l[0].Name.toString().Trim()?l[0].Name.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Address1&&null!=l[0].Address1&&""!=l[0].Address1.toString().Trim()?l[0].Address1.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Address2&&null!=l[0].Address2&&""!=l[0].Address2.toString().Trim()?l[0].Address2.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Address3&&null!=l[0].Address3&&""!=l[0].Address3.toString().Trim()?l[0].Address3.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].City&&null!=l[0].City&&""!=l[0].City.toString().Trim()?l[0].City.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].State&&null!=l[0].State&&""!=l[0].State.toString().Trim()?l[0].State.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Zip&&null!=l[0].Zip&&""!=l[0].Zip.toString().Trim()?l[0].Zip.toString().Trim()+"\r\n":""),i+="\t"+(null!=l[0].Country&&null!=l[0].Country&&""!=l[0].Country.toString().Trim()?l[0].Country.toString().Trim()+"\r\n":"")),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value=i,this.grdPrint.Data[e].Cells[0].ColSpan=5,l=this.dsTaxData.Tables[24].filter(f=>4==f.AddressTypeID),i="",i+="\t"+this.dsTaxData.Tables[18][0].Name.toString().Trim()+"\r\n",null!=l&&l.length>0&&(i+="\t"+(null!=l[0].Address1&&null!=l[0].Address1&&""!=l[0].Address1.toString().Trim()?l[0].Address1.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Address2&&null!=l[0].Address2&&""!=l[0].Address2.toString().Trim()?l[0].Address2.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Address3&&null!=l[0].Address3&&""!=l[0].Address3.toString().Trim()?l[0].Address3.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].City&&null!=l[0].City&&""!=l[0].City.toString().Trim()?l[0].City.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].State&&null!=l[0].State&&""!=l[0].State.toString().Trim()?l[0].State.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Zip&&null!=l[0].Zip&&""!=l[0].Zip.toString().Trim()?l[0].Zip.toString().Trim()+"\r\n\t":""),i+="\t"+(null!=l[0].Country&&null!=l[0].Country&&""!=l[0].Country.toString().Trim()?l[0].Country.toString().Trim()+"\r\n\t":"")),this.grdPrint.Data[e].Cells[5].Value=i,this.grdPrint.Data[e].Cells[5].ColSpan=5,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="PAN of the Deductor",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=3,this.grdPrint.Data[e].Cells[3].Value="TAN of the Deductor",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=4,this.grdPrint.Data[e].Cells[7].Value="PAN of the Employee",this.grdPrint.Data[e].Cells[7].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[7].ColSpan=3,l=this.dsTaxData.Tables[23].filter(f=>f.DBIndex==o.d.SessionManager.CompanyIndex),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value=null!=l&&l.length>0&&null!=l[0].PANNo&&null!=l[0].PANNo&&""!=l[0].PANNo.toString().Trim()?l[0].PANNo.toString().Trim():"",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=3,this.grdPrint.Data[e].Cells[3].Value=null!=l&&l.length>0&&null!=l[0].TANNo&&null!=l[0].TANNo&&""!=l[0].TANNo.toString().Trim()?l[0].TANNo.toString().Trim():"",this.grdPrint.Data[e].Cells[3].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[3].ColSpan=4,this.grdPrint.Data[e].Cells[7].Value=this.dsTaxData.Tables[18].length>0&&null!=this.dsTaxData.Tables[18][0].PANNo&&null!=this.dsTaxData.Tables[18][0].PANNo&&""!=this.dsTaxData.Tables[18][0].PANNo.toString().Trim()?this.dsTaxData.Tables[18][0].PANNo.toString().Trim():"",this.grdPrint.Data[e].Cells[7].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[7].ColSpan=3,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="CIT (TDS)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value="Assessment Year",this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=3,this.grdPrint.Data[e].Cells[8].Value="Period with the Employer\r\nFrom                  To",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Acknowledgement Nos. of all quarterly statements of TDS under sub sec. (3) of Sec.200 as provided by the TIN Facilitation Centre or NSDL website.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value=(this.dtToMonth.getFullYear()+"-"+(this.dtToMonth.getFullYear()+1).toString().substr(2)).toString(),this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[5].ColSpan=3,this.grdPrint.Data[e].Cells[8].Value=this.dtFromMonth.ToString("dd'-'MMM'-'yyyy"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[9].Value=this.dtToMonth.ToString("dd'-'MMM'-'yyyy"),this.grdPrint.Data[e].Cells[9].CellAppearance.Alignment="Center",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Details of Salary Paid and any other income and tax deducted",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[0].ColSpan=6,this.grdPrint.Data[e].Cells[6].Value="Rs",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value="Rs.",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Center",this.grdPrint.Data[e].Cells[8].ColSpan=2;let T=0,I=0,S=0,v=0,O=0,N=0,E=0,G=0,J=0;e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="1.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Gross Salary",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=9,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (a)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Salary as per provisions contained in section 17(1)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.TotalSalaryIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (b)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Value of perquisites under section 17(2) (as per Form No. 12BA, wherever applicable)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.Form12Section1Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.Form12Section1Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.Form12Section1Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (c)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Profits in lieu of salary under section 17(3) (as per Form No. 12BA, wherever applicable)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.Form12Section2Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.Form12Section2Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.Form12Section2Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (d)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=7,this.grdPrint.Data[e].Cells[8].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,I=parseFloat(this.grdPrint.Data[e].Cells[8].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (e)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Reported total amount of salary received from other employer(s)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value="0.00",this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,S=parseFloat(this.grdPrint.Data[e].Cells[8].Value),T=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="2.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Less: Allowances to the extent exempt under section 10",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=9,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (a)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Travel concession or assistance under section 10(5)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.LTAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.LTAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.LTAIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (b)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Death-cum-retirement gratuity under section 10(10)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value="0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (c)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Commuted value of pension under section 10(10A)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value="0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (d)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Cash equivalent of leave salary encashment under section 10 (10AA)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value="0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (e)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="House rent allowance under section 10(13A)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.HRAExemptionIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (f)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Amount of any other exemption under section 10 [Note: Break-up to be prepared by employee and issued to the employee, where applicable , before furnishing of Part B to the employee]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (g)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total amount of any other exemption under section 10",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=this.grdIncomeTax.Data[this.TotAmtOthExemptUs10Index].Cells[this.grdIncomeTax.ReportColumns.length-1].Value,this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (h)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total amount of exemption claimed under section 10\r\n [2(a)+2(b)+2(c)+2(d)+2(e)+2(g)]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,I-=parseFloat(this.grdPrint.Data[e].Cells[8].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="3.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total amount of salary received from current employer\r\n[1(d)-2(h)]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=I.toString(),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,S+=parseFloat(this.grdPrint.Data[e].Cells[8].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="4.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Less: Deductions under section 16",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=9,T=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (a)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Standard deduction under section 16(ia)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.StandardDedIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (b)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Entertainment allowance under section 16(ii)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value="0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (c)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Tax on employment under section 16(iii)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.ProfessionalTaxIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,T+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="5.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total amount of deductions under section 16\r\n[4(a)+4(b)+4(c)]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,S-=parseFloat(this.grdPrint.Data[e].Cells[8].Value),O=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="6.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value='Income chargeable under the head "Salaries"\r\n[(3+1(e))-5]',this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=S.ToString("0.00"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,O+=parseFloat(this.grdPrint.Data[e].Cells[8].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="7.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Add: Any other income reported by the employee under as per section 192 (2B)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=9,v=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (a)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Income (or admissible loss) from house property reported by employee offered for TDS",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?(-1*parseFloat(this.grdIncomeTax.Data[this.IncomefromHousePropertyIndex+4].Cells[this.grdIncomeTax.ReportColumns.length-1].Value)).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,v+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (b)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Income under the head Other Sources offered for TDS",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.GrossTotalIncomeIndex-1].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.GrossTotalIncomeIndex-1].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.GrossTotalIncomeIndex-1].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].ColSpan=2,v+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="8.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total amount of other income reported by the employee\r\n[7(a)+7(b)]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=v.ToString("0.00"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,O+=parseFloat(this.grdPrint.Data[e].Cells[8].Value),E=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="9.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Gross total income (6+8)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=2,this.grdPrint.Data[e].Cells[8].Value=O.ToString("0.00"),this.grdPrint.Data[e].Cells[8].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[8].ColSpan=2,E+=parseFloat(this.grdPrint.Data[e].Cells[8].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="10.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deductions under Chapter VI-A",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=9,N=0;let U=0;for(let f=this.intDeducunder8oCto80CCCIndex+1;f<this.intTotalDeducunder8oCto80CCCIndex;f++)if(null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80CCC-")){U+=null!=this.grdIncomeTax.Data[f].Cells[4].Value&&""!=this.grdIncomeTax.Data[f].Cells[4].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[4].Value):0;break}e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (a)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of life insurance premia, contributions to provident fund etc. under section 80C",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?(this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value-U).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (b)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of contribution to certain pension funds under section 80CCC",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=U.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80CCD(1)-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (c)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of contribution by taxpayer to pension scheme under section 80CCD (1)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4;let se=T;e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (d)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total deduction under section 80C, 80CCC and 80CCD(1)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=(se+parseFloat(null!=this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.intTotalDeducunder8oCto80CCCIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00")).ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80CCD(1B)-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (e)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deductions in respect of amount paid/deposited to notified pension scheme under section 80CCD (1B)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80CCD(2)-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (f)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of contribution by Employer to pension scheme under section 80CCD (2)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80D-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (g)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of health insurance premia under section 80D",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80DD-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (h)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of Medical Treatment of handicapped Dependent under section 80DD",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80U-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (i)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of Physically Disable Assesse under section 80U",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80E-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (j)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of interest on loan taken for higher education under section 80E",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&(this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80G-")||this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80GGA-")||this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80GGC-"))&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (k)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total Deduction in respect of donations to certain funds, charitable institutions, etc. under section 80G",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=m.J0.Double(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80TTA-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (l)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of interest on deposits in savings account under section 80TTA",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=m.J0.Double(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80EEB-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (m)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of interest on Electric Vehicle Loan under section 80EEB",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (n)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Amount deductible under any other provision(s) of Chapter VI-A [Note: Break-up to be prepared by employee and issued to the employee, where applicable , before furnishing of Part B to the employee]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].ColSpan=4,T=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (o)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total of amount deductible under any other provision(s) of Chapter VI-A",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80CCF-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (p)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of Amount invested in specific Government approved Infrastructure bonds under section 80CCF",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80DDB-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (q)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction for Medical Treatment of certain specified ailments for Self/Dependent under section 80DDB",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),T=0;for(let f=this.intOtherDeducunder8oCto80CCCIndex;f<=this.intOtherDeducunder8oCto80CCCIndex1;f++)null!=this.grdIncomeTax.Data[f].Cells[3].Value&&this.grdIncomeTax.Data[f].Cells[3].Value.toString().startsWith("80GG-")&&(T+=null!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[f].Cells[this.grdIncomeTax.ReportColumns.length-1].Value):0);e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="   (r)",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Deduction in respect of house rent paid who does not get HRA under section 80GG",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=T.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,N+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="11.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Aggregate of deductible amount under Chapter VI-A\r\n[10(d)+10(e)+10(f)+10(g)+10(h)+10(i)+10(j)+10(k)+10(l)+10(m)+10(n)+10(o)+10(p)+10(q)+10(r)]",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=N.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,E-=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="12.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Total taxable income (9-11)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=Math.round(E).ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,G=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="13.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Tax on total income",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.dblTaxOnTotalIncomeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,G+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="14.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Rebate under section 87A, if applicable",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.dblRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.dblRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.dblRebateIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,G-=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="15.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Surcharge, wherever applicable",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.dblSurchargeIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,G+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="16.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Health and education cess",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=null!=this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value&&""!=this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value.toString()?parseFloat(this.grdIncomeTax.Data[this.dblEducationCessIndex].Cells[this.grdIncomeTax.ReportColumns.length-1].Value).ToString("0.00"):"0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,G+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),J=0,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="17.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Tax payable (13+15+16-14)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=G.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,J+=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="18.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Less: Relief under section 89 (attach details)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value="0.00",this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,J-=parseFloat(this.grdPrint.Data[e].Cells[6].Value),e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="19.",this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].Value="Net tax payable (17-18)",this.grdPrint.Data[e].Cells[1].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[1].ColSpan=5,this.grdPrint.Data[e].Cells[6].Value=J.ToString("0.00"),this.grdPrint.Data[e].Cells[6].CellAppearance.Alignment="Right",this.grdPrint.Data[e].Cells[6].ColSpan=4,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Verification",this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Center",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),i="",i="I, "+m.J0.StringValue(this.ITComputationViewModel.lstResponsiblePerson.Text).toUpperCase()+", son / daughter of "+(null==this.ITComputationViewModel.lstResponsiblePerson.Tag?"":this.ITComputationViewModel.lstResponsiblePerson.Tag.toString().toUpperCase())+" working in the capacity of "+this.ITComputationViewModel.txtDesignation.toUpperCase()+" (designation) do hereby certify that the information given above is true, complete and correct and is based on the books of account, documents, TDS statements, and other available records.",this.grdPrint.Data[e].Cells[0].Value=i,this.grdPrint.Data[e].Cells[0].ColSpan=10,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].ColSpan=10,e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[5].Value="(Signature of person responsible for deduction of Tax)",this.grdPrint.Data[e].Cells[5].ColSpan=5,this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Place : "+this.txtPlace.Text.Trim(),this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[5].Value="Full Name : "+m.J0.StringValue(this.ITComputationViewModel.lstResponsiblePerson.Text),this.grdPrint.Data[e].Cells[5].ColSpan=5,this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Left",e++,this.grdPrint.addEmptyRowsWithCellApperance(1),this.grdPrint.Data[e].Cells[0].Value="Date  : "+this.dtpDate.Date.ToString("dd'-'MMM'-'yyyy"),this.grdPrint.Data[e].Cells[0].ColSpan=5,this.grdPrint.Data[e].Cells[0].CellAppearance.Alignment="Left",this.grdPrint.Data[e].Cells[5].Value="Designation : "+this.ITComputationViewModel.txtDesignation,this.grdPrint.Data[e].Cells[5].ColSpan=5,this.grdPrint.Data[e].Cells[5].CellAppearance.Alignment="Left"}generatePrintContent(l,t="",i=!1,n=!1){let r="",d="",C="",h="",g="";if(r+="<html><meta charset='utf-8' /><body style='color:blac;background-color:white;'>",d+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",d+=".grp{padding:2p; background-color:#87CEEB; color:#FFFCF7;font-family:arial; font-size:10pt;}",d+=".tot{background-color:whit; color:red;font-family:arial; font-weight:bold; font-size:8pt;}",d+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:right;}",r+="<style>"+d.toString()+"</style>",g=r,g+=`<h3 style="text-align: center;">${t}</h3>`,g+=" <table  border=1  style='border-collapse:collapse;  font-family:arial; font-size:9pt;' >",n){g+="<thead>",g+="<tr>";for(let p=0;p<l.ReportColumns.length;p++){const u=l.ReportColumns[p];u.HeaderAppearance.IsVisible&&(g+=`<th  width=${u.width} ></th>`)}g+="</tr>",g+="</thead>"}else{g+="<thead>",g+="<tr>";for(let p=0;p<l.ReportColumns.length;p++){const u=l.ReportColumns[p];u.HeaderAppearance.IsVisible&&(g+=`<th class='hdr'  width=${u.width} >${u.HeaderText}</th>`)}g+="</tr>",g+="</thead>"}g+="<tbody>";for(let p=0;p<l.Data.length;p++){g+="<tr",p%2==1&&(g+=" class=alt"),g+=">";const u=l.Data[p];for(let P=0;P<l.ReportColumns.length;)l.ReportColumns[P].HeaderAppearance.IsVisible?(g+=u.Cells[P].ColSpan>1?`<td  align=${u.Cells[P].CellAppearance.Alignment} colspan=${u.Cells[P].ColSpan} `:"<td ",null!=u.Cells[P].CellAppearance&&(C=(u.Cells[P].CellAppearance.ForeColor.startsWith("#ff")||u.Cells[P].CellAppearance.ForeColor.startsWith("#FF"))&&9==u.Cells[P].CellAppearance.ForeColor.length?"#"+u.Cells[P].CellAppearance.ForeColor.substr(3):u.Cells[P].CellAppearance.ForeColor,h=(u.Cells[P].CellAppearance.BackColor.startsWith("#ff")||u.Cells[P].CellAppearance.BackColor.startsWith("#FF"))&&9==u.Cells[P].CellAppearance.BackColor.length?"#"+u.Cells[P].CellAppearance.BackColor.substr(3):u.Cells[P].CellAppearance.BackColor,g+=` style='background-color:${h} + ;color:${C}'`),g+=" >",g+=m.J0.StringValue(u.Cells[P].Value),g+="</td>",P+=u.Cells[P].ColSpan):P+=u.Cells[P].ColSpan;g+="</tr>"}return g+="</tbody>",g+="</table>",g}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-income-tax-computation"]],decls:110,vars:29,consts:[["id","maincontainer",1,"maincontainer",2,"display","flex","padding","12px"],[2,"flex-direction","column","justify-content","flex-end","width","100%"],[1,"page-header"],[1,"page-title_div"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-save"],["class","secondary-btn-wicon",3,"click",4,"ngIf"],[1,"fa-light","fa-trash-alt"],[1,"fa-light","fa-broom"],["class","secondary-btn",3,"click",4,"ngIf"],[1,"main_div","detailed",2,"padding","10px 10px 0 10px"],[1,"row",2,"height","40px"],[1,"form-group","col-xl-4","col-md-4","col-sm-12","col-xs-12","PACTControl",2,"flex-direction","row","align-items","center","justify-content","space-between"],[1,"input_cntrl_label"],[1,"NoLabel",2,"margin-left","5px","width","100px"],["FieldDirective","",3,"obj","group"],[1,"input_cntrl_label",2,"margin-left","10px"],[1,"NoLabel",2,"margin-left","5px","min-width","150px"],[1,"PactMasterTree","Pactpagetree",2,"height","calc(100% - 80px)","width","100%","border","1px solid rgb(204, 204, 204)"],[3,"obj"],[1,"row",2,"height","40px","margin-top","3px"],[1,"form-group","col-xl-3","col-md-3","col-sm-12","col-xs-12","PACTControl",2,"flex-direction","row","align-items","center","justify-content","space-between"],[1,"NoLabel",2,"flex","1","margin-left","5px"],[1,"primary-btn-wicon",2,"flex","1","margin-left","5px",3,"click"],[1,"form-group","col-xl-2","col-md-2","col-sm-12","col-xs-12","PACTControl",2,"flex-direction","row","align-items","center","justify-content","space-between"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-print"],[1,"fa-light","fa-file-export"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n  "),a.j41(2,"div",1),a.EFF(3,"\n  "),a.j41(4,"div",2),a.EFF(5,"\n     "),a.j41(6,"div",3),a.EFF(7,"\n      "),a.j41(8,"span",4),a.EFF(9),a.k0s(),a.EFF(10,"\n    "),a.k0s(),a.EFF(11,"\n    "),a.j41(12,"div",5),a.EFF(13,"\n      "),a.j41(14,"span",6),a.bIt("click",function(){return i.btnSave_Click("Save")}),a.nrm(15,"i",7),a.EFF(16),a.nI1(17,"translate"),a.k0s(),a.EFF(18,"\n      "),a.DNE(19,Ts,4,3,"span",8),a.EFF(20,"\n      "),a.j41(21,"span",6),a.bIt("click",function(){return i.btnSave_Click("Delete")}),a.nrm(22,"i",9),a.EFF(23),a.nI1(24,"translate"),a.k0s(),a.EFF(25,"\n      "),a.j41(26,"span",6),a.bIt("click",function(){return i.btnSave_Click("Clear")}),a.nrm(27,"i",10),a.EFF(28),a.nI1(29,"translate"),a.k0s(),a.EFF(30,"\n      "),a.DNE(31,Is,4,3,"span",11),a.EFF(32,"\n      "),a.DNE(33,Ps,4,3,"span",11),a.EFF(34,"\n      "),a.DNE(35,ys,4,3,"span",11),a.EFF(36,"\n    "),a.k0s(),a.EFF(37,"\n  "),a.k0s(),a.EFF(38,"\n  "),a.j41(39,"div",12),a.EFF(40,"\n    "),a.j41(41,"div",13),a.EFF(42,"\n      "),a.j41(43,"div",14),a.EFF(44,"\n        "),a.j41(45,"label",15),a.EFF(46,"Financial Year "),a.k0s(),a.EFF(47,"\n        "),a.j41(48,"div",16),a.EFF(49,"\n          "),a.eu8(50,17),a.EFF(51,"\n        "),a.k0s(),a.EFF(52,"\n        "),a.j41(53,"label",18),a.EFF(54),a.k0s(),a.EFF(55,"\n      "),a.k0s(),a.EFF(56,"\n      "),a.j41(57,"div",14),a.EFF(58,"\n      "),a.j41(59,"label",15),a.EFF(60,"Employee "),a.k0s(),a.EFF(61,"\n      "),a.j41(62,"div",19),a.EFF(63,"\n          "),a.eu8(64,17),a.EFF(65,"\n        "),a.k0s(),a.EFF(66,"\n      "),a.k0s(),a.EFF(67,"\n      "),a.k0s(),a.EFF(68,"\n      "),a.j41(69,"div",20),a.EFF(70,"\n        "),a.nrm(71,"app-report-grid",21),a.EFF(72,"\n      "),a.k0s(),a.EFF(73,"\n      "),a.j41(74,"div",22),a.EFF(75,"\n        "),a.j41(76,"div",23),a.EFF(77,"\n          "),a.j41(78,"label",15),a.EFF(79,"Regime Opted For "),a.k0s(),a.EFF(80,"\n          "),a.j41(81,"div",24),a.EFF(82,"\n            "),a.eu8(83,17),a.EFF(84,"\n          "),a.k0s(),a.EFF(85,"\n          "),a.j41(86,"button",25),a.bIt("click",function(){return i.btnSave_Click("SaveRegime")}),a.EFF(87),a.nI1(88,"translate"),a.k0s(),a.EFF(89,"\n        "),a.k0s(),a.EFF(90,"\n        "),a.j41(91,"div",26),a.EFF(92,"\n       "),a.j41(93,"label",15),a.EFF(94,"Place"),a.k0s(),a.EFF(95,"\n        "),a.j41(96,"div",24),a.EFF(97,"\n          "),a.eu8(98,17),a.EFF(99,"\n        "),a.k0s(),a.EFF(100,"\n        "),a.j41(101,"div",24),a.EFF(102,"\n          "),a.eu8(103,17),a.EFF(104,"\n       "),a.k0s(),a.EFF(105,"\n      "),a.k0s(),a.EFF(106,"\n      \n    "),a.k0s(),a.EFF(107,"\n\n  "),a.k0s(),a.EFF(108,"\n  "),a.k0s(),a.EFF(109,"\n"),a.k0s()),2&t&&(a.R7$(9),a.SpI("\n        ",i.obj.Title,"\n      "),a.R7$(7),a.JRh(a.bMT(17,21,"Save")),a.R7$(3),a.Y8G("ngIf",i.obj.PrintVisiblility),a.R7$(4),a.JRh(a.bMT(24,23,"Delete")),a.R7$(5),a.JRh(a.bMT(29,25,"Clear")),a.R7$(3),a.Y8G("ngIf",i.obj.ExportVisiblility),a.R7$(2),a.Y8G("ngIf",i.obj.WorksheetVisiblility),a.R7$(2),a.Y8G("ngIf",i.obj.TDSPostVisiblility),a.R7$(15),a.Y8G("obj",i.obj.EmpYear)("group",i.form),a.R7$(4),a.JRh(i.obj.lFinancialDate),a.R7$(10),a.Y8G("obj",i.obj.Employee)("group",i.form),a.R7$(7),a.Y8G("obj",i.grdIncomeTax),a.R7$(12),a.Y8G("obj",i.obj.EmpRegime)("group",i.form),a.R7$(4),a.JRh(a.bMT(88,27,"SaveRegime")),a.R7$(11),a.Y8G("obj",i.txtPlace)("group",i.form),a.R7$(5),a.Y8G("obj",i.obj.dtpDate)("group",i.form))},dependencies:[ce.bT,ye._,Ds.e,De.D9],encapsulation:2})}return F})();class Ot{constructor(){this.FromSlab=0,this.ToSlab=0,this.Percentage=0}}var Ss=V(84769);class vt{constructor(s){this.MessageVisibility=!1,this.sBMConString="",this.bUseROffTimings=!1,this.bDocColumns=!1,this.bDirection=!1,this.sBMDBAdapterAccess="",this.IsAutoPost=!1,this.dtConfig=null,this.dicConf=new ie.bT,this.BMCDeviceBrandName=X.y$.PactComboBoxData3("BMCDeviceBrandName",10),this.BMCDatabaseType=X.y$.PactComboBoxData3("BMCDatabaseType",10),this.BMCServerName=new ee.Dw(0),this.BMCUserId=new ee.Dw(0),this.BMCPassword=new ee.Dw(0),this.BMCDatabaseName=new ee.Dw(0),this.ETMEmpTableName=new ee.Dw(0),this.ETMEmpSeqNo=new ee.Dw(0),this.ETMEmpCode=new ee.Dw(0),this.ETMEmpCodeInDevice=new ee.Dw(0),this.ETMEmpName=new ee.Dw(0),this.ETMEmpWhere=new ee.Dw(0),this.APTMAttendPunchTableName=new ee.Dw(0),this.APTMEmpSeqNo=new ee.Dw(0),this.APTMEmpCode=new ee.Dw(0),this.APTMEmpCodeInDevice=new ee.Dw(0),this.APTMPunchDateTime=new ee.Dw(0),this.APTMDeviceNo=new ee.Dw(0),this.APTMDeviceNoValues=new ee.Dw(0),this.APTMDirection=new ee.Dw(0),this.APTMDirectionInVal=new ee.Dw(0),this.APTMDirectionOutVal=new ee.Dw(0),this.APTMAttendPunchWhere=new ee.Dw(0),this.FromDate=new we.Lc(0),this.ToDate=new we.Lc(0),this.DPCDocumentName=X.y$.PactComboBoxData3("DPCDocumentName",10),this.ROTUseROffTimings=Ce.c.PactCheckBoxData_1("Use Round off Timings",10),this.GetMultipleCheckINOUTInaDay=Ce.c.PactCheckBoxData_1("Get Multiple Check IN/OUT in a Day",10),this.OverrideAttendanceDoc=Ce.c.PactCheckBoxData_1("Override Attendance Document",10),this.DonotPullBiometricDataifAttendanceisposted=Ce.c.PactCheckBoxData_1("Do not Pull Biometric Data if Attendance is posted",10),this.AutoPostAtaTime=Ce.c.PactCheckBoxData_1("AutoPost At a Time",10),this.SortBasedOn=X.y$.PactComboBoxData3("SortBasedOn",10),this.GDBQchkUseQuery=Ce.c.PactCheckBoxData_1("Use Query to get the Data",10),this.GDBQtxtQuery=new ee.Dw(0),this.sFilter="",this.sSelectedEmpSeqNos="",this.sSelectedEmpCodes="",this.sbPostErrLog="",this.oDocument=null,this.bOverrideAttendanceDoc=!1,this.bDonotPullBiometricDataifAttendanceisposted=!1,this.bAutoPostAtaTime=!1,this.dtShiftsData=null,this.dtBioMetData=null,this.dsbEmps=null,this.dsbDims=null,this.sEmpSeqNosOnGrid="",this.bGetMultipleCheckInOutInaDay=!0;try{Logger.InfoLog("BiometricConfigViewModel::Entering BiometricConfigViewModel()"),this.DisplayName=s,this.Title=s,this.DisplayMessage="",this.ShowConfigurations=!!o.d.SessionManager.IsActionAssigned(141,"Configuration"),this.Initialize(),this.subcontroller()}catch(l){Logger.ErrorLog("BiometricConfigViewModel::EXCEPTION BiometricConfigViewModel()\r\n"+l.Message+"\r\n"+l.stack)}}subcontroller(){var s=this;return(0,B.A)(function*(){yield s.LoadConfig(),s.LoadGrid(),s.DPCDocumentName.SelectionChangedCommand.Subscribe(s,"DPCDocumentNameSelectionChanged"),s.sBMConString=s.GetBMConnString(),s.ToDate.Label="To Date",s.FromDate.Label="From Date"})()}Initialize(){this.BMCDeviceBrandName.Items.Clear(),this.BMCDeviceBrandName.Items.push(X._p.ComboBoxItems_2("***MANUAL***","1")),this.BMCDeviceBrandName.Items.push(X._p.ComboBoxItems_2("ViRDI->AC-5000RF","2")),this.BMCDeviceBrandName.SelectedValue="1",this.BMCDatabaseType.Items.Clear(),this.BMCDatabaseType.Items.push(X._p.ComboBoxItems_2("MS SQL Server","1")),this.BMCDatabaseType.Items.push(X._p.ComboBoxItems_2("MS Access","2")),this.BMCDatabaseType.Items.push(X._p.ComboBoxItems_2("API","3")),this.BMCDatabaseType.SelectedValue="1",this.DPCDocumentName.Items.Clear(),this.DPCDocumentName.Items.push(X._p.ComboBoxItems_2("Attendance","40089")),this.DPCDocumentName.Items.push(X._p.ComboBoxItems_2("Time Sheet","40090")),this.DPCDocumentName.Items.push(X._p.ComboBoxItems_2("Daily Attendance","40067")),this.DPCDocumentName.Items.push(X._p.ComboBoxItems_2("Employee wise Work Sheet","40087")),this.DPCDocumentName.SelectedValue="40090",this.SortBasedOn.Items.Clear(),this.SortBasedOn.Items.push(X._p.ComboBoxItems_2("None","1")),this.SortBasedOn.Items.push(X._p.ComboBoxItems_2("EmpCode","2")),this.SortBasedOn.Items.push(X._p.ComboBoxItems_2("EmpName","3")),this.SortBasedOn.Items.push(X._p.ComboBoxItems_2("TreeView","4")),this.SortBasedOn.Items.push(X._p.ComboBoxItems_2("EmpCode Numeric","5")),this.SortBasedOn.SelectedValue="1",this.dgCol=new L.O7,this.dgvROffTimings=new ue.vv,this.dgvROffTimings.Columns=[],this.dgvROffTimings.Width="",this.dgvROffTimings.AllowReorderColumns=!1,this.dgvROffTimings.CanUserResizeColumns=!0,this.dgvROffTimings.CanUserSortColumns=!1,this.dgvROffTimings.CanUserDeleteRows=!0,this.dgvROffTimings.CanUserAddRows=!0,this.dgCol=new L.O7,this.dgCol.Header="Start Time",this.dgCol.DisplayMember="StartTime",this.dgCol.ValueMember="StartTime_Key",this.dgCol.DataType="Time2",this.dgCol.ReadOnly=!1,this.dgCol.Width=95,this.dgvROffTimings.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="End Time",this.dgCol.DisplayMember="EndTime",this.dgCol.ValueMember="EndTime_Key",this.dgCol.DataType="Time2",this.dgCol.ReadOnly=!1,this.dgCol.Width=95,this.dgvROffTimings.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="ROff Time",this.dgCol.DisplayMember="ROffTime",this.dgCol.ValueMember="ROffTime_Key",this.dgCol.DataType="Time2",this.dgCol.ReadOnly=!1,this.dgCol.Width=95,this.dgvROffTimings.Columns.push(this.dgCol),this.dgvROffTimings.Table=[],this.dgvROffTimings.TableColumns.push("StartTime"),this.dgvROffTimings.TableColumns.push("StartTime_Key"),this.dgvROffTimings.TableColumns.push("EndTime"),this.dgvROffTimings.TableColumns.push("EndTime_Key"),this.dgvROffTimings.TableColumns.push("ROffTime"),this.dgvROffTimings.TableColumns.push("ROffTime_Key"),this.dgvDocColumns=new ue.vv,this.dgvDocColumns.Columns=[],this.dgvDocColumns.Width="",this.dgvDocColumns.AllowReorderColumns=!1,this.dgvDocColumns.CanUserResizeColumns=!0,this.dgvDocColumns.CanUserSortColumns=!1,this.dgvDocColumns.CanUserDeleteRows=!0,this.dgvDocColumns.CanUserAddRows=!1,this.dgCol=new L.O7,this.dgCol.Header="Source",this.dgCol.DisplayMember="Source",this.dgCol.ValueMember="Source_Key",this.dgCol.DataType="TextBlock",this.dgCol.ReadOnly=!0,this.dgCol.Width=150,this.dgvDocColumns.Columns.push(this.dgCol);let s=[],l=o.d.empService.GetQueryData(0,"BIO001","","","");l&&l.Tables.length>0&&(s=l.Tables[0]),this.dgCol=new L.O7,this.dgCol.Header="Destination",null!=s&&s.length>0&&(this.dgCol.ValueBinding="Destination",this.dgCol.DisplayMember="USERCOLUMNNAME",this.dgCol.ValueMember="SYSCOLUMNNAME",this.dgCol.DataType="ComboBox",this.dgCol.ReadOnly=!1,this.dgCol.Width=150,this.dvcol=s,this.dgCol.ComboData=this.dvcol,this.dgvDocColumns.Columns.push(this.dgCol)),this.dgvDocColumns.Table=[],this.dgvDocColumns.TableColumns.push("Source"),this.dgvDocColumns.TableColumns.push("Source_Key"),this.dgvDocColumns.TableColumns.push("Destination"),this.dgvDocColumns.TableColumns.push("Destination_Key")}LoadGrid(){this.dgv=new ue.vv,this.dgv.Columns=[],this.dgv.Width="",this.dgv.HeaderHeight=40,this.dgv.AllowReorderColumns=!1,this.dgv.CanUserResizeColumns=!0,this.dgv.CanUserSortColumns=!1,this.dgv.CanUserDeleteRows=!0,this.dgv.IsReadOnly=!0,this.dgCol=new L.O7,this.dgCol.Header="#",this.dgCol.DisplayMember="SlNo",this.dgCol.ID="SlNo",this.dgCol.Width=45,this.dgCol.ReadOnly=!0,this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Employee Code",this.dgCol.DisplayMember="EmpCode",this.dgCol.ID="EmpCode",this.dgCol.Width=120,this.dgCol.ReadOnly=!0,this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Employee Name",this.dgCol.DisplayMember="EmpName",this.dgCol.ID="EmpName",this.dgCol.Width=250,this.dgCol.ReadOnly=!0,this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Punch Date",this.dgCol.DisplayMember="PunchDate",this.dgCol.ID="PunchDate",this.dgCol.Width=90,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Shift Code",this.dgCol.DisplayMember="ShiftCode",this.dgCol.ID="ShiftCode",this.dgCol.Width=100,this.dgCol.ReadOnly=!0,this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Shift Name",this.dgCol.DisplayMember="ShiftName",this.dgCol.ID="ShiftName",this.dgCol.Width=100,this.dgCol.ReadOnly=!0,this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Act.\nStart Time",this.dgCol.DisplayMember="ActStartTime",this.dgCol.ID="ActStartTime",this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Act.\nEnd Time",this.dgCol.DisplayMember="ActEndTime",this.dgCol.ID="ActEndTime",this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Act.\nTotal Hours",this.dgCol.DisplayMember="ActTotHrs",this.dgCol.ID="ActTotHrs",this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.bUseROffTimings&&(this.dgCol=new L.O7,this.dgCol.Header="ROff\nStart Time",this.dgCol.DisplayMember="ROffStartTime",this.dgCol.ID="ROffStartTime",this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="ROff\nEnd Time",this.dgCol.DisplayMember="ROffEndTime",this.dgCol.ID="ROffEndTime",this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="ROff\nTotal Hours",this.dgCol.DisplayMember="ROffTotHrs",this.dgCol.ID="ROffTotHrs",this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol));for(let s=0;s<this.dgvDocColumns.Table.length;s++)null!=this.dgvDocColumns.Table[s].Destination&&""!=this.dgvDocColumns.Table[s].Destination.toString()&&"-1"!=this.dgvDocColumns.Table[s].Destination.toString()&&(this.dgCol=new L.O7,this.dgCol.Header=this.dgvDocColumns.Table[s].Source.toString(),this.dgCol.DisplayMember=this.dgvDocColumns.Table[s].Source.toString(),this.dgCol.ID=this.dgvDocColumns.Table[s].Source.toString(),this.dgCol.Width=80,this.dgCol.ReadOnly=!0,this.dgCol.TextAlign="Center",this.dgv.Columns.push(this.dgCol),this.bDocColumns=!0);this.dgCol=new L.O7,this.dgCol.Header="Remarks",this.dgCol.DisplayMember="Remarks",this.dgCol.ID="Remarks",this.dgCol.Width=250,this.dgCol.ReadOnly=!0,this.dgv.Columns.push(this.dgCol),this.dgv.Table=[],this.dgv.TableColumns.push("SlNo"),this.dgv.TableColumns.push("EmpCode"),this.dgv.TableColumns.push("EmpName"),this.dgv.TableColumns.push("PunchDate"),this.dgv.TableColumns.push("ShiftCode"),this.dgv.TableColumns.push("ShiftName"),this.dgv.TableColumns.push("ActStartTime"),this.dgv.TableColumns.push("ActEndTime"),this.dgv.TableColumns.push("ActTotHrs"),this.bUseROffTimings&&(this.dgv.TableColumns.push("ROffStartTime"),this.dgv.TableColumns.push("ROffEndTime"),this.dgv.TableColumns.push("ROffTotHrs"));for(let s=0;s<this.dgvDocColumns.Table.length;s++)null!=this.dgvDocColumns.Table[s].Destination&&null!=this.dgvDocColumns.Table[s].Destination&&""!=this.dgvDocColumns.Table[s].Destination.toString()&&"-1"!=this.dgvDocColumns.Table[s].Destination.toString()&&this.dgv.TableColumns.push(this.dgvDocColumns.Table[s].Source.toString());this.dgv.TableColumns.push("Remarks"),this.dgv.TableColumns.push("Row_Background"),this.dgvFailedRecord=new ue.vv,this.dgvFailedRecord.Columns=[],this.dgvFailedRecord.Width="",this.dgvFailedRecord.HeaderHeight=30,this.dgvFailedRecord.CanUserResizeColumns=!0,this.dgvFailedRecord.IsReadOnly=!0,this.dgCol=new L.O7,this.dgCol.Header="Attendance Date",this.dgCol.DisplayMember="AttendanceDate",this.dgCol.ID="AttendanceDate",this.dgCol.Width=100,this.dgCol.ReadOnly=!0,this.dgvFailedRecord.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Code",this.dgCol.DisplayMember="Code",this.dgCol.ID="Code",this.dgCol.Width=150,this.dgCol.ReadOnly=!0,this.dgvFailedRecord.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Name",this.dgCol.DisplayMember="Name",this.dgCol.ID="Name",this.dgCol.Width=150,this.dgCol.ReadOnly=!0,this.dgvFailedRecord.Columns.push(this.dgCol),this.dgCol=new L.O7,this.dgCol.Header="Message",this.dgCol.DisplayMember="Message",this.dgCol.ID="Message",this.dgCol.Width=250,this.dgCol.ReadOnly=!0,this.dgvFailedRecord.Columns.push(this.dgCol),this.dgvFailedRecord.Table=[],this.dgvFailedRecord.TableColumns.push("AttendanceDate"),this.dgvFailedRecord.TableColumns.push("Code"),this.dgvFailedRecord.TableColumns.push("Name"),this.dgvFailedRecord.TableColumns.push("Message")}dgv_BeforeRowDeleting(s){return!1}LoadConfig(){var s=this;return(0,B.A)(function*(){s.dicConf.Clear();let l=o.d.empService.GetQueryData(0,"BIO002","","","");if(l&&l.Tables.length>0&&(s.dtConfig=l.Tables[0]),null!=s.dtConfig&&s.dtConfig.length>0){for(let t=0;t<s.dtConfig.length;t++)s.dicConf.push(m.J0.String(s.dtConfig[t].Name),m.J0.String(s.dtConfig[t].Value));if(s.drc=s.dtConfig.filter(t=>"BMCDeviceBrandName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.BMCDeviceBrandName.SelectedValue=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"BMCDatabaseType"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.BMCDatabaseType.SelectedValue=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"BMCServerName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.BMCServerName.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"BMCUserId"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.BMCUserId.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"BMCPassword"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&""!=s.drc[0].Value.toString()){let t=yield o.d.empService.DecryptString(s.drc[0].Value.toString());s.BMCPassword.Text=t.DecryptString}if(s.drc=s.dtConfig.filter(t=>"BMCDatabaseName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.BMCDatabaseName.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ETMEmpTableName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ETMEmpTableName.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ETMEmpSeqNo"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ETMEmpSeqNo.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ETMEmpCode"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ETMEmpCode.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ETMEmpCodeInDevice"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ETMEmpCodeInDevice.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ETMEmpName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ETMEmpName.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ETMEmpWhere"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ETMEmpWhere.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMAttendPunchTableName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMAttendPunchTableName.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMEmpSeqNo"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMEmpSeqNo.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMEmpCode"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMEmpCode.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMEmpCodeInDevice"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMEmpCodeInDevice.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMPunchDateTime"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMPunchDateTime.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMDeviceNo"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMDeviceNo.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMDeviceNoValues"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMDeviceNoValues.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMDirection"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMDirection.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMDirectionInVal"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMDirectionInVal.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMDirectionOutVal"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMDirectionOutVal.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"APTMAttendPunchWhere"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.APTMAttendPunchWhere.Text=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"DPCDocumentName"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.DPCDocumentName.SelectedValue=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"GetMultipleCheckINOUTInaDay"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.GetMultipleCheckINOUTInaDay.IsChecked=(0,j.yG0)(s.drc[0].Value),s.bGetMultipleCheckInOutInaDay=(0,j.yG0)(s.drc[0].Value)),s.drc=s.dtConfig.filter(t=>"OverrideAttendanceDoc"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.OverrideAttendanceDoc.IsChecked=(0,j.yG0)(s.drc[0].Value),s.bOverrideAttendanceDoc=(0,j.yG0)(s.drc[0].Value)),s.drc=s.dtConfig.filter(t=>"DonotPullBiometricDataifAttendanceisposted"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.DonotPullBiometricDataifAttendanceisposted.IsChecked=(0,j.yG0)(s.drc[0].Value),s.bDonotPullBiometricDataifAttendanceisposted=(0,j.yG0)(s.drc[0].Value)),s.drc=s.dtConfig.filter(t=>"AutoPostAtaTime"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.AutoPostAtaTime.IsChecked=(0,j.yG0)(s.drc[0].Value),s.bAutoPostAtaTime=(0,j.yG0)(s.drc[0].Value)),s.drc=s.dtConfig.filter(t=>"SortBasedOn"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.SortBasedOn.SelectedValue=s.drc[0].Value.toString()),s.drc=s.dtConfig.filter(t=>"ROTUseROffTimings"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.ROTUseROffTimings.IsChecked=(0,j.yG0)(s.drc[0].Value),s.bUseROffTimings=s.ROTUseROffTimings.IsChecked),s.dgvROffTimings.Clear(),s.drc=s.dtConfig.filter(t=>"ROffTimingsXML"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value){s.dsROffTimings=new m.VB,s.drc[0].Value.toString().Contains("\r\n")&&(s.drc[0].Value=s.drc[0].Value.toString().Replace("\r\n","")),s.dsROffTimings.ReadXml(s.drc[0].Value.toString());let t=new m.VB;t.LoadXml(s.drc[0].Value.toString());let i=t.SelectSingleNode("RoundOffTimings");if(null!=i){let n;if(i.childNodes.length>0)for(let r=0;r<i.childNodes.length;r++)n=s.dgvROffTimings.NewRow(),n.StartTime=i.childNodes[r].attributes.MinsFrom.value,n.StartTime_Key=i.childNodes[r].attributes.MinsFrom.value,n.EndTime=i.childNodes[r].attributes.MinsUpto.value,n.EndTime_Key=i.childNodes[r].attributes.MinsUpto.value,n.ROffTime=i.childNodes[r].attributes.ROffTime.value,n.ROffTime_Key=i.childNodes[r].attributes.ROffTime.value,s.dgvROffTimings.addRow(n)}}if(s.dgvDocColumns.Clear(),s.drc=s.dtConfig.filter(t=>"DocColumnsXML"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value){s.dsDocColumns=new m.VB,s.drc[0].Value.toString().Contains("\r\n")&&(s.drc[0].Value=s.drc[0].Value.toString().Replace("\r\n","")),s.dsDocColumns.ReadXml(s.drc[0].Value.toString());let t=new m.VB;t.LoadXml(s.drc[0].Value.toString());let i=t.SelectSingleNode("DocColumns");if(null!=i){let n;if(i.childNodes.length>0)for(let r=0;r<i.childNodes.length;r++)n=s.dgvDocColumns.NewRow(),n.Source=i.childNodes[r].attributes.Source.value,n.Source_Key=i.childNodes[r].attributes.Source.value,n.Destination=i.childNodes[r].attributes.Destination.value,n.Destination_Key=i.childNodes[r].attributes.Destination.value,s.dgvDocColumns.addRow(n)}}s.drc=s.dtConfig.filter(t=>"GDBQchkUseQuery"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.GDBQchkUseQuery.IsChecked=(0,j.yG0)(s.drc[0].Value)),s.drc=s.dtConfig.filter(t=>"GDBQtxtQuery"==t.Name),null!=s.drc&&s.drc.length>0&&null!=s.drc[0].Value&&(s.GDBQtxtQuery.Text=s.drc[0].Value.toString().Replace("[ENTER]","\r\n"))}})()}OnButtonClick(s){if(null!=s&&"BMCTestConn"!=s.toString()&&"SaveConfig"!=s.toString())if("GetData"==s.toString())this.GetData_Click();else if("PostData"==s.toString())this.PostData_Click();else if("Export"==s.toString())this.Export_Click();else if("ExportFailedRecords"==s.toString()){let l="";l+="<html><body style='color:blac;background-color:white;'>",l+="<style>",l+=".hdr{text-align:cente; padding:5px; background-color:#4F81BD;color:white;font-family:Arial;font-size:11pt} ",l+=".alt{background-color:whitesmok; color:black; font-family:arial; font-size:9pt; align:left;}",l+="</style>",l+="<table border=1 width='950' style='border-collapse:collaps;  font-family:arial; font-size:9pt;' >",l+="<tr><td class='hdr'><b>Sno<b></td>",l+="<td class='hdr' width='150'><b>Daily Attendance Date<b></td>",l+="<td class='hdr' width='150'><b>Code<b></td>",l+="<td class='hdr' width='150'><b>Name<b></td>",l+="<td class='hdr' width='750'><b>Message<b></td></tr>";let t=new m.VB;t.LoadXml(this.sbPostErrLog.toString());let i=t.SelectSingleNode("FailedRecord");if(null!=i&&i.childNodes.length>0)for(let n=0;n<i.childNodes.length;n++)l+="<tr",l+=">",l+="<td align='left' >"+n+"1</td>",l+="<td align='left' >"+i.childNodes[n].attributes.DADate!=null?i.childNodes[n].attributes.DADate.value:"</td>",l+="<td align='left' >"+i.childNodes[n].attributes.Code!=null?i.childNodes[n].attributes.Code.value:"</td>",l+="<td align='left' >"+i.childNodes[n].attributes.Name!=null?i.childNodes[n].attributes.Name.value:"</td>",l+="<td align='left' >"+i.childNodes[n].attributes.Error!=null?i.childNodes[n].attributes.Error.value:"</td>",l+="</tr>";l+="</table>",l+="</body>",l+="</html>"}}Filter_Click(){var s=this;return(0,B.A)(function*(){if(s.sSelectedEmpSeqNos=s.sSelectedEmpCodes="",null==s.objEmpFilter?s.objEmpFilter=new Oe.t("",0,11):(s.objEmpFilter.Filter=11,s.objEmpFilter.InitControls()),s.objEmpFilter.Filter>0&&(yield o.d.page.openDialog(s.objEmpFilter,Ye.m,{ShowCenter:!0})),s.objEmpFilter.IsCompleted)if(s.objEmpFilter.CostCenterFilters.length>0){let l=1,t="",i="",n="";s.objEmpFilter.CostCenterFilters.forEach(d=>{if(d.CostCenterID>5e4&&(l=2,t="NodeID",i=50051==d.CostCenterID?"EmpSeqNo":"CCNID"+(d.CostCenterID-5e4)),d.SelectedNodes.length>0){if(1==d.SelectedNodes.length)n+=" AND ",n+=i+"="+d.SelectedNodes[0].Id;else if(null==d.SelectedNodes.find(h=>h.Id==l&&h.IsGroup))if(n+=" AND ",Ue.IPrefetchFilter.IsGroupTree(d)){let h="";for(let c=0;c<d.SelectedNodes.length;c++)(null==d.SelectedNodes[c].Parent||!d.SelectedNodes[c].Parent.IsSelected)&&(h.length>0&&(h+=","),h+=d.SelectedNodes[c].Id);0==h.length&&(h+=-12912),n+=i+" IN ",n+=" (select T."+t+" GTID from ",n+=xe.A.GetTagTableName(d.CostCenterID)+" T with(nolock),",n+=xe.A.GetTagTableName(d.CostCenterID)+" GTP with(nolock) where T.lft BETWEEN GTP.lft AND GTP.rgt AND GTP."+t+" IN (",n+=h.toString()+")  group by T."+t+")"}else{n+=i+" IN (";for(let h=0;h<d.SelectedNodes.length;h++)h>0&&(n+=","),n+=d.SelectedNodes[h].Id;n+=")"}}else d.DeleteButtonVisibility||(n+=" AND ",n+=i+"=-12912")}),s.sFilter=n.toString(),o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(s.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(s.sFilter+="  AND EmpSeqNo IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")");let r=[];if(r.push(s.ToDate.Date.ToString("dd MMM yyyy")),r.push(s.sFilter),r.push(0),r.push(o.d.SessionManager.RoleID),r.push(o.d.SessionManager.UserID),r.push(o.d.SessionManager.LanguageID),s.dtFiltEmps=o.d.common.GetDataSet_SP(r,"spPAY_GetEmpMasterCCDetails").Tables[0],null!=s.dtFiltEmps&&s.dtFiltEmps.length>0)for(let d=0;d<s.dtFiltEmps.length;d++)s.sSelectedEmpSeqNos.length>0&&(s.sSelectedEmpSeqNos+=",",s.sSelectedEmpCodes+=","),s.sSelectedEmpSeqNos+=s.dtFiltEmps[d].EmpSeqNo.toString(),s.sSelectedEmpCodes+="'"+s.dtFiltEmps[d].EmpCode.toString()+"'"}else s.objEmpFilter.Filter>0&&s.FilterEmployees()})()}FilterEmployees(){try{Logger.InfoLog("BiometricConfigViewModel::Entering FilterEmployees()"),o.d.SessionManager.LocationID>0&&o.d.SessionManager.Preferences.ContainsKey("LocationWiseDimension")&&o.d.SessionManager.Preferences.LocationWiseDimension.split(",").Contains("50051")&&(this.sFilter+=" AND EmpSeqNo IN ( Select NodeID From Com_CCCCData with(nolock) where CostCenterID=50051 and CCNID2="+o.d.SessionManager.LocationID+")"),m.J0.IsEmpty(o.d.SessionManager.sWHEmpFilteredEmpSeqNos)||(this.sFilter+="  AND EmpSeqNo IN ("+o.d.SessionManager.sWHEmpFilteredEmpSeqNos+")");let s=[];if(s.push(this.ToDate.Date.ToString("dd MMM yyyy")),s.push(this.sFilter),s.push(0),s.push(o.d.SessionManager.RoleID),s.push(o.d.SessionManager.UserID),s.push(o.d.SessionManager.LanguageID),this.dtFiltEmps=o.d.common.GetDataSet_SP(s,"spPAY_GetEmpMasterCCDetails").Tables[0],null!=this.dtFiltEmps&&this.dtFiltEmps.length>0)for(let l=0;l<this.dtFiltEmps.length;l++)this.sSelectedEmpSeqNos.length>0&&(this.sSelectedEmpSeqNos+=",",this.sSelectedEmpCodes+=","),this.sSelectedEmpSeqNos+=this.dtFiltEmps[l].EmpSeqNo.toString(),this.sSelectedEmpCodes+="'"+this.dtFiltEmps[l].EmpCode.toString()+"'";Logger.InfoLog("BiometricConfigViewModel::Exiting FilterEmployees()")}catch(s){Logger.ErrorLog("BiometricConfigViewModel::EXCEPTION FilterEmployees()\r\n"+s.Message+"\r\n"+s.stack)}}Export_Click(){}PostData_Click(){ve.RibbonExtViewModel.GetPay_BioPostData(this)}GetGroupByFilterEmployees(){let s="  AND EmpSeqNo IN ("+this.sEmpSeqNosOnGrid+")",l=[];return l.push(this.ToDate.Date.ToString("dd MMM yyyy")),l.push(s),l.push(0),l.push(o.d.SessionManager.RoleID),l.push(o.d.SessionManager.UserID),l.push(o.d.SessionManager.LanguageID),o.d.common.GetDataSet_SP(l,"spPAY_GetEmpMasterCCDetails").Tables[0]}CreateSQLTable(s,l){let t="",i="",n="";t=" CREATE TABLE "+s+"(";for(let r=0;r<l.Columns.length;r++){switch(n="",i=l.Columns[r].DataType.toString(),i){case"System.Int32":n=" int ";break;case"System.Int64":n=" bigint ";break;case"System.Int16":n=" smallint ";break;case"System.Byte":n=" tinyint ";break;case"System.Decimal":n=" float ";break;case"System.DateTime":n=" datetime ";break;case"System.String":n=m.J0.Format(" nvarchar({0}) ",-1==l.Columns[r].MaxLength?"max":l.Columns[r].MaxLength.toString())}""!=n?(t+="\n ["+l.Columns[r].ColumnName+"] ",t+=n,t+=","):(l.Columns.Remove(l.Columns[r].ColumnName),l.AcceptChanges(),r--)}return t.substr(0,t.length-1)+"\n)"}BulkInsertData(s,l){}GetShiftsAssignedData(){let l=o.d.empService.GetQueryData(0,"BIO003",o.d.SessionManager.Preferences.ShiftAssignBasedOn,this.FromDate.Date.ToString("dd MMM yyyy"),this.ToDate.Date.ToString("dd MMM yyyy"));l&&l.Tables.length>0&&(this.dtShiftsData=l.Tables[0])}GetBioMetricData(){this.dicConf.APTMAttendPunchTableName=this.dicConf.APTMAttendPunchTableName.Replace("@Month",this.FromDate.Date.iMonth().toString()).Replace("@Year",this.FromDate.Date.getFullYear().toString());let s="\n        Select EmpCode, EmpName, CONVERT(VARCHAR(11), PunchTime, 106) as PunchDate, PunchTime, CONVERT(VARCHAR(8), PunchTime, 108) as PTime ";this.bDocColumns&&this.dicConf.APTMDeviceNo.Trim().length>0&&(s+=",DeviceNo as DeviceNo "),this.dicConf.APTMDirection.Trim().length>0&&(s+=" ,Direction as Direction",this.bDirection=!0),s+=" FROM ( Select EMP."+this.dicConf.ETMEmpCode+" as EmpCode, EMP."+this.dicConf.ETMEmpName+" as EmpName, ",s+=" AP."+this.dicConf.APTMPunchDateTime+" as PunchTime ",this.bDocColumns&&this.dicConf.APTMDeviceNo.Trim().length>0&&(s+=" ,AP."+this.dicConf.APTMDeviceNo+" as DeviceNo "),this.dicConf.APTMDirection.Trim().length>0&&(s+=" ,AP."+this.dicConf.APTMDirection+" as Direction "),s+=" From "+this.dicConf.APTMAttendPunchTableName+" AP WITH(NOLOCK)",""!=this.dicConf.APTMEmpSeqNo?s+=" JOIN "+this.dicConf.ETMEmpTableName+" EMP WITH(NOLOCK) on EMP."+this.dicConf.ETMEmpSeqNo+"=AP."+this.dicConf.APTMEmpSeqNo+" ":""!=this.dicConf.APTMEmpCode?s+=" JOIN "+this.dicConf.ETMEmpTableName+" EMP WITH(NOLOCK) on EMP."+this.dicConf.ETMEmpCode+"=AP."+this.dicConf.APTMEmpCode:""!=this.dicConf.APTMEmpCodeInDevice&&(s+=" JOIN "+this.dicConf.ETMEmpTableName+" EMP WITH(NOLOCK) on EMP."+this.dicConf.ETMEmpCodeInDevice+"=AP."+this.dicConf.APTMEmpCodeInDevice),s+=" WHERE 1=1 ",this.sSelectedEmpCodes.Trim().length>0&&(s+=" AND EMP."+this.dicConf.ETMEmpCode+" IN ("+this.sSelectedEmpCodes+") "),this.dicConf.ETMEmpWhere.Trim().length>0&&(s+=" AND "+this.dicConf.ETMEmpWhere),this.dicConf.APTMAttendPunchWhere.Trim().length>0&&(s+=" AND "+this.dicConf.APTMAttendPunchWhere),this.dicConf.APTMDeviceNo.Trim().length>0&&this.dicConf.APTMDeviceNoValues.Trim().length>0&&(s+=" AND AP."+this.dicConf.APTMDeviceNo+" IN("+this.dicConf.APTMDeviceNoValues+")"),s+=" AND DATEDIFF(DAY,AP."+this.dicConf.APTMPunchDateTime+",'"+this.FromDate.Date.AddDays(-1).ToString("dd MMM yyyy")+"')<=0 AND DATEDIFF(DAY,AP."+this.dicConf.APTMPunchDateTime+",'"+this.ToDate.Date.AddDays(1).ToString("dd MMM yyyy")+"')>=0\n) as tbl\n        Order By PunchTime, EmpCode ";let l=[];l.push(this.BMCDatabaseType.SelectedValue),l.push(this.BMCServerName.Text.Trim()),l.push(this.BMCDatabaseName.Text.Trim()),l.push(this.BMCUserId.Text.Trim()),l.push(this.BMCPassword.Text);let t=o.d.empService.ReportDataSet("RPT022",!0,s,"","","","",l);this.dtBioMetData=t.Tables[0]}GetData_Click(){var s=this;return(0,B.A)(function*(){let l=0;if(s.sEmpSeqNosOnGrid="",s.ListVisbility=!1,yield s.LoadConfig(),s.IsAutoPost){let d=[];if(d.push(s.ToDate.Date.ToString("dd MMM yyyy")),d.push(s.sFilter),d.push(0),d.push(o.d.SessionManager.RoleID),d.push(o.d.SessionManager.UserID),d.push(o.d.SessionManager.LanguageID),s.dtFiltEmps=o.d.common.GetDataSet_SP(d,"spPAY_GetEmpMasterCCDetails").Tables[0],null!=s.dtFiltEmps&&s.dtFiltEmps.length>0)for(let C=0;C<s.dtFiltEmps.length;C++)s.sSelectedEmpSeqNos.length>0&&(s.sSelectedEmpSeqNos+=",",s.sSelectedEmpCodes+=","),s.sSelectedEmpSeqNos+=s.dtFiltEmps[C].EmpSeqNo.toString(),s.sSelectedEmpCodes+="'"+s.dtFiltEmps[C].EmpCode.toString()+"'"}else yield s.Filter_Click();if(s.FromDate.Date>s.ToDate.Date)return s.DisplayMessage="'From Date' should be less than or Equal to 'To Date'",void(s.MessageVisibility=!0);if(0==s.sSelectedEmpCodes.length)return s.DisplayMessage="No Employees found",void(s.MessageVisibility=!0);s.DispMessage="Loading data, Please wait....",s.MsgVisibility=!0;let t="";for(let d=0;d<s.dgvDocColumns.Table.length;d++)null!=s.dgvDocColumns.Table[d].Destination&&null!=s.dgvDocColumns.Table[d].Destination&&""!=s.dgvDocColumns.Table[d].Destination.toString()&&"-1"!=s.dgvDocColumns.Table[d].Destination.toString()&&s.dgvDocColumns.Table[d].Destination.toString().startsWith("dcCCNID")&&(t.length>0&&(t+=","),t+=(5e4+parseInt(s.dgvDocColumns.Table[d].Destination.toString().Replace("dcCCNID",""))).toString());t.length>0&&(s.dsbDims=o.d.empService.GetQueryData(0,"BIO007",JSON.stringify(t),"",""));let i="";if(s.dsbEmps=o.d.empService.GetQueryData(0,"BIO004","","",""),s.dgv.Clear(),s.GDBQchkUseQuery.IsChecked&&s.GDBQtxtQuery.Text.Trim().length>0){let d=[],C="";if("1"==s.BMCDatabaseType.SelectedValue){C=s.GDBQtxtQuery.Text.Replace("@FROMDATE@","'"+s.FromDate.Date.ToString("dd-MMM-yyyy")+"'").Replace("@TODATE@","'"+s.ToDate.Date.ToString("dd-MMM-yyyy")+"'").Replace("@EMPCODES@",s.sSelectedEmpCodes).Replace("@Month",s.FromDate.Date.iMonth().toString()).Replace("@Year",s.FromDate.Date.getFullYear().toString());try{d=o.d.empService.GetData_ClickData(s.Title,s.sFilter,s.FromDate.Date.ToString("dd MMM yyyy"),s.ToDate.Date.ToString("dd MMM yyyy"),s.sSelectedEmpCodes)}catch(h){return s.MsgVisibility=!1,s.DisplayMessage=h.Message,void(s.MessageVisibility=!0)}}else if("2"==s.BMCDatabaseType.SelectedValue){C=s.GDBQtxtQuery.Text.Replace("@FROMDATE@","#"+s.FromDate.Date.ToString("dd-MMM-yyyy")+"#").Replace("@TODATE@","#"+s.ToDate.Date.ToString("dd-MMM-yyyy")+"#").Replace("@EMPCODES@",s.sSelectedEmpCodes).Replace("@Month",s.FromDate.Date.iMonth().toString()).Replace("@Year",s.FromDate.Date.getFullYear().toString());try{d=o.d.empService.GetData_ClickData(s.Title,s.sFilter,s.FromDate.Date.ToString("dd MMM yyyy"),s.ToDate.Date.ToString("dd MMM yyyy"),s.sSelectedEmpCodes)}catch(h){return s.MsgVisibility=!1,s.DisplayMessage=h.Message,void(s.MessageVisibility=!0)}}if(null!=d&&d.Tables.length>0&&d.Tables[0].length>0){let h,c;l=0;for(let g=0;g<d.Tables[0].length;g++)c=s.dsbEmps.Tables[0].filter(e=>e.Code==d.Tables[0][g].EmpCode.toString()),null!=c&&c.length>0&&(s.sEmpSeqNosOnGrid.length>0&&(s.sEmpSeqNosOnGrid+=","),s.sEmpSeqNosOnGrid+=c[0].NodeID.toString(),l++,h=s.dgv.NewRow(),h.SlNo=l.toString(),h.EmpCode=d.Tables[0][g].EmpCode,h.EmpName=d.Tables[0][g].EmpName,h.PunchDate=new Date(d.Tables[0][g].PunchDate).ToString("dd/MMM/yyyy"),h.ShiftCode=d.Tables[0][g].ShiftCode,h.ShiftName=d.Tables[0][g].ShiftName,d.Tables[0][g].StartTime.toString().Contains(".")||(d.Tables[0][g].StartTime=d.Tables[0][g].StartTime.toString().Contains(":")?d.Tables[0][g].StartTime.toString().Replace(":","."):d.Tables[0][g].StartTime.toString()+".0"),h.ActStartTime=new Date(d.Tables[0][g].StartTime.toString().Replace(".",":")).ToString("HH:mm"),d.Tables[0][g].EndTime.toString().Contains(".")||(d.Tables[0][g].EndTime=d.Tables[0][g].EndTime.toString().Contains(":")?d.Tables[0][g].EndTime.toString().Replace(":","."):d.Tables[0][g].EndTime.toString()+".0"),h.ActEndTime=new Date(d.Tables[0][g].EndTime.toString().Replace(".",":")).ToString("HH:mm"),h.ActTotHrs=parseFloat(d.Tables[0][g].TotHrs).ToString("00.00"),0==parseFloat(h.ActTotHrs)&&(h.Row_Background="#F77B7E"),s.bDocColumns&&(s.dgv.TableColumns.Contains("IN Device No")&&(h["IN Device No"]=d.Tables[0][g].INDeviceNo),s.dgv.TableColumns.Contains("OUT Device No")&&(h["OUT Device No"]=d.Tables[0][g].OUTDeviceNo)),h.Remarks="",s.dgv.addRow(h));s.MsgVisibility=!1}else s.MsgVisibility=!1,s.DisplayMessage="No data found.",s.MessageVisibility=!0;return}if("2"==s.BMCDatabaseType.SelectedValue){s.dicConf.ETMEmpTableName=s.ETMEmpTableName.Text.Trim(),s.dicConf.APTMAttendPunchTableName=s.APTMAttendPunchTableName.Text.Trim();let h="";h=" SELECT * FROM "+s.dicConf.ETMEmpTableName,s.dicConf.APTMAttendPunchTableName=s.dicConf.APTMAttendPunchTableName.Replace("@Month",s.FromDate.Date.iMonth().toString()).Replace("@Year",s.FromDate.Date.getFullYear().toString()),h=" SELECT * FROM "+s.dicConf.APTMAttendPunchTableName+" WHERE DateValue("+s.dicConf.APTMPunchDateTime+") BETWEEN #"+s.FromDate.Date.AddDays(-1).ToString("dd/MMM/yyyy")+"# AND #"+s.ToDate.Date.AddDays(1).ToString("dd/MMM/yyyy")+"#"}"3"==s.BMCDatabaseType.SelectedValue&&(s.dicConf.ETMEmpTableName=s.ETMEmpTableName.Text.Trim(),s.dicConf.APTMAttendPunchTableName=s.APTMAttendPunchTableName.Text.Trim());let n=[],r=!1;if(""!=s.dicConf.ETMEmpTableName.Trim()&&""!=s.dicConf.APTMAttendPunchTableName.Trim()){if(null!=s.dtFiltEmps&&s.dtFiltEmps.length>0){if(s.GetShiftsAssignedData(),null==s.dtShiftsData||0==s.dtShiftsData.length)return s.MsgVisibility=!1,s.DisplayMessage="Enter atlest one Shift Assign document for Default Employee",void(s.MessageVisibility=!0);let C=o.d.SessionManager.Preferences.ShiftAssignBasedOn;s.GetBioMetricData();let h=[];h.push("EmpSeqNo"),h.push("EmpCode"),h.push("EmpName"),h.push("PunchDate"),h.push("StartTime"),h.push("EndTime"),h.push("TotHrs"),s.bDocColumns&&(s.dgv.TableColumns.Contains("IN Device No")&&h.push("IN Device No"),s.dgv.TableColumns.Contains("OUT Device No")&&h.push("OUT Device No")),h.push("Remarks"),h.push("lfts"),h.push("EmpCodeNumeric");let e,p,u,P,x,y,M,c=s.FromDate.Date.OnlyDate(),g=s.ToDate.Date.OnlyDate(),A=null,T="",I="",S=!1,v=0,O=0;l=0;let N=s.dtBioMetData.ToTable(!0,["EmpCode","EmpName"]);if(null!=N&&N.length>0){let E=null,G="";for(let se=0;se<N.length;se++)u=s.dtFiltEmps.filter(f=>f.EmpCode==N[se].EmpCode.toString()),null!=u&&u.length>0&&(G.length>0&&(G+=","),G+=u[0].EmpSeqNo.toString());if("-2"!=C){let se=[];se.push(g.ToString("dd MMM yyyy")),se.push(" AND EmpSeqNo IN("+G+")"),se.push(0),se.push(o.d.SessionManager.RoleID),se.push(o.d.SessionManager.UserID),se.push(o.d.SessionManager.LanguageID),E=o.d.common.GetDataSet_SP(se,"spPAY_GetEmpMasterCCDetails").Tables[0]}s.bDonotPullBiometricDataifAttendanceisposted&&(i="",40067==parseInt(s.DPCDocumentName.SelectedValue)||40087==parseInt(s.DPCDocumentName.SelectedValue)?i="SELECT C.dcCCNID51 EmpSeqNo,CONVERT(DATETIME,T.DCALPHA1) DADate,I.VoucherNo FROM INV_DOCDETAILS I WITH(NOLOCK)\n                            JOIN COM_DOCCCDATA C WITH(NOLOCK) ON C.INVDOCDETAILSID = I.INVDOCDETAILSID\n                            JOIN COM_DOCTEXTDATA T WITH(NOLOCK) ON T.INVDOCDETAILSID = I.INVDOCDETAILSID\n                            JOIN COM_DOCNUMDATA N WITH(NOLOCK) ON N.INVDOCDETAILSID = I.INVDOCDETAILSID\n                            WHERE T.tDocumentType = 67 AND StatusID NOT IN(372, 376) AND C.dcCCNID51 in ("+G+")\n                            AND ISDATE(T.DCALPHA1) = 1 AND CONVERT(DATETIME, T.DCALPHA1) BETWEEN CONVERT(DATETIME, '"+s.FromDate.Date.ToString("dd/MMM/yyyy")+"') AND CONVERT(DATETIME, '"+s.ToDate.Date.ToString("dd/MMM/yyyy")+"') ":(40089==parseInt(s.DPCDocumentName.SelectedValue)||40090==parseInt(s.DPCDocumentName.SelectedValue))&&(i="SELECT C.dcCCNID51 EmpSeqNo,CONVERT(DATETIME,T.DCALPHA1) DADate,I.VoucherNo FROM INV_DOCDETAILS I WITH(NOLOCK)\n                            JOIN COM_DOCCCDATA C WITH(NOLOCK) ON C.INVDOCDETAILSID = I.INVDOCDETAILSID\n                            JOIN COM_DOCTEXTDATA T WITH(NOLOCK) ON T.INVDOCDETAILSID = I.INVDOCDETAILSID\n                            JOIN COM_DOCNUMDATA N WITH(NOLOCK) ON N.INVDOCDETAILSID = I.INVDOCDETAILSID\n                            WHERE T.tCostCenterID = "+parseInt(s.DPCDocumentName.SelectedValue)+" AND StatusID NOT IN(372, 376) AND C.dcCCNID51 in ("+G+")\n                            AND ISDATE(T.DCALPHA1) = 1 AND CONVERT(DATETIME, T.DCALPHA1) BETWEEN CONVERT(DATETIME, '"+s.FromDate.Date.ToString("dd/MMM/yyyy")+"') AND CONVERT(DATETIME, '"+s.ToDate.Date.ToString("dd/MMM/yyyy")+"') "),i.Trim().length>0&&(A=o.d.empService.GetQueryData(parseInt(s.DPCDocumentName.SelectedValue),"BIO008",JSON.stringify(G),s.FromDate.Date.ToString("dd/MMM/yyyy"),s.ToDate.Date.ToString("dd/MMM/yyyy"))));let J=null,U=null;for(;c<=g;){for(let se=0;se<N.length;se++){if(r=!1,u=s.dtFiltEmps.filter(z=>z.EmpCode==N[se].EmpCode.toString()),null!=u&&u.length>0){if(c<m.J0.ParseDate(u[0].DOJ))continue;I=u[0].EmpSeqNo.toString(),v=parseInt(u[0].lft)}if(s.bDonotPullBiometricDataifAttendanceisposted&&null!=A&&A.length>0&&(x=A.filter(z=>z.EmpSeqNo==I&&z.DADate==c.ToString("dd/MMM/yyyy")),null!=x&&x.length>0))continue;l++,e={},e.SNo=l.toString(),e.EmpSeqNo=I,e.lfts=v,null!=s.SortBasedOn.SelectedValue&&"5"==s.SortBasedOn.SelectedValue&&(O=0,O=m.J0.Int(N[se].EmpCode),e.EmpCodeNumeric=O>0?O:0),e.EmpCode=N[se].EmpCode,e.EmpName=N[se].EmpName,e.PunchDate=c.ToString("dd/MMM/yyyy"),S=!1;let f="",oe=s.dtShiftsData;if("-2"==C)f="EmpSeqNo IN(1,"+I+") ",oe=oe.filter(z=>1==z.EmpSeqNo||z.EmpSeqNo==I);else{let z="",W=C.split(",");if(null!=W&&W.length>0){let ne=E.filter(_=>_.EmpSeqNo==I);for(let _=0;_<W.length;_++)null!=W[_]&&""!=W[_]&&(z="-2"==W[_]?"EmpSeqNo":"dcCCNID"+(parseInt(W[_])-5e4),f.length>0&&(f+=" AND "),f+=z+"="+ne[0][z.Replace("dcCCNID","CCNID")],oe=oe.filter(re=>re[z]==ne[0][z.Replace("dcCCNID","CCNID")]))}}if(T=f+" AND AssigningFrom <='"+c.ToString("dd/MMM/yyyy")+"' AND AssigningUpto >='"+c.ToString("dd/MMM/yyyy")+"'",oe=oe.filter(z=>null!=z.AssigningFrom&&new Date(z.AssigningFrom.ToString("dd/MMM/yyyy"))<=c&&null!=z.AssigningUpto&&new Date(z.AssigningUpto.ToString("dd/MMM/yyyy"))>=c),u=oe,u.sort((z,W)=>z.DocID>W.DocID||z.DocID==W.DocID&&z.EmpSeqNo>W.EmpSeqNo?1:-1),null!=u&&u.length>0){let z=(new Date).OnlyDate();if(y=m.J0.ParseDate(z.ToString("dd/MMM/yyyy")+" "+u[0].ShiftBMStartTime),M=m.J0.ParseDate(z.ToString("dd/MMM/yyyy")+" "+u[0].ShiftBMEndTime),y>M?(y=c.AddHours(y.getHours()).AddMinutes(y.getMinutes()).AddSeconds(y.getSeconds()),M=c.AddDays(1).AddHours(M.getHours()).AddMinutes(M.getMinutes()).AddSeconds(M.getSeconds())):(y=c.AddHours(y.getHours()).AddMinutes(y.getMinutes()).AddSeconds(y.getSeconds()),M=c.AddHours(M.getHours()).AddMinutes(M.getMinutes()).AddSeconds(M.getSeconds())),T="EmpCode='"+e.EmpCode.toString()+"' AND PunchTime>='"+y.toString()+"' AND PunchTime<='"+M.toString()+"'",P=s.dtBioMetData.filter(W=>W.EmpCode==e.EmpCode.toString()&&new Date(W.PunchTime)>=y&&new Date(W.PunchTime)<=M),P.sort((W,ne)=>W.PunchTime-ne.PunchTime),!(null!=P&&P.length>0))continue;if(1==P.length)e.StartTime=new Date(P[0].PunchTime).ToString("HH:mm:00"),e.EndTime=new Date(P[0].PunchTime).ToString("HH:mm:00"),M=y,s.bDirection&&(e.Remarks=s.APTMDirectionInVal.Text==P[0].Direction.toString()?"Check-Out Missing":"Check-In Missing"),h.Contains("IN Device No")&&(e["IN Device No"]=P[0].DeviceNo.toString()),h.Contains("OUT Device No")&&(e["OUT Device No"]=P[0].DeviceNo.toString());else if(s.bDirection){let W=!1,ne=!1;if(s.bGetMultipleCheckInOutInaDay){for(let _=0;_<P.length;_++){W=!1,ne=!1,p={};for(let re=0;re<e.ItemArray.length;re++)p[re]=e[re];s.APTMDirectionInVal.Text==P[_].Direction.toString()&&(p.StartTime=new Date(P[_].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(p["IN Device No"]=P[_].DeviceNo.toString()),W=!0),s.APTMDirectionOutVal.Text==P[_].Direction.toString()&&(p.EndTime=new Date(P[_].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(p["OUT Device No"]=P[_].DeviceNo.toString()),ne=!0),(W||ne)&&(P.length>_+1?(W&&(s.APTMDirectionOutVal.Text==P[_+1].Direction.toString()?(p.EndTime=new Date(P[_+1].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(p["OUT Device No"]=P[_+1].DeviceNo.toString()),_++):(p.EndTime=new Date(P[_].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(p["OUT Device No"]=P[_].DeviceNo.toString()),p.Remarks="Check-Out Missing",M=y)),ne&&(p.StartTime=new Date(P[_].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(p["IN Device No"]=P[_].DeviceNo.toString()),p.Remarks="Check-In Missing",M=y)):(W&&(p.EndTime=new Date(P[_].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(p["OUT Device No"]=P[_].DeviceNo.toString()),p.Remarks="Check-Out Missing",M=y),ne&&(p.StartTime=new Date(P[_].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(p["IN Device No"]=P[_].DeviceNo.toString()),p.Remarks="Check-In Missing",M=y)),y=new Date(y.ToString("dd/MMM/yyyy")+" "+p.StartTime.toString()),M=new Date(y.ToString("dd/MMM/yyyy")+" "+p.EndTime.toString())<new Date(y.ToString("dd/MMM/yyyy")+" "+p.StartTime.toString())?new Date(M.ToString("dd/MMM/yyyy")+" "+p.EndTime.toString()):new Date(y.ToString("dd/MMM/yyyy")+" "+p.EndTime.toString()),p.TotHrs=ve.RibbonExtViewModel.CalculateTotalTime(y,y,M,M),n.push(p))}S=!0}else{if(T="EmpCode='"+e.EmpCode.toString()+"' AND PunchTime>='"+y.toString()+"' AND PunchTime<='"+M.toString()+"' AND Direction='"+s.APTMDirectionInVal.Text+"'",J=s.dtBioMetData.filter(_=>_.EmpCode==e.EmpCode.toString()&&new Date(_.PunchTime)>=y&&new Date(_.PunchTime)<=M&&_.Direction==s.APTMDirectionInVal.Text),J.sort((_,re)=>_.PunchTime-re.PunchTime),null!=J&&J.length>0&&(W=!0,e.StartTime=new Date(J[0].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(e["IN Device No"]=J[0].DeviceNo.toString())),T="EmpCode='"+e.EmpCode.toString()+"' AND PunchTime>='"+y.toString()+"' AND PunchTime<='"+M.toString()+"' AND Direction='"+s.APTMDirectionOutVal.Text+"'",U=s.dtBioMetData.filter(_=>_.EmpCode==e.EmpCode.toString()&&new Date(_.PunchTime)>=y&&new Date(_.PunchTime)<=M&&_.Direction==s.APTMDirectionInVal.Text),U.sort((_,re)=>_.PunchTime-re.PunchTime),null!=U&&U.length>0&&(W?new Date(U[U.length-1].PunchTime)>new Date(J[0].PunchTime)&&(ne=!0,e.EndTime=new Date(U[U.length-1].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(e["OUT Device No"]=U[U.length-1].DeviceNo.toString())):(ne=!0,e.EndTime=new Date(U[U.length-1].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(e["OUT Device No"]=U[U.length-1].DeviceNo.toString()))),!W&&!ne)continue;(!W||!ne)&&(M=y,W?(e.EndTime=new Date(J[0].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(e["OUT Device No"]=J[0].DeviceNo.toString()),e.Remarks="Check-Out Missing"):(e.StartTime=new Date(U[U.length-1].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(e["IN Device No"]=U[U.length-1].DeviceNo.toString()),e.Remarks="Check-In Missing"))}}else if(s.bGetMultipleCheckInOutInaDay&&P.length>2){for(let W=0;W<P.length;W+=2){p={};for(let ne=0;ne<e.ItemArray.length;ne++)p[ne]=e[ne];p.StartTime=new Date(P[W].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(p["IN Device No"]=P[W].DeviceNo.toString()),W==P.length-1?(p.EndTime=new Date(P[W].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(p["OUT Device No"]=P[W].DeviceNo.toString())):(p.EndTime=new Date(P[W+1].PunchTime).ToString("HH:mm:00"),h.Contains("OUT Device No")&&(p["OUT Device No"]=P[W+1].DeviceNo.toString())),y=new Date(y.ToString("dd/MMM/yyyy")+" "+p.StartTime.toString()),M=new Date(y.ToString("dd/MMM/yyyy")+" "+p.EndTime.toString())<new Date(y.ToString("dd/MMM/yyyy")+" "+p.StartTime.toString())?new Date(M.ToString("dd/MMM/yyyy")+" "+p.EndTime.toString()):new Date(y.ToString("dd/MMM/yyyy")+" "+p.EndTime.toString()),p.TotHrs=ve.RibbonExtViewModel.CalculateTotalTime(y,y,M,M),n.push(p)}S=!0}else e.StartTime=new Date(P[0].PunchTime).ToString("HH:mm:00"),e.EndTime=new Date(P[P.length-1].PunchTime).ToString("HH:mm:00"),h.Contains("IN Device No")&&(e["IN Device No"]=P[0].DeviceNo.toString()),h.Contains("OUT Device No")&&(e["OUT Device No"]=P[P.length-1].DeviceNo.toString());S||(y=new Date(y.ToString("dd/MMM/yyyy")+" "+e.StartTime.toString()),M=new Date(y.ToString("dd/MMM/yyyy")+" "+e.EndTime.toString())<new Date(y.ToString("dd/MMM/yyyy")+" "+e.StartTime.toString())?new Date(M.ToString("dd/MMM/yyyy")+" "+e.EndTime.toString()):new Date(y.ToString("dd/MMM/yyyy")+" "+e.EndTime.toString()),e.TotHrs=ve.RibbonExtViewModel.CalculateTotalTime(y,y,M,M))}else{if(!s.IsAutoPost)return s.MsgVisibility=!1,s.DisplayMessage="Assign Shift for the Employee Code : "+N[se].EmpCode,void(s.MessageVisibility=!0);s.MsgVisibility=!1,s.DisplayMessage="Assign Shift for the Employee Code : "+N[se].EmpCode,s.MessageVisibility=!0,r=!0}r||S||n.push(e)}c=c.AddDays(1)}}}if(l=0,n.length>0){let C,h,c="";null!=s.SortBasedOn.SelectedValue&&"1"!=s.SortBasedOn.SelectedValue&&("2"==s.SortBasedOn.SelectedValue?c="EmpCode":"3"==s.SortBasedOn.SelectedValue?c="EmpName":"4"==s.SortBasedOn.SelectedValue?c="lfts":"5"==s.SortBasedOn.SelectedValue&&(c="EmpCodeNumeric"));for(let g=0;g<n.length;g++){if(h=s.dsbEmps.Tables[0].filter(p=>p.Code==n[g].EmpCode.toString()),!(null!=h&&h.length>0))continue;s.sEmpSeqNosOnGrid.length>0&&(s.sEmpSeqNosOnGrid+=","),s.sEmpSeqNosOnGrid+=h[0].NodeID.toString(),l++;let e=(new Date).OnlyDate();if(C=s.dgv.NewRow(),C.SlNo=l.toString(),C.EmpCode=n[g].EmpCode,C.EmpName=n[g].EmpName,C.PunchDate=new Date(n[g].PunchDate).ToString("dd/MMM/yyyy"),C.ActStartTime=m.J0.ParseDate(e.ToString("dd/MMM/yyyy")+" "+n[g].StartTime).ToString("HH:mm"),C.ActEndTime=m.J0.ParseDate(e.ToString("dd/MMM/yyyy")+" "+n[g].EndTime).ToString("HH:mm"),C.ActTotHrs=n[g].TotHrs,s.bUseROffTimings){let p,u,P,y,x=0;if(p=m.J0.ParseDate(e.ToString("dd/MMM/yyyy")+" "+C.ActStartTime),u=m.J0.ParseDate(e.ToString("dd/MMM/yyyy")+" "+C.ActEndTime),null!=s.dsROffTimings.Tables.ROffRow&&(y=s.dsROffTimings.Tables.ROffRow.filter(M=>M.MinsFrom<=p.ToString("HH:mm")&&p.ToString("HH:mm")<=M.MinsUpto),null!=y&&y.length>0&&(p=new Date(p.getFullYear(),p.iMonth(),p.getDate(),parseInt(y[0].ROffTime.toString().split(":")[0]),parseInt(y[0].ROffTime.toString().split(":")[1]),0)),y=s.dsROffTimings.Tables.ROffRow.filter(M=>M.MinsFrom<=u.ToString("HH:mm")&&u.ToString("HH:mm")<=M.MinsUpto),null!=y&&y.length>0&&(u=new Date(u.getFullYear(),u.iMonth(),u.getDate(),parseInt(y[0].ROffTime.toString().split(":")[0]),parseInt(y[0].ROffTime.toString().split(":")[1]),0))),C.ROffStartTime=p.ToString("HH:mm"),C.ROffEndTime=u.ToString("HH:mm"),x=0,P=u.Subtract(p),p>u){C.ROffTotHrs="00.00",C.Row_Background="#F77B7E";continue}P=u.Subtract(p),x=parseFloat(P.Hours.ToString("00")+"."+P.Minutes.ToString("00")),C.ROffTotHrs=x.ToString("00.00")}s.bDocColumns&&(s.dgv.TableColumns.Contains("IN Device No")&&(C["IN Device No"]=n[g]["IN Device No"].toString()),s.dgv.TableColumns.Contains("OUT Device No")&&(C["OUT Device No"]=n[g]["OUT Device No"].toString())),0==parseFloat(C.ActTotHrs)&&(C.Row_Background="#F77B7E"),C.Remarks=m.J0.String(n[g].Remarks),s.dgv.addRow(C)}s.MsgVisibility=!1}else s.MsgVisibility=!1,s.DisplayMessage="No data found.",s.MessageVisibility=!0}})()}GetBMConnString(){return"1"==this.BMCDatabaseType.SelectedValue?"Data Source="+this.BMCServerName.Text.Trim()+";Initial Catalog="+this.BMCDatabaseName.Text.Trim()+";Persist Security Info=True;User ID="+this.BMCUserId.Text.Trim()+";Password="+this.BMCPassword.Text:""}}var wt=V(13816);function fs(F,s){if(1&F&&(a.j41(0,"div",20),a.EFF(1,"\n                            "),a.j41(2,"app-PactGridView",21),a.EFF(3,"\n                            "),a.k0s(),a.EFF(4,"\n                        "),a.k0s()),2&F){const l=a.XpG();a.R7$(2),a.Y8G("obj",l.obj.dgv)("group",l.form)}}function Es(F,s){if(1&F&&(a.qex(0),a.EFF(1,"\n                                "),a.j41(2,"app-PactGridView",21),a.EFF(3,"\n                                "),a.k0s(),a.EFF(4,"\n                            "),a.bVm()),2&F){const l=a.XpG();a.R7$(2),a.Y8G("obj",l.obj.dgvFailedRecord)("group",l.form)}}let xs=(()=>{class F{constructor(){this.form=new ae.gE({})}ngOnInit(){this.params?.obj&&(this.obj=this.params.obj)}static#e=this.\u0275fac=function(t){return new(t||F)};static#t=this.\u0275cmp=a.VBU({type:F,selectors:[["app-biometric-config-view-model"]],decls:64,vars:17,consts:[["id","maincontainer",1,"maincontainer","master_container"],[1,"page-header"],[1,"page-title_div"],[1,"page-title"],[1,"btnMetroDiv","secondary-btn-group"],[1,"secondary-btn",3,"click"],[1,"fa-light","fa-user"],[1,"fa-light","fa-floppy-disk-circle-arrow-right"],[1,"fa-light","fa-file-export"],[1,"document-screen","main_div"],[1,"PACTTabFields","pagesection-noborder","tab_content","tab-exrafields","custom_accordion",2,"height","100%"],[1,"master-tab-container",2,"width","100%","height","98%"],["heading","Data",3,"removable"],[1,"row","form-row",2,"width","100%","margin-left","10px"],[1,"form-group","col-xl-4","col-md-4","col-sm-12","col-xs-12","PACTControl"],["FieldDirective","",3,"obj","group"],[1,"documentgrid","row","form-row",2,"width","100%"],["class","form-group col-9 section documentgrid",4,"ngIf"],[1,"form-group","col-3",2,"overflow","scroll"],[4,"ngIf"],[1,"form-group","col-9","section","documentgrid"],[2,"width","100%",3,"obj","group"]],template:function(t,i){1&t&&(a.j41(0,"div",0),a.EFF(1,"\n    "),a.j41(2,"div",1),a.EFF(3,"\n        "),a.j41(4,"div",2),a.EFF(5,"\n            "),a.j41(6,"span",3),a.EFF(7),a.k0s(),a.EFF(8,"\n\n        "),a.k0s(),a.EFF(9,"\n        "),a.j41(10,"div",4),a.EFF(11,"\n            "),a.j41(12,"span",5),a.bIt("click",function(){return i.obj.OnButtonClick("GetData")}),a.nrm(13,"i",6),a.EFF(14),a.nI1(15,"translate"),a.k0s(),a.EFF(16,"\n            "),a.j41(17,"span",5),a.bIt("click",function(){return i.obj.OnButtonClick("PostData")}),a.nrm(18,"i",7),a.EFF(19),a.nI1(20,"translate"),a.k0s(),a.EFF(21,"\n            "),a.j41(22,"span",5),a.bIt("click",function(){return i.obj.OnButtonClick("Export")}),a.nrm(23,"i",8),a.EFF(24),a.nI1(25,"translate"),a.k0s(),a.EFF(26,"\n        "),a.k0s(),a.EFF(27,"\n    "),a.k0s(),a.EFF(28,"\n\n    "),a.j41(29,"div",9),a.EFF(30,"\n\n        "),a.j41(31,"div",10),a.EFF(32,"\n            "),a.j41(33,"tabset",11),a.EFF(34,"\n                "),a.j41(35,"tab",12),a.EFF(36,"\n                    "),a.j41(37,"div",13),a.EFF(38,"\n                        "),a.j41(39,"div",14),a.EFF(40,"\n                            "),a.eu8(41,15),a.EFF(42,"\n                        "),a.k0s(),a.EFF(43,"\n                        "),a.j41(44,"div",14),a.EFF(45,"\n                            "),a.eu8(46,15),a.EFF(47,"\n                        "),a.k0s(),a.EFF(48,"\n                    "),a.k0s(),a.EFF(49,"\n                    "),a.j41(50,"div",16),a.EFF(51,"\n                        "),a.DNE(52,fs,5,2,"div",17),a.EFF(53,"\n                        "),a.j41(54,"div",18),a.EFF(55,"\n                            "),a.DNE(56,Es,5,2,"ng-container",19),a.EFF(57,"\n\n                        "),a.k0s(),a.EFF(58,"\n                    "),a.k0s(),a.EFF(59,"\n                "),a.k0s(),a.EFF(60,"\n            "),a.k0s(),a.EFF(61,"\n        "),a.k0s(),a.EFF(62,"\n    "),a.k0s(),a.EFF(63,"\n"),a.k0s()),2&t&&(a.R7$(7),a.SpI("\n                ",i.obj.Title,"\n            "),a.R7$(7),a.JRh(a.bMT(15,11,"Get Data")),a.R7$(5),a.JRh(a.bMT(20,13,"Post")),a.R7$(5),a.JRh(a.bMT(25,15,"Export")),a.R7$(11),a.Y8G("removable",!1),a.R7$(6),a.Y8G("obj",i.obj.FromDate)("group",i.form),a.R7$(5),a.Y8G("obj",i.obj.ToDate)("group",i.form),a.R7$(6),a.Y8G("ngIf",i.obj.dgv),a.R7$(4),a.Y8G("ngIf",i.obj.ListVisbility))},dependencies:[ce.bT,ye._,Ne.X,wt.V6,wt.fw,De.D9]})}return F})();class As{static LoadPayrollScreen(s,l){if(50054!=s.FeatureID)if(256==s.FeatureID){let t=new Je.SetPayrollDateViewModel;o.d.page.ShowDialog(t,Me.SetPayrollDateComponent,{ShowCenter:!0,Title:o.d.GetResource("Pay_SetPayrollDate")})}else if(258==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof Et);if(t)o.d.page.SetActiveTab(t);else{let i=new Et(l);i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:Qt,params:{obj:i}})}}else if(260==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof je);if(t)o.d.page.SetActiveTab(t);else{let i=new je(l);i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:Se,params:{obj:i}})}}else if(261==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof bt.N);if(t)o.d.page.SetActiveTab(t);else{let i=new bt.N(l);i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:ss,params:{obj:i}})}}else if(262==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof Lt);if(t)o.d.page.SetActiveTab(t);else{let i=new Lt;i.Title=i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:gs,params:{obj:i}})}}else if(263!=s.FeatureID)if(264==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof Vt);if(t)o.d.page.SetActiveTab(t);else{let i=new Vt;i.IncomeTaxComputationViewModel(),i.Title=i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:Ms,params:{obj:i}})}}else if(40095==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof rt.FinalSettlementViewModel);if(t)o.d.page.SetActiveTab(t);else{let i=new rt.FinalSettlementViewModel(l);i.FinalSettlementViewModel_1().then(n=>{1==i.DialogResult&&(i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:as.FinalSettlementComponent,params:{obj:i}}))})}}else if(141==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof vt);if(t)o.d.page.SetActiveTab(t);else{let i=new vt(l);i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:xs,params:{obj:i}})}}else if(266==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof At);if(t)o.d.page.SetActiveTab(t);else{let i=new At(l);i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:es,params:{obj:i}})}}else if(267!=s.FeatureID)if(40054==s.FeatureID){let t=o.d.page.tabs.find(i=>i.params?.obj instanceof Ve.MonthlyPayrollViewModel);if(t)o.d.page.SetActiveTab(t);else{let i=new Ve.MonthlyPayrollViewModel(s.ScreenName,"");i.DisplayName=l,o.d.page.addNewTab({title:s.ScreenName,component:lt.MonthlyPayrollComponent,params:{obj:i}})}}else if(40088!=s.FeatureID&&"4101"===s.FeatureActionID.toString())return{component:pe.TreeViewPageComponent,params:{ScreenName:s.ScreenName,FeatureActionID:s.FeatureActionID,CostCenterID:s.FeatureID,Call:"C3"},basedon:"CostCenterID"};return{}}static LoadMonthlyPayrolByVoucherNo(s,l){return new Ve.MonthlyPayrollViewModel(s,"",l)}static GetAppraisal(s){let P,l=0,t=0,i=0,n=0,r=!1,C="",h="",c="",g=new Date,e=new Date,p=new Date,u=s.ToTable(!0,["EmpSeqNo"]);if(null!=u&&u.length>0)for(let x=0;x<u.length;x++)if(null!=u[x].EmpSeqNo&&null!=u[x].EmpSeqNo&&""!=u[x].EmpSeqNo.toString()&&(l=parseInt(u[x].EmpSeqNo),P=s.filter(y=>y.EmpSeqNo==l),null!=P&&P.length>0)){g=new Date(P[0].EffectFrom),e=new Date(P[0].ApplyFrom),p=new Date(P[0].NextAppraisalDate),null!=P[0].Remarks&&null!=P[0].Remarks&&(C=P[0].Remarks.toString()),null!=P[0].Reason&&null!=P[0].Reason&&(h=P[0].Reason.toString());let y=o.d.common.GetDataSet3("BULK004",l.toString(),g.getMonth().toString(),g.getFullYear().toString());i=null!=y&&y.Tables.length>0&&y.Tables[0].length>0?parseInt(y.Tables[0][0].SeqNo):0;let M=new Ss.X(null,l,new Date,i);M.isFromBulkAppraisals=!0,M.EffectFrom.Date=g,M.ActAppraisalFrom.Date=e,M.NextAppraisal.Date=p,M.Remarks.Text=C,M.Reason.Text=h;for(let A=0;A<P.length;A++){if(t=parseInt(P[A].ComponentID),n=parseFloat(P[A].Amt),r=!1,null!=y&&y.Tables.length>1&&y.Tables[1].length>0){let T=y.Tables[1].filter(I=>"BasicMonthlyFld"==I.prefname);null!=T&&T.length>0&&""!=T[0].prefvalue.toString()&&t==parseInt(T[0].prefvalue.toString())&&(M.BasicMonthly.Text=n.toString(),r=!0),T=y.Tables[1].filter(I=>"AnnualCTCFld"==I.prefname),null!=T&&T.length>0&&""!=T[0].prefvalue.toString()&&t==parseInt(T[0].prefvalue.toString())&&(M.AnnualCTC.Text=n.toString(),r=!0)}for(let T=0;T<M.dgvEarnings.Table.length;T++)if(M.dgvEarnings.Table[T].EarComponentID.toString()==t.toString()){M.dgvEarnings.Table[T].EarValue=n,r=!0;break}if(!r)for(let T=0;T<M.dgvDeductions.Table.length;T++)if(M.dgvDeductions.Table[T].DedComponentID.toString()==t.toString()){M.dgvDeductions.Table[T].DedValue=n;break}}M.ExecuteFormulas(),M.OnButtonClick("Save"),null!=M.DisplayMessage&&M.DisplayMessage.length>0||M.strUpdate.length>0&&(c+=M.strUpdate)}return c}static LoadFinalSettlementByVoucherNo(s,l){return new rt.FinalSettlementViewModel(s,l)}static ShowQuickAdd_Payroll(s,l){return(0,B.A)(function*(){if(50051==s){const{AddEditEmpMasterComponent:t}=yield V.e(2742).then(V.bind(V,12742)),{AddEditEmpMasterViewModel:i}=yield Promise.resolve().then(V.bind(V,76412));let r={obj:new i(l,0,0,"",!1)};o.d.page.addNewTab({title:"",component:t,params:r})}})()}}}}]);