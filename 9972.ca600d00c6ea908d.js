"use strict";(self.webpackChunkRevenUWebApp=self.webpackChunkRevenUWebApp||[]).push([[9972],{59972:(R,g,h)=>{h.r(g),h.d(g,{PaymentTermViewModel:()=>O});var d=h(86739),l=h(8787),f=h(32647),G=h(23823),x=h(31820),o=h(92701),I=h(49710),p=h(18569),T=h(48792),D=h(89417),e=h(54438),B=h(8495),S=h(73955);let _=(()=>{class y{constructor(){this.form=new D.gE({})}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||y)};static#t=this.\u0275cmp=e.VBU({type:y,selectors:[["app-paymenttermimport"]],inputs:{obj:"obj"},decls:72,vars:24,consts:[["fileUpload",""],["fileUpload1",""],[1,"master-screen",2,"padding-bottom","4px"],[1,"PACTHeaderFields","dialogSubBody"],[1,"form-group","row","form-row","col-xl-12","col-md-12","col-sm-12","col-xs-12","PACTControl",2,"flex-direction","row","display","flex","align-items","center"],[1,"input_cntrl_label",2,"width","70px"],[2,"margin-right","10px","width","200px"],["type","text","readonly","",1,"form-group","row","form-row","PACTControl","input_cntrl",3,"ngModelChange","ngModel"],[2,"width","80px"],["type","file","accept",".xlsx,.xls,.csv","name","upload",2,"display","none",3,"change"],[1,"secondary-btn-wicon",2,"border","0px!important",3,"click"],[1,"fa-light","fa-search"],[2,"width","70px"],["type","file","accept",".rim","name","upload",2,"display","none",3,"change"],[1,"form-group","row","form-row","PACTControl",2,"margin-top","15px"],["FieldDirective","",3,"obj","group"],[1,"Pactdailogfooter"],[1,"primary-btn-wicon",3,"click"],[1,"fa-light","fa-circle-check"],[1,"secondary-btn-wicon",3,"click"],[1,"fa-light","fa-rectangle-xmark"]],template:function(i,n){if(1&i){const r=e.RV6();e.j41(0,"div",2),e.EFF(1,"\n    "),e.j41(2,"div",3),e.EFF(3,"\n        "),e.j41(4,"div",4),e.EFF(5,"\n            "),e.j41(6,"label",5),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.EFF(9,"\n            "),e.j41(10,"div",6),e.EFF(11,"\n                "),e.j41(12,"input",7),e.mxI("ngModelChange",function(a){return e.eBV(r),e.DH7(n.obj.ActualFileName,a)||(n.obj.ActualFileName=a),e.Njj(a)}),e.k0s(),e.EFF(13,"\n            "),e.k0s(),e.EFF(14,"\n            "),e.j41(15,"div",8),e.EFF(16,"\n                "),e.j41(17,"input",9,0),e.bIt("change",function(a){return e.eBV(r),e.Njj(n.obj.OpenFile(a))}),e.k0s(),e.EFF(19,"\n                "),e.j41(20,"span",10),e.bIt("click",function(){e.eBV(r);const a=e.sdS(18);return e.Njj(a.click())}),e.nrm(21,"i",11),e.EFF(22),e.nI1(23,"translate"),e.k0s(),e.EFF(24,"\n            "),e.k0s(),e.EFF(25,"\n        "),e.k0s(),e.EFF(26,"      \n\n        "),e.j41(27,"div",4),e.EFF(28,"\n            "),e.j41(29,"label",5),e.EFF(30),e.nI1(31,"translate"),e.k0s(),e.EFF(32,"\n            "),e.j41(33,"div",6),e.EFF(34,"\n                "),e.j41(35,"input",7),e.mxI("ngModelChange",function(a){return e.eBV(r),e.DH7(n.obj.RimFileName,a)||(n.obj.RimFileName=a),e.Njj(a)}),e.k0s(),e.EFF(36,"\n            "),e.k0s(),e.EFF(37,"\n            "),e.j41(38,"div",12),e.EFF(39,"\n                "),e.j41(40,"input",13,1),e.bIt("change",function(a){return e.eBV(r),e.Njj(n.obj.Open(a))}),e.k0s(),e.EFF(42,"\n                "),e.j41(43,"span",10),e.bIt("click",function(){e.eBV(r);const a=e.sdS(41);return e.Njj(a.click())}),e.nrm(44,"i",11),e.EFF(45),e.nI1(46,"translate"),e.k0s(),e.EFF(47,"\n            "),e.k0s(),e.EFF(48,"\n        "),e.k0s(),e.EFF(49,"\n        "),e.j41(50,"div",14),e.EFF(51,"\n            "),e.eu8(52,15),e.EFF(53,"\n        "),e.k0s(),e.EFF(54,"\n    "),e.k0s(),e.EFF(55,"\n    "),e.j41(56,"div",16),e.EFF(57,"\n        "),e.j41(58,"div"),e.EFF(59,"\n            "),e.j41(60,"button",17),e.bIt("click",function(){return e.eBV(r),e.Njj(n.obj.OnButtonClick("Import"))}),e.nrm(61,"i",18),e.EFF(62),e.nI1(63,"translate"),e.k0s(),e.EFF(64,"\n            "),e.j41(65,"button",19),e.bIt("click",function(){return e.eBV(r),e.Njj(n.obj.OnButtonClick("CancelImport"))}),e.nrm(66,"i",20),e.EFF(67),e.nI1(68,"translate"),e.k0s(),e.EFF(69,"\n        "),e.k0s(),e.EFF(70,"\n    "),e.k0s(),e.EFF(71,"\n"),e.k0s()}2&i&&(e.xc7("width",n.obj.IsMobile?"unset":"400px"),e.R7$(7),e.JRh(e.bMT(8,12,"Com_Attachments_FileName")),e.R7$(5),e.R50("ngModel",n.obj.ActualFileName),e.R7$(10),e.JRh(e.bMT(23,14,"Browse")),e.R7$(8),e.JRh(e.bMT(31,16,"Rim File")),e.R7$(5),e.R50("ngModel",n.obj.RimFileName),e.R7$(10),e.JRh(e.bMT(46,18,"Open")),e.R7$(7),e.Y8G("obj",n.obj.DtImportObj)("group",n.form),e.R7$(10),e.JRh(e.bMT(63,20,"Ok")),e.R7$(5),e.JRh(e.bMT(68,22,"Cancel")))},dependencies:[D.me,D.BC,D.vS,B._,S.D9],encapsulation:2})}return y})();var C=h(62288);class O extends G.g{get DtImport(){return this.DtImportObj.Table}set DtImport(t){this.DtImportObj.Table=t}get ImportCols(){return this.DtImportObj.Columns}set ImportCols(t){this.DtImportObj.Columns=t}constructor(){super(),this.ImportVisiblity=!1,this.DtImportObj=new I.vv,this.ds=null,this.obj=new T.Document,this.Name=new x.Dw(0),this.Profile=new o.y$(0),this.Dimensions=new o.y$(0),this.ExcelData=[],this.ExcelDataColumn=[],this.Name.Enable=!1,this.DisplayName=d.d.GetResource("Payment_Terms"),this.ProfileFill(),this.AddGridColumns(),this.FillingRows(),this.PaymentGrid.SearchVisible=!1,this.Name.Label="Name",this.Profile.Label="Profile",this.Dimensions.Label="Dimension",this.Profile.SelectionChangedCommand.Subscribe(this,"OnProfileSelection")}OnBeginEdit(t){"DataGridPactListBoxColumn"==t.args.column.className&&!l.J0.IsEmpty(this.Dimensions.SelectedValue)&&"0"!=this.Dimensions.SelectedValue&&(t.args.Column.CostCenterID=parseInt(this.Dimensions.SelectedValue))}OnCellEditEnding(t){let s=t.item;"PactTextBoxEditor"==t.column.className&&"Percent"==t.column.field&&(""!=l.J0.String(s.Percent).Trim()?(""==l.J0.String(s.Period)&&(s.Period="1"),""==l.J0.String(s.TypeID)&&(s.TypeID="0"),""==l.J0.String(s.BasedOn)&&(s.BasedOn="1"),""==l.J0.String(s.PostonDate)&&(s.PostonDate="0")):(""!=l.J0.String(s.Period)&&(s.Period=null),""!=l.J0.String(s.TypeID)&&(s.TypeID=null),""!=l.J0.String(s.BasedOn)&&(s.BasedOn=null),""!=l.J0.String(s.PostonDate)&&(s.PostonDate=null)),this.PaymentGrid.updateRow(s),this.PaymentGrid.UpdateTotals())}ProfileFill(){this.Profile.Items.Clear(),this.ds=this.obj.GetAndDeleteTerms(0,1),null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables[0].length>0?(this.Profile.Items.push(o._p.ComboBoxItems_2("New","-1")),this.ds.Tables[0].forEach(t=>{0==this.Profile.Items.filter(s=>s.Value==t.ProfileID.toString()).length&&this.Profile.Items.push(o._p.ComboBoxItems_2(t.ProfileName.toString(),t.ProfileID.toString()))})):(this.Profile.Items.push(o._p.ComboBoxItems_2("New","-1")),this.Dimensions.Visible=!1),null!=this.ds&&this.ds.Tables.length>1&&!l.J0.IsEmpty(d.d.SessionManager.Preferences.EnableDimPayterm)&&(0,f.yG0)(d.d.SessionManager.Preferences.EnableDimPayterm)?(this.Dimensions.Label="Dimensions",this.Dimensions.Items.push(o._p.ComboBoxItems_2("","0")),this.ds.Tables[1].forEach(t=>{this.Dimensions.Items.push(o._p.ComboBoxItems_2(t.Name.toString(),t.FeatureID.toString()))}),d.d.SessionManager.Preferences.ContainsKey("PaytermLinkDim")&&""!=d.d.SessionManager.Preferences.PaytermLinkDim&&(this.Dimensions.SelectedValue=d.d.SessionManager.Preferences.PaytermLinkDim,this.Dimensions.Enable=!1),this.Dimensions.Visible=!0):this.Dimensions.Visible=!1}FillingRows(){if(0==this.PaymentGrid.Table.length)for(let t=this.PaymentGrid.Table.length;t<10;t++){let s=this.PaymentGrid.NewRow();s.Sno=t+1,this.PaymentGrid.addRow(s)}}AddGridColumns(){this.PaymentGrid=new I.vv,this.PaymentGrid.Columns=[],this.PaymentGrid.CellEditEnding.Subscribe(this,"OnCellEditEnding"),this.PaymentGrid.BeginEdit.Subscribe(this,"OnBeginEdit"),this.PaymentGrid.Table=[],this.PaymentGrid.CanUserAddRows=!0,this.PaymentGrid.CanUserDeleteRows=!0,this.PaymentGrid.Height=window.innerHeight-100,this.PaymentGrid.Width=(window.innerWidth-90).toString(),this.PaymentGrid.TableColumns.push("Sno"),this.PaymentGrid.TableColumns.push("Percent"),this.PaymentGrid.TableColumns.push("Days"),this.PaymentGrid.TableColumns.push("Period"),this.PaymentGrid.TableColumns.push("TypeID"),this.PaymentGrid.TableColumns.push("BasedOn"),this.PaymentGrid.TableColumns.push("Occurences"),this.PaymentGrid.TableColumns.push("PostonDate"),this.PaymentGrid.TableColumns.push("Remarks"),this.PaymentGrid.TableColumns.push("Remarks1");let t=new p.O7;t.Header=d.d.GetResource("Sno"),t.DisplayMember="Sno",t.ReadOnly=!0,t.Width=50,t.DataType="FLOAT",this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header=d.d.GetResource("Percentage"),t.DisplayMember="Percent",t.ReadOnly=!1,t.Width=135,t.ShowTotal=!0,t.IsCalculated=1,t.DecimalPoints="",t.DataType="FLOAT",this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Number",t.DisplayMember="Days",t.ReadOnly=!1,t.Width=100,t.DataType="INT",this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Period",t.ValueBinding="Period",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=100;let s=new Array;s.push(o._p.ComboBoxItems_2("Month(s)","2")),s.push(o._p.ComboBoxItems_2("Day(s)","1")),t.ComboData=s,this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Type",t.ValueBinding="TypeID",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=100,s=new Array,s.push(o._p.ComboBoxItems_2("None","0")),s.push(o._p.ComboBoxItems_2("Repeat","1")),s.push(o._p.ComboBoxItems_2("Divide","2")),t.ComboData=s,this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Based On",t.ValueBinding="BasedOn",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=100,s=new Array,s.push(o._p.ComboBoxItems_2("Voucher Date","1")),s.push(o._p.ComboBoxItems_2("Preference Date","2")),t.ComboData=s,this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Occurences",t.DisplayMember="Occurences",t.Width=100,t.DataType="INT",this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Remarks",t.DisplayMember="Remarks",t.Width=100,this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Remarks1",t.DisplayMember="Remarks1",t.Width=100,this.PaymentGrid.Columns.push(t),t=new p.O7,t.Header="Post on Date",t.ValueBinding="PostonDate",t.DataType="ComboBox",t.DisplayMember="Name",t.ValueMember="Value",t.Width=100,s=new Array,s.push(o._p.ComboBoxItems_2("Same","0")),s.push(o._p.ComboBoxItems_2("1","1")),s.push(o._p.ComboBoxItems_2("2","2")),s.push(o._p.ComboBoxItems_2("3","3")),s.push(o._p.ComboBoxItems_2("4","4")),s.push(o._p.ComboBoxItems_2("5","5")),s.push(o._p.ComboBoxItems_2("6","6")),s.push(o._p.ComboBoxItems_2("7","7")),s.push(o._p.ComboBoxItems_2("8","8")),s.push(o._p.ComboBoxItems_2("9","9")),s.push(o._p.ComboBoxItems_2("10","10")),s.push(o._p.ComboBoxItems_2("11","11")),s.push(o._p.ComboBoxItems_2("12","12")),s.push(o._p.ComboBoxItems_2("13","13")),s.push(o._p.ComboBoxItems_2("14","14")),s.push(o._p.ComboBoxItems_2("15","15")),s.push(o._p.ComboBoxItems_2("16","16")),s.push(o._p.ComboBoxItems_2("17","17")),s.push(o._p.ComboBoxItems_2("18","18")),s.push(o._p.ComboBoxItems_2("19","19")),s.push(o._p.ComboBoxItems_2("20","20")),s.push(o._p.ComboBoxItems_2("21","21")),s.push(o._p.ComboBoxItems_2("22","22")),s.push(o._p.ComboBoxItems_2("23","23")),s.push(o._p.ComboBoxItems_2("24","24")),s.push(o._p.ComboBoxItems_2("25","25")),s.push(o._p.ComboBoxItems_2("26","26")),s.push(o._p.ComboBoxItems_2("27","27")),s.push(o._p.ComboBoxItems_2("28","28")),s.push(o._p.ComboBoxItems_2("29","29")),s.push(o._p.ComboBoxItems_2("30","30")),s.push(o._p.ComboBoxItems_2("LastDayofMonth","31")),t.ComboData=s,this.PaymentGrid.Columns.push(t),this.Dimensions.Visible&&(t=new p.O7,t.Header="Dimension",t.DisplayMember="Dim",t.DataType="LISTBOX",t.Width=150,t.TypeID=1,this.PaymentGrid.Columns.push(t),this.PaymentGrid.TableColumns.push("Dim_Key"),this.PaymentGrid.TableColumns.push("Dim")),this.DtImportObj.Clear(),this.DtImportObj.Columns=[],this.DtImport=[];let i=new p.O7;i.DisplayMember="FieldName",i.Header=d.d.GetResource("Import_FieldName"),i.DataType="TextBlock",i.Width=100,i.ReadOnly=!0,this.ImportCols.push(i),this.DtImportObj.TableColumns.push("FieldName"),i=new p.O7,i.DisplayMember="Name",i.ValueMember="Value",i.ValueBinding="FeatureFieldName",i.Header=d.d.GetResource("Import_FeatureFieldName"),i.DataType="ComboBox",i.Width=120,s=[],s.push(o._p.ComboBoxItems_2("","")),this.PaymentGrid.Columns.forEach(n=>{!l.J0.IsEmpty(n.DisplayMember)&&"Sno"!=n.DisplayMember&&n.IsVisible&&s.push(o._p.ComboBoxItems_2(n.Header,"ComboBox"==n.DataType?n.ValueBinding:n.DisplayMember))}),i.ComboData=s,this.ImportCols.push(i),this.DtImportObj.TableColumns.push("FeatureFieldName")}ImportData(){this.PaymentGrid.Clear();for(let t=0;t<this.ExcelTable.length;t++){let s=this.PaymentGrid.NewRow();s.Sno=t+1,this.DtImport.forEach(i=>{let n=this.ExcelDataColumn.indexOf(i.FieldName);if(""!=l.J0.String(i[Object.keys(i)[2]])&&""!=l.J0.String(this.ExcelTable[t][n])){var r=this.PaymentGrid.Columns.find(m=>!l.J0.IsEmpty(m.ValueBinding)&&m.ValueBinding==l.J0.String(i[Object.keys(i)[2]]));null==r&&(r=this.PaymentGrid.Columns.find(m=>"ComboBox"!=m.DataType&&m.DisplayMember==l.J0.String(i[Object.keys(i)[2]]))),null!=r&&("ComboBox"==r.DataType?s[r.ValueBinding]=this.ExcelTable[t][n]:s[r.DisplayMember]=this.ExcelTable[t][n])}}),this.PaymentGrid.addRow(s)}}OnButtonClick(t){if("Save"==t){if(null==this.Name.Text||""==this.Name.Text)return this.DisplayMessage="Enter Profile Name",void(this.MessageVisibility=!0);if(d.d.SessionManager.Preferences.ContainsKey("Validate100PerPayTerm")&&!l.J0.IsEmpty(d.d.SessionManager.Preferences.Validate100PerPayTerm)&&(0,f.yG0)(d.d.SessionManager.Preferences.Validate100PerPayTerm)){var i=this.PaymentGrid.Columns.find(a=>null!=a.DisplayMember&&"Percent"==a.DisplayMember);if(null!=i){let a=0;if(l.J0.IsEmpty(i.footer.toString())||(a=parseFloat(i.footer.toString())),a<100)return this.DisplayMessage="Percentage should be equal to 100%",void(this.MessageVisibility=!0)}}this.PaymentGrid.angularGrid?.slickGrid&&this.PaymentGrid.angularGrid?.slickGrid.getActiveCellNode()&&this.PaymentGrid.angularGrid.slickGrid.getEditorLock().commitCurrentEdit();let n="",r=0;for(let a=0;a<this.PaymentGrid.Table.length;a++)!l.J0.IsEmpty(this.PaymentGrid.Table[a].Percent)&&!l.J0.IsEmpty(this.PaymentGrid.Table[a].Days)&&(n+="<Row ",l.J0.IsEmpty(this.PaymentGrid.Table[a].TypeID)||"1"!=this.PaymentGrid.Table[a].TypeID.toString()||l.J0.IsEmpty(this.PaymentGrid.Table[a].Occurences)?r+=parseFloat(this.PaymentGrid.Table[a].Percent.toString()):r+=parseFloat(this.PaymentGrid.Table[a].Percent.toString())*parseFloat(this.PaymentGrid.Table[a].Occurences.toString()),n+='percentage="'+this.PaymentGrid.Table[a].Percent.toString()+'" ',l.J0.IsEmpty(this.PaymentGrid.Table[a].Days)||(n+='Days="'+this.PaymentGrid.Table[a].Days.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].Period)||(n+='Period="'+this.PaymentGrid.Table[a].Period.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].TypeID)||(n+='TypeID="'+this.PaymentGrid.Table[a].TypeID.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].BasedOn)||(n+='BasedOn="'+this.PaymentGrid.Table[a].BasedOn.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].Occurences)||(n+='Occurences="'+this.PaymentGrid.Table[a].Occurences.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].PostonDate)||(n+='DateNo="'+this.PaymentGrid.Table[a].PostonDate.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].Remarks)||(n+='Remarks="'+this.PaymentGrid.Table[a].Remarks.toString()+'" '),l.J0.IsEmpty(this.PaymentGrid.Table[a].Remarks1)||(n+='Remarks1="'+this.PaymentGrid.Table[a].Remarks1.toString()+'" '),this.Dimensions.Visible&&!l.J0.IsEmpty(this.PaymentGrid.Table[a].Dim_Key)&&(n+='Dim="'+this.PaymentGrid.Table[a].Dim_Key.toString()+'" '),n+='Discount="" ',n+="/>");if(r>100)return this.DisplayMessage="Percentage can not be greater than 100.",void(this.MessageVisibility=!0);let m=0;T.Document.SetPaymentDiscountTerm(this.Name.Text,this.Profile.SelectedValue,this.Dimensions.SelectedValue,n.toString()).subscribe(a=>{this.DisplayMessage=a.Message,m=a.RetValue,m>0?(this.Name.Text="",this.PaymentGrid.Clear(),this.FillingRows(),this.ProfileFill()):this.MessageVisibility=!0},a=>{console.log(a),this.DisplayMessage="Error in save"})}else if("ImportVisiblity"==t.toString()){this.ImportVisiblity=!0;let n="Import";this.DtImportObj.Height=300,d.d.page.ShowDialog(this,_,{NoWidth:!0,Title:n})}else"CancelImport"==t.toString()?(d.d.page.HideDialog(this.PopUpGUID),this.ImportVisiblity=!1):"Import"==t.ToString()?this.ImportData():("-1"==this.Profile.SelectedValue?this.DisplayMessage="Cannot Delete New":(this.ds=this.obj.GetAndDeleteTerms(parseInt(this.Profile.SelectedValue),3),null!=this.ds&&this.ds.Tables.length>0&&this.ds.Tables[0].length>0&&(this.DisplayMessage=this.ds.Tables[0][0].ErrorMessage.toString(),"Deleted Successfully"==this.DisplayMessage&&(this.Name.Text="",this.PaymentGrid.Clear(),this.FillingRows(),this.ProfileFill()))),this.MessageVisibility=!0)}Open(t){if(1!==t.target.files.length)throw new Error("Cannot use multiple files");{const s=new FileReader,i=t.target.files[0];this.RimFileName=t.target.value;let n=new l.VB;s.onload=r=>{if(n.LoadXml(s.result),null!=n)for(let a=0;a<n.DocumentElement.children.length;a++){const P=n.DocumentElement.children[a];(a+1).toString()==P.attributes[0].value&&(this.DtImport[a].FeatureFieldName=l.J0.String(P.attributes[2].value),this.DtImportObj.updateRow(this.DtImport[a]))}},s.readAsBinaryString(i)}}OpenFile(t){if(1!==t.target.files.length)throw new Error("Cannot use multiple files");const s=new FileReader,i=t.target.files[0];s.onload=n=>{const a=C.LF(s.result,{type:"binary",cellDates:!0});this.ExcelData=C.Wp.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1}),this.ExcelTable=this.ExcelData;try{this.ActualFileName=t.target.value,this.DtImport.Clear();for(let u=0;u<this.ExcelData[0].length;u++){let b=this.DtImportObj.NewRow();this.DtImportObj.addRow(b),b.FieldName=this.ExcelData[0][u],this.DtImportObj.updateRow(b)}if(this.ExcelTable.length>0&&(this.ExcelDataColumn=this.ExcelTable[0],this.ExcelTable.splice(0,1)),console.log(this.DtImport),console.log("DTImport"),!l.J0.IsEmpty(this.ImportCols[1].DefaultValueText)){let u=new l.VB;if(u.LoadXml(this.ImportCols[1].DefaultValueText),null!=u)for(let b=0;b<u.DocumentElement.children.length;b++){const E=u.DocumentElement.children[b];for(let c=0;c<this.DtImport.length;c++)(c+1).toString()==E.attributes[0].value&&(this.DtImport[c].FeatureFieldName=l.J0.String(E.attributes[2].value),this.DtImportObj.updateRow(this.DtImport[c]))}}}catch(F){return void(this.DisplayMessage=F.Message)}},s.readAsBinaryString(i)}OnProfileSelection(t){if("-1"==this.Profile.SelectedValue)this.Name.Enable=!0,this.Name.Text="",this.PaymentGrid.Clear(),this.FillingRows();else if(null!=this.Profile.SelectedValue){this.Name.Enable=!1,this.ds=this.obj.GetAndDeleteTerms(parseInt(this.Profile.SelectedValue),0),this.Name.Text=this.Profile.GetText(),this.PaymentGrid.Clear();let s="";if(null!=this.ds&&this.ds.Tables.length>0){for(let i=0;i<this.ds.Tables[0].length;i++){let n=this.PaymentGrid.NewRow();n.Sno=i+1,n.Percent=this.ds.Tables[0][i].percentage,n.Days=this.ds.Tables[0][i].Days,l.J0.IsEmpty(this.ds.Tables[0][i].Period)||(n.Period=this.ds.Tables[0][i].Period),l.J0.IsEmpty(this.ds.Tables[0][i].TypeID)||(n.TypeID=this.ds.Tables[0][i].TypeID),l.J0.IsEmpty(this.ds.Tables[0][i].BasedOn)||(n.BasedOn=this.ds.Tables[0][i].BasedOn),l.J0.IsEmpty(this.ds.Tables[0][i].Occurences)||(n.Occurences=this.ds.Tables[0][i].Occurences),l.J0.IsEmpty(this.ds.Tables[0][i].DateNo)||(n.PostonDate=this.ds.Tables[0][i].DateNo),this.ds.Columns[0].Contains("Remarks")&&!l.J0.IsEmpty(this.ds.Tables[0][i].Remarks)&&(n.Remarks=this.ds.Tables[0][i].Remarks),this.ds.Columns[0].Contains("Remarks1")&&!l.J0.IsEmpty(this.ds.Tables[0][i].Remarks1)&&(n.Remarks1=this.ds.Tables[0][i].Remarks1),this.PaymentGrid.TableColumns.Contains("Dim_Key")&&!l.J0.IsEmpty(this.ds.Tables[0][i].DimNodeID)&&(n.Dim_Key=this.ds.Tables[0][i].DimNodeID,""!=s&&(s+=","),s+=this.ds.Tables[0][i].DimNodeID.toString()),this.PaymentGrid.addRow(n)}if(this.ds.Tables[0].length>0&&this.Dimensions.Visible&&!l.J0.IsEmpty(this.ds.Tables[0][0].DimCCID)&&"0"!=this.ds.Tables[0][0].dimccid.toString()){this.Dimensions.SelectedValue=this.ds.Tables[0][0].DimCCID.toString();let i=this.obj.GetdimensionNames(this.Dimensions.SelectedValue,s);i.Tables.length>0&&!i.Columns[0].Contains("ErrorMessage")&&this.PaymentGrid.Table.forEach(n=>{if(!l.J0.IsEmpty(n.Dim_Key.toString())){let r=i.Tables[0].filter(m=>m.NodeID==n.Dim_Key.toString());r.length>0&&(n.Dim=r[0][Object.keys(r[0])[1]].toString())}})}for(let i=this.ds.Tables[0].length;i<this.ds.Tables[0].length+10;i++){let n=this.PaymentGrid.NewRow();n.Sno=i+1,this.PaymentGrid.addRow(n)}}this.PaymentGrid.UpdateTotals()}}}}}]);